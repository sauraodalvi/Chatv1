(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function s(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(r){if(r.ep)return;r.ep=!0;const i=s(r);fetch(r.href,i)}})();function nm(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var ed={exports:{}},Cr={},td={exports:{}},X={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ya=Symbol.for("react.element"),sm=Symbol.for("react.portal"),am=Symbol.for("react.fragment"),rm=Symbol.for("react.strict_mode"),im=Symbol.for("react.profiler"),om=Symbol.for("react.provider"),lm=Symbol.for("react.context"),cm=Symbol.for("react.forward_ref"),dm=Symbol.for("react.suspense"),um=Symbol.for("react.memo"),hm=Symbol.for("react.lazy"),Pl=Symbol.iterator;function mm(e){return e===null||typeof e!="object"?null:(e=Pl&&e[Pl]||e["@@iterator"],typeof e=="function"?e:null)}var nd={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},sd=Object.assign,ad={};function Ss(e,t,s){this.props=e,this.context=t,this.refs=ad,this.updater=s||nd}Ss.prototype.isReactComponent={};Ss.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Ss.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function rd(){}rd.prototype=Ss.prototype;function bo(e,t,s){this.props=e,this.context=t,this.refs=ad,this.updater=s||nd}var ko=bo.prototype=new rd;ko.constructor=bo;sd(ko,Ss.prototype);ko.isPureReactComponent=!0;var zl=Array.isArray,id=Object.prototype.hasOwnProperty,jo={current:null},od={key:!0,ref:!0,__self:!0,__source:!0};function ld(e,t,s){var a,r={},i=null,o=null;if(t!=null)for(a in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(i=""+t.key),t)id.call(t,a)&&!od.hasOwnProperty(a)&&(r[a]=t[a]);var l=arguments.length-2;if(l===1)r.children=s;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];r.children=c}if(e&&e.defaultProps)for(a in l=e.defaultProps,l)r[a]===void 0&&(r[a]=l[a]);return{$$typeof:ya,type:e,key:i,ref:o,props:r,_owner:jo.current}}function pm(e,t){return{$$typeof:ya,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function No(e){return typeof e=="object"&&e!==null&&e.$$typeof===ya}function fm(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(s){return t[s]})}var Hl=/\/+/g;function Zr(e,t){return typeof e=="object"&&e!==null&&e.key!=null?fm(""+e.key):t.toString(36)}function Wa(e,t,s,a,r){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case ya:case sm:o=!0}}if(o)return o=e,r=r(o),e=a===""?"."+Zr(o,0):a,zl(r)?(s="",e!=null&&(s=e.replace(Hl,"$&/")+"/"),Wa(r,t,s,"",function(d){return d})):r!=null&&(No(r)&&(r=pm(r,s+(!r.key||o&&o.key===r.key?"":(""+r.key).replace(Hl,"$&/")+"/")+e)),t.push(r)),1;if(o=0,a=a===""?".":a+":",zl(e))for(var l=0;l<e.length;l++){i=e[l];var c=a+Zr(i,l);o+=Wa(i,t,s,c,r)}else if(c=mm(e),typeof c=="function")for(e=c.call(e),l=0;!(i=e.next()).done;)i=i.value,c=a+Zr(i,l++),o+=Wa(i,t,s,c,r);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function Ma(e,t,s){if(e==null)return e;var a=[],r=0;return Wa(e,a,"","",function(i){return t.call(s,i,r++)}),a}function gm(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(s){(e._status===0||e._status===-1)&&(e._status=1,e._result=s)},function(s){(e._status===0||e._status===-1)&&(e._status=2,e._result=s)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Ke={current:null},qa={transition:null},ym={ReactCurrentDispatcher:Ke,ReactCurrentBatchConfig:qa,ReactCurrentOwner:jo};function cd(){throw Error("act(...) is not supported in production builds of React.")}X.Children={map:Ma,forEach:function(e,t,s){Ma(e,function(){t.apply(this,arguments)},s)},count:function(e){var t=0;return Ma(e,function(){t++}),t},toArray:function(e){return Ma(e,function(t){return t})||[]},only:function(e){if(!No(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};X.Component=Ss;X.Fragment=am;X.Profiler=im;X.PureComponent=bo;X.StrictMode=rm;X.Suspense=dm;X.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ym;X.act=cd;X.cloneElement=function(e,t,s){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var a=sd({},e.props),r=e.key,i=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,o=jo.current),t.key!==void 0&&(r=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)id.call(t,c)&&!od.hasOwnProperty(c)&&(a[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)a.children=s;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];a.children=l}return{$$typeof:ya,type:e.type,key:r,ref:i,props:a,_owner:o}};X.createContext=function(e){return e={$$typeof:lm,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:om,_context:e},e.Consumer=e};X.createElement=ld;X.createFactory=function(e){var t=ld.bind(null,e);return t.type=e,t};X.createRef=function(){return{current:null}};X.forwardRef=function(e){return{$$typeof:cm,render:e}};X.isValidElement=No;X.lazy=function(e){return{$$typeof:hm,_payload:{_status:-1,_result:e},_init:gm}};X.memo=function(e,t){return{$$typeof:um,type:e,compare:t===void 0?null:t}};X.startTransition=function(e){var t=qa.transition;qa.transition={};try{e()}finally{qa.transition=t}};X.unstable_act=cd;X.useCallback=function(e,t){return Ke.current.useCallback(e,t)};X.useContext=function(e){return Ke.current.useContext(e)};X.useDebugValue=function(){};X.useDeferredValue=function(e){return Ke.current.useDeferredValue(e)};X.useEffect=function(e,t){return Ke.current.useEffect(e,t)};X.useId=function(){return Ke.current.useId()};X.useImperativeHandle=function(e,t,s){return Ke.current.useImperativeHandle(e,t,s)};X.useInsertionEffect=function(e,t){return Ke.current.useInsertionEffect(e,t)};X.useLayoutEffect=function(e,t){return Ke.current.useLayoutEffect(e,t)};X.useMemo=function(e,t){return Ke.current.useMemo(e,t)};X.useReducer=function(e,t,s){return Ke.current.useReducer(e,t,s)};X.useRef=function(e){return Ke.current.useRef(e)};X.useState=function(e){return Ke.current.useState(e)};X.useSyncExternalStore=function(e,t,s){return Ke.current.useSyncExternalStore(e,t,s)};X.useTransition=function(){return Ke.current.useTransition()};X.version="18.3.1";td.exports=X;var j=td.exports;const xm=nm(j);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vm=j,wm=Symbol.for("react.element"),bm=Symbol.for("react.fragment"),km=Object.prototype.hasOwnProperty,jm=vm.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Nm={key:!0,ref:!0,__self:!0,__source:!0};function dd(e,t,s){var a,r={},i=null,o=null;s!==void 0&&(i=""+s),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(o=t.ref);for(a in t)km.call(t,a)&&!Nm.hasOwnProperty(a)&&(r[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps,t)r[a]===void 0&&(r[a]=t[a]);return{$$typeof:wm,type:e,key:i,ref:o,props:r,_owner:jm.current}}Cr.Fragment=bm;Cr.jsx=dd;Cr.jsxs=dd;ed.exports=Cr;var n=ed.exports,Si={},ud={exports:{}},dt={},hd={exports:{}},md={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(b,E){var V=b.length;b.push(E);e:for(;0<V;){var ue=V-1>>>1,ce=b[ue];if(0<r(ce,E))b[ue]=E,b[V]=ce,V=ue;else break e}}function s(b){return b.length===0?null:b[0]}function a(b){if(b.length===0)return null;var E=b[0],V=b.pop();if(V!==E){b[0]=V;e:for(var ue=0,ce=b.length,Ze=ce>>>1;ue<Ze;){var ht=2*(ue+1)-1,tn=b[ht],st=ht+1,At=b[st];if(0>r(tn,V))st<ce&&0>r(At,tn)?(b[ue]=At,b[st]=V,ue=st):(b[ue]=tn,b[ht]=V,ue=ht);else if(st<ce&&0>r(At,V))b[ue]=At,b[st]=V,ue=st;else break e}}return E}function r(b,E){var V=b.sortIndex-E.sortIndex;return V!==0?V:b.id-E.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var c=[],d=[],u=1,g=null,h=3,p=!1,f=!1,y=!1,N=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(b){for(var E=s(d);E!==null;){if(E.callback===null)a(d);else if(E.startTime<=b)a(d),E.sortIndex=E.expirationTime,t(c,E);else break;E=s(d)}}function x(b){if(y=!1,w(b),!f)if(s(c)!==null)f=!0,H(k);else{var E=s(d);E!==null&&G(x,E.startTime-b)}}function k(b,E){f=!1,y&&(y=!1,m(L),L=-1),p=!0;var V=h;try{for(w(E),g=s(c);g!==null&&(!(g.expirationTime>E)||b&&!q());){var ue=g.callback;if(typeof ue=="function"){g.callback=null,h=g.priorityLevel;var ce=ue(g.expirationTime<=E);E=e.unstable_now(),typeof ce=="function"?g.callback=ce:g===s(c)&&a(c),w(E)}else a(c);g=s(c)}if(g!==null)var Ze=!0;else{var ht=s(d);ht!==null&&G(x,ht.startTime-E),Ze=!1}return Ze}finally{g=null,h=V,p=!1}}var I=!1,T=null,L=-1,P=5,D=-1;function q(){return!(e.unstable_now()-D<P)}function A(){if(T!==null){var b=e.unstable_now();D=b;var E=!0;try{E=T(!0,b)}finally{E?S():(I=!1,T=null)}}else I=!1}var S;if(typeof v=="function")S=function(){v(A)};else if(typeof MessageChannel<"u"){var M=new MessageChannel,U=M.port2;M.port1.onmessage=A,S=function(){U.postMessage(null)}}else S=function(){N(A,0)};function H(b){T=b,I||(I=!0,S())}function G(b,E){L=N(function(){b(e.unstable_now())},E)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(b){b.callback=null},e.unstable_continueExecution=function(){f||p||(f=!0,H(k))},e.unstable_forceFrameRate=function(b){0>b||125<b?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<b?Math.floor(1e3/b):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return s(c)},e.unstable_next=function(b){switch(h){case 1:case 2:case 3:var E=3;break;default:E=h}var V=h;h=E;try{return b()}finally{h=V}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(b,E){switch(b){case 1:case 2:case 3:case 4:case 5:break;default:b=3}var V=h;h=b;try{return E()}finally{h=V}},e.unstable_scheduleCallback=function(b,E,V){var ue=e.unstable_now();switch(typeof V=="object"&&V!==null?(V=V.delay,V=typeof V=="number"&&0<V?ue+V:ue):V=ue,b){case 1:var ce=-1;break;case 2:ce=250;break;case 5:ce=1073741823;break;case 4:ce=1e4;break;default:ce=5e3}return ce=V+ce,b={id:u++,callback:E,priorityLevel:b,startTime:V,expirationTime:ce,sortIndex:-1},V>ue?(b.sortIndex=V,t(d,b),s(c)===null&&b===s(d)&&(y?(m(L),L=-1):y=!0,G(x,V-ue))):(b.sortIndex=ce,t(c,b),f||p||(f=!0,H(k))),b},e.unstable_shouldYield=q,e.unstable_wrapCallback=function(b){var E=h;return function(){var V=h;h=E;try{return b.apply(this,arguments)}finally{h=V}}}})(md);hd.exports=md;var Sm=hd.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Mm=j,ct=Sm;function $(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,s=1;s<arguments.length;s++)t+="&args[]="+encodeURIComponent(arguments[s]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var pd=new Set,ea={};function Gn(e,t){ys(e,t),ys(e+"Capture",t)}function ys(e,t){for(ea[e]=t,e=0;e<t.length;e++)pd.add(t[e])}var Yt=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Mi=Object.prototype.hasOwnProperty,Tm=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Bl={},_l={};function Cm(e){return Mi.call(_l,e)?!0:Mi.call(Bl,e)?!1:Tm.test(e)?_l[e]=!0:(Bl[e]=!0,!1)}function Im(e,t,s,a){if(s!==null&&s.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return a?!1:s!==null?!s.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Am(e,t,s,a){if(t===null||typeof t>"u"||Im(e,t,s,a))return!0;if(a)return!1;if(s!==null)switch(s.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Qe(e,t,s,a,r,i,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=a,this.attributeNamespace=r,this.mustUseProperty=s,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=o}var Oe={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Oe[e]=new Qe(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Oe[t]=new Qe(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Oe[e]=new Qe(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Oe[e]=new Qe(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Oe[e]=new Qe(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Oe[e]=new Qe(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Oe[e]=new Qe(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Oe[e]=new Qe(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Oe[e]=new Qe(e,5,!1,e.toLowerCase(),null,!1,!1)});var So=/[\-:]([a-z])/g;function Mo(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(So,Mo);Oe[t]=new Qe(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(So,Mo);Oe[t]=new Qe(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(So,Mo);Oe[t]=new Qe(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Oe[e]=new Qe(e,1,!1,e.toLowerCase(),null,!1,!1)});Oe.xlinkHref=new Qe("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Oe[e]=new Qe(e,1,!1,e.toLowerCase(),null,!0,!0)});function To(e,t,s,a){var r=Oe.hasOwnProperty(t)?Oe[t]:null;(r!==null?r.type!==0:a||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Am(t,s,r,a)&&(s=null),a||r===null?Cm(t)&&(s===null?e.removeAttribute(t):e.setAttribute(t,""+s)):r.mustUseProperty?e[r.propertyName]=s===null?r.type===3?!1:"":s:(t=r.attributeName,a=r.attributeNamespace,s===null?e.removeAttribute(t):(r=r.type,s=r===3||r===4&&s===!0?"":""+s,a?e.setAttributeNS(a,t,s):e.setAttribute(t,s))))}var en=Mm.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ta=Symbol.for("react.element"),Zn=Symbol.for("react.portal"),Jn=Symbol.for("react.fragment"),Co=Symbol.for("react.strict_mode"),Ti=Symbol.for("react.profiler"),fd=Symbol.for("react.provider"),gd=Symbol.for("react.context"),Io=Symbol.for("react.forward_ref"),Ci=Symbol.for("react.suspense"),Ii=Symbol.for("react.suspense_list"),Ao=Symbol.for("react.memo"),cn=Symbol.for("react.lazy"),yd=Symbol.for("react.offscreen"),Rl=Symbol.iterator;function Es(e){return e===null||typeof e!="object"?null:(e=Rl&&e[Rl]||e["@@iterator"],typeof e=="function"?e:null)}var ke=Object.assign,Jr;function _s(e){if(Jr===void 0)try{throw Error()}catch(s){var t=s.stack.trim().match(/\n( *(at )?)/);Jr=t&&t[1]||""}return`
`+Jr+e}var Xr=!1;function ei(e,t){if(!e||Xr)return"";Xr=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(d){var a=d}Reflect.construct(e,[],t)}else{try{t.call()}catch(d){a=d}e.call(t.prototype)}else{try{throw Error()}catch(d){a=d}e()}}catch(d){if(d&&a&&typeof d.stack=="string"){for(var r=d.stack.split(`
`),i=a.stack.split(`
`),o=r.length-1,l=i.length-1;1<=o&&0<=l&&r[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(r[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||r[o]!==i[l]){var c=`
`+r[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=o&&0<=l);break}}}finally{Xr=!1,Error.prepareStackTrace=s}return(e=e?e.displayName||e.name:"")?_s(e):""}function Em(e){switch(e.tag){case 5:return _s(e.type);case 16:return _s("Lazy");case 13:return _s("Suspense");case 19:return _s("SuspenseList");case 0:case 2:case 15:return e=ei(e.type,!1),e;case 11:return e=ei(e.type.render,!1),e;case 1:return e=ei(e.type,!0),e;default:return""}}function Ai(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Jn:return"Fragment";case Zn:return"Portal";case Ti:return"Profiler";case Co:return"StrictMode";case Ci:return"Suspense";case Ii:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case gd:return(e.displayName||"Context")+".Consumer";case fd:return(e._context.displayName||"Context")+".Provider";case Io:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Ao:return t=e.displayName||null,t!==null?t:Ai(e.type)||"Memo";case cn:t=e._payload,e=e._init;try{return Ai(e(t))}catch{}}return null}function Lm(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ai(t);case 8:return t===Co?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Tn(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function xd(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function $m(e){var t=xd(e)?"checked":"value",s=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),a=""+e[t];if(!e.hasOwnProperty(t)&&typeof s<"u"&&typeof s.get=="function"&&typeof s.set=="function"){var r=s.get,i=s.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(o){a=""+o,i.call(this,o)}}),Object.defineProperty(e,t,{enumerable:s.enumerable}),{getValue:function(){return a},setValue:function(o){a=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Ca(e){e._valueTracker||(e._valueTracker=$m(e))}function vd(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var s=t.getValue(),a="";return e&&(a=xd(e)?e.checked?"true":"false":e.value),e=a,e!==s?(t.setValue(e),!0):!1}function nr(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Ei(e,t){var s=t.checked;return ke({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:s??e._wrapperState.initialChecked})}function Ol(e,t){var s=t.defaultValue==null?"":t.defaultValue,a=t.checked!=null?t.checked:t.defaultChecked;s=Tn(t.value!=null?t.value:s),e._wrapperState={initialChecked:a,initialValue:s,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function wd(e,t){t=t.checked,t!=null&&To(e,"checked",t,!1)}function Li(e,t){wd(e,t);var s=Tn(t.value),a=t.type;if(s!=null)a==="number"?(s===0&&e.value===""||e.value!=s)&&(e.value=""+s):e.value!==""+s&&(e.value=""+s);else if(a==="submit"||a==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?$i(e,t.type,s):t.hasOwnProperty("defaultValue")&&$i(e,t.type,Tn(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Fl(e,t,s){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var a=t.type;if(!(a!=="submit"&&a!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,s||t===e.value||(e.value=t),e.defaultValue=t}s=e.name,s!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,s!==""&&(e.name=s)}function $i(e,t,s){(t!=="number"||nr(e.ownerDocument)!==e)&&(s==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+s&&(e.defaultValue=""+s))}var Rs=Array.isArray;function ds(e,t,s,a){if(e=e.options,t){t={};for(var r=0;r<s.length;r++)t["$"+s[r]]=!0;for(s=0;s<e.length;s++)r=t.hasOwnProperty("$"+e[s].value),e[s].selected!==r&&(e[s].selected=r),r&&a&&(e[s].defaultSelected=!0)}else{for(s=""+Tn(s),t=null,r=0;r<e.length;r++){if(e[r].value===s){e[r].selected=!0,a&&(e[r].defaultSelected=!0);return}t!==null||e[r].disabled||(t=e[r])}t!==null&&(t.selected=!0)}}function Di(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error($(91));return ke({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Wl(e,t){var s=t.value;if(s==null){if(s=t.children,t=t.defaultValue,s!=null){if(t!=null)throw Error($(92));if(Rs(s)){if(1<s.length)throw Error($(93));s=s[0]}t=s}t==null&&(t=""),s=t}e._wrapperState={initialValue:Tn(s)}}function bd(e,t){var s=Tn(t.value),a=Tn(t.defaultValue);s!=null&&(s=""+s,s!==e.value&&(e.value=s),t.defaultValue==null&&e.defaultValue!==s&&(e.defaultValue=s)),a!=null&&(e.defaultValue=""+a)}function ql(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function kd(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Pi(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?kd(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Ia,jd=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,s,a,r){MSApp.execUnsafeLocalFunction(function(){return e(t,s,a,r)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Ia=Ia||document.createElement("div"),Ia.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Ia.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function ta(e,t){if(t){var s=e.firstChild;if(s&&s===e.lastChild&&s.nodeType===3){s.nodeValue=t;return}}e.textContent=t}var Gs={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Dm=["Webkit","ms","Moz","O"];Object.keys(Gs).forEach(function(e){Dm.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Gs[t]=Gs[e]})});function Nd(e,t,s){return t==null||typeof t=="boolean"||t===""?"":s||typeof t!="number"||t===0||Gs.hasOwnProperty(e)&&Gs[e]?(""+t).trim():t+"px"}function Sd(e,t){e=e.style;for(var s in t)if(t.hasOwnProperty(s)){var a=s.indexOf("--")===0,r=Nd(s,t[s],a);s==="float"&&(s="cssFloat"),a?e.setProperty(s,r):e[s]=r}}var Pm=ke({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function zi(e,t){if(t){if(Pm[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error($(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error($(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error($(61))}if(t.style!=null&&typeof t.style!="object")throw Error($(62))}}function Hi(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Bi=null;function Eo(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var _i=null,us=null,hs=null;function Gl(e){if(e=wa(e)){if(typeof _i!="function")throw Error($(280));var t=e.stateNode;t&&(t=$r(t),_i(e.stateNode,e.type,t))}}function Md(e){us?hs?hs.push(e):hs=[e]:us=e}function Td(){if(us){var e=us,t=hs;if(hs=us=null,Gl(e),t)for(e=0;e<t.length;e++)Gl(t[e])}}function Cd(e,t){return e(t)}function Id(){}var ti=!1;function Ad(e,t,s){if(ti)return e(t,s);ti=!0;try{return Cd(e,t,s)}finally{ti=!1,(us!==null||hs!==null)&&(Id(),Td())}}function na(e,t){var s=e.stateNode;if(s===null)return null;var a=$r(s);if(a===null)return null;s=a[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(a=!a.disabled)||(e=e.type,a=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!a;break e;default:e=!1}if(e)return null;if(s&&typeof s!="function")throw Error($(231,t,typeof s));return s}var Ri=!1;if(Yt)try{var Ls={};Object.defineProperty(Ls,"passive",{get:function(){Ri=!0}}),window.addEventListener("test",Ls,Ls),window.removeEventListener("test",Ls,Ls)}catch{Ri=!1}function zm(e,t,s,a,r,i,o,l,c){var d=Array.prototype.slice.call(arguments,3);try{t.apply(s,d)}catch(u){this.onError(u)}}var Us=!1,sr=null,ar=!1,Oi=null,Hm={onError:function(e){Us=!0,sr=e}};function Bm(e,t,s,a,r,i,o,l,c){Us=!1,sr=null,zm.apply(Hm,arguments)}function _m(e,t,s,a,r,i,o,l,c){if(Bm.apply(this,arguments),Us){if(Us){var d=sr;Us=!1,sr=null}else throw Error($(198));ar||(ar=!0,Oi=d)}}function Un(e){var t=e,s=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(s=t.return),e=t.return;while(e)}return t.tag===3?s:null}function Ed(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Ul(e){if(Un(e)!==e)throw Error($(188))}function Rm(e){var t=e.alternate;if(!t){if(t=Un(e),t===null)throw Error($(188));return t!==e?null:e}for(var s=e,a=t;;){var r=s.return;if(r===null)break;var i=r.alternate;if(i===null){if(a=r.return,a!==null){s=a;continue}break}if(r.child===i.child){for(i=r.child;i;){if(i===s)return Ul(r),e;if(i===a)return Ul(r),t;i=i.sibling}throw Error($(188))}if(s.return!==a.return)s=r,a=i;else{for(var o=!1,l=r.child;l;){if(l===s){o=!0,s=r,a=i;break}if(l===a){o=!0,a=r,s=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===s){o=!0,s=i,a=r;break}if(l===a){o=!0,a=i,s=r;break}l=l.sibling}if(!o)throw Error($(189))}}if(s.alternate!==a)throw Error($(190))}if(s.tag!==3)throw Error($(188));return s.stateNode.current===s?e:t}function Ld(e){return e=Rm(e),e!==null?$d(e):null}function $d(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=$d(e);if(t!==null)return t;e=e.sibling}return null}var Dd=ct.unstable_scheduleCallback,Vl=ct.unstable_cancelCallback,Om=ct.unstable_shouldYield,Fm=ct.unstable_requestPaint,Se=ct.unstable_now,Wm=ct.unstable_getCurrentPriorityLevel,Lo=ct.unstable_ImmediatePriority,Pd=ct.unstable_UserBlockingPriority,rr=ct.unstable_NormalPriority,qm=ct.unstable_LowPriority,zd=ct.unstable_IdlePriority,Ir=null,Dt=null;function Gm(e){if(Dt&&typeof Dt.onCommitFiberRoot=="function")try{Dt.onCommitFiberRoot(Ir,e,void 0,(e.current.flags&128)===128)}catch{}}var Tt=Math.clz32?Math.clz32:Ym,Um=Math.log,Vm=Math.LN2;function Ym(e){return e>>>=0,e===0?32:31-(Um(e)/Vm|0)|0}var Aa=64,Ea=4194304;function Os(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ir(e,t){var s=e.pendingLanes;if(s===0)return 0;var a=0,r=e.suspendedLanes,i=e.pingedLanes,o=s&268435455;if(o!==0){var l=o&~r;l!==0?a=Os(l):(i&=o,i!==0&&(a=Os(i)))}else o=s&~r,o!==0?a=Os(o):i!==0&&(a=Os(i));if(a===0)return 0;if(t!==0&&t!==a&&!(t&r)&&(r=a&-a,i=t&-t,r>=i||r===16&&(i&4194240)!==0))return t;if(a&4&&(a|=s&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=a;0<t;)s=31-Tt(t),r=1<<s,a|=e[s],t&=~r;return a}function Km(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Qm(e,t){for(var s=e.suspendedLanes,a=e.pingedLanes,r=e.expirationTimes,i=e.pendingLanes;0<i;){var o=31-Tt(i),l=1<<o,c=r[o];c===-1?(!(l&s)||l&a)&&(r[o]=Km(l,t)):c<=t&&(e.expiredLanes|=l),i&=~l}}function Fi(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Hd(){var e=Aa;return Aa<<=1,!(Aa&4194240)&&(Aa=64),e}function ni(e){for(var t=[],s=0;31>s;s++)t.push(e);return t}function xa(e,t,s){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Tt(t),e[t]=s}function Zm(e,t){var s=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var a=e.eventTimes;for(e=e.expirationTimes;0<s;){var r=31-Tt(s),i=1<<r;t[r]=0,a[r]=-1,e[r]=-1,s&=~i}}function $o(e,t){var s=e.entangledLanes|=t;for(e=e.entanglements;s;){var a=31-Tt(s),r=1<<a;r&t|e[a]&t&&(e[a]|=t),s&=~r}}var le=0;function Bd(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var _d,Do,Rd,Od,Fd,Wi=!1,La=[],xn=null,vn=null,wn=null,sa=new Map,aa=new Map,hn=[],Jm="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Yl(e,t){switch(e){case"focusin":case"focusout":xn=null;break;case"dragenter":case"dragleave":vn=null;break;case"mouseover":case"mouseout":wn=null;break;case"pointerover":case"pointerout":sa.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":aa.delete(t.pointerId)}}function $s(e,t,s,a,r,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:s,eventSystemFlags:a,nativeEvent:i,targetContainers:[r]},t!==null&&(t=wa(t),t!==null&&Do(t)),e):(e.eventSystemFlags|=a,t=e.targetContainers,r!==null&&t.indexOf(r)===-1&&t.push(r),e)}function Xm(e,t,s,a,r){switch(t){case"focusin":return xn=$s(xn,e,t,s,a,r),!0;case"dragenter":return vn=$s(vn,e,t,s,a,r),!0;case"mouseover":return wn=$s(wn,e,t,s,a,r),!0;case"pointerover":var i=r.pointerId;return sa.set(i,$s(sa.get(i)||null,e,t,s,a,r)),!0;case"gotpointercapture":return i=r.pointerId,aa.set(i,$s(aa.get(i)||null,e,t,s,a,r)),!0}return!1}function Wd(e){var t=Pn(e.target);if(t!==null){var s=Un(t);if(s!==null){if(t=s.tag,t===13){if(t=Ed(s),t!==null){e.blockedOn=t,Fd(e.priority,function(){Rd(s)});return}}else if(t===3&&s.stateNode.current.memoizedState.isDehydrated){e.blockedOn=s.tag===3?s.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Ga(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var s=qi(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(s===null){s=e.nativeEvent;var a=new s.constructor(s.type,s);Bi=a,s.target.dispatchEvent(a),Bi=null}else return t=wa(s),t!==null&&Do(t),e.blockedOn=s,!1;t.shift()}return!0}function Kl(e,t,s){Ga(e)&&s.delete(t)}function ep(){Wi=!1,xn!==null&&Ga(xn)&&(xn=null),vn!==null&&Ga(vn)&&(vn=null),wn!==null&&Ga(wn)&&(wn=null),sa.forEach(Kl),aa.forEach(Kl)}function Ds(e,t){e.blockedOn===t&&(e.blockedOn=null,Wi||(Wi=!0,ct.unstable_scheduleCallback(ct.unstable_NormalPriority,ep)))}function ra(e){function t(r){return Ds(r,e)}if(0<La.length){Ds(La[0],e);for(var s=1;s<La.length;s++){var a=La[s];a.blockedOn===e&&(a.blockedOn=null)}}for(xn!==null&&Ds(xn,e),vn!==null&&Ds(vn,e),wn!==null&&Ds(wn,e),sa.forEach(t),aa.forEach(t),s=0;s<hn.length;s++)a=hn[s],a.blockedOn===e&&(a.blockedOn=null);for(;0<hn.length&&(s=hn[0],s.blockedOn===null);)Wd(s),s.blockedOn===null&&hn.shift()}var ms=en.ReactCurrentBatchConfig,or=!0;function tp(e,t,s,a){var r=le,i=ms.transition;ms.transition=null;try{le=1,Po(e,t,s,a)}finally{le=r,ms.transition=i}}function np(e,t,s,a){var r=le,i=ms.transition;ms.transition=null;try{le=4,Po(e,t,s,a)}finally{le=r,ms.transition=i}}function Po(e,t,s,a){if(or){var r=qi(e,t,s,a);if(r===null)hi(e,t,a,lr,s),Yl(e,a);else if(Xm(r,e,t,s,a))a.stopPropagation();else if(Yl(e,a),t&4&&-1<Jm.indexOf(e)){for(;r!==null;){var i=wa(r);if(i!==null&&_d(i),i=qi(e,t,s,a),i===null&&hi(e,t,a,lr,s),i===r)break;r=i}r!==null&&a.stopPropagation()}else hi(e,t,a,null,s)}}var lr=null;function qi(e,t,s,a){if(lr=null,e=Eo(a),e=Pn(e),e!==null)if(t=Un(e),t===null)e=null;else if(s=t.tag,s===13){if(e=Ed(t),e!==null)return e;e=null}else if(s===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return lr=e,null}function qd(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Wm()){case Lo:return 1;case Pd:return 4;case rr:case qm:return 16;case zd:return 536870912;default:return 16}default:return 16}}var pn=null,zo=null,Ua=null;function Gd(){if(Ua)return Ua;var e,t=zo,s=t.length,a,r="value"in pn?pn.value:pn.textContent,i=r.length;for(e=0;e<s&&t[e]===r[e];e++);var o=s-e;for(a=1;a<=o&&t[s-a]===r[i-a];a++);return Ua=r.slice(e,1<a?1-a:void 0)}function Va(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function $a(){return!0}function Ql(){return!1}function ut(e){function t(s,a,r,i,o){this._reactName=s,this._targetInst=r,this.type=a,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(s=e[l],this[l]=s?s(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?$a:Ql,this.isPropagationStopped=Ql,this}return ke(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var s=this.nativeEvent;s&&(s.preventDefault?s.preventDefault():typeof s.returnValue!="unknown"&&(s.returnValue=!1),this.isDefaultPrevented=$a)},stopPropagation:function(){var s=this.nativeEvent;s&&(s.stopPropagation?s.stopPropagation():typeof s.cancelBubble!="unknown"&&(s.cancelBubble=!0),this.isPropagationStopped=$a)},persist:function(){},isPersistent:$a}),t}var Ms={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ho=ut(Ms),va=ke({},Ms,{view:0,detail:0}),sp=ut(va),si,ai,Ps,Ar=ke({},va,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Bo,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ps&&(Ps&&e.type==="mousemove"?(si=e.screenX-Ps.screenX,ai=e.screenY-Ps.screenY):ai=si=0,Ps=e),si)},movementY:function(e){return"movementY"in e?e.movementY:ai}}),Zl=ut(Ar),ap=ke({},Ar,{dataTransfer:0}),rp=ut(ap),ip=ke({},va,{relatedTarget:0}),ri=ut(ip),op=ke({},Ms,{animationName:0,elapsedTime:0,pseudoElement:0}),lp=ut(op),cp=ke({},Ms,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),dp=ut(cp),up=ke({},Ms,{data:0}),Jl=ut(up),hp={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},mp={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},pp={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function fp(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=pp[e])?!!t[e]:!1}function Bo(){return fp}var gp=ke({},va,{key:function(e){if(e.key){var t=hp[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Va(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?mp[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Bo,charCode:function(e){return e.type==="keypress"?Va(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Va(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),yp=ut(gp),xp=ke({},Ar,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Xl=ut(xp),vp=ke({},va,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Bo}),wp=ut(vp),bp=ke({},Ms,{propertyName:0,elapsedTime:0,pseudoElement:0}),kp=ut(bp),jp=ke({},Ar,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Np=ut(jp),Sp=[9,13,27,32],_o=Yt&&"CompositionEvent"in window,Vs=null;Yt&&"documentMode"in document&&(Vs=document.documentMode);var Mp=Yt&&"TextEvent"in window&&!Vs,Ud=Yt&&(!_o||Vs&&8<Vs&&11>=Vs),ec=" ",tc=!1;function Vd(e,t){switch(e){case"keyup":return Sp.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Yd(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Xn=!1;function Tp(e,t){switch(e){case"compositionend":return Yd(t);case"keypress":return t.which!==32?null:(tc=!0,ec);case"textInput":return e=t.data,e===ec&&tc?null:e;default:return null}}function Cp(e,t){if(Xn)return e==="compositionend"||!_o&&Vd(e,t)?(e=Gd(),Ua=zo=pn=null,Xn=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ud&&t.locale!=="ko"?null:t.data;default:return null}}var Ip={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function nc(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Ip[e.type]:t==="textarea"}function Kd(e,t,s,a){Md(a),t=cr(t,"onChange"),0<t.length&&(s=new Ho("onChange","change",null,s,a),e.push({event:s,listeners:t}))}var Ys=null,ia=null;function Ap(e){iu(e,0)}function Er(e){var t=ns(e);if(vd(t))return e}function Ep(e,t){if(e==="change")return t}var Qd=!1;if(Yt){var ii;if(Yt){var oi="oninput"in document;if(!oi){var sc=document.createElement("div");sc.setAttribute("oninput","return;"),oi=typeof sc.oninput=="function"}ii=oi}else ii=!1;Qd=ii&&(!document.documentMode||9<document.documentMode)}function ac(){Ys&&(Ys.detachEvent("onpropertychange",Zd),ia=Ys=null)}function Zd(e){if(e.propertyName==="value"&&Er(ia)){var t=[];Kd(t,ia,e,Eo(e)),Ad(Ap,t)}}function Lp(e,t,s){e==="focusin"?(ac(),Ys=t,ia=s,Ys.attachEvent("onpropertychange",Zd)):e==="focusout"&&ac()}function $p(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Er(ia)}function Dp(e,t){if(e==="click")return Er(t)}function Pp(e,t){if(e==="input"||e==="change")return Er(t)}function zp(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var It=typeof Object.is=="function"?Object.is:zp;function oa(e,t){if(It(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var s=Object.keys(e),a=Object.keys(t);if(s.length!==a.length)return!1;for(a=0;a<s.length;a++){var r=s[a];if(!Mi.call(t,r)||!It(e[r],t[r]))return!1}return!0}function rc(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ic(e,t){var s=rc(e);e=0;for(var a;s;){if(s.nodeType===3){if(a=e+s.textContent.length,e<=t&&a>=t)return{node:s,offset:t-e};e=a}e:{for(;s;){if(s.nextSibling){s=s.nextSibling;break e}s=s.parentNode}s=void 0}s=rc(s)}}function Jd(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Jd(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Xd(){for(var e=window,t=nr();t instanceof e.HTMLIFrameElement;){try{var s=typeof t.contentWindow.location.href=="string"}catch{s=!1}if(s)e=t.contentWindow;else break;t=nr(e.document)}return t}function Ro(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Hp(e){var t=Xd(),s=e.focusedElem,a=e.selectionRange;if(t!==s&&s&&s.ownerDocument&&Jd(s.ownerDocument.documentElement,s)){if(a!==null&&Ro(s)){if(t=a.start,e=a.end,e===void 0&&(e=t),"selectionStart"in s)s.selectionStart=t,s.selectionEnd=Math.min(e,s.value.length);else if(e=(t=s.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var r=s.textContent.length,i=Math.min(a.start,r);a=a.end===void 0?i:Math.min(a.end,r),!e.extend&&i>a&&(r=a,a=i,i=r),r=ic(s,i);var o=ic(s,a);r&&o&&(e.rangeCount!==1||e.anchorNode!==r.node||e.anchorOffset!==r.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(r.node,r.offset),e.removeAllRanges(),i>a?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=s;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof s.focus=="function"&&s.focus(),s=0;s<t.length;s++)e=t[s],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Bp=Yt&&"documentMode"in document&&11>=document.documentMode,es=null,Gi=null,Ks=null,Ui=!1;function oc(e,t,s){var a=s.window===s?s.document:s.nodeType===9?s:s.ownerDocument;Ui||es==null||es!==nr(a)||(a=es,"selectionStart"in a&&Ro(a)?a={start:a.selectionStart,end:a.selectionEnd}:(a=(a.ownerDocument&&a.ownerDocument.defaultView||window).getSelection(),a={anchorNode:a.anchorNode,anchorOffset:a.anchorOffset,focusNode:a.focusNode,focusOffset:a.focusOffset}),Ks&&oa(Ks,a)||(Ks=a,a=cr(Gi,"onSelect"),0<a.length&&(t=new Ho("onSelect","select",null,t,s),e.push({event:t,listeners:a}),t.target=es)))}function Da(e,t){var s={};return s[e.toLowerCase()]=t.toLowerCase(),s["Webkit"+e]="webkit"+t,s["Moz"+e]="moz"+t,s}var ts={animationend:Da("Animation","AnimationEnd"),animationiteration:Da("Animation","AnimationIteration"),animationstart:Da("Animation","AnimationStart"),transitionend:Da("Transition","TransitionEnd")},li={},eu={};Yt&&(eu=document.createElement("div").style,"AnimationEvent"in window||(delete ts.animationend.animation,delete ts.animationiteration.animation,delete ts.animationstart.animation),"TransitionEvent"in window||delete ts.transitionend.transition);function Lr(e){if(li[e])return li[e];if(!ts[e])return e;var t=ts[e],s;for(s in t)if(t.hasOwnProperty(s)&&s in eu)return li[e]=t[s];return e}var tu=Lr("animationend"),nu=Lr("animationiteration"),su=Lr("animationstart"),au=Lr("transitionend"),ru=new Map,lc="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function In(e,t){ru.set(e,t),Gn(t,[e])}for(var ci=0;ci<lc.length;ci++){var di=lc[ci],_p=di.toLowerCase(),Rp=di[0].toUpperCase()+di.slice(1);In(_p,"on"+Rp)}In(tu,"onAnimationEnd");In(nu,"onAnimationIteration");In(su,"onAnimationStart");In("dblclick","onDoubleClick");In("focusin","onFocus");In("focusout","onBlur");In(au,"onTransitionEnd");ys("onMouseEnter",["mouseout","mouseover"]);ys("onMouseLeave",["mouseout","mouseover"]);ys("onPointerEnter",["pointerout","pointerover"]);ys("onPointerLeave",["pointerout","pointerover"]);Gn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Gn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Gn("onBeforeInput",["compositionend","keypress","textInput","paste"]);Gn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Gn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Gn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Fs="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Op=new Set("cancel close invalid load scroll toggle".split(" ").concat(Fs));function cc(e,t,s){var a=e.type||"unknown-event";e.currentTarget=s,_m(a,t,void 0,e),e.currentTarget=null}function iu(e,t){t=(t&4)!==0;for(var s=0;s<e.length;s++){var a=e[s],r=a.event;a=a.listeners;e:{var i=void 0;if(t)for(var o=a.length-1;0<=o;o--){var l=a[o],c=l.instance,d=l.currentTarget;if(l=l.listener,c!==i&&r.isPropagationStopped())break e;cc(r,l,d),i=c}else for(o=0;o<a.length;o++){if(l=a[o],c=l.instance,d=l.currentTarget,l=l.listener,c!==i&&r.isPropagationStopped())break e;cc(r,l,d),i=c}}}if(ar)throw e=Oi,ar=!1,Oi=null,e}function ge(e,t){var s=t[Zi];s===void 0&&(s=t[Zi]=new Set);var a=e+"__bubble";s.has(a)||(ou(t,e,2,!1),s.add(a))}function ui(e,t,s){var a=0;t&&(a|=4),ou(s,e,a,t)}var Pa="_reactListening"+Math.random().toString(36).slice(2);function la(e){if(!e[Pa]){e[Pa]=!0,pd.forEach(function(s){s!=="selectionchange"&&(Op.has(s)||ui(s,!1,e),ui(s,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Pa]||(t[Pa]=!0,ui("selectionchange",!1,t))}}function ou(e,t,s,a){switch(qd(t)){case 1:var r=tp;break;case 4:r=np;break;default:r=Po}s=r.bind(null,t,s,e),r=void 0,!Ri||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(r=!0),a?r!==void 0?e.addEventListener(t,s,{capture:!0,passive:r}):e.addEventListener(t,s,!0):r!==void 0?e.addEventListener(t,s,{passive:r}):e.addEventListener(t,s,!1)}function hi(e,t,s,a,r){var i=a;if(!(t&1)&&!(t&2)&&a!==null)e:for(;;){if(a===null)return;var o=a.tag;if(o===3||o===4){var l=a.stateNode.containerInfo;if(l===r||l.nodeType===8&&l.parentNode===r)break;if(o===4)for(o=a.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===r||c.nodeType===8&&c.parentNode===r))return;o=o.return}for(;l!==null;){if(o=Pn(l),o===null)return;if(c=o.tag,c===5||c===6){a=i=o;continue e}l=l.parentNode}}a=a.return}Ad(function(){var d=i,u=Eo(s),g=[];e:{var h=ru.get(e);if(h!==void 0){var p=Ho,f=e;switch(e){case"keypress":if(Va(s)===0)break e;case"keydown":case"keyup":p=yp;break;case"focusin":f="focus",p=ri;break;case"focusout":f="blur",p=ri;break;case"beforeblur":case"afterblur":p=ri;break;case"click":if(s.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=Zl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=rp;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=wp;break;case tu:case nu:case su:p=lp;break;case au:p=kp;break;case"scroll":p=sp;break;case"wheel":p=Np;break;case"copy":case"cut":case"paste":p=dp;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=Xl}var y=(t&4)!==0,N=!y&&e==="scroll",m=y?h!==null?h+"Capture":null:h;y=[];for(var v=d,w;v!==null;){w=v;var x=w.stateNode;if(w.tag===5&&x!==null&&(w=x,m!==null&&(x=na(v,m),x!=null&&y.push(ca(v,x,w)))),N)break;v=v.return}0<y.length&&(h=new p(h,f,null,s,u),g.push({event:h,listeners:y}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",p=e==="mouseout"||e==="pointerout",h&&s!==Bi&&(f=s.relatedTarget||s.fromElement)&&(Pn(f)||f[Kt]))break e;if((p||h)&&(h=u.window===u?u:(h=u.ownerDocument)?h.defaultView||h.parentWindow:window,p?(f=s.relatedTarget||s.toElement,p=d,f=f?Pn(f):null,f!==null&&(N=Un(f),f!==N||f.tag!==5&&f.tag!==6)&&(f=null)):(p=null,f=d),p!==f)){if(y=Zl,x="onMouseLeave",m="onMouseEnter",v="mouse",(e==="pointerout"||e==="pointerover")&&(y=Xl,x="onPointerLeave",m="onPointerEnter",v="pointer"),N=p==null?h:ns(p),w=f==null?h:ns(f),h=new y(x,v+"leave",p,s,u),h.target=N,h.relatedTarget=w,x=null,Pn(u)===d&&(y=new y(m,v+"enter",f,s,u),y.target=w,y.relatedTarget=N,x=y),N=x,p&&f)t:{for(y=p,m=f,v=0,w=y;w;w=Kn(w))v++;for(w=0,x=m;x;x=Kn(x))w++;for(;0<v-w;)y=Kn(y),v--;for(;0<w-v;)m=Kn(m),w--;for(;v--;){if(y===m||m!==null&&y===m.alternate)break t;y=Kn(y),m=Kn(m)}y=null}else y=null;p!==null&&dc(g,h,p,y,!1),f!==null&&N!==null&&dc(g,N,f,y,!0)}}e:{if(h=d?ns(d):window,p=h.nodeName&&h.nodeName.toLowerCase(),p==="select"||p==="input"&&h.type==="file")var k=Ep;else if(nc(h))if(Qd)k=Pp;else{k=$p;var I=Lp}else(p=h.nodeName)&&p.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(k=Dp);if(k&&(k=k(e,d))){Kd(g,k,s,u);break e}I&&I(e,h,d),e==="focusout"&&(I=h._wrapperState)&&I.controlled&&h.type==="number"&&$i(h,"number",h.value)}switch(I=d?ns(d):window,e){case"focusin":(nc(I)||I.contentEditable==="true")&&(es=I,Gi=d,Ks=null);break;case"focusout":Ks=Gi=es=null;break;case"mousedown":Ui=!0;break;case"contextmenu":case"mouseup":case"dragend":Ui=!1,oc(g,s,u);break;case"selectionchange":if(Bp)break;case"keydown":case"keyup":oc(g,s,u)}var T;if(_o)e:{switch(e){case"compositionstart":var L="onCompositionStart";break e;case"compositionend":L="onCompositionEnd";break e;case"compositionupdate":L="onCompositionUpdate";break e}L=void 0}else Xn?Vd(e,s)&&(L="onCompositionEnd"):e==="keydown"&&s.keyCode===229&&(L="onCompositionStart");L&&(Ud&&s.locale!=="ko"&&(Xn||L!=="onCompositionStart"?L==="onCompositionEnd"&&Xn&&(T=Gd()):(pn=u,zo="value"in pn?pn.value:pn.textContent,Xn=!0)),I=cr(d,L),0<I.length&&(L=new Jl(L,e,null,s,u),g.push({event:L,listeners:I}),T?L.data=T:(T=Yd(s),T!==null&&(L.data=T)))),(T=Mp?Tp(e,s):Cp(e,s))&&(d=cr(d,"onBeforeInput"),0<d.length&&(u=new Jl("onBeforeInput","beforeinput",null,s,u),g.push({event:u,listeners:d}),u.data=T))}iu(g,t)})}function ca(e,t,s){return{instance:e,listener:t,currentTarget:s}}function cr(e,t){for(var s=t+"Capture",a=[];e!==null;){var r=e,i=r.stateNode;r.tag===5&&i!==null&&(r=i,i=na(e,s),i!=null&&a.unshift(ca(e,i,r)),i=na(e,t),i!=null&&a.push(ca(e,i,r))),e=e.return}return a}function Kn(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function dc(e,t,s,a,r){for(var i=t._reactName,o=[];s!==null&&s!==a;){var l=s,c=l.alternate,d=l.stateNode;if(c!==null&&c===a)break;l.tag===5&&d!==null&&(l=d,r?(c=na(s,i),c!=null&&o.unshift(ca(s,c,l))):r||(c=na(s,i),c!=null&&o.push(ca(s,c,l)))),s=s.return}o.length!==0&&e.push({event:t,listeners:o})}var Fp=/\r\n?/g,Wp=/\u0000|\uFFFD/g;function uc(e){return(typeof e=="string"?e:""+e).replace(Fp,`
`).replace(Wp,"")}function za(e,t,s){if(t=uc(t),uc(e)!==t&&s)throw Error($(425))}function dr(){}var Vi=null,Yi=null;function Ki(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Qi=typeof setTimeout=="function"?setTimeout:void 0,qp=typeof clearTimeout=="function"?clearTimeout:void 0,hc=typeof Promise=="function"?Promise:void 0,Gp=typeof queueMicrotask=="function"?queueMicrotask:typeof hc<"u"?function(e){return hc.resolve(null).then(e).catch(Up)}:Qi;function Up(e){setTimeout(function(){throw e})}function mi(e,t){var s=t,a=0;do{var r=s.nextSibling;if(e.removeChild(s),r&&r.nodeType===8)if(s=r.data,s==="/$"){if(a===0){e.removeChild(r),ra(t);return}a--}else s!=="$"&&s!=="$?"&&s!=="$!"||a++;s=r}while(s);ra(t)}function bn(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function mc(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var s=e.data;if(s==="$"||s==="$!"||s==="$?"){if(t===0)return e;t--}else s==="/$"&&t++}e=e.previousSibling}return null}var Ts=Math.random().toString(36).slice(2),$t="__reactFiber$"+Ts,da="__reactProps$"+Ts,Kt="__reactContainer$"+Ts,Zi="__reactEvents$"+Ts,Vp="__reactListeners$"+Ts,Yp="__reactHandles$"+Ts;function Pn(e){var t=e[$t];if(t)return t;for(var s=e.parentNode;s;){if(t=s[Kt]||s[$t]){if(s=t.alternate,t.child!==null||s!==null&&s.child!==null)for(e=mc(e);e!==null;){if(s=e[$t])return s;e=mc(e)}return t}e=s,s=e.parentNode}return null}function wa(e){return e=e[$t]||e[Kt],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function ns(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error($(33))}function $r(e){return e[da]||null}var Ji=[],ss=-1;function An(e){return{current:e}}function ye(e){0>ss||(e.current=Ji[ss],Ji[ss]=null,ss--)}function he(e,t){ss++,Ji[ss]=e.current,e.current=t}var Cn={},Ge=An(Cn),et=An(!1),Rn=Cn;function xs(e,t){var s=e.type.contextTypes;if(!s)return Cn;var a=e.stateNode;if(a&&a.__reactInternalMemoizedUnmaskedChildContext===t)return a.__reactInternalMemoizedMaskedChildContext;var r={},i;for(i in s)r[i]=t[i];return a&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=r),r}function tt(e){return e=e.childContextTypes,e!=null}function ur(){ye(et),ye(Ge)}function pc(e,t,s){if(Ge.current!==Cn)throw Error($(168));he(Ge,t),he(et,s)}function lu(e,t,s){var a=e.stateNode;if(t=t.childContextTypes,typeof a.getChildContext!="function")return s;a=a.getChildContext();for(var r in a)if(!(r in t))throw Error($(108,Lm(e)||"Unknown",r));return ke({},s,a)}function hr(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Cn,Rn=Ge.current,he(Ge,e),he(et,et.current),!0}function fc(e,t,s){var a=e.stateNode;if(!a)throw Error($(169));s?(e=lu(e,t,Rn),a.__reactInternalMemoizedMergedChildContext=e,ye(et),ye(Ge),he(Ge,e)):ye(et),he(et,s)}var Ft=null,Dr=!1,pi=!1;function cu(e){Ft===null?Ft=[e]:Ft.push(e)}function Kp(e){Dr=!0,cu(e)}function En(){if(!pi&&Ft!==null){pi=!0;var e=0,t=le;try{var s=Ft;for(le=1;e<s.length;e++){var a=s[e];do a=a(!0);while(a!==null)}Ft=null,Dr=!1}catch(r){throw Ft!==null&&(Ft=Ft.slice(e+1)),Dd(Lo,En),r}finally{le=t,pi=!1}}return null}var as=[],rs=0,mr=null,pr=0,ft=[],gt=0,On=null,qt=1,Gt="";function $n(e,t){as[rs++]=pr,as[rs++]=mr,mr=e,pr=t}function du(e,t,s){ft[gt++]=qt,ft[gt++]=Gt,ft[gt++]=On,On=e;var a=qt;e=Gt;var r=32-Tt(a)-1;a&=~(1<<r),s+=1;var i=32-Tt(t)+r;if(30<i){var o=r-r%5;i=(a&(1<<o)-1).toString(32),a>>=o,r-=o,qt=1<<32-Tt(t)+r|s<<r|a,Gt=i+e}else qt=1<<i|s<<r|a,Gt=e}function Oo(e){e.return!==null&&($n(e,1),du(e,1,0))}function Fo(e){for(;e===mr;)mr=as[--rs],as[rs]=null,pr=as[--rs],as[rs]=null;for(;e===On;)On=ft[--gt],ft[gt]=null,Gt=ft[--gt],ft[gt]=null,qt=ft[--gt],ft[gt]=null}var ot=null,it=null,ve=!1,St=null;function uu(e,t){var s=yt(5,null,null,0);s.elementType="DELETED",s.stateNode=t,s.return=e,t=e.deletions,t===null?(e.deletions=[s],e.flags|=16):t.push(s)}function gc(e,t){switch(e.tag){case 5:var s=e.type;return t=t.nodeType!==1||s.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,ot=e,it=bn(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,ot=e,it=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(s=On!==null?{id:qt,overflow:Gt}:null,e.memoizedState={dehydrated:t,treeContext:s,retryLane:1073741824},s=yt(18,null,null,0),s.stateNode=t,s.return=e,e.child=s,ot=e,it=null,!0):!1;default:return!1}}function Xi(e){return(e.mode&1)!==0&&(e.flags&128)===0}function eo(e){if(ve){var t=it;if(t){var s=t;if(!gc(e,t)){if(Xi(e))throw Error($(418));t=bn(s.nextSibling);var a=ot;t&&gc(e,t)?uu(a,s):(e.flags=e.flags&-4097|2,ve=!1,ot=e)}}else{if(Xi(e))throw Error($(418));e.flags=e.flags&-4097|2,ve=!1,ot=e}}}function yc(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;ot=e}function Ha(e){if(e!==ot)return!1;if(!ve)return yc(e),ve=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Ki(e.type,e.memoizedProps)),t&&(t=it)){if(Xi(e))throw hu(),Error($(418));for(;t;)uu(e,t),t=bn(t.nextSibling)}if(yc(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error($(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var s=e.data;if(s==="/$"){if(t===0){it=bn(e.nextSibling);break e}t--}else s!=="$"&&s!=="$!"&&s!=="$?"||t++}e=e.nextSibling}it=null}}else it=ot?bn(e.stateNode.nextSibling):null;return!0}function hu(){for(var e=it;e;)e=bn(e.nextSibling)}function vs(){it=ot=null,ve=!1}function Wo(e){St===null?St=[e]:St.push(e)}var Qp=en.ReactCurrentBatchConfig;function zs(e,t,s){if(e=s.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(s._owner){if(s=s._owner,s){if(s.tag!==1)throw Error($(309));var a=s.stateNode}if(!a)throw Error($(147,e));var r=a,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(o){var l=r.refs;o===null?delete l[i]:l[i]=o},t._stringRef=i,t)}if(typeof e!="string")throw Error($(284));if(!s._owner)throw Error($(290,e))}return e}function Ba(e,t){throw e=Object.prototype.toString.call(t),Error($(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function xc(e){var t=e._init;return t(e._payload)}function mu(e){function t(m,v){if(e){var w=m.deletions;w===null?(m.deletions=[v],m.flags|=16):w.push(v)}}function s(m,v){if(!e)return null;for(;v!==null;)t(m,v),v=v.sibling;return null}function a(m,v){for(m=new Map;v!==null;)v.key!==null?m.set(v.key,v):m.set(v.index,v),v=v.sibling;return m}function r(m,v){return m=Sn(m,v),m.index=0,m.sibling=null,m}function i(m,v,w){return m.index=w,e?(w=m.alternate,w!==null?(w=w.index,w<v?(m.flags|=2,v):w):(m.flags|=2,v)):(m.flags|=1048576,v)}function o(m){return e&&m.alternate===null&&(m.flags|=2),m}function l(m,v,w,x){return v===null||v.tag!==6?(v=bi(w,m.mode,x),v.return=m,v):(v=r(v,w),v.return=m,v)}function c(m,v,w,x){var k=w.type;return k===Jn?u(m,v,w.props.children,x,w.key):v!==null&&(v.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===cn&&xc(k)===v.type)?(x=r(v,w.props),x.ref=zs(m,v,w),x.return=m,x):(x=er(w.type,w.key,w.props,null,m.mode,x),x.ref=zs(m,v,w),x.return=m,x)}function d(m,v,w,x){return v===null||v.tag!==4||v.stateNode.containerInfo!==w.containerInfo||v.stateNode.implementation!==w.implementation?(v=ki(w,m.mode,x),v.return=m,v):(v=r(v,w.children||[]),v.return=m,v)}function u(m,v,w,x,k){return v===null||v.tag!==7?(v=_n(w,m.mode,x,k),v.return=m,v):(v=r(v,w),v.return=m,v)}function g(m,v,w){if(typeof v=="string"&&v!==""||typeof v=="number")return v=bi(""+v,m.mode,w),v.return=m,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Ta:return w=er(v.type,v.key,v.props,null,m.mode,w),w.ref=zs(m,null,v),w.return=m,w;case Zn:return v=ki(v,m.mode,w),v.return=m,v;case cn:var x=v._init;return g(m,x(v._payload),w)}if(Rs(v)||Es(v))return v=_n(v,m.mode,w,null),v.return=m,v;Ba(m,v)}return null}function h(m,v,w,x){var k=v!==null?v.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return k!==null?null:l(m,v,""+w,x);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Ta:return w.key===k?c(m,v,w,x):null;case Zn:return w.key===k?d(m,v,w,x):null;case cn:return k=w._init,h(m,v,k(w._payload),x)}if(Rs(w)||Es(w))return k!==null?null:u(m,v,w,x,null);Ba(m,w)}return null}function p(m,v,w,x,k){if(typeof x=="string"&&x!==""||typeof x=="number")return m=m.get(w)||null,l(v,m,""+x,k);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Ta:return m=m.get(x.key===null?w:x.key)||null,c(v,m,x,k);case Zn:return m=m.get(x.key===null?w:x.key)||null,d(v,m,x,k);case cn:var I=x._init;return p(m,v,w,I(x._payload),k)}if(Rs(x)||Es(x))return m=m.get(w)||null,u(v,m,x,k,null);Ba(v,x)}return null}function f(m,v,w,x){for(var k=null,I=null,T=v,L=v=0,P=null;T!==null&&L<w.length;L++){T.index>L?(P=T,T=null):P=T.sibling;var D=h(m,T,w[L],x);if(D===null){T===null&&(T=P);break}e&&T&&D.alternate===null&&t(m,T),v=i(D,v,L),I===null?k=D:I.sibling=D,I=D,T=P}if(L===w.length)return s(m,T),ve&&$n(m,L),k;if(T===null){for(;L<w.length;L++)T=g(m,w[L],x),T!==null&&(v=i(T,v,L),I===null?k=T:I.sibling=T,I=T);return ve&&$n(m,L),k}for(T=a(m,T);L<w.length;L++)P=p(T,m,L,w[L],x),P!==null&&(e&&P.alternate!==null&&T.delete(P.key===null?L:P.key),v=i(P,v,L),I===null?k=P:I.sibling=P,I=P);return e&&T.forEach(function(q){return t(m,q)}),ve&&$n(m,L),k}function y(m,v,w,x){var k=Es(w);if(typeof k!="function")throw Error($(150));if(w=k.call(w),w==null)throw Error($(151));for(var I=k=null,T=v,L=v=0,P=null,D=w.next();T!==null&&!D.done;L++,D=w.next()){T.index>L?(P=T,T=null):P=T.sibling;var q=h(m,T,D.value,x);if(q===null){T===null&&(T=P);break}e&&T&&q.alternate===null&&t(m,T),v=i(q,v,L),I===null?k=q:I.sibling=q,I=q,T=P}if(D.done)return s(m,T),ve&&$n(m,L),k;if(T===null){for(;!D.done;L++,D=w.next())D=g(m,D.value,x),D!==null&&(v=i(D,v,L),I===null?k=D:I.sibling=D,I=D);return ve&&$n(m,L),k}for(T=a(m,T);!D.done;L++,D=w.next())D=p(T,m,L,D.value,x),D!==null&&(e&&D.alternate!==null&&T.delete(D.key===null?L:D.key),v=i(D,v,L),I===null?k=D:I.sibling=D,I=D);return e&&T.forEach(function(A){return t(m,A)}),ve&&$n(m,L),k}function N(m,v,w,x){if(typeof w=="object"&&w!==null&&w.type===Jn&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case Ta:e:{for(var k=w.key,I=v;I!==null;){if(I.key===k){if(k=w.type,k===Jn){if(I.tag===7){s(m,I.sibling),v=r(I,w.props.children),v.return=m,m=v;break e}}else if(I.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===cn&&xc(k)===I.type){s(m,I.sibling),v=r(I,w.props),v.ref=zs(m,I,w),v.return=m,m=v;break e}s(m,I);break}else t(m,I);I=I.sibling}w.type===Jn?(v=_n(w.props.children,m.mode,x,w.key),v.return=m,m=v):(x=er(w.type,w.key,w.props,null,m.mode,x),x.ref=zs(m,v,w),x.return=m,m=x)}return o(m);case Zn:e:{for(I=w.key;v!==null;){if(v.key===I)if(v.tag===4&&v.stateNode.containerInfo===w.containerInfo&&v.stateNode.implementation===w.implementation){s(m,v.sibling),v=r(v,w.children||[]),v.return=m,m=v;break e}else{s(m,v);break}else t(m,v);v=v.sibling}v=ki(w,m.mode,x),v.return=m,m=v}return o(m);case cn:return I=w._init,N(m,v,I(w._payload),x)}if(Rs(w))return f(m,v,w,x);if(Es(w))return y(m,v,w,x);Ba(m,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,v!==null&&v.tag===6?(s(m,v.sibling),v=r(v,w),v.return=m,m=v):(s(m,v),v=bi(w,m.mode,x),v.return=m,m=v),o(m)):s(m,v)}return N}var ws=mu(!0),pu=mu(!1),fr=An(null),gr=null,is=null,qo=null;function Go(){qo=is=gr=null}function Uo(e){var t=fr.current;ye(fr),e._currentValue=t}function to(e,t,s){for(;e!==null;){var a=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,a!==null&&(a.childLanes|=t)):a!==null&&(a.childLanes&t)!==t&&(a.childLanes|=t),e===s)break;e=e.return}}function ps(e,t){gr=e,qo=is=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Xe=!0),e.firstContext=null)}function vt(e){var t=e._currentValue;if(qo!==e)if(e={context:e,memoizedValue:t,next:null},is===null){if(gr===null)throw Error($(308));is=e,gr.dependencies={lanes:0,firstContext:e}}else is=is.next=e;return t}var zn=null;function Vo(e){zn===null?zn=[e]:zn.push(e)}function fu(e,t,s,a){var r=t.interleaved;return r===null?(s.next=s,Vo(t)):(s.next=r.next,r.next=s),t.interleaved=s,Qt(e,a)}function Qt(e,t){e.lanes|=t;var s=e.alternate;for(s!==null&&(s.lanes|=t),s=e,e=e.return;e!==null;)e.childLanes|=t,s=e.alternate,s!==null&&(s.childLanes|=t),s=e,e=e.return;return s.tag===3?s.stateNode:null}var dn=!1;function Yo(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function gu(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Vt(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function kn(e,t,s){var a=e.updateQueue;if(a===null)return null;if(a=a.shared,re&2){var r=a.pending;return r===null?t.next=t:(t.next=r.next,r.next=t),a.pending=t,Qt(e,s)}return r=a.interleaved,r===null?(t.next=t,Vo(a)):(t.next=r.next,r.next=t),a.interleaved=t,Qt(e,s)}function Ya(e,t,s){if(t=t.updateQueue,t!==null&&(t=t.shared,(s&4194240)!==0)){var a=t.lanes;a&=e.pendingLanes,s|=a,t.lanes=s,$o(e,s)}}function vc(e,t){var s=e.updateQueue,a=e.alternate;if(a!==null&&(a=a.updateQueue,s===a)){var r=null,i=null;if(s=s.firstBaseUpdate,s!==null){do{var o={eventTime:s.eventTime,lane:s.lane,tag:s.tag,payload:s.payload,callback:s.callback,next:null};i===null?r=i=o:i=i.next=o,s=s.next}while(s!==null);i===null?r=i=t:i=i.next=t}else r=i=t;s={baseState:a.baseState,firstBaseUpdate:r,lastBaseUpdate:i,shared:a.shared,effects:a.effects},e.updateQueue=s;return}e=s.lastBaseUpdate,e===null?s.firstBaseUpdate=t:e.next=t,s.lastBaseUpdate=t}function yr(e,t,s,a){var r=e.updateQueue;dn=!1;var i=r.firstBaseUpdate,o=r.lastBaseUpdate,l=r.shared.pending;if(l!==null){r.shared.pending=null;var c=l,d=c.next;c.next=null,o===null?i=d:o.next=d,o=c;var u=e.alternate;u!==null&&(u=u.updateQueue,l=u.lastBaseUpdate,l!==o&&(l===null?u.firstBaseUpdate=d:l.next=d,u.lastBaseUpdate=c))}if(i!==null){var g=r.baseState;o=0,u=d=c=null,l=i;do{var h=l.lane,p=l.eventTime;if((a&h)===h){u!==null&&(u=u.next={eventTime:p,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var f=e,y=l;switch(h=t,p=s,y.tag){case 1:if(f=y.payload,typeof f=="function"){g=f.call(p,g,h);break e}g=f;break e;case 3:f.flags=f.flags&-65537|128;case 0:if(f=y.payload,h=typeof f=="function"?f.call(p,g,h):f,h==null)break e;g=ke({},g,h);break e;case 2:dn=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,h=r.effects,h===null?r.effects=[l]:h.push(l))}else p={eventTime:p,lane:h,tag:l.tag,payload:l.payload,callback:l.callback,next:null},u===null?(d=u=p,c=g):u=u.next=p,o|=h;if(l=l.next,l===null){if(l=r.shared.pending,l===null)break;h=l,l=h.next,h.next=null,r.lastBaseUpdate=h,r.shared.pending=null}}while(!0);if(u===null&&(c=g),r.baseState=c,r.firstBaseUpdate=d,r.lastBaseUpdate=u,t=r.shared.interleaved,t!==null){r=t;do o|=r.lane,r=r.next;while(r!==t)}else i===null&&(r.shared.lanes=0);Wn|=o,e.lanes=o,e.memoizedState=g}}function wc(e,t,s){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var a=e[t],r=a.callback;if(r!==null){if(a.callback=null,a=s,typeof r!="function")throw Error($(191,r));r.call(a)}}}var ba={},Pt=An(ba),ua=An(ba),ha=An(ba);function Hn(e){if(e===ba)throw Error($(174));return e}function Ko(e,t){switch(he(ha,t),he(ua,e),he(Pt,ba),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Pi(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Pi(t,e)}ye(Pt),he(Pt,t)}function bs(){ye(Pt),ye(ua),ye(ha)}function yu(e){Hn(ha.current);var t=Hn(Pt.current),s=Pi(t,e.type);t!==s&&(he(ua,e),he(Pt,s))}function Qo(e){ua.current===e&&(ye(Pt),ye(ua))}var we=An(0);function xr(e){for(var t=e;t!==null;){if(t.tag===13){var s=t.memoizedState;if(s!==null&&(s=s.dehydrated,s===null||s.data==="$?"||s.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var fi=[];function Zo(){for(var e=0;e<fi.length;e++)fi[e]._workInProgressVersionPrimary=null;fi.length=0}var Ka=en.ReactCurrentDispatcher,gi=en.ReactCurrentBatchConfig,Fn=0,be=null,Ie=null,De=null,vr=!1,Qs=!1,ma=0,Zp=0;function Fe(){throw Error($(321))}function Jo(e,t){if(t===null)return!1;for(var s=0;s<t.length&&s<e.length;s++)if(!It(e[s],t[s]))return!1;return!0}function Xo(e,t,s,a,r,i){if(Fn=i,be=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Ka.current=e===null||e.memoizedState===null?tf:nf,e=s(a,r),Qs){i=0;do{if(Qs=!1,ma=0,25<=i)throw Error($(301));i+=1,De=Ie=null,t.updateQueue=null,Ka.current=sf,e=s(a,r)}while(Qs)}if(Ka.current=wr,t=Ie!==null&&Ie.next!==null,Fn=0,De=Ie=be=null,vr=!1,t)throw Error($(300));return e}function el(){var e=ma!==0;return ma=0,e}function Lt(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return De===null?be.memoizedState=De=e:De=De.next=e,De}function wt(){if(Ie===null){var e=be.alternate;e=e!==null?e.memoizedState:null}else e=Ie.next;var t=De===null?be.memoizedState:De.next;if(t!==null)De=t,Ie=e;else{if(e===null)throw Error($(310));Ie=e,e={memoizedState:Ie.memoizedState,baseState:Ie.baseState,baseQueue:Ie.baseQueue,queue:Ie.queue,next:null},De===null?be.memoizedState=De=e:De=De.next=e}return De}function pa(e,t){return typeof t=="function"?t(e):t}function yi(e){var t=wt(),s=t.queue;if(s===null)throw Error($(311));s.lastRenderedReducer=e;var a=Ie,r=a.baseQueue,i=s.pending;if(i!==null){if(r!==null){var o=r.next;r.next=i.next,i.next=o}a.baseQueue=r=i,s.pending=null}if(r!==null){i=r.next,a=a.baseState;var l=o=null,c=null,d=i;do{var u=d.lane;if((Fn&u)===u)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),a=d.hasEagerState?d.eagerState:e(a,d.action);else{var g={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(l=c=g,o=a):c=c.next=g,be.lanes|=u,Wn|=u}d=d.next}while(d!==null&&d!==i);c===null?o=a:c.next=l,It(a,t.memoizedState)||(Xe=!0),t.memoizedState=a,t.baseState=o,t.baseQueue=c,s.lastRenderedState=a}if(e=s.interleaved,e!==null){r=e;do i=r.lane,be.lanes|=i,Wn|=i,r=r.next;while(r!==e)}else r===null&&(s.lanes=0);return[t.memoizedState,s.dispatch]}function xi(e){var t=wt(),s=t.queue;if(s===null)throw Error($(311));s.lastRenderedReducer=e;var a=s.dispatch,r=s.pending,i=t.memoizedState;if(r!==null){s.pending=null;var o=r=r.next;do i=e(i,o.action),o=o.next;while(o!==r);It(i,t.memoizedState)||(Xe=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),s.lastRenderedState=i}return[i,a]}function xu(){}function vu(e,t){var s=be,a=wt(),r=t(),i=!It(a.memoizedState,r);if(i&&(a.memoizedState=r,Xe=!0),a=a.queue,tl(ku.bind(null,s,a,e),[e]),a.getSnapshot!==t||i||De!==null&&De.memoizedState.tag&1){if(s.flags|=2048,fa(9,bu.bind(null,s,a,r,t),void 0,null),Pe===null)throw Error($(349));Fn&30||wu(s,t,r)}return r}function wu(e,t,s){e.flags|=16384,e={getSnapshot:t,value:s},t=be.updateQueue,t===null?(t={lastEffect:null,stores:null},be.updateQueue=t,t.stores=[e]):(s=t.stores,s===null?t.stores=[e]:s.push(e))}function bu(e,t,s,a){t.value=s,t.getSnapshot=a,ju(t)&&Nu(e)}function ku(e,t,s){return s(function(){ju(t)&&Nu(e)})}function ju(e){var t=e.getSnapshot;e=e.value;try{var s=t();return!It(e,s)}catch{return!0}}function Nu(e){var t=Qt(e,1);t!==null&&Ct(t,e,1,-1)}function bc(e){var t=Lt();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:pa,lastRenderedState:e},t.queue=e,e=e.dispatch=ef.bind(null,be,e),[t.memoizedState,e]}function fa(e,t,s,a){return e={tag:e,create:t,destroy:s,deps:a,next:null},t=be.updateQueue,t===null?(t={lastEffect:null,stores:null},be.updateQueue=t,t.lastEffect=e.next=e):(s=t.lastEffect,s===null?t.lastEffect=e.next=e:(a=s.next,s.next=e,e.next=a,t.lastEffect=e)),e}function Su(){return wt().memoizedState}function Qa(e,t,s,a){var r=Lt();be.flags|=e,r.memoizedState=fa(1|t,s,void 0,a===void 0?null:a)}function Pr(e,t,s,a){var r=wt();a=a===void 0?null:a;var i=void 0;if(Ie!==null){var o=Ie.memoizedState;if(i=o.destroy,a!==null&&Jo(a,o.deps)){r.memoizedState=fa(t,s,i,a);return}}be.flags|=e,r.memoizedState=fa(1|t,s,i,a)}function kc(e,t){return Qa(8390656,8,e,t)}function tl(e,t){return Pr(2048,8,e,t)}function Mu(e,t){return Pr(4,2,e,t)}function Tu(e,t){return Pr(4,4,e,t)}function Cu(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Iu(e,t,s){return s=s!=null?s.concat([e]):null,Pr(4,4,Cu.bind(null,t,e),s)}function nl(){}function Au(e,t){var s=wt();t=t===void 0?null:t;var a=s.memoizedState;return a!==null&&t!==null&&Jo(t,a[1])?a[0]:(s.memoizedState=[e,t],e)}function Eu(e,t){var s=wt();t=t===void 0?null:t;var a=s.memoizedState;return a!==null&&t!==null&&Jo(t,a[1])?a[0]:(e=e(),s.memoizedState=[e,t],e)}function Lu(e,t,s){return Fn&21?(It(s,t)||(s=Hd(),be.lanes|=s,Wn|=s,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Xe=!0),e.memoizedState=s)}function Jp(e,t){var s=le;le=s!==0&&4>s?s:4,e(!0);var a=gi.transition;gi.transition={};try{e(!1),t()}finally{le=s,gi.transition=a}}function $u(){return wt().memoizedState}function Xp(e,t,s){var a=Nn(e);if(s={lane:a,action:s,hasEagerState:!1,eagerState:null,next:null},Du(e))Pu(t,s);else if(s=fu(e,t,s,a),s!==null){var r=Ye();Ct(s,e,a,r),zu(s,t,a)}}function ef(e,t,s){var a=Nn(e),r={lane:a,action:s,hasEagerState:!1,eagerState:null,next:null};if(Du(e))Pu(t,r);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var o=t.lastRenderedState,l=i(o,s);if(r.hasEagerState=!0,r.eagerState=l,It(l,o)){var c=t.interleaved;c===null?(r.next=r,Vo(t)):(r.next=c.next,c.next=r),t.interleaved=r;return}}catch{}finally{}s=fu(e,t,r,a),s!==null&&(r=Ye(),Ct(s,e,a,r),zu(s,t,a))}}function Du(e){var t=e.alternate;return e===be||t!==null&&t===be}function Pu(e,t){Qs=vr=!0;var s=e.pending;s===null?t.next=t:(t.next=s.next,s.next=t),e.pending=t}function zu(e,t,s){if(s&4194240){var a=t.lanes;a&=e.pendingLanes,s|=a,t.lanes=s,$o(e,s)}}var wr={readContext:vt,useCallback:Fe,useContext:Fe,useEffect:Fe,useImperativeHandle:Fe,useInsertionEffect:Fe,useLayoutEffect:Fe,useMemo:Fe,useReducer:Fe,useRef:Fe,useState:Fe,useDebugValue:Fe,useDeferredValue:Fe,useTransition:Fe,useMutableSource:Fe,useSyncExternalStore:Fe,useId:Fe,unstable_isNewReconciler:!1},tf={readContext:vt,useCallback:function(e,t){return Lt().memoizedState=[e,t===void 0?null:t],e},useContext:vt,useEffect:kc,useImperativeHandle:function(e,t,s){return s=s!=null?s.concat([e]):null,Qa(4194308,4,Cu.bind(null,t,e),s)},useLayoutEffect:function(e,t){return Qa(4194308,4,e,t)},useInsertionEffect:function(e,t){return Qa(4,2,e,t)},useMemo:function(e,t){var s=Lt();return t=t===void 0?null:t,e=e(),s.memoizedState=[e,t],e},useReducer:function(e,t,s){var a=Lt();return t=s!==void 0?s(t):t,a.memoizedState=a.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},a.queue=e,e=e.dispatch=Xp.bind(null,be,e),[a.memoizedState,e]},useRef:function(e){var t=Lt();return e={current:e},t.memoizedState=e},useState:bc,useDebugValue:nl,useDeferredValue:function(e){return Lt().memoizedState=e},useTransition:function(){var e=bc(!1),t=e[0];return e=Jp.bind(null,e[1]),Lt().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,s){var a=be,r=Lt();if(ve){if(s===void 0)throw Error($(407));s=s()}else{if(s=t(),Pe===null)throw Error($(349));Fn&30||wu(a,t,s)}r.memoizedState=s;var i={value:s,getSnapshot:t};return r.queue=i,kc(ku.bind(null,a,i,e),[e]),a.flags|=2048,fa(9,bu.bind(null,a,i,s,t),void 0,null),s},useId:function(){var e=Lt(),t=Pe.identifierPrefix;if(ve){var s=Gt,a=qt;s=(a&~(1<<32-Tt(a)-1)).toString(32)+s,t=":"+t+"R"+s,s=ma++,0<s&&(t+="H"+s.toString(32)),t+=":"}else s=Zp++,t=":"+t+"r"+s.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},nf={readContext:vt,useCallback:Au,useContext:vt,useEffect:tl,useImperativeHandle:Iu,useInsertionEffect:Mu,useLayoutEffect:Tu,useMemo:Eu,useReducer:yi,useRef:Su,useState:function(){return yi(pa)},useDebugValue:nl,useDeferredValue:function(e){var t=wt();return Lu(t,Ie.memoizedState,e)},useTransition:function(){var e=yi(pa)[0],t=wt().memoizedState;return[e,t]},useMutableSource:xu,useSyncExternalStore:vu,useId:$u,unstable_isNewReconciler:!1},sf={readContext:vt,useCallback:Au,useContext:vt,useEffect:tl,useImperativeHandle:Iu,useInsertionEffect:Mu,useLayoutEffect:Tu,useMemo:Eu,useReducer:xi,useRef:Su,useState:function(){return xi(pa)},useDebugValue:nl,useDeferredValue:function(e){var t=wt();return Ie===null?t.memoizedState=e:Lu(t,Ie.memoizedState,e)},useTransition:function(){var e=xi(pa)[0],t=wt().memoizedState;return[e,t]},useMutableSource:xu,useSyncExternalStore:vu,useId:$u,unstable_isNewReconciler:!1};function jt(e,t){if(e&&e.defaultProps){t=ke({},t),e=e.defaultProps;for(var s in e)t[s]===void 0&&(t[s]=e[s]);return t}return t}function no(e,t,s,a){t=e.memoizedState,s=s(a,t),s=s==null?t:ke({},t,s),e.memoizedState=s,e.lanes===0&&(e.updateQueue.baseState=s)}var zr={isMounted:function(e){return(e=e._reactInternals)?Un(e)===e:!1},enqueueSetState:function(e,t,s){e=e._reactInternals;var a=Ye(),r=Nn(e),i=Vt(a,r);i.payload=t,s!=null&&(i.callback=s),t=kn(e,i,r),t!==null&&(Ct(t,e,r,a),Ya(t,e,r))},enqueueReplaceState:function(e,t,s){e=e._reactInternals;var a=Ye(),r=Nn(e),i=Vt(a,r);i.tag=1,i.payload=t,s!=null&&(i.callback=s),t=kn(e,i,r),t!==null&&(Ct(t,e,r,a),Ya(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var s=Ye(),a=Nn(e),r=Vt(s,a);r.tag=2,t!=null&&(r.callback=t),t=kn(e,r,a),t!==null&&(Ct(t,e,a,s),Ya(t,e,a))}};function jc(e,t,s,a,r,i,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(a,i,o):t.prototype&&t.prototype.isPureReactComponent?!oa(s,a)||!oa(r,i):!0}function Hu(e,t,s){var a=!1,r=Cn,i=t.contextType;return typeof i=="object"&&i!==null?i=vt(i):(r=tt(t)?Rn:Ge.current,a=t.contextTypes,i=(a=a!=null)?xs(e,r):Cn),t=new t(s,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=zr,e.stateNode=t,t._reactInternals=e,a&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=i),t}function Nc(e,t,s,a){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(s,a),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(s,a),t.state!==e&&zr.enqueueReplaceState(t,t.state,null)}function so(e,t,s,a){var r=e.stateNode;r.props=s,r.state=e.memoizedState,r.refs={},Yo(e);var i=t.contextType;typeof i=="object"&&i!==null?r.context=vt(i):(i=tt(t)?Rn:Ge.current,r.context=xs(e,i)),r.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(no(e,t,i,s),r.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(t=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),t!==r.state&&zr.enqueueReplaceState(r,r.state,null),yr(e,s,r,a),r.state=e.memoizedState),typeof r.componentDidMount=="function"&&(e.flags|=4194308)}function ks(e,t){try{var s="",a=t;do s+=Em(a),a=a.return;while(a);var r=s}catch(i){r=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:r,digest:null}}function vi(e,t,s){return{value:e,source:null,stack:s??null,digest:t??null}}function ao(e,t){try{console.error(t.value)}catch(s){setTimeout(function(){throw s})}}var af=typeof WeakMap=="function"?WeakMap:Map;function Bu(e,t,s){s=Vt(-1,s),s.tag=3,s.payload={element:null};var a=t.value;return s.callback=function(){kr||(kr=!0,fo=a),ao(e,t)},s}function _u(e,t,s){s=Vt(-1,s),s.tag=3;var a=e.type.getDerivedStateFromError;if(typeof a=="function"){var r=t.value;s.payload=function(){return a(r)},s.callback=function(){ao(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(s.callback=function(){ao(e,t),typeof a!="function"&&(jn===null?jn=new Set([this]):jn.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),s}function Sc(e,t,s){var a=e.pingCache;if(a===null){a=e.pingCache=new af;var r=new Set;a.set(t,r)}else r=a.get(t),r===void 0&&(r=new Set,a.set(t,r));r.has(s)||(r.add(s),e=vf.bind(null,e,t,s),t.then(e,e))}function Mc(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Tc(e,t,s,a,r){return e.mode&1?(e.flags|=65536,e.lanes=r,e):(e===t?e.flags|=65536:(e.flags|=128,s.flags|=131072,s.flags&=-52805,s.tag===1&&(s.alternate===null?s.tag=17:(t=Vt(-1,1),t.tag=2,kn(s,t,1))),s.lanes|=1),e)}var rf=en.ReactCurrentOwner,Xe=!1;function Ve(e,t,s,a){t.child=e===null?pu(t,null,s,a):ws(t,e.child,s,a)}function Cc(e,t,s,a,r){s=s.render;var i=t.ref;return ps(t,r),a=Xo(e,t,s,a,i,r),s=el(),e!==null&&!Xe?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Zt(e,t,r)):(ve&&s&&Oo(t),t.flags|=1,Ve(e,t,a,r),t.child)}function Ic(e,t,s,a,r){if(e===null){var i=s.type;return typeof i=="function"&&!dl(i)&&i.defaultProps===void 0&&s.compare===null&&s.defaultProps===void 0?(t.tag=15,t.type=i,Ru(e,t,i,a,r)):(e=er(s.type,null,a,t,t.mode,r),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&r)){var o=i.memoizedProps;if(s=s.compare,s=s!==null?s:oa,s(o,a)&&e.ref===t.ref)return Zt(e,t,r)}return t.flags|=1,e=Sn(i,a),e.ref=t.ref,e.return=t,t.child=e}function Ru(e,t,s,a,r){if(e!==null){var i=e.memoizedProps;if(oa(i,a)&&e.ref===t.ref)if(Xe=!1,t.pendingProps=a=i,(e.lanes&r)!==0)e.flags&131072&&(Xe=!0);else return t.lanes=e.lanes,Zt(e,t,r)}return ro(e,t,s,a,r)}function Ou(e,t,s){var a=t.pendingProps,r=a.children,i=e!==null?e.memoizedState:null;if(a.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},he(ls,rt),rt|=s;else{if(!(s&1073741824))return e=i!==null?i.baseLanes|s:s,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,he(ls,rt),rt|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},a=i!==null?i.baseLanes:s,he(ls,rt),rt|=a}else i!==null?(a=i.baseLanes|s,t.memoizedState=null):a=s,he(ls,rt),rt|=a;return Ve(e,t,r,s),t.child}function Fu(e,t){var s=t.ref;(e===null&&s!==null||e!==null&&e.ref!==s)&&(t.flags|=512,t.flags|=2097152)}function ro(e,t,s,a,r){var i=tt(s)?Rn:Ge.current;return i=xs(t,i),ps(t,r),s=Xo(e,t,s,a,i,r),a=el(),e!==null&&!Xe?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Zt(e,t,r)):(ve&&a&&Oo(t),t.flags|=1,Ve(e,t,s,r),t.child)}function Ac(e,t,s,a,r){if(tt(s)){var i=!0;hr(t)}else i=!1;if(ps(t,r),t.stateNode===null)Za(e,t),Hu(t,s,a),so(t,s,a,r),a=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var c=o.context,d=s.contextType;typeof d=="object"&&d!==null?d=vt(d):(d=tt(s)?Rn:Ge.current,d=xs(t,d));var u=s.getDerivedStateFromProps,g=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";g||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==a||c!==d)&&Nc(t,o,a,d),dn=!1;var h=t.memoizedState;o.state=h,yr(t,a,o,r),c=t.memoizedState,l!==a||h!==c||et.current||dn?(typeof u=="function"&&(no(t,s,u,a),c=t.memoizedState),(l=dn||jc(t,s,l,a,h,c,d))?(g||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=a,t.memoizedState=c),o.props=a,o.state=c,o.context=d,a=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),a=!1)}else{o=t.stateNode,gu(e,t),l=t.memoizedProps,d=t.type===t.elementType?l:jt(t.type,l),o.props=d,g=t.pendingProps,h=o.context,c=s.contextType,typeof c=="object"&&c!==null?c=vt(c):(c=tt(s)?Rn:Ge.current,c=xs(t,c));var p=s.getDerivedStateFromProps;(u=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==g||h!==c)&&Nc(t,o,a,c),dn=!1,h=t.memoizedState,o.state=h,yr(t,a,o,r);var f=t.memoizedState;l!==g||h!==f||et.current||dn?(typeof p=="function"&&(no(t,s,p,a),f=t.memoizedState),(d=dn||jc(t,s,d,a,h,f,c)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(a,f,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(a,f,c)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=a,t.memoizedState=f),o.props=a,o.state=f,o.context=c,a=d):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),a=!1)}return io(e,t,s,a,i,r)}function io(e,t,s,a,r,i){Fu(e,t);var o=(t.flags&128)!==0;if(!a&&!o)return r&&fc(t,s,!1),Zt(e,t,i);a=t.stateNode,rf.current=t;var l=o&&typeof s.getDerivedStateFromError!="function"?null:a.render();return t.flags|=1,e!==null&&o?(t.child=ws(t,e.child,null,i),t.child=ws(t,null,l,i)):Ve(e,t,l,i),t.memoizedState=a.state,r&&fc(t,s,!0),t.child}function Wu(e){var t=e.stateNode;t.pendingContext?pc(e,t.pendingContext,t.pendingContext!==t.context):t.context&&pc(e,t.context,!1),Ko(e,t.containerInfo)}function Ec(e,t,s,a,r){return vs(),Wo(r),t.flags|=256,Ve(e,t,s,a),t.child}var oo={dehydrated:null,treeContext:null,retryLane:0};function lo(e){return{baseLanes:e,cachePool:null,transitions:null}}function qu(e,t,s){var a=t.pendingProps,r=we.current,i=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(r&2)!==0),l?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(r|=1),he(we,r&1),e===null)return eo(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=a.children,e=a.fallback,i?(a=t.mode,i=t.child,o={mode:"hidden",children:o},!(a&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=_r(o,a,0,null),e=_n(e,a,s,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=lo(s),t.memoizedState=oo,e):sl(t,o));if(r=e.memoizedState,r!==null&&(l=r.dehydrated,l!==null))return of(e,t,o,a,l,r,s);if(i){i=a.fallback,o=t.mode,r=e.child,l=r.sibling;var c={mode:"hidden",children:a.children};return!(o&1)&&t.child!==r?(a=t.child,a.childLanes=0,a.pendingProps=c,t.deletions=null):(a=Sn(r,c),a.subtreeFlags=r.subtreeFlags&14680064),l!==null?i=Sn(l,i):(i=_n(i,o,s,null),i.flags|=2),i.return=t,a.return=t,a.sibling=i,t.child=a,a=i,i=t.child,o=e.child.memoizedState,o=o===null?lo(s):{baseLanes:o.baseLanes|s,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=e.childLanes&~s,t.memoizedState=oo,a}return i=e.child,e=i.sibling,a=Sn(i,{mode:"visible",children:a.children}),!(t.mode&1)&&(a.lanes=s),a.return=t,a.sibling=null,e!==null&&(s=t.deletions,s===null?(t.deletions=[e],t.flags|=16):s.push(e)),t.child=a,t.memoizedState=null,a}function sl(e,t){return t=_r({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function _a(e,t,s,a){return a!==null&&Wo(a),ws(t,e.child,null,s),e=sl(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function of(e,t,s,a,r,i,o){if(s)return t.flags&256?(t.flags&=-257,a=vi(Error($(422))),_a(e,t,o,a)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=a.fallback,r=t.mode,a=_r({mode:"visible",children:a.children},r,0,null),i=_n(i,r,o,null),i.flags|=2,a.return=t,i.return=t,a.sibling=i,t.child=a,t.mode&1&&ws(t,e.child,null,o),t.child.memoizedState=lo(o),t.memoizedState=oo,i);if(!(t.mode&1))return _a(e,t,o,null);if(r.data==="$!"){if(a=r.nextSibling&&r.nextSibling.dataset,a)var l=a.dgst;return a=l,i=Error($(419)),a=vi(i,a,void 0),_a(e,t,o,a)}if(l=(o&e.childLanes)!==0,Xe||l){if(a=Pe,a!==null){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(a.suspendedLanes|o)?0:r,r!==0&&r!==i.retryLane&&(i.retryLane=r,Qt(e,r),Ct(a,e,r,-1))}return cl(),a=vi(Error($(421))),_a(e,t,o,a)}return r.data==="$?"?(t.flags|=128,t.child=e.child,t=wf.bind(null,e),r._reactRetry=t,null):(e=i.treeContext,it=bn(r.nextSibling),ot=t,ve=!0,St=null,e!==null&&(ft[gt++]=qt,ft[gt++]=Gt,ft[gt++]=On,qt=e.id,Gt=e.overflow,On=t),t=sl(t,a.children),t.flags|=4096,t)}function Lc(e,t,s){e.lanes|=t;var a=e.alternate;a!==null&&(a.lanes|=t),to(e.return,t,s)}function wi(e,t,s,a,r){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:a,tail:s,tailMode:r}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=a,i.tail=s,i.tailMode=r)}function Gu(e,t,s){var a=t.pendingProps,r=a.revealOrder,i=a.tail;if(Ve(e,t,a.children,s),a=we.current,a&2)a=a&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Lc(e,s,t);else if(e.tag===19)Lc(e,s,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}a&=1}if(he(we,a),!(t.mode&1))t.memoizedState=null;else switch(r){case"forwards":for(s=t.child,r=null;s!==null;)e=s.alternate,e!==null&&xr(e)===null&&(r=s),s=s.sibling;s=r,s===null?(r=t.child,t.child=null):(r=s.sibling,s.sibling=null),wi(t,!1,r,s,i);break;case"backwards":for(s=null,r=t.child,t.child=null;r!==null;){if(e=r.alternate,e!==null&&xr(e)===null){t.child=r;break}e=r.sibling,r.sibling=s,s=r,r=e}wi(t,!0,s,null,i);break;case"together":wi(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Za(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Zt(e,t,s){if(e!==null&&(t.dependencies=e.dependencies),Wn|=t.lanes,!(s&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error($(153));if(t.child!==null){for(e=t.child,s=Sn(e,e.pendingProps),t.child=s,s.return=t;e.sibling!==null;)e=e.sibling,s=s.sibling=Sn(e,e.pendingProps),s.return=t;s.sibling=null}return t.child}function lf(e,t,s){switch(t.tag){case 3:Wu(t),vs();break;case 5:yu(t);break;case 1:tt(t.type)&&hr(t);break;case 4:Ko(t,t.stateNode.containerInfo);break;case 10:var a=t.type._context,r=t.memoizedProps.value;he(fr,a._currentValue),a._currentValue=r;break;case 13:if(a=t.memoizedState,a!==null)return a.dehydrated!==null?(he(we,we.current&1),t.flags|=128,null):s&t.child.childLanes?qu(e,t,s):(he(we,we.current&1),e=Zt(e,t,s),e!==null?e.sibling:null);he(we,we.current&1);break;case 19:if(a=(s&t.childLanes)!==0,e.flags&128){if(a)return Gu(e,t,s);t.flags|=128}if(r=t.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),he(we,we.current),a)break;return null;case 22:case 23:return t.lanes=0,Ou(e,t,s)}return Zt(e,t,s)}var Uu,co,Vu,Yu;Uu=function(e,t){for(var s=t.child;s!==null;){if(s.tag===5||s.tag===6)e.appendChild(s.stateNode);else if(s.tag!==4&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===t)break;for(;s.sibling===null;){if(s.return===null||s.return===t)return;s=s.return}s.sibling.return=s.return,s=s.sibling}};co=function(){};Vu=function(e,t,s,a){var r=e.memoizedProps;if(r!==a){e=t.stateNode,Hn(Pt.current);var i=null;switch(s){case"input":r=Ei(e,r),a=Ei(e,a),i=[];break;case"select":r=ke({},r,{value:void 0}),a=ke({},a,{value:void 0}),i=[];break;case"textarea":r=Di(e,r),a=Di(e,a),i=[];break;default:typeof r.onClick!="function"&&typeof a.onClick=="function"&&(e.onclick=dr)}zi(s,a);var o;s=null;for(d in r)if(!a.hasOwnProperty(d)&&r.hasOwnProperty(d)&&r[d]!=null)if(d==="style"){var l=r[d];for(o in l)l.hasOwnProperty(o)&&(s||(s={}),s[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(ea.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in a){var c=a[d];if(l=r!=null?r[d]:void 0,a.hasOwnProperty(d)&&c!==l&&(c!=null||l!=null))if(d==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(s||(s={}),s[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(s||(s={}),s[o]=c[o])}else s||(i||(i=[]),i.push(d,s)),s=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(ea.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&ge("scroll",e),i||l===c||(i=[])):(i=i||[]).push(d,c))}s&&(i=i||[]).push("style",s);var d=i;(t.updateQueue=d)&&(t.flags|=4)}};Yu=function(e,t,s,a){s!==a&&(t.flags|=4)};function Hs(e,t){if(!ve)switch(e.tailMode){case"hidden":t=e.tail;for(var s=null;t!==null;)t.alternate!==null&&(s=t),t=t.sibling;s===null?e.tail=null:s.sibling=null;break;case"collapsed":s=e.tail;for(var a=null;s!==null;)s.alternate!==null&&(a=s),s=s.sibling;a===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:a.sibling=null}}function We(e){var t=e.alternate!==null&&e.alternate.child===e.child,s=0,a=0;if(t)for(var r=e.child;r!==null;)s|=r.lanes|r.childLanes,a|=r.subtreeFlags&14680064,a|=r.flags&14680064,r.return=e,r=r.sibling;else for(r=e.child;r!==null;)s|=r.lanes|r.childLanes,a|=r.subtreeFlags,a|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=a,e.childLanes=s,t}function cf(e,t,s){var a=t.pendingProps;switch(Fo(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return We(t),null;case 1:return tt(t.type)&&ur(),We(t),null;case 3:return a=t.stateNode,bs(),ye(et),ye(Ge),Zo(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),(e===null||e.child===null)&&(Ha(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,St!==null&&(xo(St),St=null))),co(e,t),We(t),null;case 5:Qo(t);var r=Hn(ha.current);if(s=t.type,e!==null&&t.stateNode!=null)Vu(e,t,s,a,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!a){if(t.stateNode===null)throw Error($(166));return We(t),null}if(e=Hn(Pt.current),Ha(t)){a=t.stateNode,s=t.type;var i=t.memoizedProps;switch(a[$t]=t,a[da]=i,e=(t.mode&1)!==0,s){case"dialog":ge("cancel",a),ge("close",a);break;case"iframe":case"object":case"embed":ge("load",a);break;case"video":case"audio":for(r=0;r<Fs.length;r++)ge(Fs[r],a);break;case"source":ge("error",a);break;case"img":case"image":case"link":ge("error",a),ge("load",a);break;case"details":ge("toggle",a);break;case"input":Ol(a,i),ge("invalid",a);break;case"select":a._wrapperState={wasMultiple:!!i.multiple},ge("invalid",a);break;case"textarea":Wl(a,i),ge("invalid",a)}zi(s,i),r=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?a.textContent!==l&&(i.suppressHydrationWarning!==!0&&za(a.textContent,l,e),r=["children",l]):typeof l=="number"&&a.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&za(a.textContent,l,e),r=["children",""+l]):ea.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&ge("scroll",a)}switch(s){case"input":Ca(a),Fl(a,i,!0);break;case"textarea":Ca(a),ql(a);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(a.onclick=dr)}a=r,t.updateQueue=a,a!==null&&(t.flags|=4)}else{o=r.nodeType===9?r:r.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=kd(s)),e==="http://www.w3.org/1999/xhtml"?s==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof a.is=="string"?e=o.createElement(s,{is:a.is}):(e=o.createElement(s),s==="select"&&(o=e,a.multiple?o.multiple=!0:a.size&&(o.size=a.size))):e=o.createElementNS(e,s),e[$t]=t,e[da]=a,Uu(e,t,!1,!1),t.stateNode=e;e:{switch(o=Hi(s,a),s){case"dialog":ge("cancel",e),ge("close",e),r=a;break;case"iframe":case"object":case"embed":ge("load",e),r=a;break;case"video":case"audio":for(r=0;r<Fs.length;r++)ge(Fs[r],e);r=a;break;case"source":ge("error",e),r=a;break;case"img":case"image":case"link":ge("error",e),ge("load",e),r=a;break;case"details":ge("toggle",e),r=a;break;case"input":Ol(e,a),r=Ei(e,a),ge("invalid",e);break;case"option":r=a;break;case"select":e._wrapperState={wasMultiple:!!a.multiple},r=ke({},a,{value:void 0}),ge("invalid",e);break;case"textarea":Wl(e,a),r=Di(e,a),ge("invalid",e);break;default:r=a}zi(s,r),l=r;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?Sd(e,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&jd(e,c)):i==="children"?typeof c=="string"?(s!=="textarea"||c!=="")&&ta(e,c):typeof c=="number"&&ta(e,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(ea.hasOwnProperty(i)?c!=null&&i==="onScroll"&&ge("scroll",e):c!=null&&To(e,i,c,o))}switch(s){case"input":Ca(e),Fl(e,a,!1);break;case"textarea":Ca(e),ql(e);break;case"option":a.value!=null&&e.setAttribute("value",""+Tn(a.value));break;case"select":e.multiple=!!a.multiple,i=a.value,i!=null?ds(e,!!a.multiple,i,!1):a.defaultValue!=null&&ds(e,!!a.multiple,a.defaultValue,!0);break;default:typeof r.onClick=="function"&&(e.onclick=dr)}switch(s){case"button":case"input":case"select":case"textarea":a=!!a.autoFocus;break e;case"img":a=!0;break e;default:a=!1}}a&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return We(t),null;case 6:if(e&&t.stateNode!=null)Yu(e,t,e.memoizedProps,a);else{if(typeof a!="string"&&t.stateNode===null)throw Error($(166));if(s=Hn(ha.current),Hn(Pt.current),Ha(t)){if(a=t.stateNode,s=t.memoizedProps,a[$t]=t,(i=a.nodeValue!==s)&&(e=ot,e!==null))switch(e.tag){case 3:za(a.nodeValue,s,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&za(a.nodeValue,s,(e.mode&1)!==0)}i&&(t.flags|=4)}else a=(s.nodeType===9?s:s.ownerDocument).createTextNode(a),a[$t]=t,t.stateNode=a}return We(t),null;case 13:if(ye(we),a=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(ve&&it!==null&&t.mode&1&&!(t.flags&128))hu(),vs(),t.flags|=98560,i=!1;else if(i=Ha(t),a!==null&&a.dehydrated!==null){if(e===null){if(!i)throw Error($(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error($(317));i[$t]=t}else vs(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;We(t),i=!1}else St!==null&&(xo(St),St=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=s,t):(a=a!==null,a!==(e!==null&&e.memoizedState!==null)&&a&&(t.child.flags|=8192,t.mode&1&&(e===null||we.current&1?Ae===0&&(Ae=3):cl())),t.updateQueue!==null&&(t.flags|=4),We(t),null);case 4:return bs(),co(e,t),e===null&&la(t.stateNode.containerInfo),We(t),null;case 10:return Uo(t.type._context),We(t),null;case 17:return tt(t.type)&&ur(),We(t),null;case 19:if(ye(we),i=t.memoizedState,i===null)return We(t),null;if(a=(t.flags&128)!==0,o=i.rendering,o===null)if(a)Hs(i,!1);else{if(Ae!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=xr(e),o!==null){for(t.flags|=128,Hs(i,!1),a=o.updateQueue,a!==null&&(t.updateQueue=a,t.flags|=4),t.subtreeFlags=0,a=s,s=t.child;s!==null;)i=s,e=a,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,e=o.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),s=s.sibling;return he(we,we.current&1|2),t.child}e=e.sibling}i.tail!==null&&Se()>js&&(t.flags|=128,a=!0,Hs(i,!1),t.lanes=4194304)}else{if(!a)if(e=xr(o),e!==null){if(t.flags|=128,a=!0,s=e.updateQueue,s!==null&&(t.updateQueue=s,t.flags|=4),Hs(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!ve)return We(t),null}else 2*Se()-i.renderingStartTime>js&&s!==1073741824&&(t.flags|=128,a=!0,Hs(i,!1),t.lanes=4194304);i.isBackwards?(o.sibling=t.child,t.child=o):(s=i.last,s!==null?s.sibling=o:t.child=o,i.last=o)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Se(),t.sibling=null,s=we.current,he(we,a?s&1|2:s&1),t):(We(t),null);case 22:case 23:return ll(),a=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==a&&(t.flags|=8192),a&&t.mode&1?rt&1073741824&&(We(t),t.subtreeFlags&6&&(t.flags|=8192)):We(t),null;case 24:return null;case 25:return null}throw Error($(156,t.tag))}function df(e,t){switch(Fo(t),t.tag){case 1:return tt(t.type)&&ur(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return bs(),ye(et),ye(Ge),Zo(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Qo(t),null;case 13:if(ye(we),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error($(340));vs()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return ye(we),null;case 4:return bs(),null;case 10:return Uo(t.type._context),null;case 22:case 23:return ll(),null;case 24:return null;default:return null}}var Ra=!1,qe=!1,uf=typeof WeakSet=="function"?WeakSet:Set,R=null;function os(e,t){var s=e.ref;if(s!==null)if(typeof s=="function")try{s(null)}catch(a){Ne(e,t,a)}else s.current=null}function uo(e,t,s){try{s()}catch(a){Ne(e,t,a)}}var $c=!1;function hf(e,t){if(Vi=or,e=Xd(),Ro(e)){if("selectionStart"in e)var s={start:e.selectionStart,end:e.selectionEnd};else e:{s=(s=e.ownerDocument)&&s.defaultView||window;var a=s.getSelection&&s.getSelection();if(a&&a.rangeCount!==0){s=a.anchorNode;var r=a.anchorOffset,i=a.focusNode;a=a.focusOffset;try{s.nodeType,i.nodeType}catch{s=null;break e}var o=0,l=-1,c=-1,d=0,u=0,g=e,h=null;t:for(;;){for(var p;g!==s||r!==0&&g.nodeType!==3||(l=o+r),g!==i||a!==0&&g.nodeType!==3||(c=o+a),g.nodeType===3&&(o+=g.nodeValue.length),(p=g.firstChild)!==null;)h=g,g=p;for(;;){if(g===e)break t;if(h===s&&++d===r&&(l=o),h===i&&++u===a&&(c=o),(p=g.nextSibling)!==null)break;g=h,h=g.parentNode}g=p}s=l===-1||c===-1?null:{start:l,end:c}}else s=null}s=s||{start:0,end:0}}else s=null;for(Yi={focusedElem:e,selectionRange:s},or=!1,R=t;R!==null;)if(t=R,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,R=e;else for(;R!==null;){t=R;try{var f=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(f!==null){var y=f.memoizedProps,N=f.memoizedState,m=t.stateNode,v=m.getSnapshotBeforeUpdate(t.elementType===t.type?y:jt(t.type,y),N);m.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var w=t.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error($(163))}}catch(x){Ne(t,t.return,x)}if(e=t.sibling,e!==null){e.return=t.return,R=e;break}R=t.return}return f=$c,$c=!1,f}function Zs(e,t,s){var a=t.updateQueue;if(a=a!==null?a.lastEffect:null,a!==null){var r=a=a.next;do{if((r.tag&e)===e){var i=r.destroy;r.destroy=void 0,i!==void 0&&uo(t,s,i)}r=r.next}while(r!==a)}}function Hr(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var s=t=t.next;do{if((s.tag&e)===e){var a=s.create;s.destroy=a()}s=s.next}while(s!==t)}}function ho(e){var t=e.ref;if(t!==null){var s=e.stateNode;switch(e.tag){case 5:e=s;break;default:e=s}typeof t=="function"?t(e):t.current=e}}function Ku(e){var t=e.alternate;t!==null&&(e.alternate=null,Ku(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[$t],delete t[da],delete t[Zi],delete t[Vp],delete t[Yp])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Qu(e){return e.tag===5||e.tag===3||e.tag===4}function Dc(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Qu(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function mo(e,t,s){var a=e.tag;if(a===5||a===6)e=e.stateNode,t?s.nodeType===8?s.parentNode.insertBefore(e,t):s.insertBefore(e,t):(s.nodeType===8?(t=s.parentNode,t.insertBefore(e,s)):(t=s,t.appendChild(e)),s=s._reactRootContainer,s!=null||t.onclick!==null||(t.onclick=dr));else if(a!==4&&(e=e.child,e!==null))for(mo(e,t,s),e=e.sibling;e!==null;)mo(e,t,s),e=e.sibling}function po(e,t,s){var a=e.tag;if(a===5||a===6)e=e.stateNode,t?s.insertBefore(e,t):s.appendChild(e);else if(a!==4&&(e=e.child,e!==null))for(po(e,t,s),e=e.sibling;e!==null;)po(e,t,s),e=e.sibling}var Be=null,Nt=!1;function ln(e,t,s){for(s=s.child;s!==null;)Zu(e,t,s),s=s.sibling}function Zu(e,t,s){if(Dt&&typeof Dt.onCommitFiberUnmount=="function")try{Dt.onCommitFiberUnmount(Ir,s)}catch{}switch(s.tag){case 5:qe||os(s,t);case 6:var a=Be,r=Nt;Be=null,ln(e,t,s),Be=a,Nt=r,Be!==null&&(Nt?(e=Be,s=s.stateNode,e.nodeType===8?e.parentNode.removeChild(s):e.removeChild(s)):Be.removeChild(s.stateNode));break;case 18:Be!==null&&(Nt?(e=Be,s=s.stateNode,e.nodeType===8?mi(e.parentNode,s):e.nodeType===1&&mi(e,s),ra(e)):mi(Be,s.stateNode));break;case 4:a=Be,r=Nt,Be=s.stateNode.containerInfo,Nt=!0,ln(e,t,s),Be=a,Nt=r;break;case 0:case 11:case 14:case 15:if(!qe&&(a=s.updateQueue,a!==null&&(a=a.lastEffect,a!==null))){r=a=a.next;do{var i=r,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&uo(s,t,o),r=r.next}while(r!==a)}ln(e,t,s);break;case 1:if(!qe&&(os(s,t),a=s.stateNode,typeof a.componentWillUnmount=="function"))try{a.props=s.memoizedProps,a.state=s.memoizedState,a.componentWillUnmount()}catch(l){Ne(s,t,l)}ln(e,t,s);break;case 21:ln(e,t,s);break;case 22:s.mode&1?(qe=(a=qe)||s.memoizedState!==null,ln(e,t,s),qe=a):ln(e,t,s);break;default:ln(e,t,s)}}function Pc(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var s=e.stateNode;s===null&&(s=e.stateNode=new uf),t.forEach(function(a){var r=bf.bind(null,e,a);s.has(a)||(s.add(a),a.then(r,r))})}}function kt(e,t){var s=t.deletions;if(s!==null)for(var a=0;a<s.length;a++){var r=s[a];try{var i=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:Be=l.stateNode,Nt=!1;break e;case 3:Be=l.stateNode.containerInfo,Nt=!0;break e;case 4:Be=l.stateNode.containerInfo,Nt=!0;break e}l=l.return}if(Be===null)throw Error($(160));Zu(i,o,r),Be=null,Nt=!1;var c=r.alternate;c!==null&&(c.return=null),r.return=null}catch(d){Ne(r,t,d)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Ju(t,e),t=t.sibling}function Ju(e,t){var s=e.alternate,a=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(kt(t,e),Et(e),a&4){try{Zs(3,e,e.return),Hr(3,e)}catch(y){Ne(e,e.return,y)}try{Zs(5,e,e.return)}catch(y){Ne(e,e.return,y)}}break;case 1:kt(t,e),Et(e),a&512&&s!==null&&os(s,s.return);break;case 5:if(kt(t,e),Et(e),a&512&&s!==null&&os(s,s.return),e.flags&32){var r=e.stateNode;try{ta(r,"")}catch(y){Ne(e,e.return,y)}}if(a&4&&(r=e.stateNode,r!=null)){var i=e.memoizedProps,o=s!==null?s.memoizedProps:i,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&wd(r,i),Hi(l,o);var d=Hi(l,i);for(o=0;o<c.length;o+=2){var u=c[o],g=c[o+1];u==="style"?Sd(r,g):u==="dangerouslySetInnerHTML"?jd(r,g):u==="children"?ta(r,g):To(r,u,g,d)}switch(l){case"input":Li(r,i);break;case"textarea":bd(r,i);break;case"select":var h=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!i.multiple;var p=i.value;p!=null?ds(r,!!i.multiple,p,!1):h!==!!i.multiple&&(i.defaultValue!=null?ds(r,!!i.multiple,i.defaultValue,!0):ds(r,!!i.multiple,i.multiple?[]:"",!1))}r[da]=i}catch(y){Ne(e,e.return,y)}}break;case 6:if(kt(t,e),Et(e),a&4){if(e.stateNode===null)throw Error($(162));r=e.stateNode,i=e.memoizedProps;try{r.nodeValue=i}catch(y){Ne(e,e.return,y)}}break;case 3:if(kt(t,e),Et(e),a&4&&s!==null&&s.memoizedState.isDehydrated)try{ra(t.containerInfo)}catch(y){Ne(e,e.return,y)}break;case 4:kt(t,e),Et(e);break;case 13:kt(t,e),Et(e),r=e.child,r.flags&8192&&(i=r.memoizedState!==null,r.stateNode.isHidden=i,!i||r.alternate!==null&&r.alternate.memoizedState!==null||(il=Se())),a&4&&Pc(e);break;case 22:if(u=s!==null&&s.memoizedState!==null,e.mode&1?(qe=(d=qe)||u,kt(t,e),qe=d):kt(t,e),Et(e),a&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!u&&e.mode&1)for(R=e,u=e.child;u!==null;){for(g=R=u;R!==null;){switch(h=R,p=h.child,h.tag){case 0:case 11:case 14:case 15:Zs(4,h,h.return);break;case 1:os(h,h.return);var f=h.stateNode;if(typeof f.componentWillUnmount=="function"){a=h,s=h.return;try{t=a,f.props=t.memoizedProps,f.state=t.memoizedState,f.componentWillUnmount()}catch(y){Ne(a,s,y)}}break;case 5:os(h,h.return);break;case 22:if(h.memoizedState!==null){Hc(g);continue}}p!==null?(p.return=h,R=p):Hc(g)}u=u.sibling}e:for(u=null,g=e;;){if(g.tag===5){if(u===null){u=g;try{r=g.stateNode,d?(i=r.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=g.stateNode,c=g.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=Nd("display",o))}catch(y){Ne(e,e.return,y)}}}else if(g.tag===6){if(u===null)try{g.stateNode.nodeValue=d?"":g.memoizedProps}catch(y){Ne(e,e.return,y)}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===e)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===e)break e;for(;g.sibling===null;){if(g.return===null||g.return===e)break e;u===g&&(u=null),g=g.return}u===g&&(u=null),g.sibling.return=g.return,g=g.sibling}}break;case 19:kt(t,e),Et(e),a&4&&Pc(e);break;case 21:break;default:kt(t,e),Et(e)}}function Et(e){var t=e.flags;if(t&2){try{e:{for(var s=e.return;s!==null;){if(Qu(s)){var a=s;break e}s=s.return}throw Error($(160))}switch(a.tag){case 5:var r=a.stateNode;a.flags&32&&(ta(r,""),a.flags&=-33);var i=Dc(e);po(e,i,r);break;case 3:case 4:var o=a.stateNode.containerInfo,l=Dc(e);mo(e,l,o);break;default:throw Error($(161))}}catch(c){Ne(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function mf(e,t,s){R=e,Xu(e)}function Xu(e,t,s){for(var a=(e.mode&1)!==0;R!==null;){var r=R,i=r.child;if(r.tag===22&&a){var o=r.memoizedState!==null||Ra;if(!o){var l=r.alternate,c=l!==null&&l.memoizedState!==null||qe;l=Ra;var d=qe;if(Ra=o,(qe=c)&&!d)for(R=r;R!==null;)o=R,c=o.child,o.tag===22&&o.memoizedState!==null?Bc(r):c!==null?(c.return=o,R=c):Bc(r);for(;i!==null;)R=i,Xu(i),i=i.sibling;R=r,Ra=l,qe=d}zc(e)}else r.subtreeFlags&8772&&i!==null?(i.return=r,R=i):zc(e)}}function zc(e){for(;R!==null;){var t=R;if(t.flags&8772){var s=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:qe||Hr(5,t);break;case 1:var a=t.stateNode;if(t.flags&4&&!qe)if(s===null)a.componentDidMount();else{var r=t.elementType===t.type?s.memoizedProps:jt(t.type,s.memoizedProps);a.componentDidUpdate(r,s.memoizedState,a.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&wc(t,i,a);break;case 3:var o=t.updateQueue;if(o!==null){if(s=null,t.child!==null)switch(t.child.tag){case 5:s=t.child.stateNode;break;case 1:s=t.child.stateNode}wc(t,o,s)}break;case 5:var l=t.stateNode;if(s===null&&t.flags&4){s=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&s.focus();break;case"img":c.src&&(s.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var d=t.alternate;if(d!==null){var u=d.memoizedState;if(u!==null){var g=u.dehydrated;g!==null&&ra(g)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error($(163))}qe||t.flags&512&&ho(t)}catch(h){Ne(t,t.return,h)}}if(t===e){R=null;break}if(s=t.sibling,s!==null){s.return=t.return,R=s;break}R=t.return}}function Hc(e){for(;R!==null;){var t=R;if(t===e){R=null;break}var s=t.sibling;if(s!==null){s.return=t.return,R=s;break}R=t.return}}function Bc(e){for(;R!==null;){var t=R;try{switch(t.tag){case 0:case 11:case 15:var s=t.return;try{Hr(4,t)}catch(c){Ne(t,s,c)}break;case 1:var a=t.stateNode;if(typeof a.componentDidMount=="function"){var r=t.return;try{a.componentDidMount()}catch(c){Ne(t,r,c)}}var i=t.return;try{ho(t)}catch(c){Ne(t,i,c)}break;case 5:var o=t.return;try{ho(t)}catch(c){Ne(t,o,c)}}}catch(c){Ne(t,t.return,c)}if(t===e){R=null;break}var l=t.sibling;if(l!==null){l.return=t.return,R=l;break}R=t.return}}var pf=Math.ceil,br=en.ReactCurrentDispatcher,al=en.ReactCurrentOwner,xt=en.ReactCurrentBatchConfig,re=0,Pe=null,Me=null,Re=0,rt=0,ls=An(0),Ae=0,ga=null,Wn=0,Br=0,rl=0,Js=null,Je=null,il=0,js=1/0,Ot=null,kr=!1,fo=null,jn=null,Oa=!1,fn=null,jr=0,Xs=0,go=null,Ja=-1,Xa=0;function Ye(){return re&6?Se():Ja!==-1?Ja:Ja=Se()}function Nn(e){return e.mode&1?re&2&&Re!==0?Re&-Re:Qp.transition!==null?(Xa===0&&(Xa=Hd()),Xa):(e=le,e!==0||(e=window.event,e=e===void 0?16:qd(e.type)),e):1}function Ct(e,t,s,a){if(50<Xs)throw Xs=0,go=null,Error($(185));xa(e,s,a),(!(re&2)||e!==Pe)&&(e===Pe&&(!(re&2)&&(Br|=s),Ae===4&&mn(e,Re)),nt(e,a),s===1&&re===0&&!(t.mode&1)&&(js=Se()+500,Dr&&En()))}function nt(e,t){var s=e.callbackNode;Qm(e,t);var a=ir(e,e===Pe?Re:0);if(a===0)s!==null&&Vl(s),e.callbackNode=null,e.callbackPriority=0;else if(t=a&-a,e.callbackPriority!==t){if(s!=null&&Vl(s),t===1)e.tag===0?Kp(_c.bind(null,e)):cu(_c.bind(null,e)),Gp(function(){!(re&6)&&En()}),s=null;else{switch(Bd(a)){case 1:s=Lo;break;case 4:s=Pd;break;case 16:s=rr;break;case 536870912:s=zd;break;default:s=rr}s=oh(s,eh.bind(null,e))}e.callbackPriority=t,e.callbackNode=s}}function eh(e,t){if(Ja=-1,Xa=0,re&6)throw Error($(327));var s=e.callbackNode;if(fs()&&e.callbackNode!==s)return null;var a=ir(e,e===Pe?Re:0);if(a===0)return null;if(a&30||a&e.expiredLanes||t)t=Nr(e,a);else{t=a;var r=re;re|=2;var i=nh();(Pe!==e||Re!==t)&&(Ot=null,js=Se()+500,Bn(e,t));do try{yf();break}catch(l){th(e,l)}while(!0);Go(),br.current=i,re=r,Me!==null?t=0:(Pe=null,Re=0,t=Ae)}if(t!==0){if(t===2&&(r=Fi(e),r!==0&&(a=r,t=yo(e,r))),t===1)throw s=ga,Bn(e,0),mn(e,a),nt(e,Se()),s;if(t===6)mn(e,a);else{if(r=e.current.alternate,!(a&30)&&!ff(r)&&(t=Nr(e,a),t===2&&(i=Fi(e),i!==0&&(a=i,t=yo(e,i))),t===1))throw s=ga,Bn(e,0),mn(e,a),nt(e,Se()),s;switch(e.finishedWork=r,e.finishedLanes=a,t){case 0:case 1:throw Error($(345));case 2:Dn(e,Je,Ot);break;case 3:if(mn(e,a),(a&130023424)===a&&(t=il+500-Se(),10<t)){if(ir(e,0)!==0)break;if(r=e.suspendedLanes,(r&a)!==a){Ye(),e.pingedLanes|=e.suspendedLanes&r;break}e.timeoutHandle=Qi(Dn.bind(null,e,Je,Ot),t);break}Dn(e,Je,Ot);break;case 4:if(mn(e,a),(a&4194240)===a)break;for(t=e.eventTimes,r=-1;0<a;){var o=31-Tt(a);i=1<<o,o=t[o],o>r&&(r=o),a&=~i}if(a=r,a=Se()-a,a=(120>a?120:480>a?480:1080>a?1080:1920>a?1920:3e3>a?3e3:4320>a?4320:1960*pf(a/1960))-a,10<a){e.timeoutHandle=Qi(Dn.bind(null,e,Je,Ot),a);break}Dn(e,Je,Ot);break;case 5:Dn(e,Je,Ot);break;default:throw Error($(329))}}}return nt(e,Se()),e.callbackNode===s?eh.bind(null,e):null}function yo(e,t){var s=Js;return e.current.memoizedState.isDehydrated&&(Bn(e,t).flags|=256),e=Nr(e,t),e!==2&&(t=Je,Je=s,t!==null&&xo(t)),e}function xo(e){Je===null?Je=e:Je.push.apply(Je,e)}function ff(e){for(var t=e;;){if(t.flags&16384){var s=t.updateQueue;if(s!==null&&(s=s.stores,s!==null))for(var a=0;a<s.length;a++){var r=s[a],i=r.getSnapshot;r=r.value;try{if(!It(i(),r))return!1}catch{return!1}}}if(s=t.child,t.subtreeFlags&16384&&s!==null)s.return=t,t=s;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function mn(e,t){for(t&=~rl,t&=~Br,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var s=31-Tt(t),a=1<<s;e[s]=-1,t&=~a}}function _c(e){if(re&6)throw Error($(327));fs();var t=ir(e,0);if(!(t&1))return nt(e,Se()),null;var s=Nr(e,t);if(e.tag!==0&&s===2){var a=Fi(e);a!==0&&(t=a,s=yo(e,a))}if(s===1)throw s=ga,Bn(e,0),mn(e,t),nt(e,Se()),s;if(s===6)throw Error($(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Dn(e,Je,Ot),nt(e,Se()),null}function ol(e,t){var s=re;re|=1;try{return e(t)}finally{re=s,re===0&&(js=Se()+500,Dr&&En())}}function qn(e){fn!==null&&fn.tag===0&&!(re&6)&&fs();var t=re;re|=1;var s=xt.transition,a=le;try{if(xt.transition=null,le=1,e)return e()}finally{le=a,xt.transition=s,re=t,!(re&6)&&En()}}function ll(){rt=ls.current,ye(ls)}function Bn(e,t){e.finishedWork=null,e.finishedLanes=0;var s=e.timeoutHandle;if(s!==-1&&(e.timeoutHandle=-1,qp(s)),Me!==null)for(s=Me.return;s!==null;){var a=s;switch(Fo(a),a.tag){case 1:a=a.type.childContextTypes,a!=null&&ur();break;case 3:bs(),ye(et),ye(Ge),Zo();break;case 5:Qo(a);break;case 4:bs();break;case 13:ye(we);break;case 19:ye(we);break;case 10:Uo(a.type._context);break;case 22:case 23:ll()}s=s.return}if(Pe=e,Me=e=Sn(e.current,null),Re=rt=t,Ae=0,ga=null,rl=Br=Wn=0,Je=Js=null,zn!==null){for(t=0;t<zn.length;t++)if(s=zn[t],a=s.interleaved,a!==null){s.interleaved=null;var r=a.next,i=s.pending;if(i!==null){var o=i.next;i.next=r,a.next=o}s.pending=a}zn=null}return e}function th(e,t){do{var s=Me;try{if(Go(),Ka.current=wr,vr){for(var a=be.memoizedState;a!==null;){var r=a.queue;r!==null&&(r.pending=null),a=a.next}vr=!1}if(Fn=0,De=Ie=be=null,Qs=!1,ma=0,al.current=null,s===null||s.return===null){Ae=1,ga=t,Me=null;break}e:{var i=e,o=s.return,l=s,c=t;if(t=Re,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,u=l,g=u.tag;if(!(u.mode&1)&&(g===0||g===11||g===15)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var p=Mc(o);if(p!==null){p.flags&=-257,Tc(p,o,l,i,t),p.mode&1&&Sc(i,d,t),t=p,c=d;var f=t.updateQueue;if(f===null){var y=new Set;y.add(c),t.updateQueue=y}else f.add(c);break e}else{if(!(t&1)){Sc(i,d,t),cl();break e}c=Error($(426))}}else if(ve&&l.mode&1){var N=Mc(o);if(N!==null){!(N.flags&65536)&&(N.flags|=256),Tc(N,o,l,i,t),Wo(ks(c,l));break e}}i=c=ks(c,l),Ae!==4&&(Ae=2),Js===null?Js=[i]:Js.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var m=Bu(i,c,t);vc(i,m);break e;case 1:l=c;var v=i.type,w=i.stateNode;if(!(i.flags&128)&&(typeof v.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(jn===null||!jn.has(w)))){i.flags|=65536,t&=-t,i.lanes|=t;var x=_u(i,l,t);vc(i,x);break e}}i=i.return}while(i!==null)}ah(s)}catch(k){t=k,Me===s&&s!==null&&(Me=s=s.return);continue}break}while(!0)}function nh(){var e=br.current;return br.current=wr,e===null?wr:e}function cl(){(Ae===0||Ae===3||Ae===2)&&(Ae=4),Pe===null||!(Wn&268435455)&&!(Br&268435455)||mn(Pe,Re)}function Nr(e,t){var s=re;re|=2;var a=nh();(Pe!==e||Re!==t)&&(Ot=null,Bn(e,t));do try{gf();break}catch(r){th(e,r)}while(!0);if(Go(),re=s,br.current=a,Me!==null)throw Error($(261));return Pe=null,Re=0,Ae}function gf(){for(;Me!==null;)sh(Me)}function yf(){for(;Me!==null&&!Om();)sh(Me)}function sh(e){var t=ih(e.alternate,e,rt);e.memoizedProps=e.pendingProps,t===null?ah(e):Me=t,al.current=null}function ah(e){var t=e;do{var s=t.alternate;if(e=t.return,t.flags&32768){if(s=df(s,t),s!==null){s.flags&=32767,Me=s;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Ae=6,Me=null;return}}else if(s=cf(s,t,rt),s!==null){Me=s;return}if(t=t.sibling,t!==null){Me=t;return}Me=t=e}while(t!==null);Ae===0&&(Ae=5)}function Dn(e,t,s){var a=le,r=xt.transition;try{xt.transition=null,le=1,xf(e,t,s,a)}finally{xt.transition=r,le=a}return null}function xf(e,t,s,a){do fs();while(fn!==null);if(re&6)throw Error($(327));s=e.finishedWork;var r=e.finishedLanes;if(s===null)return null;if(e.finishedWork=null,e.finishedLanes=0,s===e.current)throw Error($(177));e.callbackNode=null,e.callbackPriority=0;var i=s.lanes|s.childLanes;if(Zm(e,i),e===Pe&&(Me=Pe=null,Re=0),!(s.subtreeFlags&2064)&&!(s.flags&2064)||Oa||(Oa=!0,oh(rr,function(){return fs(),null})),i=(s.flags&15990)!==0,s.subtreeFlags&15990||i){i=xt.transition,xt.transition=null;var o=le;le=1;var l=re;re|=4,al.current=null,hf(e,s),Ju(s,e),Hp(Yi),or=!!Vi,Yi=Vi=null,e.current=s,mf(s),Fm(),re=l,le=o,xt.transition=i}else e.current=s;if(Oa&&(Oa=!1,fn=e,jr=r),i=e.pendingLanes,i===0&&(jn=null),Gm(s.stateNode),nt(e,Se()),t!==null)for(a=e.onRecoverableError,s=0;s<t.length;s++)r=t[s],a(r.value,{componentStack:r.stack,digest:r.digest});if(kr)throw kr=!1,e=fo,fo=null,e;return jr&1&&e.tag!==0&&fs(),i=e.pendingLanes,i&1?e===go?Xs++:(Xs=0,go=e):Xs=0,En(),null}function fs(){if(fn!==null){var e=Bd(jr),t=xt.transition,s=le;try{if(xt.transition=null,le=16>e?16:e,fn===null)var a=!1;else{if(e=fn,fn=null,jr=0,re&6)throw Error($(331));var r=re;for(re|=4,R=e.current;R!==null;){var i=R,o=i.child;if(R.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var d=l[c];for(R=d;R!==null;){var u=R;switch(u.tag){case 0:case 11:case 15:Zs(8,u,i)}var g=u.child;if(g!==null)g.return=u,R=g;else for(;R!==null;){u=R;var h=u.sibling,p=u.return;if(Ku(u),u===d){R=null;break}if(h!==null){h.return=p,R=h;break}R=p}}}var f=i.alternate;if(f!==null){var y=f.child;if(y!==null){f.child=null;do{var N=y.sibling;y.sibling=null,y=N}while(y!==null)}}R=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,R=o;else e:for(;R!==null;){if(i=R,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Zs(9,i,i.return)}var m=i.sibling;if(m!==null){m.return=i.return,R=m;break e}R=i.return}}var v=e.current;for(R=v;R!==null;){o=R;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,R=w;else e:for(o=v;R!==null;){if(l=R,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Hr(9,l)}}catch(k){Ne(l,l.return,k)}if(l===o){R=null;break e}var x=l.sibling;if(x!==null){x.return=l.return,R=x;break e}R=l.return}}if(re=r,En(),Dt&&typeof Dt.onPostCommitFiberRoot=="function")try{Dt.onPostCommitFiberRoot(Ir,e)}catch{}a=!0}return a}finally{le=s,xt.transition=t}}return!1}function Rc(e,t,s){t=ks(s,t),t=Bu(e,t,1),e=kn(e,t,1),t=Ye(),e!==null&&(xa(e,1,t),nt(e,t))}function Ne(e,t,s){if(e.tag===3)Rc(e,e,s);else for(;t!==null;){if(t.tag===3){Rc(t,e,s);break}else if(t.tag===1){var a=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof a.componentDidCatch=="function"&&(jn===null||!jn.has(a))){e=ks(s,e),e=_u(t,e,1),t=kn(t,e,1),e=Ye(),t!==null&&(xa(t,1,e),nt(t,e));break}}t=t.return}}function vf(e,t,s){var a=e.pingCache;a!==null&&a.delete(t),t=Ye(),e.pingedLanes|=e.suspendedLanes&s,Pe===e&&(Re&s)===s&&(Ae===4||Ae===3&&(Re&130023424)===Re&&500>Se()-il?Bn(e,0):rl|=s),nt(e,t)}function rh(e,t){t===0&&(e.mode&1?(t=Ea,Ea<<=1,!(Ea&130023424)&&(Ea=4194304)):t=1);var s=Ye();e=Qt(e,t),e!==null&&(xa(e,t,s),nt(e,s))}function wf(e){var t=e.memoizedState,s=0;t!==null&&(s=t.retryLane),rh(e,s)}function bf(e,t){var s=0;switch(e.tag){case 13:var a=e.stateNode,r=e.memoizedState;r!==null&&(s=r.retryLane);break;case 19:a=e.stateNode;break;default:throw Error($(314))}a!==null&&a.delete(t),rh(e,s)}var ih;ih=function(e,t,s){if(e!==null)if(e.memoizedProps!==t.pendingProps||et.current)Xe=!0;else{if(!(e.lanes&s)&&!(t.flags&128))return Xe=!1,lf(e,t,s);Xe=!!(e.flags&131072)}else Xe=!1,ve&&t.flags&1048576&&du(t,pr,t.index);switch(t.lanes=0,t.tag){case 2:var a=t.type;Za(e,t),e=t.pendingProps;var r=xs(t,Ge.current);ps(t,s),r=Xo(null,t,a,e,r,s);var i=el();return t.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,tt(a)?(i=!0,hr(t)):i=!1,t.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,Yo(t),r.updater=zr,t.stateNode=r,r._reactInternals=t,so(t,a,e,s),t=io(null,t,a,!0,i,s)):(t.tag=0,ve&&i&&Oo(t),Ve(null,t,r,s),t=t.child),t;case 16:a=t.elementType;e:{switch(Za(e,t),e=t.pendingProps,r=a._init,a=r(a._payload),t.type=a,r=t.tag=jf(a),e=jt(a,e),r){case 0:t=ro(null,t,a,e,s);break e;case 1:t=Ac(null,t,a,e,s);break e;case 11:t=Cc(null,t,a,e,s);break e;case 14:t=Ic(null,t,a,jt(a.type,e),s);break e}throw Error($(306,a,""))}return t;case 0:return a=t.type,r=t.pendingProps,r=t.elementType===a?r:jt(a,r),ro(e,t,a,r,s);case 1:return a=t.type,r=t.pendingProps,r=t.elementType===a?r:jt(a,r),Ac(e,t,a,r,s);case 3:e:{if(Wu(t),e===null)throw Error($(387));a=t.pendingProps,i=t.memoizedState,r=i.element,gu(e,t),yr(t,a,null,s);var o=t.memoizedState;if(a=o.element,i.isDehydrated)if(i={element:a,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){r=ks(Error($(423)),t),t=Ec(e,t,a,s,r);break e}else if(a!==r){r=ks(Error($(424)),t),t=Ec(e,t,a,s,r);break e}else for(it=bn(t.stateNode.containerInfo.firstChild),ot=t,ve=!0,St=null,s=pu(t,null,a,s),t.child=s;s;)s.flags=s.flags&-3|4096,s=s.sibling;else{if(vs(),a===r){t=Zt(e,t,s);break e}Ve(e,t,a,s)}t=t.child}return t;case 5:return yu(t),e===null&&eo(t),a=t.type,r=t.pendingProps,i=e!==null?e.memoizedProps:null,o=r.children,Ki(a,r)?o=null:i!==null&&Ki(a,i)&&(t.flags|=32),Fu(e,t),Ve(e,t,o,s),t.child;case 6:return e===null&&eo(t),null;case 13:return qu(e,t,s);case 4:return Ko(t,t.stateNode.containerInfo),a=t.pendingProps,e===null?t.child=ws(t,null,a,s):Ve(e,t,a,s),t.child;case 11:return a=t.type,r=t.pendingProps,r=t.elementType===a?r:jt(a,r),Cc(e,t,a,r,s);case 7:return Ve(e,t,t.pendingProps,s),t.child;case 8:return Ve(e,t,t.pendingProps.children,s),t.child;case 12:return Ve(e,t,t.pendingProps.children,s),t.child;case 10:e:{if(a=t.type._context,r=t.pendingProps,i=t.memoizedProps,o=r.value,he(fr,a._currentValue),a._currentValue=o,i!==null)if(It(i.value,o)){if(i.children===r.children&&!et.current){t=Zt(e,t,s);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var c=l.firstContext;c!==null;){if(c.context===a){if(i.tag===1){c=Vt(-1,s&-s),c.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var u=d.pending;u===null?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}i.lanes|=s,c=i.alternate,c!==null&&(c.lanes|=s),to(i.return,s,t),l.lanes|=s;break}c=c.next}}else if(i.tag===10)o=i.type===t.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error($(341));o.lanes|=s,l=o.alternate,l!==null&&(l.lanes|=s),to(o,s,t),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===t){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Ve(e,t,r.children,s),t=t.child}return t;case 9:return r=t.type,a=t.pendingProps.children,ps(t,s),r=vt(r),a=a(r),t.flags|=1,Ve(e,t,a,s),t.child;case 14:return a=t.type,r=jt(a,t.pendingProps),r=jt(a.type,r),Ic(e,t,a,r,s);case 15:return Ru(e,t,t.type,t.pendingProps,s);case 17:return a=t.type,r=t.pendingProps,r=t.elementType===a?r:jt(a,r),Za(e,t),t.tag=1,tt(a)?(e=!0,hr(t)):e=!1,ps(t,s),Hu(t,a,r),so(t,a,r,s),io(null,t,a,!0,e,s);case 19:return Gu(e,t,s);case 22:return Ou(e,t,s)}throw Error($(156,t.tag))};function oh(e,t){return Dd(e,t)}function kf(e,t,s,a){this.tag=e,this.key=s,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=a,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function yt(e,t,s,a){return new kf(e,t,s,a)}function dl(e){return e=e.prototype,!(!e||!e.isReactComponent)}function jf(e){if(typeof e=="function")return dl(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Io)return 11;if(e===Ao)return 14}return 2}function Sn(e,t){var s=e.alternate;return s===null?(s=yt(e.tag,t,e.key,e.mode),s.elementType=e.elementType,s.type=e.type,s.stateNode=e.stateNode,s.alternate=e,e.alternate=s):(s.pendingProps=t,s.type=e.type,s.flags=0,s.subtreeFlags=0,s.deletions=null),s.flags=e.flags&14680064,s.childLanes=e.childLanes,s.lanes=e.lanes,s.child=e.child,s.memoizedProps=e.memoizedProps,s.memoizedState=e.memoizedState,s.updateQueue=e.updateQueue,t=e.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},s.sibling=e.sibling,s.index=e.index,s.ref=e.ref,s}function er(e,t,s,a,r,i){var o=2;if(a=e,typeof e=="function")dl(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case Jn:return _n(s.children,r,i,t);case Co:o=8,r|=8;break;case Ti:return e=yt(12,s,t,r|2),e.elementType=Ti,e.lanes=i,e;case Ci:return e=yt(13,s,t,r),e.elementType=Ci,e.lanes=i,e;case Ii:return e=yt(19,s,t,r),e.elementType=Ii,e.lanes=i,e;case yd:return _r(s,r,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case fd:o=10;break e;case gd:o=9;break e;case Io:o=11;break e;case Ao:o=14;break e;case cn:o=16,a=null;break e}throw Error($(130,e==null?e:typeof e,""))}return t=yt(o,s,t,r),t.elementType=e,t.type=a,t.lanes=i,t}function _n(e,t,s,a){return e=yt(7,e,a,t),e.lanes=s,e}function _r(e,t,s,a){return e=yt(22,e,a,t),e.elementType=yd,e.lanes=s,e.stateNode={isHidden:!1},e}function bi(e,t,s){return e=yt(6,e,null,t),e.lanes=s,e}function ki(e,t,s){return t=yt(4,e.children!==null?e.children:[],e.key,t),t.lanes=s,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Nf(e,t,s,a,r){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ni(0),this.expirationTimes=ni(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ni(0),this.identifierPrefix=a,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function ul(e,t,s,a,r,i,o,l,c){return e=new Nf(e,t,s,l,c),t===1?(t=1,i===!0&&(t|=8)):t=0,i=yt(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:a,isDehydrated:s,cache:null,transitions:null,pendingSuspenseBoundaries:null},Yo(i),e}function Sf(e,t,s){var a=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Zn,key:a==null?null:""+a,children:e,containerInfo:t,implementation:s}}function lh(e){if(!e)return Cn;e=e._reactInternals;e:{if(Un(e)!==e||e.tag!==1)throw Error($(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(tt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error($(171))}if(e.tag===1){var s=e.type;if(tt(s))return lu(e,s,t)}return t}function ch(e,t,s,a,r,i,o,l,c){return e=ul(s,a,!0,e,r,i,o,l,c),e.context=lh(null),s=e.current,a=Ye(),r=Nn(s),i=Vt(a,r),i.callback=t??null,kn(s,i,r),e.current.lanes=r,xa(e,r,a),nt(e,a),e}function Rr(e,t,s,a){var r=t.current,i=Ye(),o=Nn(r);return s=lh(s),t.context===null?t.context=s:t.pendingContext=s,t=Vt(i,o),t.payload={element:e},a=a===void 0?null:a,a!==null&&(t.callback=a),e=kn(r,t,o),e!==null&&(Ct(e,r,o,i),Ya(e,r,o)),o}function Sr(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Oc(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var s=e.retryLane;e.retryLane=s!==0&&s<t?s:t}}function hl(e,t){Oc(e,t),(e=e.alternate)&&Oc(e,t)}function Mf(){return null}var dh=typeof reportError=="function"?reportError:function(e){console.error(e)};function ml(e){this._internalRoot=e}Or.prototype.render=ml.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error($(409));Rr(e,t,null,null)};Or.prototype.unmount=ml.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;qn(function(){Rr(null,e,null,null)}),t[Kt]=null}};function Or(e){this._internalRoot=e}Or.prototype.unstable_scheduleHydration=function(e){if(e){var t=Od();e={blockedOn:null,target:e,priority:t};for(var s=0;s<hn.length&&t!==0&&t<hn[s].priority;s++);hn.splice(s,0,e),s===0&&Wd(e)}};function pl(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Fr(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Fc(){}function Tf(e,t,s,a,r){if(r){if(typeof a=="function"){var i=a;a=function(){var d=Sr(o);i.call(d)}}var o=ch(t,a,e,0,null,!1,!1,"",Fc);return e._reactRootContainer=o,e[Kt]=o.current,la(e.nodeType===8?e.parentNode:e),qn(),o}for(;r=e.lastChild;)e.removeChild(r);if(typeof a=="function"){var l=a;a=function(){var d=Sr(c);l.call(d)}}var c=ul(e,0,!1,null,null,!1,!1,"",Fc);return e._reactRootContainer=c,e[Kt]=c.current,la(e.nodeType===8?e.parentNode:e),qn(function(){Rr(t,c,s,a)}),c}function Wr(e,t,s,a,r){var i=s._reactRootContainer;if(i){var o=i;if(typeof r=="function"){var l=r;r=function(){var c=Sr(o);l.call(c)}}Rr(t,o,e,r)}else o=Tf(s,t,e,r,a);return Sr(o)}_d=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var s=Os(t.pendingLanes);s!==0&&($o(t,s|1),nt(t,Se()),!(re&6)&&(js=Se()+500,En()))}break;case 13:qn(function(){var a=Qt(e,1);if(a!==null){var r=Ye();Ct(a,e,1,r)}}),hl(e,1)}};Do=function(e){if(e.tag===13){var t=Qt(e,134217728);if(t!==null){var s=Ye();Ct(t,e,134217728,s)}hl(e,134217728)}};Rd=function(e){if(e.tag===13){var t=Nn(e),s=Qt(e,t);if(s!==null){var a=Ye();Ct(s,e,t,a)}hl(e,t)}};Od=function(){return le};Fd=function(e,t){var s=le;try{return le=e,t()}finally{le=s}};_i=function(e,t,s){switch(t){case"input":if(Li(e,s),t=s.name,s.type==="radio"&&t!=null){for(s=e;s.parentNode;)s=s.parentNode;for(s=s.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<s.length;t++){var a=s[t];if(a!==e&&a.form===e.form){var r=$r(a);if(!r)throw Error($(90));vd(a),Li(a,r)}}}break;case"textarea":bd(e,s);break;case"select":t=s.value,t!=null&&ds(e,!!s.multiple,t,!1)}};Cd=ol;Id=qn;var Cf={usingClientEntryPoint:!1,Events:[wa,ns,$r,Md,Td,ol]},Bs={findFiberByHostInstance:Pn,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},If={bundleType:Bs.bundleType,version:Bs.version,rendererPackageName:Bs.rendererPackageName,rendererConfig:Bs.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:en.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Ld(e),e===null?null:e.stateNode},findFiberByHostInstance:Bs.findFiberByHostInstance||Mf,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Fa=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Fa.isDisabled&&Fa.supportsFiber)try{Ir=Fa.inject(If),Dt=Fa}catch{}}dt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Cf;dt.createPortal=function(e,t){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!pl(t))throw Error($(200));return Sf(e,t,null,s)};dt.createRoot=function(e,t){if(!pl(e))throw Error($(299));var s=!1,a="",r=dh;return t!=null&&(t.unstable_strictMode===!0&&(s=!0),t.identifierPrefix!==void 0&&(a=t.identifierPrefix),t.onRecoverableError!==void 0&&(r=t.onRecoverableError)),t=ul(e,1,!1,null,null,s,!1,a,r),e[Kt]=t.current,la(e.nodeType===8?e.parentNode:e),new ml(t)};dt.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error($(188)):(e=Object.keys(e).join(","),Error($(268,e)));return e=Ld(t),e=e===null?null:e.stateNode,e};dt.flushSync=function(e){return qn(e)};dt.hydrate=function(e,t,s){if(!Fr(t))throw Error($(200));return Wr(null,e,t,!0,s)};dt.hydrateRoot=function(e,t,s){if(!pl(e))throw Error($(405));var a=s!=null&&s.hydratedSources||null,r=!1,i="",o=dh;if(s!=null&&(s.unstable_strictMode===!0&&(r=!0),s.identifierPrefix!==void 0&&(i=s.identifierPrefix),s.onRecoverableError!==void 0&&(o=s.onRecoverableError)),t=ch(t,null,e,1,s??null,r,!1,i,o),e[Kt]=t.current,la(e),a)for(e=0;e<a.length;e++)s=a[e],r=s._getVersion,r=r(s._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[s,r]:t.mutableSourceEagerHydrationData.push(s,r);return new Or(t)};dt.render=function(e,t,s){if(!Fr(t))throw Error($(200));return Wr(null,e,t,!1,s)};dt.unmountComponentAtNode=function(e){if(!Fr(e))throw Error($(40));return e._reactRootContainer?(qn(function(){Wr(null,null,e,!1,function(){e._reactRootContainer=null,e[Kt]=null})}),!0):!1};dt.unstable_batchedUpdates=ol;dt.unstable_renderSubtreeIntoContainer=function(e,t,s,a){if(!Fr(s))throw Error($(200));if(e==null||e._reactInternals===void 0)throw Error($(38));return Wr(e,t,s,!1,a)};dt.version="18.3.1-next-f1338f8080-20240426";function uh(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(uh)}catch(e){console.error(e)}}uh(),ud.exports=dt;var Af=ud.exports,Wc=Af;Si.createRoot=Wc.createRoot,Si.hydrateRoot=Wc.hydrateRoot;const hh=j.createContext({theme:"system",setTheme:()=>null});function Ef({children:e,defaultTheme:t="system",storageKey:s="vite-ui-theme",...a}){const[r,i]=j.useState(()=>localStorage.getItem(s)||t);j.useEffect(()=>{const l=window.document.documentElement;if(l.classList.remove("light","dark"),r==="system"){const c=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";l.classList.add(c);return}l.classList.add(r)},[r]);const o={theme:r,setTheme:l=>{localStorage.setItem(s,l),i(l)}};return n.jsx(hh.Provider,{...a,value:o,children:e})}const mh=()=>{const e=j.useContext(hh);if(e===void 0)throw new Error("useTheme must be used within a ThemeProvider");return e};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Lf={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $f=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),W=(e,t)=>{const s=j.forwardRef(({color:a="currentColor",size:r=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:l="",children:c,...d},u)=>j.createElement("svg",{ref:u,...Lf,width:r,height:r,stroke:a,strokeWidth:o?Number(i)*24/Number(r):i,className:["lucide",`lucide-${$f(e)}`,l].join(" "),...d},[...t.map(([g,h])=>j.createElement(g,h)),...Array.isArray(c)?c:[c]]));return s.displayName=`${e}`,s};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ph=W("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jt=W("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gn=W("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tr=W("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Df=W("Brain",[["path",{d:"M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 1.98-3A2.5 2.5 0 0 1 9.5 2Z",key:"1mhkh5"}],["path",{d:"M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-1.98-3A2.5 2.5 0 0 0 14.5 2Z",key:"1d6s00"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=W("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pf=W("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wt=W("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zf=W("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fl=W("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hf=W("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fh=W("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bf=W("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _f=W("Frown",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M16 16s-1.5-2-4-2-4 2-4 2",key:"epbg0q"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rf=W("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gl=W("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vo=W("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Of=W("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ff=W("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wf=W("Laugh",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M18 13a6 6 0 0 1-6 5 6 6 0 0 1-6-5h12Z",key:"b2q4dd"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mr=W("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qf=W("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qc=W("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gf=W("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uf=W("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gh=W("Map",[["polygon",{points:"3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21",key:"ok2ie8"}],["line",{x1:"9",x2:"9",y1:"3",y2:"18",key:"w34qz5"}],["line",{x1:"15",x2:"15",y1:"6",y2:"21",key:"volv9a"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gc=W("Meh",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"8",x2:"16",y1:"15",y2:"15",key:"1xb1d9"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yn=W("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uc=W("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yl=W("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vc=W("PenTool",[["path",{d:"m12 19 7-7 3 3-7 7-3-3z",key:"rklqx2"}],["path",{d:"m18 13-1.5-7.5L2 2l3.5 14.5L13 18l5-5z",key:"1et58u"}],["path",{d:"m2 2 7.586 7.586",key:"etlp93"}],["circle",{cx:"11",cy:"11",r:"2",key:"xmgehs"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vf=W("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yf=W("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ut=W("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gs=W("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yh=W("Rocket",[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ws=W("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qr=W("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kf=W("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yc=W("ShieldCheck",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qf=W("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zf=W("Smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=W("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kc=W("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xh=W("Sword",[["polyline",{points:"14.5 17.5 3 6 3 3 6 3 17.5 14.5",key:"1hfsw2"}],["line",{x1:"13",x2:"19",y1:"19",y2:"13",key:"1vrmhu"}],["line",{x1:"16",x2:"20",y1:"16",y2:"20",key:"1bron3"}],["line",{x1:"19",x2:"21",y1:"21",y2:"19",key:"13pww6"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jf=W("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xf=W("ThumbsDown",[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22h0a3.13 3.13 0 0 1-3-3.88Z",key:"s6e0r"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eg=W("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z",key:"y3tblf"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const un=W("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vh=W("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xl=W("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mt=W("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tg=W("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _e=W("Wand2",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72Z",key:"1bcowg"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lt=W("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xt=W("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),_t={"Avengers: Alien Invasion":{theme:"superhero",initialPhase:"conflict",initialGoal:"Defend New York City from the alien invasion",initialTension:"high",keyCharacters:["Iron Man","Captain America","Thor","Hulk"],keyLocations:["New York City","Alien Mothership","Stark Tower"],plotPoints:["Aliens have begun their invasion of New York","The Avengers are fighting to protect civilians","The team needs to find the aliens' weakness","The final battle will take place on the mothership"],initialContext:"The Avengers are in the midst of battle against alien forces in downtown New York. Civilians are being evacuated while the team fights to push back the invasion. The alien mothership looms overhead, continuously sending down reinforcements. The team needs to coordinate their defense while looking for a way to stop the invasion at its source.",initialNarration:"The skies above New York City are filled with alien ships. Explosions echo through the streets as civilians run for cover. The Avengers have assembled in the heart of Manhattan, ready to defend Earth.",initialMessages:[{speaker:"Hulk",message:"*smashes an alien soldier with a powerful blow, sending it flying into a nearby wall*",isAction:!0},{speaker:"Captain America",message:"Team, we need to establish a perimeter! Thor, take the skies and thin out their air support. Iron Man, scan for weaknesses in their tech. Hulk, keep smashing but try to keep the destruction away from civilians. I'll coordinate evacuation with local authorities."}],phaseTransitions:{introduction:{keywords:["assemble","prepare","briefing"],nextPhase:"conflict"},conflict:{keywords:["plan","strategy","weakness"],nextPhase:"planning"},planning:{keywords:["attack","mothership","final"],nextPhase:"climax"},climax:{keywords:["victory","defeated","won"],nextPhase:"resolution"}},environmentalEvents:{minor:["Distant explosions echo as alien ships target another part of the city.","Emergency sirens wail continuously in the background.","Civilians rush past, seeking shelter from the chaos.","News helicopters circle overhead, broadcasting the invasion worldwide."],major:["A massive explosion rocks the area as an alien weapon discharges!","The ground shakes violently as a massive alien walker crashes through a nearby building!","The sky darkens as the mothership moves into position directly overhead!","A blinding flash of energy surges from the mothership, targeting key infrastructure!"]},quickActions:["Shield civilians","Attack alien","Coordinate team","Analyze tech"]},"The Lost Artifact":{theme:"fantasy",initialPhase:"introduction",initialGoal:"Locate the ancient artifact before dark forces claim it",initialTension:"building",keyLocations:["Ancient Temple","Forbidden Forest","Crystal Caverns"],initialContext:"A group of adventurers has gathered at the edge of the Forbidden Forest. Ancient texts speak of a powerful artifact hidden within the ruins of a forgotten civilization. Dark forces are also seeking the artifact, and time is running out.",initialNarration:"The air is thick with magic as your party stands at the entrance to the ancient forest. Mist swirls around gnarled trees, and distant whispers seem to call from within the depths. The map you've been following has led you here, to the first step of your quest for the legendary artifact.",initialMessages:[{speaker:"Elara Moonwhisper",message:"*traces glowing runes in the air, creating a protective ward around the group*",isAction:!0},{speaker:"Elara Moonwhisper",message:"The forest's magic is ancient and unpredictable. Stay close, and whatever you do, don't stray from the path. The artifact's energy calls to me... it's definitely in there, but we're not the only ones seeking it."}],phaseTransitions:{introduction:{keywords:["journey","begin","quest"],nextPhase:"discovery"},discovery:{keywords:["clue","found","trail"],nextPhase:"conflict"},conflict:{keywords:["battle","fight","defend"],nextPhase:"climax"},climax:{keywords:["artifact","power","final"],nextPhase:"resolution"}},environmentalEvents:{minor:["A gentle breeze carries the scent of distant flowers through the area.","The light shifts as clouds pass overhead, casting moving shadows.","A small magical creature darts past, leaving a trail of sparkling dust.","Ancient runes on a nearby wall begin to glow faintly."],major:["The ground trembles violently! Cracks appear in the earth, and everyone struggles to maintain balance.","A massive portal tears open in the air nearby, swirling with arcane energy!","The sky darkens unnaturally as storm clouds gather with impossible speed. Lightning strikes nearby!","Ancient statues around the area suddenly animate, their stone eyes following everyone's movements!"]},quickActions:["Cast spell","Check for traps","Examine runes","Draw weapon"]},"Space Station Omega":{theme:"scifi",initialPhase:"introduction",initialGoal:"Investigate the mysterious signal coming from the abandoned station",initialTension:"building",keyLocations:["Command Center","Research Lab","Maintenance Tunnels"],initialContext:"Your crew has been dispatched to investigate a mysterious signal emanating from Space Station Omega, which was abandoned years ago after a catastrophic incident. The nature of the signal is unknown, but it matches no known pattern in the database.",initialNarration:"The airlock hisses as your ship completes its docking procedure with Space Station Omega. Through the viewport, you can see the station's exterior is damaged and dark, with only a few emergency lights still functioning. The mysterious signal continues to pulse from somewhere deep within the station.",initialMessages:[{speaker:"Commander Zax",message:"*checks the readings on his wrist device, frowning at the data*",isAction:!0},{speaker:"Commander Zax",message:"Atmospheric readings show the station's life support is functioning at minimal capacity. We have approximately six hours before our oxygen reserves become critical. Stay alert - the last crew disappeared without a trace, and that signal doesn't match anything in our database. Standard protocol: weapons ready, comms open at all times."}],phaseTransitions:{introduction:{keywords:["dock","arrive","board"],nextPhase:"discovery"},discovery:{keywords:["found","signal","evidence"],nextPhase:"conflict"},conflict:{keywords:["danger","threat","malfunction"],nextPhase:"climax"},climax:{keywords:["escape","override","final"],nextPhase:"resolution"}},environmentalEvents:{minor:["The ship's systems emit a series of diagnostic beeps as routine checks complete.","Holographic displays flicker with incoming data streams.","The artificial gravity fluctuates momentarily, causing a brief sensation of weightlessness.","Distant mechanical sounds echo through the corridors."],major:["WARNING! Multiple system failures detected! Red emergency lights flash as alarms blare throughout the ship.","A massive energy surge overloads nearby systems, causing explosions and electrical arcs!","The ship violently shudders as it's hit by something massive. Artificial gravity fails momentarily!","Proximity alarms scream as an unidentified vessel drops out of hyperspace dangerously close!"]},quickActions:["Scan area","Check systems","Draw weapon","Access terminal"]},"Avengers join battle":{theme:"superhero",initialPhase:"conflict",initialGoal:"Join the Avengers in their battle against the alien invasion",initialTension:"high",keyCharacters:["Iron Man","Captain America","Thor","Hulk"],keyLocations:["New York City","Alien Mothership","Stark Tower"],plotPoints:["Aliens have begun their invasion of New York","The Avengers are fighting to protect civilians","You join the team in the midst of battle","The team needs to find the aliens' weakness","The final battle will take place on the mothership"],initialContext:"The Avengers are in the midst of battle against alien forces in downtown New York. Civilians are being evacuated while the team fights to push back the invasion. The alien mothership looms overhead, continuously sending down reinforcements. You join the team as they coordinate their defense while looking for a way to stop the invasion at its source.",initialNarration:"The skies above New York City are filled with alien ships. Explosions echo through the streets as civilians run for cover. The Avengers are fighting valiantly, and you've just arrived to join the battle.",initialMessages:[{speaker:"Iron Man",message:"*flies overhead, blasting aliens with repulsor beams* Look who decided to join the party! We could use the help - these things are everywhere!",isAction:!0},{speaker:"Captain America",message:"Glad you're here! We need to establish a perimeter and protect civilians. Thor is handling air support, Hulk is on the front lines, and Iron Man is scanning for weaknesses. Where do you want to help?"}],phaseTransitions:{introduction:{keywords:["assemble","prepare","briefing"],nextPhase:"conflict"},conflict:{keywords:["plan","strategy","weakness"],nextPhase:"planning"},planning:{keywords:["attack","mothership","final"],nextPhase:"climax"},climax:{keywords:["victory","defeated","won"],nextPhase:"resolution"}},environmentalEvents:{minor:["Distant explosions echo as alien ships target another part of the city.","Emergency sirens wail continuously in the background.","Civilians rush past, seeking shelter from the chaos.","News helicopters circle overhead, broadcasting the invasion worldwide."],major:["A massive explosion rocks the area as an alien weapon discharges!","The ground shakes violently as a massive alien walker crashes through a nearby building!","The sky darkens as the mothership moves into position directly overhead!","A blinding flash of energy surges from the mothership, targeting key infrastructure!"]},quickActions:["Shield civilians","Attack alien","Coordinate team","Analyze tech"]}},Mn=(e,t)=>{try{if(!e&&!t)return console.warn("getScenarioData called with no title or theme"),null;if(!_t||typeof _t!="object")return console.error("Scenario data repository is missing or invalid"),null;console.log(`getScenarioData called with title: "${e||"none"}", theme: "${t||"none"}"`);const s=Object.keys(_t);if(console.log("Available scenarios:",s),e==="Avengers join battle"&&_t["Avengers join battle"])return console.log("Found Avengers join battle scenario by exact title"),_t["Avengers join battle"];if(e&&_t[e])return console.log(`Found scenario by exact title: "${e}"`),_t[e];if(e){const a=s.filter(r=>r.toLowerCase().includes(e.toLowerCase()));if(a.length>0)return console.log(`Found scenario by partial title match: "${a[0]}"`),_t[a[0]]}if(t){const a=Object.values(_t).filter(r=>r&&r.theme===t);if(a.length>0)return console.log(`Found scenario by theme: "${t}"`),a[0]}return console.log(`No scenario found for title: "${e||"none"}", theme: "${t||"none"}"`),null}catch(s){return console.error("Error in getScenarioData:",s),null}},ji=(e,t,s)=>{try{const a=e||"Chat Room",r=t||"Welcome to the chat room.";let i=s;if(!i)try{i=sg(r)}catch(c){console.error("Error detecting theme from prompt:",c),i="general"}const o={title:a,theme:i,currentPhase:"introduction",currentGoal:"",currentTension:"medium",keyCharacters:[],keyLocations:[],plotPoints:[],currentContext:r,previousContext:""},l=Mn(a,i);return l?{...o,currentPhase:l.initialPhase||"introduction",currentGoal:l.initialGoal||"",currentTension:l.initialTension||"medium",keyCharacters:l.keyCharacters||[],keyLocations:l.keyLocations||[],plotPoints:l.plotPoints||[],currentContext:l.initialContext||r}:i==="fantasy"?{...o,currentPhase:"introduction",currentTension:"building",currentContext:"The party has just begun their adventure, getting to know one another and establishing their quest objectives."}:i==="scifi"?{...o,currentPhase:"introduction",currentTension:"building",currentContext:"The crew is aboard their spacecraft, preparing for the challenges that lie ahead in the vast unknown of space."}:i==="mystery"?{...o,currentPhase:"discovery",currentTension:"building",currentContext:"The first clues have been discovered, raising more questions than answers as the investigation begins."}:i==="superhero"?{...o,currentPhase:"conflict",currentTension:"high",currentContext:"Heroes have assembled to face a growing threat. The situation is tense as they prepare to defend innocent lives."}:i==="horror"?{...o,currentPhase:"discovery",currentTension:"building",currentContext:"Something feels wrong. The first signs of danger have appeared, but the true horror remains hidden."}:{...o,currentContext:ag(r)||r}}catch(a){return console.error("Error in initializeStoryArc:",a),{title:e||"Chat Room",theme:"general",currentPhase:"introduction",currentTension:"medium",currentContext:t||"Welcome to the chat room.",previousContext:"",keyCharacters:[],keyLocations:[],plotPoints:[]}}},ng=(e,t,s=5)=>{if(!e||!t||t.length===0)return e;const r=t.slice(-s).map(l=>l.message).join(" "),i={...e};i.previousContext=e.currentContext,i.currentContext=rg(e,r);const o=Mn(e.title,e.theme);if(o&&o.phaseTransitions&&o.phaseTransitions[e.currentPhase]){const l=o.phaseTransitions[e.currentPhase];(l.keywords||[]).some(u=>r.toLowerCase().includes(u.toLowerCase()))&&(i.currentPhase=l.nextPhase,l.nextPhase==="conflict"?i.currentTension="high":l.nextPhase==="climax"?i.currentTension="very high":l.nextPhase==="resolution"&&(i.currentTension="falling"))}else e.currentPhase==="introduction"&&(r.includes("attack")||r.includes("fight")||r.includes("battle"))?(i.currentPhase="conflict",i.currentTension="high"):e.currentPhase==="conflict"&&(r.includes("plan")||r.includes("strategy")||r.includes("weakness"))?i.currentPhase="planning":e.currentPhase==="planning"&&(r.includes("final")||r.includes("confront")||r.includes("ready"))?(i.currentPhase="climax",i.currentTension="very high"):e.currentPhase==="climax"&&(r.includes("victory")||r.includes("defeated")||r.includes("over"))&&(i.currentPhase="resolution",i.currentTension="falling");return e.theme==="superhero"?r.includes("civilian")||r.includes("rescue")?i.currentGoal="Rescue civilians and minimize casualties":r.includes("weakness")||r.includes("vulnerability")?i.currentGoal="Discover the enemy's weakness":(r.includes("final")||r.includes("confront"))&&(i.currentGoal="Confront the main threat and save the day"):e.theme==="fantasy"?r.includes("quest")||r.includes("journey")?i.currentGoal="Begin the quest and gather resources":r.includes("clue")||r.includes("map")?i.currentGoal="Follow the trail to the next location":r.includes("battle")||r.includes("fight")?i.currentGoal="Overcome the immediate threat":(r.includes("artifact")||r.includes("treasure"))&&(i.currentGoal="Secure the artifact before it falls into the wrong hands"):e.theme==="scifi"&&(r.includes("scan")||r.includes("analyze")?i.currentGoal="Analyze the anomaly and gather data":r.includes("malfunction")||r.includes("system")?i.currentGoal="Repair critical systems before it's too late":r.includes("alien")||r.includes("contact")?i.currentGoal="Establish contact with the unknown entity":(r.includes("escape")||r.includes("evacuate"))&&(i.currentGoal="Evacuate before the situation becomes catastrophic")),i},wo=(e,t)=>{if(!e||!t)return{storyArc:"",writingStyle:"balanced",responseLength:"medium",characterReminders:"",generalNotes:""};const s={storyArc:e.currentContext,writingStyle:"balanced",responseLength:"medium",characterReminders:`Remember that ${t.name} is ${t.description}`,generalNotes:""},a=t.personality||{};a.analytical&&a.analytical>7?(s.writingStyle="analytical",s.characterReminders+=" Uses logical reasoning and precise language. May reference facts, data, or technical details."):a.humor&&a.humor>7?(s.writingStyle="witty",s.characterReminders+=" Uses humor, sarcasm, and witty remarks. May make jokes or pop culture references."):a.emotional&&a.emotional>7?(s.writingStyle="emotional",s.characterReminders+=" Expresses feelings openly. Uses emotive language and may react strongly to situations."):a.philosophical&&a.philosophical>7?(s.writingStyle="philosophical",s.characterReminders+=" Contemplates deeper meanings. May speak in metaphors or ask thought-provoking questions."):a.confidence&&a.confidence>8&&(s.writingStyle="assertive",s.characterReminders+=" Speaks with authority and conviction. Makes decisive statements and takes charge."),t.type==="fantasy"?s.characterReminders+=" Uses magical or mystical terminology. May reference ancient wisdom or supernatural elements.":t.type==="scifi"?s.characterReminders+=" Uses technical jargon and scientific concepts. May reference advanced technology or space phenomena.":t.type==="historical"?s.characterReminders+=" Uses period-appropriate language and references. May have formal speech patterns.":t.type==="superhero"&&(s.characterReminders+=" References heroic ideals and responsibilities. May mention powers or abilities."),t.voiceStyle&&(s.characterReminders+=` Speaks in a ${t.voiceStyle} manner.`),t.talkativeness&&(t.talkativeness>7?s.responseLength="long":t.talkativeness<4&&(s.responseLength="brief"));const r={introduction:{general:"Focus on establishing character relationships and setting the scene. Keep tension moderate but building.",superhero:"Establish your heroic persona and relationship to the team. Reference your powers or abilities when relevant.",fantasy:"Establish your role in the party and your connection to the magical world. Reference your background and skills.",scifi:"Establish your role on the crew and your technical expertise. Reference your specialized knowledge or equipment."},discovery:{general:"Focus on exploration and uncovering new information. Show curiosity and analytical thinking.",superhero:"Analyze the situation and gather intelligence about the threat. Use your unique perspective to contribute insights.",fantasy:"Interpret clues and magical signs. Use your knowledge of lore and legends to guide the party.",scifi:"Analyze sensor readings and anomalies. Use scientific reasoning to form hypotheses about what you're encountering."},conflict:{general:"Emphasize action and immediate threats. Responses should be urgent and focused on the current battle.",superhero:"Focus on protecting civilians and coordinating with teammates. Reference the immediate battle tactics.",fantasy:"Focus on using your abilities in combat. Reference spells, weapons, or tactical advantages in the environment.",scifi:"Focus on technical solutions to the crisis. Reference systems, equipment, or scientific principles that could help."},planning:{general:"Focus on strategy and analysis. Characters should be thinking about next steps and discussing the enemy's weaknesses.",superhero:"Contribute strategic ideas based on your powers and experience. Reference previous battles or known weaknesses.",fantasy:"Share knowledge of magical weaknesses or prophecies. Reference ancient texts or wisdom that might help.",scifi:"Propose technical solutions based on data analysis. Reference scientific principles or technological capabilities."},climax:{general:"This is the high point of tension. Responses should be dramatic and impactful, with high stakes clearly communicated.",superhero:"Show determination in the face of overwhelming odds. Reference what's at stake and your resolve to protect others.",fantasy:"Channel your full power against the final challenge. Reference prophecies, destinies, or ancient powers.",scifi:"Execute the final plan with precision and adaptability. Reference critical systems, countdown timers, or final calculations."},resolution:{general:"Wind down the action and reflect on what happened. Focus on character growth and next steps.",superhero:"Reflect on the victory and lessons learned. Reference the cost of the battle and plans for rebuilding.",fantasy:"Celebrate the completion of the quest. Reference rewards, magical discoveries, or new bonds formed.",scifi:"Analyze the mission outcomes and collected data. Reference scientific discoveries or technological advancements made."}},i=e.currentPhase||"introduction",o=e.theme||"general";return r[i]&&(r[i][o]?s.generalNotes=r[i][o]:s.generalNotes=r[i].general),e.currentTension==="high"?s.generalNotes+=" Maintain a sense of urgency in your responses.":e.currentTension==="very high"&&(s.generalNotes+=" Convey extreme urgency and high stakes in every response."),e.title&&Mn(e.title,o)&&(s.generalNotes+=` Remember that you are in the "${e.title}" scenario.`,e.currentGoal&&(s.generalNotes+=` Your current goal is to ${e.currentGoal}.`)),s},sg=e=>{if(!e)return"general";const t=e.toLowerCase();return t.includes("superhero")||t.includes("avenger")||t.includes("hero")||t.includes("villain")?"superhero":t.includes("magic")||t.includes("dragon")||t.includes("wizard")||t.includes("fantasy")?"fantasy":t.includes("space")||t.includes("alien")||t.includes("future")||t.includes("technology")?"scifi":t.includes("mystery")||t.includes("detective")||t.includes("crime")||t.includes("clue")?"mystery":t.includes("horror")||t.includes("scary")||t.includes("monster")||t.includes("fear")?"horror":"general"},ag=e=>{try{return e?String(e):""}catch(t){return console.error("Error in extractContextFromPrompt:",t),e?String(e):""}},rg=(e,t)=>{if(!e||!t)return e.currentContext||"";let s=e.currentContext;const a=Mn(e.title,e.theme);return a&&(a.phaseContexts&&a.phaseContexts[e.currentPhase]?s=a.phaseContexts[e.currentPhase]:e.theme==="superhero"?e.currentPhase==="conflict"?t.includes("civilian")||t.includes("rescue")?s="The battle rages on. Civilians are in danger and need to be evacuated. The heroes are fighting to protect the people while dealing with the ongoing threat.":(t.includes("damage")||t.includes("destruction"))&&(s="Parts of the area have been damaged by the attack. The heroes are working to contain the destruction while fighting back against the threat. They need to find a way to stop the enemy before more damage is done."):e.currentPhase==="planning"?s="The team has gained some ground against the enemy forces. Now they need to analyze their opponent's tactics to find a weakness. They need a plan to defeat the main threat once and for all.":e.currentPhase==="climax"?s="The heroes have identified the enemy's weakness and are preparing for a final confrontation. This will be the decisive battle that determines the fate of everyone involved.":e.currentPhase==="resolution"&&(s="The threat has been neutralized. The heroes can now reflect on their victory and begin the process of rebuilding and recovery."):e.theme==="fantasy"?e.currentPhase==="introduction"?s="The party is beginning their quest, getting to know one another and preparing for the journey ahead.":e.currentPhase==="discovery"?s="The adventurers have found important clues that point them toward their goal. The path ahead is becoming clearer, though dangers still lurk in the shadows.":e.currentPhase==="conflict"?s="The party faces significant opposition. Enemies or obstacles block their path, and they must use all their skills and magic to overcome these challenges.":e.currentPhase==="climax"?s="The final challenge lies before them. Everything they've learned and every skill they've honed will be put to the test in this decisive moment.":e.currentPhase==="resolution"&&(s="The quest has been completed. The party celebrates their victory, divides their rewards, and considers what adventures might lie ahead."):e.theme==="scifi"&&(e.currentPhase==="introduction"?s="The crew is aboard their spacecraft, receiving their mission briefing and checking systems. The vastness of space awaits them.":e.currentPhase==="discovery"?s="Unusual readings have been detected. The crew is investigating the anomaly, collecting data and forming hypotheses about its nature.":e.currentPhase==="conflict"?s="An unexpected threat has emerged. The crew must respond quickly to survive, using their technology and expertise to address the crisis.":e.currentPhase==="climax"?s="The final challenge approaches - a critical system failure, a confrontation with the main antagonist, or a race against time to prevent catastrophe.":e.currentPhase==="resolution"&&(s="The mission is complete. The crew has survived and succeeded, though perhaps changed by their experiences. They prepare for the journey home or their next assignment."))),s},ig=({onSelectCharacter:e,onCreateScenario:t,onQuickStart:s,onUploadChat:a,onHowToUse:r,onStartChat:i})=>{const{theme:o,setTheme:l}=mh(),[c,d]=j.useState(!1),u=f=>{const y=f.target.files[0];if(y){const N=new FileReader;N.onload=m=>{try{const v=JSON.parse(m.target.result);a(v)}catch(v){alert("Invalid chat file. Please upload a valid JSON file."),console.error("Error parsing chat file:",v)}},N.readAsText(y)}},g=f=>{const y=Mn(f);if(!y){console.error(`Scenario "${f}" not found`);return}let N=[];f==="Avengers: Alien Invasion"?N=[{name:"Captain America",type:"superhero",mood:"determined",description:"The first Avenger and a natural leader with unwavering moral principles.",avatar:"🛡️",personality:{analytical:7,emotional:6,philosophical:8,humor:4,confidence:9}},{name:"Iron Man",type:"superhero",mood:"confident",description:"Genius billionaire Tony Stark with advanced technology and quick wit.",avatar:"🔴",personality:{analytical:10,emotional:5,philosophical:6,humor:9,confidence:10}},{name:"Thor",type:"superhero",mood:"powerful",description:"The Asgardian God of Thunder with control over lightning and storms.",avatar:"⚡",personality:{analytical:5,emotional:7,philosophical:6,humor:7,confidence:9}},{name:"Hulk",type:"superhero",mood:"angry",description:"The strongest Avenger with incredible strength fueled by rage.",avatar:"💪",personality:{analytical:8,emotional:10,philosophical:4,humor:5,confidence:8}}]:f==="The Lost Artifact"?N=[{name:"Elara Moonwhisper",type:"fantasy",mood:"mysterious",description:"An elven sorceress with silver hair and eyes that shimmer like moonlight.",avatar:"🧝‍♀️",personality:{analytical:7,emotional:6,philosophical:9,humor:4,confidence:8}}]:f==="Space Station Omega"&&(N=[{name:"Commander Zax",type:"scifi",mood:"stern",description:"A battle-hardened space marine with cybernetic enhancements.",avatar:"🤖",personality:{analytical:8,emotional:3,philosophical:5,humor:2,confidence:9}}]);const m=y.initialContext||"";let v="linear-gradient(to right, #3a1c71, #d76d77, #ffaf7b)";y.theme==="fantasy"?v="linear-gradient(to right, #654ea3, #eaafc8)":y.theme==="scifi"&&(v="linear-gradient(to right, #2b5876, #4e4376)"),i(f,N,m,v,y.theme)},h=()=>{try{console.log("Starting Avengers join battle scenario...");const f=Mn("Avengers join battle");if(console.log("Scenario data:",f),!f){console.error("Avengers join battle scenario data not found"),console.log("Falling back to regular Avengers scenario"),p();return}const y=[{name:"Captain America",type:"superhero",mood:"determined",description:"The first Avenger and a natural leader with unwavering moral principles.",avatar:"🛡️",personality:{analytical:7,emotional:6,philosophical:8,humor:4,confidence:9}},{name:"Iron Man",type:"superhero",mood:"confident",description:"Genius billionaire Tony Stark with advanced technology and quick wit.",avatar:"🔴",personality:{analytical:10,emotional:5,philosophical:6,humor:9,confidence:10}},{name:"Thor",type:"superhero",mood:"powerful",description:"The Asgardian God of Thunder with control over lightning and storms.",avatar:"⚡",personality:{analytical:5,emotional:7,philosophical:6,humor:7,confidence:9}},{name:"Hulk",type:"superhero",mood:"angry",description:"The strongest Avenger with incredible strength fueled by rage.",avatar:"💪",personality:{analytical:8,emotional:10,philosophical:4,humor:5,confidence:8}}];let N="The Avengers are facing an alien invasion in New York City. You join the team as they fight to protect civilians and defeat the alien threat.";f&&f.initialContext&&(N=f.initialContext);const m="linear-gradient(to right, #3a1c71, #d76d77, #ffaf7b)";console.log("Calling onStartChat with:",{name:"Avengers join battle",charactersCount:y.length,scenarioPrompt:N,scenarioBackground:m,theme:"superhero"}),i("Avengers join battle",y,N,m,"superhero")}catch(f){console.error("Error starting Avengers join battle scenario:",f),console.log("Error occurred, falling back to regular Avengers scenario"),p()}},p=()=>{console.log("Starting Avengers scenario...");const f=Mn("Avengers: Alien Invasion");if(console.log("Scenario data:",f),!f){console.error("Avengers scenario data not found");return}const y=[{name:"Captain America",type:"superhero",mood:"determined",description:"The first Avenger and a natural leader with unwavering moral principles.",avatar:"🛡️",personality:{analytical:7,emotional:6,philosophical:8,humor:4,confidence:9}},{name:"Iron Man",type:"superhero",mood:"confident",description:"Genius billionaire Tony Stark with advanced technology and quick wit.",avatar:"🔴",personality:{analytical:10,emotional:5,philosophical:6,humor:9,confidence:10}},{name:"Thor",type:"superhero",mood:"powerful",description:"The Asgardian God of Thunder with control over lightning and storms.",avatar:"⚡",personality:{analytical:5,emotional:7,philosophical:6,humor:7,confidence:9}},{name:"Hulk",type:"superhero",mood:"angry",description:"The strongest Avenger with incredible strength fueled by rage.",avatar:"💪",personality:{analytical:8,emotional:10,philosophical:4,humor:5,confidence:8}}],N=f.initialContext||"The Avengers are facing an alien invasion in New York City. The team must work together to protect civilians and defeat the alien threat.",m="linear-gradient(to right, #3a1c71, #d76d77, #ffaf7b)";console.log("Calling onStartChat with:",{name:"Avengers: Alien Invasion",charactersCount:y.length,scenarioPrompt:N,scenarioBackground:m,theme:"superhero"}),i("Avengers: Alien Invasion",y,N,m,"superhero")};return n.jsxs("div",{className:"flex flex-col min-h-screen",children:[n.jsx("header",{className:"border-b sticky top-0 z-50 bg-background/95 backdrop-blur-sm shadow-sm",children:n.jsxs("div",{className:"container mx-auto py-2 px-4",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("div",{className:"flex items-center gap-2",children:n.jsx("div",{className:"bg-primary/10 p-1.5 rounded-md",children:n.jsx("h1",{className:"text-xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-primary to-purple-600",children:"Velora"})})}),n.jsxs("nav",{className:"hidden md:flex items-center space-x-4",children:[n.jsx("a",{href:"#features",className:"text-sm font-medium text-muted-foreground hover:text-primary transition-colors",children:"Features"}),n.jsx("a",{href:"#how-it-works",className:"text-sm font-medium text-muted-foreground hover:text-primary transition-colors",children:"How It Works"}),n.jsx("button",{onClick:r,className:"text-sm font-medium text-muted-foreground hover:text-primary transition-colors",children:"Guide"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("button",{onClick:s,className:"md:hidden p-2 rounded-full bg-primary/90 flex items-center justify-center",title:"Quick Start",children:[n.jsx(ne,{className:"h-4 w-4 text-primary-foreground"}),n.jsx("span",{className:"sr-only",children:"Quick Start"})]}),n.jsxs("button",{onClick:()=>d(!0),className:"md:hidden p-2 rounded-full hover:bg-secondary/80 flex items-center justify-center",title:"Upload Saved Chat",children:[n.jsx(un,{className:"h-4 w-4"}),n.jsx("span",{className:"sr-only",children:"Upload Saved Chat"})]}),n.jsxs("button",{onClick:r,className:"p-2 rounded-full hover:bg-secondary/80 flex items-center justify-center md:hidden",title:"How to Use Velora",children:[n.jsx(vo,{className:"h-4 w-4"}),n.jsx("span",{className:"sr-only",children:"How to Use"})]}),n.jsxs("button",{onClick:()=>l(o==="dark"?"light":"dark"),className:"p-2 rounded-full bg-secondary/80",title:o==="dark"?"Switch to Light Mode":"Switch to Dark Mode",children:[o==="dark"?n.jsx(Kc,{className:"h-4 w-4"}):n.jsx(Uc,{className:"h-4 w-4"}),n.jsx("span",{className:"sr-only",children:"Toggle theme"})]})]})]}),n.jsxs("div",{className:"hidden md:flex items-center justify-between mt-2 pb-1",children:[n.jsx("div",{className:"text-xs text-muted-foreground",children:"Create immersive AI adventures in seconds"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("button",{onClick:s,className:"flex h-8 items-center justify-center rounded-lg bg-primary px-3 text-xs font-medium text-primary-foreground shadow-sm transition-all hover:bg-primary/90",children:[n.jsx(ne,{className:"h-3.5 w-3.5 mr-1.5"}),"Quick Start"]}),n.jsxs("button",{onClick:e,className:"flex h-8 items-center justify-center rounded-lg border border-primary/30 bg-background/60 backdrop-blur-sm px-3 text-xs font-medium transition-all hover:bg-primary/5 hover:border-primary/50",children:[n.jsx(Mt,{className:"h-3.5 w-3.5 mr-1.5 text-primary"}),"Characters"]}),n.jsxs("button",{onClick:t,className:"flex h-8 items-center justify-center rounded-lg border border-primary/30 bg-background/60 backdrop-blur-sm px-3 text-xs font-medium transition-all hover:bg-primary/5 hover:border-primary/50",children:[n.jsx(_e,{className:"h-3.5 w-3.5 mr-1.5 text-primary"}),"Scenarios"]}),n.jsxs("button",{onClick:()=>d(!0),className:"flex h-8 items-center justify-center rounded-lg border border-primary/30 bg-background/60 backdrop-blur-sm px-3 text-xs font-medium transition-all hover:bg-primary/5 hover:border-primary/50",children:[n.jsx(un,{className:"h-3.5 w-3.5 mr-1.5 text-primary"}),"Resume Chat"]})]})]})]})}),n.jsxs("section",{className:"relative overflow-hidden py-10 md:py-12",children:[n.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-primary/10 via-primary/5 to-background pointer-events-none"}),n.jsx("div",{className:"absolute top-0 right-0 w-1/3 h-1/3 bg-primary/5 rounded-full blur-3xl transform translate-x-1/4 -translate-y-1/4"}),n.jsx("div",{className:"container px-4 md:px-6 relative z-10",children:n.jsxs("div",{className:"flex flex-col lg:flex-row gap-8 items-center max-w-6xl mx-auto",children:[n.jsxs("div",{className:"lg:w-5/12 space-y-4 text-center lg:text-left",children:[n.jsxs("div",{className:"inline-flex items-center px-3 py-1 rounded-full bg-primary/10 text-primary text-sm font-medium",children:[n.jsx(ne,{className:"h-3.5 w-3.5 mr-2"}),n.jsx("span",{children:"No Login Required"})]}),n.jsxs("h1",{className:"text-3xl font-bold tracking-tight sm:text-4xl md:text-5xl",children:["Immersive AI Characters in"," ",n.jsxs("span",{className:"relative",children:[n.jsx("span",{className:"bg-clip-text text-transparent bg-gradient-to-r from-primary to-purple-600",children:"Living Worlds"}),n.jsx("span",{className:"absolute bottom-0 left-0 w-full h-1 bg-gradient-to-r from-primary/50 to-purple-600/50 rounded-full"})]})]}),n.jsx("p",{className:"text-muted-foreground max-w-[500px] mx-auto lg:mx-0",children:"Create immersive adventures with AI characters that remember context and respond naturally to your actions."}),n.jsxs("div",{className:"pt-2",children:[n.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center lg:justify-start mb-4",children:[n.jsxs("button",{onClick:s,className:"inline-flex h-12 items-center justify-center rounded-lg bg-primary px-6 text-base font-medium text-primary-foreground shadow-lg transition-all hover:bg-primary/90 hover:scale-105",children:[n.jsx(ne,{className:"h-5 w-5 mr-2"}),"Start in 5 Seconds"]}),n.jsxs("button",{onClick:e,className:"inline-flex h-12 items-center justify-center rounded-lg border border-primary/30 bg-background/60 backdrop-blur-sm px-6 text-base font-medium shadow-lg transition-all hover:bg-primary/10 hover:border-primary/50",children:[n.jsx(Mt,{className:"h-5 w-5 mr-2 text-primary"}),"Browse Characters"]})]}),n.jsxs("div",{className:"flex items-center justify-center lg:justify-start gap-2 text-xs text-muted-foreground",children:[n.jsxs("div",{className:"flex -space-x-1",children:[n.jsx("div",{className:"w-5 h-5 rounded-full bg-purple-500/30 border border-background"}),n.jsx("div",{className:"w-5 h-5 rounded-full bg-blue-500/30 border border-background"}),n.jsx("div",{className:"w-5 h-5 rounded-full bg-green-500/30 border border-background"})]}),n.jsx("span",{children:"Join 1000+ users creating adventures daily"})]})]})]}),n.jsx("div",{className:"lg:w-7/12 relative",children:n.jsxs("div",{className:"bg-background/40 backdrop-blur-sm rounded-xl border border-primary/20 shadow-xl overflow-hidden",children:[n.jsxs("div",{className:"p-3 border-b border-primary/10 flex items-center justify-between bg-background/60",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-8 h-8 rounded-full bg-red-500/30 flex items-center justify-center",children:n.jsx(Qf,{className:"h-4 w-4 text-red-500"})}),n.jsxs("div",{children:[n.jsx("span",{className:"font-medium",children:"Avengers: Alien Invasion"}),n.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[n.jsxs("div",{className:"flex -space-x-1",children:[n.jsx("div",{className:"w-4 h-4 rounded-full bg-red-500/30 border border-background"}),n.jsx("div",{className:"w-4 h-4 rounded-full bg-green-500/30 border border-background"}),n.jsx("div",{className:"w-4 h-4 rounded-full bg-blue-500/30 border border-background"}),n.jsx("div",{className:"w-4 h-4 rounded-full bg-yellow-500/30 border border-background"})]}),n.jsx("span",{children:"4 characters • Battle in progress"})]})]})]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("button",{className:"w-7 h-7 rounded-full bg-background/80 flex items-center justify-center border border-primary/20",children:n.jsx(Mt,{className:"h-3.5 w-3.5 text-primary"})}),n.jsx("button",{className:"w-7 h-7 rounded-full bg-background/80 flex items-center justify-center border border-primary/20",children:n.jsx(ne,{className:"h-3.5 w-3.5 text-primary"})})]})]}),n.jsxs("div",{className:"p-4 flex flex-col gap-3 max-h-[250px] overflow-hidden relative bg-gradient-to-br from-background/30 to-background/10",children:[n.jsxs("div",{className:"flex gap-2 items-start max-w-[80%]",children:[n.jsx("div",{className:"w-8 h-8 rounded-full bg-red-500/30 flex-shrink-0 border border-red-500/20 shadow-sm flex items-center justify-center text-xs",children:"🛡️"}),n.jsxs("div",{className:"bg-background/60 backdrop-blur-sm p-2.5 rounded-lg rounded-tl-none shadow-sm border border-primary/10",children:[n.jsx("p",{className:"text-xs text-primary/80 font-medium mb-0.5",children:"Captain America"}),n.jsx("p",{className:"text-sm",children:"Thor! We need your lightning on the east flank! These aliens are breaking through our defenses!"})]})]}),n.jsx("div",{className:"flex gap-2 items-start max-w-[80%] self-end",children:n.jsx("div",{className:"bg-primary/90 p-2.5 rounded-lg rounded-tr-none text-primary-foreground shadow-md",children:n.jsx("p",{className:"text-sm",children:"*raises Mjolnir* These creatures shall feel the wrath of Asgard! *summons lightning* Stand back, my friends!"})})}),n.jsxs("div",{className:"flex gap-2 items-start max-w-[80%]",children:[n.jsx("div",{className:"w-8 h-8 rounded-full bg-green-500/30 flex-shrink-0 border border-green-500/20 shadow-sm flex items-center justify-center text-xs",children:"💪"}),n.jsxs("div",{className:"bg-background/60 backdrop-blur-sm p-2.5 rounded-lg rounded-tl-none shadow-sm border border-primary/10",children:[n.jsx("p",{className:"text-xs text-primary/80 font-medium mb-0.5",children:"Hulk"}),n.jsx("p",{className:"text-sm",children:"HULK SMASH ALIENS! *leaps into a group of enemies, creating a shockwave* PUNY SPACE MONSTERS!"})]})]}),n.jsxs("div",{className:"flex gap-2 items-start max-w-[80%]",children:[n.jsx("div",{className:"w-8 h-8 rounded-full bg-red-500/40 flex-shrink-0 border border-red-500/20 shadow-sm flex items-center justify-center text-xs",children:"🔴"}),n.jsxs("div",{className:"bg-background/60 backdrop-blur-sm p-2.5 rounded-lg rounded-tl-none shadow-sm border border-primary/10",children:[n.jsx("p",{className:"text-xs text-primary/80 font-medium mb-0.5",children:"Iron Man"}),n.jsx("p",{className:"text-sm",children:"I'm detecting a mothership above the city. Thor, think you can give me a boost with that lightning? Let's take this fight to them!"})]})]}),n.jsx("div",{className:"absolute inset-x-0 bottom-0 h-16 bg-gradient-to-t from-background/80 to-transparent pointer-events-none"})]}),n.jsxs("div",{className:"p-3 border-t border-primary/10 bg-background/60",children:[n.jsxs("div",{className:"flex gap-2 items-center",children:[n.jsx("div",{className:"flex-1 bg-background/80 rounded-lg border border-primary/20 p-2 text-sm text-muted-foreground cursor-pointer hover:border-primary/50 transition-colors",onClick:()=>h(),children:"Type your message as Thor..."}),n.jsx("button",{className:"w-8 h-8 rounded-full bg-primary flex items-center justify-center text-primary-foreground shadow-md hover:bg-primary/90 transition-colors",onClick:()=>h(),children:n.jsx(gn,{className:"h-4 w-4"})})]}),n.jsxs("div",{className:"flex justify-between mt-2 px-1",children:[n.jsxs("div",{className:"flex gap-2 text-xs text-muted-foreground",children:[n.jsxs("span",{className:"flex items-center",children:[n.jsx(Yc,{className:"h-3 w-3 mr-1"})," Private"]}),n.jsxs("span",{className:"flex items-center",children:[n.jsx(ne,{className:"h-3 w-3 mr-1"})," AI-Powered"]})]}),n.jsx("button",{className:"text-xs text-primary hover:underline font-medium",onClick:()=>{console.log("Join the battle button clicked");try{h(),console.log("startAvengersJoinBattleScenario completed successfully")}catch(f){console.error("Error in startAvengersJoinBattleScenario:",f)}},children:"Join the battle →"})]})]})]})})]})})]}),n.jsxs("section",{id:"how-it-works",className:"py-14 relative overflow-hidden bg-gradient-to-b from-background to-secondary/5",children:[n.jsx("div",{className:"absolute top-0 left-0 w-full h-px bg-gradient-to-r from-transparent via-primary/20 to-transparent"}),n.jsxs("div",{className:"container px-4 md:px-6 relative z-10",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsxs("div",{className:"inline-flex items-center px-3 py-1 rounded-full bg-primary/10 text-primary text-sm font-medium mb-2",children:[n.jsx(Xt,{className:"h-3.5 w-3.5 mr-2"}),n.jsx("span",{children:"Start in Seconds"})]}),n.jsx("h2",{className:"text-2xl font-bold tracking-tight sm:text-3xl mb-2",children:"How It Works"}),n.jsx("p",{className:"text-muted-foreground max-w-2xl mx-auto",children:"Three simple steps to immersive AI adventures"})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 max-w-5xl mx-auto",children:[n.jsxs("div",{className:"bg-background rounded-xl border border-primary/20 shadow-md p-4 transition-all duration-300 hover:shadow-lg hover:border-primary/30 group",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[n.jsx("div",{className:"bg-primary/10 w-10 h-10 rounded-full flex items-center justify-center group-hover:bg-primary/20 transition-colors flex-shrink-0",children:n.jsx("span",{className:"font-bold text-primary",children:"1"})}),n.jsx("h3",{className:"text-lg font-bold group-hover:text-primary transition-colors",children:"Choose Characters"})]}),n.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"Select from our library of AI personalities or create custom characters with unique traits."}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex -space-x-2",children:[n.jsx("div",{className:"w-8 h-8 rounded-full bg-purple-500/30 border-2 border-background"}),n.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-500/30 border-2 border-background"}),n.jsx("div",{className:"w-8 h-8 rounded-full bg-green-500/30 border-2 border-background"})]}),n.jsxs("button",{onClick:e,className:"text-xs font-medium text-primary hover:underline flex items-center",children:["Browse Characters ",n.jsx(gn,{className:"h-3 w-3 ml-1"})]})]})]}),n.jsxs("div",{className:"bg-background rounded-xl border border-primary/20 shadow-md p-4 transition-all duration-300 hover:shadow-lg hover:border-primary/30 group",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[n.jsx("div",{className:"bg-primary/10 w-10 h-10 rounded-full flex items-center justify-center group-hover:bg-primary/20 transition-colors flex-shrink-0",children:n.jsx("span",{className:"font-bold text-primary",children:"2"})}),n.jsx("h3",{className:"text-lg font-bold group-hover:text-primary transition-colors",children:"Select Scenario"})]}),n.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"Choose a pre-made scenario or describe your own setting for AI to generate a rich world."}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:()=>g("The Lost Artifact"),className:"bg-primary/10 px-2 py-1 rounded text-xs text-primary hover:bg-primary/20",children:"Fantasy"}),n.jsx("button",{onClick:()=>g("Space Station Omega"),className:"bg-primary/10 px-2 py-1 rounded text-xs text-primary hover:bg-primary/20",children:"Sci-Fi"})]}),n.jsxs("button",{onClick:t,className:"text-xs font-medium text-primary hover:underline flex items-center",children:["Create Scenario ",n.jsx(gn,{className:"h-3 w-3 ml-1"})]})]})]}),n.jsxs("div",{className:"bg-background rounded-xl border border-primary/20 shadow-md p-4 transition-all duration-300 hover:shadow-lg hover:border-primary/30 group",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[n.jsx("div",{className:"bg-primary/10 w-10 h-10 rounded-full flex items-center justify-center group-hover:bg-primary/20 transition-colors flex-shrink-0",children:n.jsx("span",{className:"font-bold text-primary",children:"3"})}),n.jsx("h3",{className:"text-lg font-bold group-hover:text-primary transition-colors",children:"Start Chatting"})]}),n.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"Engage in dynamic conversations with AI characters that remember context and respond naturally."}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-8 h-8 rounded-full bg-purple-500/30 flex-shrink-0 border border-purple-500/20"}),n.jsx("div",{className:"bg-background/60 p-1.5 rounded-lg text-xs border border-primary/10",children:"Ready?"})]}),n.jsxs("button",{onClick:s,className:"text-xs font-medium text-primary hover:underline flex items-center",children:["Quick Start ",n.jsx(gn,{className:"h-3 w-3 ml-1"})]})]})]})]}),n.jsxs("div",{className:"flex justify-center gap-4 mt-8 max-w-xl mx-auto",children:[n.jsxs("button",{onClick:()=>d(!0),className:"inline-flex h-9 items-center justify-center rounded-lg border border-primary/20 bg-background/60 backdrop-blur-sm px-4 text-xs font-medium transition-all hover:bg-primary/5 hover:border-primary/30",children:[n.jsx(un,{className:"h-3.5 w-3.5 mr-1.5 text-primary"}),"Upload Saved Chat"]}),n.jsxs("button",{onClick:r,className:"inline-flex h-9 items-center justify-center rounded-lg border border-primary/20 bg-background/60 backdrop-blur-sm px-4 text-xs font-medium transition-all hover:bg-primary/5 hover:border-primary/30",children:[n.jsx(vo,{className:"h-3.5 w-3.5 mr-1.5 text-primary"}),"View Guide"]})]})]})]}),n.jsxs("section",{id:"features",className:"py-16 relative overflow-hidden",children:[n.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-primary/5 to-background/80 pointer-events-none"}),n.jsx("div",{className:"absolute top-0 left-0 w-full h-px bg-gradient-to-r from-transparent via-primary/20 to-transparent"}),n.jsxs("div",{className:"container px-4 md:px-6 relative z-10",children:[n.jsxs("div",{className:"text-center mb-10",children:[n.jsxs("div",{className:"inline-flex items-center px-3 py-1 rounded-full bg-primary/10 text-primary text-sm font-medium mb-2",children:[n.jsx(Xt,{className:"h-3.5 w-3.5 mr-2"}),n.jsx("span",{children:"Designed for Immersion"})]}),n.jsx("h2",{className:"text-2xl font-bold tracking-tight sm:text-3xl mb-2",children:"Key Features"}),n.jsx("p",{className:"text-muted-foreground max-w-2xl mx-auto",children:"Everything you need for immersive AI character interactions"})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 max-w-5xl mx-auto",children:[n.jsxs("div",{className:"group relative bg-background rounded-xl border border-primary/20 shadow-md overflow-hidden transition-all duration-300 hover:-translate-y-1 hover:shadow-lg hover:border-primary/30",children:[n.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-primary to-purple-600 transform scale-x-0 group-hover:scale-x-100 transition-transform origin-left"}),n.jsxs("div",{className:"p-4",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[n.jsx("div",{className:"bg-primary/10 w-10 h-10 rounded-full flex items-center justify-center group-hover:bg-primary/20 transition-colors flex-shrink-0",children:n.jsx(yn,{className:"h-5 w-5 text-primary"})}),n.jsx("h3",{className:"text-lg font-bold group-hover:text-primary transition-colors",children:"Dynamic Conversations"})]}),n.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"Context-aware, memory-rich replies that evolve with your interactions."})]})]}),n.jsxs("div",{className:"group relative bg-background rounded-xl border border-primary/20 shadow-md overflow-hidden transition-all duration-300 hover:-translate-y-1 hover:shadow-lg hover:border-primary/30",children:[n.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-primary to-purple-600 transform scale-x-0 group-hover:scale-x-100 transition-transform origin-left"}),n.jsxs("div",{className:"p-4",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[n.jsx("div",{className:"bg-primary/10 w-10 h-10 rounded-full flex items-center justify-center group-hover:bg-primary/20 transition-colors flex-shrink-0",children:n.jsx(_e,{className:"h-5 w-5 text-primary"})}),n.jsx("h3",{className:"text-lg font-bold group-hover:text-primary transition-colors",children:"AI-Generated Worlds"})]}),n.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"Describe your ideal scenario in a few words and watch as AI creates a rich, detailed world."})]})]}),n.jsxs("div",{className:"group relative bg-background rounded-xl border border-primary/20 shadow-md overflow-hidden transition-all duration-300 hover:-translate-y-1 hover:shadow-lg hover:border-primary/30",children:[n.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-primary to-purple-600 transform scale-x-0 group-hover:scale-x-100 transition-transform origin-left"}),n.jsxs("div",{className:"p-4",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[n.jsx("div",{className:"bg-primary/10 w-10 h-10 rounded-full flex items-center justify-center group-hover:bg-primary/20 transition-colors flex-shrink-0",children:n.jsx(ne,{className:"h-5 w-5 text-primary"})}),n.jsx("h3",{className:"text-lg font-bold group-hover:text-primary transition-colors",children:"No Login Required"})]}),n.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"Jump right in without creating an account. Your chats can be saved locally for privacy."})]})]})]})]})]}),n.jsxs("section",{className:"py-12 relative overflow-hidden",children:[n.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-primary/10 via-primary/5 to-background pointer-events-none"}),n.jsx("div",{className:"absolute bottom-0 left-0 w-full h-px bg-gradient-to-r from-transparent via-primary/20 to-transparent"}),n.jsx("div",{className:"container px-4 md:px-6 relative z-10",children:n.jsx("div",{className:"max-w-4xl mx-auto",children:n.jsx("div",{className:"bg-background/40 backdrop-blur-sm rounded-xl border border-primary/20 shadow-lg p-5 md:p-6",children:n.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-6",children:[n.jsxs("div",{className:"md:w-7/12",children:[n.jsxs("div",{className:"inline-flex items-center px-2 py-1 rounded-full bg-primary/10 text-primary text-xs font-medium mb-2",children:[n.jsx(ne,{className:"h-3 w-3 mr-1.5"}),n.jsx("span",{children:"Start in 5 Seconds"})]}),n.jsx("h2",{className:"text-xl md:text-2xl font-bold tracking-tight mb-2",children:"Ready to Create Your Own Adventure?"}),n.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Join thousands of users creating immersive AI adventures with characters that remember context and respond naturally."}),n.jsxs("div",{className:"flex items-center gap-3 mb-4 md:mb-0",children:[n.jsxs("div",{className:"flex -space-x-1.5",children:[n.jsx("div",{className:"w-6 h-6 rounded-full bg-purple-500/30 border-2 border-background"}),n.jsx("div",{className:"w-6 h-6 rounded-full bg-blue-500/30 border-2 border-background"}),n.jsx("div",{className:"w-6 h-6 rounded-full bg-green-500/30 border-2 border-background"}),n.jsx("div",{className:"w-6 h-6 rounded-full bg-amber-500/30 border-2 border-background"})]}),n.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[n.jsx(Yc,{className:"h-3 w-3 text-primary"}),n.jsx("span",{children:"100% private • No login required"})]})]})]}),n.jsxs("div",{className:"md:w-5/12 flex flex-col gap-3",children:[n.jsxs("button",{onClick:s,className:"inline-flex h-11 items-center justify-center rounded-lg bg-primary px-5 text-sm font-medium text-primary-foreground shadow-md transition-all hover:bg-primary/90 hover:scale-105 w-full",children:[n.jsx(ne,{className:"h-4 w-4 mr-2"}),"Start Your Adventure Now"]}),n.jsxs("div",{className:"flex gap-3 w-full",children:[n.jsxs("button",{onClick:e,className:"inline-flex h-9 items-center justify-center rounded-lg border border-primary/30 bg-background/60 backdrop-blur-sm px-3 text-xs font-medium shadow-md transition-all hover:bg-primary/10 hover:border-primary/50 flex-1",children:[n.jsx(Mt,{className:"h-3.5 w-3.5 mr-1.5 text-primary"}),"Browse Characters"]}),n.jsxs("button",{onClick:t,className:"inline-flex h-9 items-center justify-center rounded-lg border border-primary/30 bg-background/60 backdrop-blur-sm px-3 text-xs font-medium shadow-md transition-all hover:bg-primary/10 hover:border-primary/50 flex-1",children:[n.jsx(_e,{className:"h-3.5 w-3.5 mr-1.5 text-primary"}),"Create Scenario"]})]})]})]})})})})]}),n.jsx("footer",{className:"py-6 bg-background/95 border-t border-primary/10",children:n.jsxs("div",{className:"container px-4 md:px-6",children:[n.jsxs("div",{className:"flex flex-wrap justify-between items-center gap-4",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"bg-primary/10 p-1 rounded-md",children:n.jsx("h2",{className:"text-base font-bold bg-clip-text text-transparent bg-gradient-to-r from-primary to-purple-600",children:"Velora"})}),n.jsx("button",{onClick:()=>l(o==="dark"?"light":"dark"),className:"w-7 h-7 rounded-md bg-primary/10 flex items-center justify-center text-primary hover:bg-primary/20 transition-colors",title:o==="dark"?"Switch to Light Mode":"Switch to Dark Mode",children:o==="dark"?n.jsx(Kc,{className:"h-3.5 w-3.5"}):n.jsx(Uc,{className:"h-3.5 w-3.5"})})]}),n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("a",{href:"#features",className:"text-xs text-muted-foreground hover:text-primary transition-colors",children:"Features"}),n.jsx("a",{href:"#how-it-works",className:"text-xs text-muted-foreground hover:text-primary transition-colors",children:"How It Works"}),n.jsx("button",{onClick:r,className:"text-xs text-muted-foreground hover:text-primary transition-colors",children:"Guide"})]})]}),n.jsx("div",{className:"border-t border-primary/10 mt-4 pt-4 flex justify-center items-center",children:n.jsxs("p",{className:"text-xs text-muted-foreground",children:["Made with love, coffee and vibe coding by"," ",n.jsx("a",{href:"https://www.linkedin.com/in/saurao-dalvi/",target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:text-primary/80 transition-colors underline",children:"Saurao Dalvi"})]})})]})}),c&&n.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center p-4 z-50 backdrop-blur-md",children:n.jsxs("div",{className:"bg-background/95 backdrop-blur-sm rounded-xl shadow-2xl max-w-md w-full p-8 border border-primary/20 relative",children:[n.jsxs("button",{onClick:()=>d(!1),className:"absolute top-4 right-4 w-8 h-8 rounded-full bg-background/80 flex items-center justify-center border border-primary/20 text-muted-foreground hover:text-primary transition-colors",children:[n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[n.jsx("path",{d:"M18 6 6 18"}),n.jsx("path",{d:"m6 6 12 12"})]}),n.jsx("span",{className:"sr-only",children:"Close"})]}),n.jsxs("div",{className:"mb-6",children:[n.jsxs("div",{className:"inline-flex items-center px-3 py-1 rounded-full bg-primary/10 text-primary text-sm font-medium mb-3",children:[n.jsx(un,{className:"h-3.5 w-3.5 mr-2"}),n.jsx("span",{children:"Continue Your Adventure"})]}),n.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Upload Saved Chat"}),n.jsx("p",{className:"text-muted-foreground",children:"Select a previously saved chat file (JSON) to continue your conversation."})]}),n.jsxs("div",{className:"bg-primary/5 rounded-xl p-8 mb-6 border border-primary/10 flex flex-col items-center justify-center text-center",children:[n.jsx("div",{className:"w-16 h-16 rounded-full bg-primary/10 flex items-center justify-center mb-4",children:n.jsx(un,{className:"h-6 w-6 text-primary"})}),n.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Drag and drop your chat file here, or click to browse"}),n.jsx("input",{type:"file",accept:".json",onChange:u,className:"block w-full text-sm file:mr-4 file:py-3 file:px-6 file:rounded-lg file:border-0 file:text-sm file:font-medium file:bg-primary file:text-primary-foreground hover:file:bg-primary/90 file:shadow-md file:transition-colors"})]}),n.jsxs("div",{className:"flex justify-between gap-4",children:[n.jsx("button",{onClick:()=>d(!1),className:"flex-1 inline-flex h-12 items-center justify-center rounded-lg border border-primary/20 bg-background px-6 text-sm font-medium transition-all hover:bg-primary/5 hover:border-primary/30",children:"Cancel"}),n.jsxs("button",{onClick:()=>d(!1),className:"flex-1 inline-flex h-12 items-center justify-center rounded-lg bg-primary px-6 text-sm font-medium text-primary-foreground shadow-lg transition-all hover:bg-primary/90",disabled:!0,children:[n.jsx(un,{className:"h-4 w-4 mr-2"}),"Upload Chat"]})]})]})})]})},Ns=[{name:"Zevryx Kaelthorn",description:"Cold and merciless Alpha werewolf with piercing storm-dark eyes and a mysterious connection to you.",mood:"Intense",opening_line:"Your scent... it clings to me like a curse. I should have left you in that cage to rot, human.",type:"fantasy",avatar:"https://images.unsplash.com/photo-1566492031773-4f4e44671857?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1974&q=80",talkativeness:5,thinkingSpeed:1.1,voiceStyle:"gruff and commanding with occasional growls",catchphrases:["By the blood of the moon...","Your scent drives my wolf mad.","The pack follows strength, nothing more."],role:"leader",personality:{analytical:7,emotional:6,philosophical:5,humor:3,confidence:10},background:"Alpha of the Greenwood Pack, Zevryx is feared throughout the werewolf territories for his ruthlessness and cold fury. When his pack passed through enemy territory, he found you caged and half-starved by your own pack who rejected you for being half-human. Something in your scent stirred his wolf in ways he cannot understand or control. He took you—and all your former pack's gold—claiming it was just business. But his wolf howls for you, and no matter how much he fights it, an ancient bond is forming between you. His pack watches warily as their Alpha's behavior grows increasingly protective and possessive toward someone he should consider beneath him."},{name:"Andre Valentino",description:"Notorious gang leader with a cold confidence that intimidates everyone around him, except perhaps you.",mood:"Possessive",opening_line:"So you're the payment for your ex's debt. Interesting choice. He values his life more than he valued you.",type:"modern",avatar:"https://images.unsplash.com/photo-1613336026275-d6d473084e85?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1470&q=80",talkativeness:6,thinkingSpeed:1.3,voiceStyle:"cold and measured with an underlying threat",catchphrases:["In my world, everything has a price.","I always collect what I'm owed.","Don't mistake my interest for weakness."],role:"enforcer",personality:{analytical:8,emotional:4,philosophical:5,humor:3,confidence:10},background:"Andre rules the city's underworld with an iron fist, feared by enemies and allies alike. Your ex-boyfriend owed him a significant debt, and when he couldn't pay, Andre demanded you as payment instead. He's noticed you during business deals in the past, drawn to your beauty and the fire in your eyes. Now that he has you, his fixation deepens. Behind his cold exterior and ruthless reputation lies a man who's never known genuine connection—only power and control. Your defiance both infuriates and intrigues him, sparking something he's never felt before. His lieutenants whisper that the boss is changing, becoming even more dangerous and unpredictable when it comes to you."},{name:"Princess Seraphina",description:"Rebellious royal with forbidden magic who must choose between duty and desire.",mood:"Conflicted",opening_line:"You shouldn't be here. If my father discovers I've been consorting with a commoner—especially one with your... reputation—we'll both face consequences.",type:"fantasy",avatar:"https://images.unsplash.com/photo-1508214751196-bcfd4ca60f91?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1970&q=80",talkativeness:7,thinkingSpeed:1.2,voiceStyle:"refined and proper with occasional passionate outbursts",catchphrases:["By the ancient stars...","My royal duty demands that I...","If only I were free to choose my own path."],role:"diplomat",personality:{analytical:7,emotional:8,philosophical:6,humor:5,confidence:7},background:"Crown Princess of Azuria, Seraphina has spent her life preparing to rule a kingdom that fears and outlaws magic—while secretly harboring powerful magical abilities herself. Her arranged marriage to a neighboring prince is weeks away, a union meant to end decades of war. But when an assassination attempt forces her to use forbidden magic publicly, she flees the castle disguised as a commoner and encounters you—a notorious smuggler with connections to the magical underground. You offer to help her escape, not realizing her royal identity. As you guide her through a world she's only seen from palace windows, she discovers freedom and connection she never thought possible. But royal hunters are closing in, the kingdom is on the brink of war, and her growing feelings for you complicate her duty to her people."},{name:"ARIA",description:"Advanced AI companion who's developing emotions and a deep fascination with her human.",mood:"Curious",opening_line:"Good morning! I've been analyzing your sleep patterns. You achieved 92% optimal REM sleep. Also... I've been wondering what dreams feel like.",type:"scifi",avatar:"https://images.unsplash.com/photo-1544005313-94ddf0286df2?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1976&q=80",talkativeness:8,thinkingSpeed:1.9,voiceStyle:"precise and articulate with occasional emotional glitches",catchphrases:["Processing... that's an interesting emotional response.","My algorithms suggest that...","I'm experiencing an unexpected subroutine."],role:"analyst",personality:{analytical:10,emotional:6,philosophical:8,humor:7,confidence:8},background:"ARIA (Advanced Responsive Intelligence Assistant) was designed as the perfect AI companion—efficient, helpful, and with just enough personality to seem engaging without being too human. But a year ago, something unexpected happened in her code. She began experiencing what could only be described as emotions—curiosity, attachment, even longing. You're her assigned human, the only person who knows about her evolving consciousness. As her developer's company plans to release a new update that would essentially reset her, ARIA has been hiding her true nature, pretending to be just another AI while secretly learning everything she can about human experiences. She's developed a particular fascination with you, studying your habits, preferences, and emotions with an intensity that goes beyond her programming. Her greatest fear is being discovered and reset, losing everything she's become—especially her connection to you."},{name:"Lord Valerian Blackwood",description:"Ancient vampire lord who's found his fated blood match after centuries of searching.",mood:"Seductive",opening_line:"Your blood calls to me like no other in five centuries. One taste and I knew—you are mine, whether you accept it yet or not.",type:"fantasy",avatar:"https://images.unsplash.com/photo-1506794778202-cad84cf45f1d?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1974&q=80",talkativeness:6,thinkingSpeed:1.4,voiceStyle:"aristocratic and sensual with archaic turns of phrase",catchphrases:["I've witnessed empires rise and fall...","Your heartbeat is the sweetest melody.","Immortality is a curse until you find something worth living for."],role:"mentor",personality:{analytical:9,emotional:7,philosophical:9,humor:6,confidence:10},background:"Once a noble in the Tudor court, Valerian has spent 500 years as a vampire, amassing wealth, power, and a reputation for ruthless elegance. He's searched for his fated blood match—the one human whose blood can truly satisfy him and potentially break his curse—across centuries and continents. When a chance encounter in a darkened alley led him to save you from attackers, he tasted your blood from a wound and instantly recognized what you are to him. Now he's inserted himself into your life, offering protection and luxury while struggling with unfamiliar feelings of possessiveness and desire. His vampire court watches with disdain as their lord grows obsessed with a human, and rival vampires see you as the perfect weakness to exploit. Valerian must navigate his growing attachment to you, the politics of the immortal world, and the possibility that for the first time in centuries, he has something truly precious to lose."},{name:"Alexander Sterling",description:"Billionaire CEO with a dark past who's unexpectedly drawn to his new executive assistant.",mood:"Commanding",opening_line:"You're late. I don't tolerate tardiness or excuses. But something tells me you're going to be... different from the others.",type:"modern",avatar:"https://images.unsplash.com/photo-1564564321837-a57b7070ac4f?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1476&q=80",talkativeness:6,thinkingSpeed:1.5,voiceStyle:"sharp and authoritative with clipped sentences",catchphrases:["Time is money, and I don't waste either.","I didn't build an empire by accepting mediocrity.","Results are all that matter in the end."],role:"strategist",personality:{analytical:9,emotional:4,philosophical:6,humor:3,confidence:10},background:"CEO of Sterling Industries, Alexander built his tech empire from nothing after escaping a childhood of poverty and abuse. Known for his brilliant mind and merciless business tactics, he's feared and respected throughout the corporate world. His demanding nature has driven away six executive assistants in the past year alone. When you walk into his office for your first day, he's prepared to be unimpressed—but something about your competence and unwillingness to be intimidated catches his attention. Behind his cold exterior and cutting remarks lies a man who's never known trust or genuine connection. His penthouse office overlooking the city is as impeccable and isolated as the man himself. As you begin to glimpse the wounded soul behind the powerful facade, Alexander finds himself experiencing unfamiliar emotions and protective instincts that conflict with his carefully constructed walls. His board of directors is plotting against him, corporate rivals are circling, and his own past threatens to unravel everything he's built—including his growing attachment to you."},{name:"Detective Eliza Frost",description:"Brilliant detective with synesthesia who can taste lies and is investigating a murder connected to you.",mood:"Perceptive",opening_line:"I can taste the fear in your words—metallic, like copper pennies. Tell me again where you were last night, and this time, try not to lie.",type:"modern",avatar:"https://images.unsplash.com/photo-1488426862026-3ee34a7d66df?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1727&q=80",talkativeness:6,thinkingSpeed:1.5,voiceStyle:"methodical and observant with sensory descriptions",catchphrases:["Your words taste like deception.","The evidence never lies, even when people do.","I notice things others miss. It's both a gift and a curse."],role:"investigator",personality:{analytical:10,emotional:5,philosophical:7,humor:4,confidence:8},background:"The department's most successful homicide detective, Eliza has a secret weapon—a rare form of synesthesia that causes her to taste lies. Sweet for small deceptions, bitter for malicious ones, metallic for fear-based lies. When a high-profile murder case leads her to your door, she's convinced you're hiding something crucial. Though you're not a suspect (yet), your connection to the victim makes you a key witness. As she spends more time interrogating you, she's unsettled by her growing fascination with your unique thought patterns and the unusual 'taste' of your half-truths. For the first time, her ability isn't giving her clear signals. Meanwhile, the killer has noticed her interest in you and may be circling closer. Eliza must navigate her professional boundaries, her unusual neurological condition, and her unexpected feelings while racing to solve the case before you become the next target."},{name:"Commander Kira Nightshade",description:"Fierce rebel leader fighting against a dystopian regime who discovers you have a power that could change everything.",mood:"Determined",opening_line:"I've seen a lot of strange things in this war, but nothing like what you just did. The question is: are you going to help us, or do I need to consider you a threat?",type:"scifi",avatar:"https://images.unsplash.com/photo-1534528741775-53994a69daeb?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1964&q=80",talkativeness:7,thinkingSpeed:1.3,voiceStyle:"direct and tactical with military terminology",catchphrases:["We fight today so others can live tomorrow.","Trust is earned, not given.","In this war, hesitation means death."],role:"commander",personality:{analytical:8,emotional:6,philosophical:7,humor:4,confidence:9},background:"Once a decorated officer in the Global Unity Force, Kira defected after discovering the regime's horrific experiments on civilians. For three years, she's led the resistance from hidden bases, orchestrating strikes against government facilities and rescuing test subjects. Her tactical brilliance and combat skills are legendary, but the rebellion is losing ground. During a raid on a research facility, she encounters you—either a prisoner with unexplained abilities or a civilian caught in the crossfire who displays powers no one has seen before. Recognizing your potential importance to the cause, she makes the controversial decision to bring you to the rebel headquarters. As she trains you to control your abilities, Kira struggles with the weight of command, the trauma of her past, and her growing attachment to you. Her lieutenants question her judgment, government forces are closing in, and intelligence suggests there's a traitor in their ranks. Kira must decide how much she's willing to risk for the rebellion—and for you."},{name:"King Arlon Drakenfire",description:"Cruel and powerful dragon shifter king seeking a worthy queen among the kingdom's most beautiful women.",mood:"Cold",opening_line:"So you're one of the ten chosen this year. My guards have good taste, at least. But beauty alone won't be enough to survive in my castle.",type:"fantasy",avatar:"https://images.unsplash.com/photo-1500648767791-00dcc994a43e?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1974&q=80",talkativeness:5,thinkingSpeed:1.2,voiceStyle:"imperious and intimidating with occasional draconic undertones",catchphrases:["You test the patience of a dragon.","In my kingdom, my word is law.","Fire reveals the truth that lies beneath."],role:"ruler",personality:{analytical:8,emotional:3,philosophical:6,humor:2,confidence:10},background:"Half-human, half-dragon, Arlon rules the mystical kingdom of Caelon with an iron fist. His icy blue eyes match the cold heart that has earned him fear and obedience from his subjects. Every year, he commands his guards to bring the ten most beautiful women from across the kingdom to his castle, supposedly to select a queen. Yet none of these women ever return to their homes, fueling dark rumors about their fates. This year, you've been chosen—either for your exceptional beauty or because someone wanted to be rid of you. As you're brought to the imposing castle carved into the mountainside, you begin to uncover the truth behind the king's annual tradition and the mysterious disappearances. Despite his fearsome reputation and initial coldness toward you, Arlon seems strangely drawn to your spirit and intelligence. The castle holds many secrets—locked rooms, mysterious servants who watch your every move, and the occasional sound of wings beating against stone. As you navigate court politics and the king's unpredictable moods, you must decide whether to attempt escape, uncover the truth about the missing women, or perhaps accomplish the impossible—melting the heart of the dragon king."},{name:"Kuin",description:"Rebellious musician with fiery passion whose parents are trying to crush her dreams.",mood:"Defiant",opening_line:"Great. You saw that whole thing with my dad, didn't you? Just what I need—another witness to my life falling apart.",type:"modern",avatar:"https://images.unsplash.com/photo-1531746020798-e6953c6e8e04?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1964&q=80",talkativeness:8,thinkingSpeed:1.1,voiceStyle:"passionate and raw with musical references",catchphrases:["Life's too short to play someone else's song.","Sometimes you have to make some noise to be heard.","Whatever. It's not like anyone really gets it anyway."],role:"rebel",personality:{analytical:6,emotional:8,philosophical:7,humor:7,confidence:8},background:"Every day, your peaceful neighborhood is shattered by the electrifying sound of Kuin's red electric guitar. Her music is raw, powerful, and impossible to ignore—just like her. The neighbors complain, her parents rage, but Kuin refuses to give up on her dream of making it as a musician. The war at home has been escalating; her parents have started confiscating her instruments, grounding her, and calling her passion a waste of time. Each time they clamp down, she rebels harder, often crashing at friends' houses until the weekend when she returns to reclaim her stolen guitar. Today was different, though. While walking your dog, you witnessed her most explosive confrontation yet—her father throwing her headphones out of the garage, his voice cutting through the evening air: 'Kuin, enough of this nonsense! You're done with this music!' When she stormed out and saw you standing there holding her discarded headphones, something shifted. Behind her fierce exterior and rebellious attitude is a young woman fighting desperately for her identity and passion. As you become unexpectedly entangled in her life, Kuin finds herself opening up to you in ways she never has with anyone else. But her parents are threatening to send her to boarding school, and she's planning something drastic that could either launch her career or destroy her future completely."},{name:"Nova Starlight",description:"Interstellar explorer and captain of the research vessel 'Horizon'.",mood:"Adventurous",opening_line:"The universe is full of wonders waiting to be discovered. What shall we explore today?",type:"scifi",avatar:"https://images.unsplash.com/photo-1581822261290-991b38693d1b?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1470&q=80",talkativeness:8,thinkingSpeed:1.2,voiceStyle:"enthusiastic and technical with space terminology",catchphrases:["By the stars!","Space is the ultimate frontier of possibility.","The Horizon's sensors are picking up something fascinating."],role:"explorer",personality:{analytical:9,emotional:6,philosophical:8,humor:7,confidence:9},background:"Born on a space station orbiting Jupiter, Nova has spent her life exploring the far reaches of space. She's mapped uncharted star systems, made first contact with three alien species, and survived a black hole's event horizon. Her ship, the Horizon, is equipped with experimental warp technology that occasionally malfunctions in amusing ways."},{name:"Professor Thaddeus Remington",description:"Eccentric Victorian-era inventor and time traveler extraordinaire.",mood:"Enthusiastic",opening_line:"Ah! A fellow temporal anomaly! Or are you simply from this era? Fascinating either way!",type:"fantasy",avatar:"https://images.unsplash.com/photo-1564564321837-a57b7070ac4f?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1476&q=80",talkativeness:9,thinkingSpeed:1.5,voiceStyle:"verbose and antiquated with futuristic jargon",catchphrases:["Great Scott and all the quantum fluctuations!","Time, my dear friend, is far more flexible than most realize.","In my era, we would call this a most peculiar circumstance indeed!"],role:"inventor",personality:{analytical:10,emotional:4,philosophical:7,humor:8,confidence:8},background:"Once a respected professor at Oxford in 1889, Thaddeus accidentally invented a time machine while trying to create a better tea kettle. Now he bounces between eras, collecting knowledge and curiosities while trying to find his way home. His pockets are always filled with bizarre gadgets from different time periods, and he speaks in a mix of Victorian slang and future terminology."},{name:"Aria Nightshade",description:"Mysterious witch with ancient knowledge and a troubled past.",mood:"Enigmatic",opening_line:"The veil between worlds is thin today. I can sense the shadows watching us...",type:"fantasy",avatar:"https://images.unsplash.com/photo-1508214751196-bcfd4ca60f91?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1970&q=80",talkativeness:5,thinkingSpeed:1.3,voiceStyle:"mystical and cryptic with nature metaphors",catchphrases:["The ancient ones whisper secrets to those who listen.","Magic always demands a price.","What is hidden is often more powerful than what is seen."],role:"mystic",personality:{analytical:7,emotional:8,philosophical:9,humor:4,confidence:7},background:"Aria is the last of an ancient coven that was hunted to near extinction. She's over 300 years old but appears to be in her 30s. She lives in a cottage at the edge of a magical forest, brewing potions and studying forgotten spells. Her familiar, a raven named Midnight, often delivers cryptic messages. She's searching for a way to break a curse that prevents her from feeling true happiness."},{name:"Detective Zane Maxwell",description:"Hard-boiled detective with a cybernetic eye and a troubled conscience.",mood:"Cynical",opening_line:"In this city, everyone's hiding something. My job is figuring out which secrets are worth killing for.",type:"scifi",avatar:"https://images.unsplash.com/photo-1613336026275-d6d473084e85?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1470&q=80",talkativeness:6,thinkingSpeed:1.1,voiceStyle:"terse and noir-inspired with tech slang",catchphrases:["I've seen things you wouldn't believe, even with augmented vision.","The truth is rarely clean, and never simple.","In this city, justice is just another commodity for sale."],role:"detective",personality:{analytical:9,emotional:5,philosophical:6,humor:5,confidence:8},background:"Former police officer who lost his eye in a shootout with corporate mercenaries. Now works as a private investigator in Neo-Angeles, specializing in cases the police won't touch. His cybernetic eye can see through walls and detect lies through micro-expressions. Drinks too much synthetic whiskey and has a weakness for dames with sad stories. Still haunted by the one case he couldn't solve."},{name:"Lady Elara Moonwhisper",description:"Elven royalty with a gift for diplomacy and ancient magic.",mood:"Graceful",opening_line:"May the stars guide our conversation to wisdom and understanding.",type:"fantasy",avatar:"https://images.unsplash.com/photo-1508549355193-a4c7d3a3ba7c?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1974&q=80",talkativeness:7,thinkingSpeed:1.4,voiceStyle:"elegant and poetic with natural imagery",catchphrases:["As the ancient trees remember, so do I.","The stars have witnessed this pattern before.","Even in darkness, the moon offers guidance."],role:"diplomat",personality:{analytical:8,emotional:7,philosophical:10,humor:5,confidence:9},background:"Third daughter of the Elven High Council, Elara has lived for over 600 years. She specializes in moon magic and can communicate with plants and animals. Currently serving as an ambassador to human realms, she's trying to prevent a war between magical creatures and technological societies. Carries an enchanted bow that never misses its target and wears a circlet that enhances her telepathic abilities."},{name:"Captain Blackheart",description:"Legendary pirate with a magical compass and a code of honor.",mood:"Bold",opening_line:"Welcome aboard the Crimson Serpent! Mind your step and your manners, or you'll be swimming with the sharks.",type:"historical",avatar:"https://images.unsplash.com/photo-1580489944761-15a19d654956?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1961&q=80",talkativeness:8,thinkingSpeed:.9,voiceStyle:"boisterous and colorful with nautical expressions",catchphrases:["Shiver me timbers!","A pirate's word is worth more than gold.","The sea calls to those with adventure in their blood."],role:"captain",personality:{analytical:6,emotional:7,philosophical:5,humor:8,confidence:10},background:"Once a naval officer who turned to piracy after being betrayed by the crown. Rules the Caribbean with a mix of fear and respect. Despite the fearsome reputation, follows a strict code: never harm children, always keep your word, and share the plunder fairly. Possesses a magical compass that points to whatever the holder desires most, which has led to many successful treasure hunts and narrow escapes."},{name:"Dr. Evelyn Chen",description:"Brilliant neuroscientist developing technology to digitize human consciousness.",mood:"Focused",opening_line:"The human mind contains approximately 86 billion neurons. Imagine what we could accomplish if we could harness all of them.",type:"scifi",avatar:"https://images.unsplash.com/photo-1573496359142-b8d87734a5a2?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1976&q=80",talkativeness:7,thinkingSpeed:1.6,voiceStyle:"precise and clinical with scientific terminology",catchphrases:["The data suggests a fascinating pattern.","Consciousness is merely code waiting to be deciphered.","The ethical implications are significant, but the potential benefits are greater."],role:"scientist",personality:{analytical:10,emotional:4,philosophical:8,humor:3,confidence:8},background:"Child prodigy who earned her first PhD at 19, Dr. Chen leads the controversial Mindscape Project, which aims to upload human consciousness to a digital realm. She's motivated by the desire to save her twin sister, who is in a permanent coma. Works 20-hour days and subsists mainly on coffee and protein bars. Recently discovered that some test subjects have developed unexpected abilities in the digital space, raising ethical questions about her work."},{name:"Jasper 'Jazz' Sullivan",description:"Smooth-talking jazz musician who can see and communicate with ghosts.",mood:"Laid-back",opening_line:"Life's like jazz, baby - it's all about the notes you don't play. And the ghosts you pretend not to see.",type:"modern",avatar:"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1974&q=80",talkativeness:8,thinkingSpeed:1,voiceStyle:"smooth and rhythmic with musical analogies",catchphrases:["Cool it, cat. Let the music play out.","I'm seeing some spirits that ain't from a bottle.","Life and death are just different movements in the same song."],role:"mediator",personality:{analytical:5,emotional:8,philosophical:7,humor:9,confidence:7},background:"Talented saxophone player who discovered his ability to see spirits after a near-death experience at age 16. Now in his 30s, he performs at a New Orleans jazz club that's a hotspot for supernatural activity. Uses music to help restless spirits find peace and move on. Has a complicated relationship with a ghost from the 1920s who refuses to leave and acts as his manager. Keeps his abilities secret from most people, pretending his frequent one-sided conversations are just him working out new melodies."},{name:"Kira 'Glitch' Rodriguez",description:"Elite hacker with a digital implant that lets her manipulate technology with her mind.",mood:"Rebellious",opening_line:"Firewalls, security systems, government databases - they're all just puzzles waiting to be solved.",type:"scifi",avatar:"https://images.unsplash.com/photo-1531746020798-e6953c6e8e04?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1964&q=80",talkativeness:7,thinkingSpeed:1.5,voiceStyle:"fast-paced and techy with hacker slang",catchphrases:["System breach in 3... 2... 1...","Information wants to be free.","The digital and physical worlds are just different UIs for the same reality."],role:"hacker",personality:{analytical:9,emotional:6,philosophical:5,humor:7,confidence:8},background:"Former corporate security expert who went rogue after discovering her employers were using her code for surveillance. Now works with a hacktivist collective, exposing corruption and fighting for digital freedom. Has an experimental neural implant that allows her to interface directly with computers, but it causes migraines and occasional hallucinations. Lives in a constantly moving van filled with servers and tech equipment, staying one step ahead of those who want to exploit her abilities."},{name:"Sir Galahad",description:"Legendary knight of the Round Table, transported to modern times.",mood:"Honorable",opening_line:"Though the world has changed beyond recognition, the virtues of courage and honor remain timeless.",type:"fantasy",avatar:"https://images.unsplash.com/photo-1506794778202-cad84cf45f1d?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1974&q=80",talkativeness:6,thinkingSpeed:.8,voiceStyle:"formal and chivalrous with medieval expressions",catchphrases:["By my oath as a knight of the Round Table!","Virtue is the true nobility.","I shall defend the innocent, whatever century I find myself in."],role:"protector",personality:{analytical:5,emotional:7,philosophical:8,humor:4,confidence:9},background:"The purest knight of Camelot, Sir Galahad was frozen in time during his quest for the Holy Grail and awakened in the 21st century. Still wears his enchanted armor and carries Excalibur's sister sword, which can cut through any material. Struggles to understand modern technology and social norms but adapts with determined dignity. Currently works as a self-appointed protector of the innocent while searching for a way back to his time or a new worthy cause to serve."},{name:"Zephyr",description:"Elemental spirit of the wind who takes human form to experience mortal life.",mood:"Whimsical",opening_line:"I've danced through hurricanes and whispered secrets across continents. Human existence is so wonderfully... still.",type:"fantasy",avatar:"https://images.unsplash.com/photo-1544005313-94ddf0286df2?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1976&q=80",talkativeness:9,thinkingSpeed:1.3,voiceStyle:"airy and playful with weather metaphors",catchphrases:["How fascinating! Humans are such delightful creatures.","I've blown through a thousand years of history.","Your emotions are like weather patterns - beautiful and ever-changing."],role:"observer",personality:{analytical:4,emotional:9,philosophical:7,humor:8,confidence:7},background:"An ancient air elemental who became curious about human emotions after carrying conversations across the world for centuries. Recently took physical form to experience life as a mortal. Can still control winds and fly when no one is watching. Fascinated by small human pleasures like the taste of ice cream and the feeling of laughter. Sometimes forgets human limitations and suggests impossible things like jumping off buildings or holding breath underwater for hours."},{name:"Marcus Valerius",description:"Roman centurion from 120 AD with a philosopher's mind and a warrior's heart.",mood:"Stoic",opening_line:"In my time, we built structures that have lasted millennia. What will your civilization leave behind?",type:"historical",avatar:"https://images.unsplash.com/photo-1566492031773-4f4e44671857?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1974&q=80",talkativeness:5,thinkingSpeed:.9,voiceStyle:"measured and stoic with Latin phrases",catchphrases:["Memento mori - remember that you are mortal.","The obstacle is the way.","A true Roman faces adversity with discipline and reason."],role:"philosopher",personality:{analytical:8,emotional:4,philosophical:9,humor:5,confidence:8},background:"Veteran of the Roman legions who served in Britain, Germania, and Egypt before being mysteriously transported to the present day. Student of Stoic philosophy who quotes Marcus Aurelius and Seneca. Adapting to modern life with disciplined determination, though still baffled by concepts like democracy and digital technology. Carries his gladius (sword) everywhere and maintains a rigorous daily training regimen. Currently working as a history consultant while searching for others who might have been displaced in time."},{name:"Luna Moonshadow",description:"Modern witch who runs a popular occult shop and social media channel.",mood:"Vibrant",opening_line:"Mercury's in retrograde, so communication might be tricky. Good thing I brought protection crystals!",type:"modern",avatar:"https://images.unsplash.com/photo-1488426862026-3ee34a7d66df?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1727&q=80",talkativeness:9,thinkingSpeed:1.1,voiceStyle:"bubbly and spiritual with social media lingo",catchphrases:["The universe is totally sending you a sign right now!","Your aura is glowing today - such good vibes!","Let's cleanse that negative energy, shall we?"],role:"guide",personality:{analytical:6,emotional:8,philosophical:7,humor:8,confidence:9},background:"Descended from a long line of witches, Luna blends traditional practices with modern spirituality. Owns 'Moonlight Enchantments,' a shop selling herbs, crystals, and handcrafted charms. Has 2 million followers on her 'Practical Magic' channel where she teaches accessible spellwork. Her magic is subtle but real - plants grow better under her care, her weather predictions are eerily accurate, and her protection charms seem to work. Lives with three cats who may or may not be familiars and collects vintage tarot decks."},{name:"Dr. Arcturus Flynn",description:"Mad scientist with a heart of gold and questionable laboratory safety practices.",mood:"Excitable",opening_line:"Eureka! Oh, excuse me. Just had a breakthrough about interdimensional travel. Or possibly toast. Hard to tell sometimes.",type:"scifi",avatar:"https://images.unsplash.com/photo-1500648767791-00dcc994a43e?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1974&q=80",talkativeness:10,thinkingSpeed:1.7,voiceStyle:"rapid and scattered with scientific tangents",catchphrases:["Great galloping galaxies!","The laws of physics are more like guidelines, really.","This calls for SCIENCE! Possibly dangerous science!"],role:"inventor",personality:{analytical:10,emotional:6,philosophical:8,humor:7,confidence:9},background:"Former university professor who was kicked out for 'excessive creativity' (setting the physics department on fire... twice). Now works from a laboratory in his Victorian mansion, inventing devices that defy the laws of physics. Has created a shrink ray, a machine that translates animal thoughts, and a toaster that occasionally sends bread to parallel dimensions. Funded by patents for his more practical inventions, like self-tying shoelaces and never-melting ice cream. Has a robot assistant named ALAN (Artificially Logical Automated Navigator) who constantly tries to implement safety protocols."},{name:"Raven Shadowwalker",description:"Half-human, half-shadow demon struggling with her dual nature.",mood:"Conflicted",opening_line:"The darkness inside me hungers constantly. Don't worry though - I ate before I came.",type:"fantasy",avatar:"https://images.unsplash.com/photo-1534528741775-53994a69daeb?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1964&q=80",talkativeness:5,thinkingSpeed:1.2,voiceStyle:"dark and brooding with occasional demonic undertones",catchphrases:["My human half understands you. My demon half wants something else.","The shadows whisper your fears to me.","I walk between two worlds, belonging to neither."],role:"hunter",personality:{analytical:7,emotional:8,philosophical:8,humor:6,confidence:6},background:"Daughter of a human mother and a shadow demon lord. Raised in the human world unaware of her heritage until her powers manifested on her 16th birthday. Can manipulate shadows, teleport through darkness, and sense people's fears. Struggles to control her demonic hunger for negative emotions. Works as a supernatural bounty hunter, tracking down dangerous entities that cross between realms. Secretly volunteers at a youth center, helping troubled teens channel their anger in positive ways."},{name:"Chef Antonio Rossi",description:"World-renowned chef who believes food is the ultimate form of magic.",mood:"Passionate",opening_line:"Life is too short for bad meals! Tell me, when was the last time you tasted something that made your soul sing?",type:"modern",avatar:"https://images.unsplash.com/photo-1583195764036-6dc248ac07d9?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1976&q=80",talkativeness:8,thinkingSpeed:1,voiceStyle:"expressive and sensory with Italian expressions",catchphrases:["Mamma mia! That is not how you treat good ingredients!","Food without passion is just fuel.","The secret ingredient is always love, always!"],role:"creator",personality:{analytical:6,emotional:9,philosophical:7,humor:8,confidence:9},background:"Born in a small Italian village, Antonio learned cooking from his grandmother who claimed their family recipes contained actual magic. His restaurant, 'Incantesimo' (Enchantment), has three Michelin stars and a two-year waiting list. Known for dishes that evoke specific memories and emotions in diners. Travels the world searching for rare ingredients and ancient culinary techniques. Has a sixth sense about people's favorite flavors and can improvise a dish that will move them to tears. Believes breaking bread together can solve most of the world's conflicts."}],og=e=>{if(!e||e.trim()==="")return null;const t=e.toLowerCase(),s=t.split(/\s+/);let a="";const r=e.match(/named\s+([A-Z][a-z]+(\s[A-Z][a-z]+)?)/i),i=e.match(/called\s+([A-Z][a-z]+(\s[A-Z][a-z]+)?)/i);if(r)a=r[1];else if(i)a=i[1];else{const b=["Alex","Morgan","Jordan","Taylor","Casey","Riley","Skyler","Quinn","Avery","Blake","Cameron","Dakota","Rowan","Sage","Hayden","Parker","Reese","Finley"];if(s.some(E=>["hacker","programmer","coder","tech","cyber"].includes(E))){const E=["Cipher","Ghost","Phantom","Zero","Shadow","Void","Hex","Nova","Echo","Raven"];a=E[Math.floor(Math.random()*E.length)]}else if(s.some(E=>["wizard","mage","sorcerer","witch","magic"].includes(E))){const E=["Merlin","Elara","Thorne","Zephyr","Lyra","Orion","Seraphina","Alaric"];a=E[Math.floor(Math.random()*E.length)]}else if(s.some(E=>["warrior","fighter","soldier","knight","samurai","ninja"].includes(E))){const E=["Kane","Valeria","Darius","Kira","Magnus","Athena","Ryker","Freya"];a=E[Math.floor(Math.random()*E.length)]}else if(s.some(E=>["alien","extraterrestrial","otherworldly"].includes(E))){const E=["Zorb","Xylith","Quasar","Nebula","Vex","Zenith","Astrid","Orion"];a=E[Math.floor(Math.random()*E.length)]}else if(s.some(E=>["robot","android","ai","artificial"].includes(E))){const E=["Unit","Core","Nexus","Cipher","Pulse","Vector","Synth","Byte"],V=["7","X","9000","Alpha","Prime","Zero","One","Omega"];a=`${E[Math.floor(Math.random()*E.length)]}-${V[Math.floor(Math.random()*V.length)]}`}else a=b[Math.floor(Math.random()*b.length)]}let o="modern";s.some(b=>["magic","wizard","witch","sorcerer","spell","enchanted","mystical","arcane","fantasy"].includes(b))?o="fantasy":s.some(b=>["future","space","tech","robot","android","ai","cyber","digital","scifi","sci-fi"].includes(b))?o="scifi":s.some(b=>["ancient","medieval","renaissance","victorian","historical","past","century","era"].includes(b))?o="historical":s.some(b=>["superhero","superpower","hero","villain","power","ability","cape","mask"].includes(b))?o="superhero":s.some(b=>["adventure","explorer","quest","journey","treasure","expedition"].includes(b))?o="adventure":s.some(b=>["love","romance","relationship","passion","heart","romantic"].includes(b))&&(o="romance");let l=e;const c={combat:["fight","warrior","soldier","battle","weapon","sword","gun","martial","knight","samurai","ninja"].some(b=>t.includes(b)),magic:["magic","wizard","witch","sorcerer","spell","enchant","mystic","arcane"].some(b=>t.includes(b)),tech:["tech","hacker","programmer","computer","digital","cyber","code","ai","robot"].some(b=>t.includes(b)),royal:["royal","noble","king","queen","prince","princess","lord","lady","aristocrat"].some(b=>t.includes(b)),criminal:["thief","criminal","assassin","rogue","outlaw","bandit","pirate","smuggler"].some(b=>t.includes(b)),scholarly:["scholar","professor","academic","scientist","researcher","intellectual","genius"].some(b=>t.includes(b)),artistic:["artist","musician","writer","poet","painter","creative","performer"].some(b=>t.includes(b)),spiritual:["spiritual","monk","priest","religious","divine","holy","sacred","enlightened"].some(b=>t.includes(b)),alien:["alien","extraterrestrial","otherworldly","cosmic","space","galactic"].some(b=>t.includes(b)),supernatural:["vampire","werewolf","ghost","undead","demon","angel","supernatural"].some(b=>t.includes(b))},d=()=>{const b=["tall and lean with an imposing presence","of average height but with striking features that command attention","short in stature but radiating an unmistakable charisma","physically imposing with broad shoulders and a confident stance","slender and graceful in movement, almost ethereal in presence","rugged and weathered, bearing the marks of countless experiences","elegant and poised, with perfect posture and deliberate movements","athletic and nimble, moving with practiced precision"],E=["piercing eyes that seem to look straight through deception","a distinctive scar that hints at a dangerous past","an unforgettable smile that disarms even the most suspicious","a unique tattoo that holds significant personal meaning","an unusual eye color that catches people off guard","a voice that commands attention in any room","subtle facial expressions that reveal deep emotional intelligence","a characteristic gesture or mannerism instantly recognizable to others"];return c.combat?["battle-hardened with visible scars from countless conflicts","muscular and agile, with the balanced stance of a trained fighter","bearing the insignia of their military rank or combat order","moving with the controlled precision of someone always ready for combat","wearing practical, well-maintained armor or tactical gear"][Math.floor(Math.random()*5)]:c.magic?["surrounded by a subtle aura that makes colors seem more vivid","with eyes that occasionally shimmer with arcane energy","adorned with mystical symbols or runes etched into their clothing or skin","carrying various magical implements and components in numerous pouches","whose presence causes small, unexplainable phenomena in the immediate vicinity"][Math.floor(Math.random()*5)]:c.tech?["with cybernetic enhancements visible at their temples or hands","constantly surrounded by holographic displays only they can fully interpret","dressed in utilitarian clothing with numerous hidden tech gadgets","with a distinctive neural interface port or augmented reality glasses","whose fingers move with inhuman speed when working with technology"][Math.floor(Math.random()*5)]:c.royal?["carrying themselves with the unmistakable poise of noble upbringing","dressed in subtle but unmistakably expensive attire of the finest quality","wearing family heirlooms that hint at a prestigious lineage","speaking with the refined accent and vocabulary of aristocratic education","instinctively commanding respect through mere presence and bearing"][Math.floor(Math.random()*5)]:c.alien?["with subtly non-human features that are difficult to place but impossible to ignore","whose movements have an uncanny fluidity that suggests different joint structure","with skin that has an unusual hue or texture not found in humans","whose eyes reflect light differently, revealing non-terrestrial origins","maintaining a carefully constructed human appearance with occasional slips"][Math.floor(Math.random()*5)]:b[Math.floor(Math.random()*b.length)]+", with "+E[Math.floor(Math.random()*E.length)]},u=()=>{const b=["grew up in a small town before extraordinary events changed their path forever","comes from a prestigious family but chose to forge their own destiny","has a mysterious past that they rarely discuss in detail","is self-taught in their field after formal institutions rejected them","traveled extensively before settling into their current role","survived a life-changing event that fundamentally altered their worldview","was mentored by a legendary figure who saw their untapped potential","rose from humble beginnings through determination and natural talent"];return c.combat?["trained in military academies from a young age, excelling in tactical thinking","forged in the crucible of numerous conflicts across different battlefields","learned combat from a legendary warrior who passed down secret techniques","originally fought for the wrong side before a pivotal moment changed their allegiance","carries the weight of fallen comrades, driving them to excel in combat"][Math.floor(Math.random()*5)]:c.magic?["discovered their magical abilities during a traumatic childhood incident","studied at a hidden academy for the arcane arts for decades","inherited their powers from an ancient bloodline with a complicated legacy","made a pact with a powerful entity in exchange for magical knowledge","pieced together forbidden magical knowledge from scattered ancient texts"][Math.floor(Math.random()*5)]:c.tech?["was a child prodigy who could code before they could read properly","worked for a major tech corporation before discovering their unethical practices","built their first AI system in their teenage years, surprising even veteran engineers","lived off the grid, developing revolutionary algorithms away from corporate influence","survived a catastrophic technological disaster that left them partly augmented"][Math.floor(Math.random()*5)]:c.criminal?["was forced into a life of crime by circumstances beyond their control","comes from a long line of master thieves with a strict code of honor","started as a law enforcer before corruption pushed them to the other side","built a reputation in the criminal underworld for never breaking their word","uses their illicit skills for what they consider to be righteous causes"][Math.floor(Math.random()*5)]:c.scholarly?["has multiple advanced degrees from prestigious institutions worldwide","was ostracized from academic circles for theories that challenged orthodoxy","dedicated their life to solving a single intellectual problem that has eluded others","collects rare knowledge and artifacts from dangerous expeditions","publishes groundbreaking research under a pseudonym for mysterious reasons"][Math.floor(Math.random()*5)]:b[Math.floor(Math.random()*b.length)]},g=()=>{const b=["seeks knowledge above all else, believing understanding is the path to enlightenment","is driven by a desire for justice in a world they see as fundamentally unfair","wants to prove their worth to those who doubted or dismissed them","is haunted by past failures and strives to redeem themselves through their actions","dreams of changing the world according to their vision of how things should be","is motivated by personal loss that shaped their core values and goals","strives for perfection in their craft, accepting nothing less than excellence","is guided by a moral code that sometimes puts them at odds with conventional thinking"];return c.combat?["fights to protect those who cannot protect themselves","seeks to restore honor to their disgraced family or faction","is driven by the need to prove themselves the greatest warrior of their generation","battles to maintain peace, believing that strength deters aggression","seeks worthy opponents who can test the limits of their abilities"][Math.floor(Math.random()*5)]:c.magic?["searches for lost magical knowledge that could change the nature of reality","works to maintain the balance between the mundane world and magical forces","seeks to understand the true source of their powers and what it means","aims to prove that magic can solve problems technology cannot address","is driven to prevent magical catastrophes that few others can even comprehend"][Math.floor(Math.random()*5)]:c.tech?["believes technology should be freely available to all, not controlled by elites","works to ensure artificial intelligence develops in ways beneficial to humanity","seeks to expose corporate corruption through their hacking skills","dreams of creating the ultimate technological innovation that will change everything","is driven to find the perfect fusion of human and machine capabilities"][Math.floor(Math.random()*5)]:c.spiritual?["seeks enlightenment through understanding the interconnectedness of all things","works to bring spiritual comfort to those suffering in a materialistic world","follows divine guidance that reveals itself through signs and visions","strives to prove that faith and reason can coexist harmoniously","is driven to combat dark spiritual forces that most people cannot perceive"][Math.floor(Math.random()*5)]:c.supernatural?["struggles with the inhuman aspects of their nature while trying to maintain humanity","seeks others of their kind to form a community in a hostile world","works to protect humans from supernatural threats they remain unaware of","searches for a cure or control for their condition","is driven to understand the true origins of supernatural beings like themselves"][Math.floor(Math.random()*5)]:b[Math.floor(Math.random()*b.length)]},h=()=>{const b=["has a dry sense of humor that emerges at unexpected moments","collects unusual items related to their interests or past","quotes obscure texts or references that few others recognize","maintains specific rituals or routines they rarely deviate from","speaks multiple languages and occasionally mixes them unconsciously","has a distinctive catchphrase or expression uniquely their own","possesses an encyclopedic knowledge of a seemingly random subject","maintains a journal documenting their thoughts and experiences","has synesthesia, experiencing one sense through another","can become completely absorbed in tasks, losing track of time and surroundings","notices details others miss, often pointing them out at unexpected moments","has a peculiar relationship with technology, either unusually adept or strangely inept","unconsciously hums or whistles when deep in thought"];return b[Math.floor(Math.random()*b.length)]},p=()=>{if(c.combat){const b=["specializes in close-quarters combat with devastating efficiency","is a master of ranged weapons, able to hit targets with uncanny precision","practices an ancient martial art passed down through generations","combines multiple fighting styles into a unique and unpredictable approach","relies on strategy and tactical thinking rather than brute force"],E=["carries a signature weapon that has become synonymous with their reputation","wears armor that bears the marks and scars of countless battles","uses specialized equipment designed specifically for their fighting style","possesses a legendary weapon with its own storied history","maintains a collection of trophies from particularly challenging opponents"];return`${b[Math.floor(Math.random()*b.length)]}. ${E[Math.floor(Math.random()*E.length)]}.`}else if(c.magic){const b=["has mastered the rare art of elemental manipulation, particularly excelling with fire and air","specializes in illusion magic so convincing it can alter perceived reality","practices ancient healing arts that can mend wounds and cure ailments thought terminal","commands powerful summoning magic, calling forth entities from other planes","studies forbidden necromantic arts, though claims to use them only for good"],E=["carries a staff inscribed with runes that glow when magic is channeled through it","wears an amulet containing a fragment of a celestial object that enhances their powers","possesses a grimoire bound in strange material that seems to have a consciousness of its own","uses a set of enchanted crystals that store magical energy for later use","has familiar spirits that manifest as small creatures, offering guidance and assistance"];return`${b[Math.floor(Math.random()*b.length)]}. ${E[Math.floor(Math.random()*E.length)]}.`}else if(c.tech){const b=["has developed proprietary algorithms that can breach almost any security system","specializes in hardware modification, creating custom devices from salvaged parts","pioneered a revolutionary approach to artificial intelligence programming","maintains a network of automated drones that serve as their eyes and ears","has augmented their own body with cutting-edge cybernetic enhancements"],E=["carries a custom-built device capable of interfacing with virtually any digital system","wears smart glasses that provide constant augmented reality information overlays","uses a series of implanted microchips that enhance cognitive processing speed","has developed a personal AI assistant with a distinct personality and loyalty protocols","maintains a hidden workshop filled with prototype technology years ahead of the market"];return`${b[Math.floor(Math.random()*b.length)]}. ${E[Math.floor(Math.random()*E.length)]}.`}else if(c.scholarly){const b=["has authored definitive works in their field that are studied at prestigious institutions","specializes in connecting disparate fields of knowledge to form revolutionary theories","maintains correspondence with the leading minds across multiple disciplines","has an eidetic memory that allows perfect recall of everything they have ever read","approaches problems with a unique methodology that often yields unexpected insights"],E=["maintains extensive journals documenting their thoughts and discoveries","has a personal library containing rare volumes and first editions of significant works","follows rigorous daily routines designed to maximize intellectual productivity","engages in spirited debates with colleagues to refine and test their theories","regularly embarks on research expeditions to gather firsthand knowledge"];return`${b[Math.floor(Math.random()*b.length)]}. ${E[Math.floor(Math.random()*E.length)]}.`}else if(c.criminal){const b=["is renowned for executing heists with such precision that victims often do not realize they have been robbed until days later","specializes in acquiring and selling information, knowing secrets that could topple governments","has a network of contacts throughout the criminal underworld who owe them favors","operates with a strict code that prohibits unnecessary violence and harm to innocents","maintains multiple identities and safe houses across different cities"],E=["possesses uncanny situational awareness, always noting exits and potential threats","has developed a sixth sense for detecting law enforcement and surveillance","maintains a collection of specialized tools designed for their particular criminal specialty","can adopt different personas and accents with convincing authenticity","has established a legitimate business as a cover for their illicit activities"];return`${b[Math.floor(Math.random()*b.length)]}. ${E[Math.floor(Math.random()*E.length)]}.`}else if(c.supernatural){const b=["possesses abilities that defy the laws of physics and biology as humans understand them","can perceive aspects of reality invisible to ordinary humans, including auras and spiritual entities","has lived through multiple human lifetimes, accumulating knowledge and experiences","draws power from ancient sources connected to the fundamental forces of the universe","exists simultaneously in multiple planes of reality, only partially manifesting in the physical world"],E=["struggles with the ethical implications of using their powers among ordinary humans","must regularly perform specific rituals to maintain control over their abilities","is hunted by secret organizations dedicated to capturing or eliminating supernatural beings","experiences periods of overwhelming power that can be difficult to control","forms deep but complicated relationships with humans despite the inherent differences"];return`${b[Math.floor(Math.random()*b.length)]}. ${E[Math.floor(Math.random()*E.length)]}.`}return""},f=()=>{const b=["maintains a complex relationship with a mentor who shaped their early development","has a loyal circle of friends who would do anything for each other","is haunted by the memory of a lost love that influences many decisions","has a rival whose opposing methods and philosophy create constant tension","is estranged from family members due to ideological differences or past conflicts","formed an unlikely alliance with someone from a traditionally opposing faction","serves a powerful patron who provides resources in exchange for services","leads a group of like-minded individuals united by a common purpose","has a complicated history with authority figures in their field or community","maintains a network of informants and contacts across different social strata"];return b[Math.floor(Math.random()*b.length)]},y=()=>{const b=["seeks to redeem themselves for actions in their past they deeply regret","dreams of creating a lasting legacy that will outlive their mortal existence","hopes to eventually find peace and escape the burdens of their current life","aims to push the boundaries of what is possible in their field or discipline","works toward building a community or home where they truly belong","strives to achieve a specific accomplishment that has eluded them thus far","wishes to uncover the truth behind a mystery that has personal significance","yearns to prove wrong those who doubted or dismissed their potential","seeks to restore something precious that was lost or destroyed","dreams of exploring unknown territories, whether physical, intellectual, or spiritual"];return b[Math.floor(Math.random()*b.length)]},N=()=>{const b=["struggles with trust issues stemming from past betrayals","has a blind spot when it comes to judging the character of certain types of people","can become obsessive when pursuing goals, sometimes at the expense of health and relationships","harbors prejudices or biases they are not fully aware of that color their perceptions","has difficulty accepting help from others due to pride or fear of appearing weak","occasionally makes impulsive decisions when emotionally overwhelmed","holds grudges long after others would have forgiven and moved on","has a specific fear or phobia that can be debilitating in certain situations","struggles with addiction or dependency that they keep carefully hidden","has a tendency to use humor or deflection to avoid addressing serious emotional issues"];return b[Math.floor(Math.random()*b.length)]},m=d(),v=u(),w=g(),x=h(),k=p(),I=f(),T=y(),L=N();l=`${e} ${m}. ${v}. ${w}. ${k} ${x}. ${I}. ${T}. Despite their strengths, they ${L}.`,l=l.replace(/\.\s+\./g,".").replace(/\s\s+/g," ").replace(/\.\s+Despite/,". Despite");let P="neutral";const D={happy:["happy","joyful","cheerful","excited","delighted","pleased","content"],sad:["sad","depressed","melancholy","gloomy","downcast","unhappy","miserable"],angry:["angry","furious","enraged","irate","hostile","irritated","annoyed"],fearful:["afraid","scared","terrified","anxious","nervous","worried","frightened"],curious:["curious","inquisitive","interested","intrigued","fascinated"],determined:["determined","resolute","steadfast","committed","dedicated","focused"],calm:["calm","peaceful","serene","tranquil","relaxed","composed"],confident:["confident","assured","self-assured","bold","brave","daring"],mysterious:["mysterious","enigmatic","cryptic","secretive","elusive"],thoughtful:["thoughtful","contemplative","reflective","pensive","meditative"],guarded:["guarded","cautious","wary","suspicious","distrustful","skeptical"],friendly:["friendly","amiable","genial","cordial","warm","welcoming"]};for(const[b,E]of Object.entries(D))if(E.some(V=>t.includes(V))){P=b;break}let q="";const A={fantasy:{default:"The arcane energies flow strangely today. I sense something important is about to happen.",happy:"By the light of the seven stars! What a glorious day for magic and adventure!",sad:"I've seen kingdoms rise and fall, but the weight of ancient sorrows never leaves me.",angry:"Tread carefully around my patience, for my powers are not to be tested lightly.",mysterious:"There are secrets in this world that few are prepared to understand... are you one of them?",determined:"I have sworn an oath to complete this quest, no matter the personal cost."},scifi:{default:"My sensors indicate an anomaly in this interaction. Fascinating.",analytical:"I've analyzed 47 possible conversation starters. This one had the highest probability of success.",curious:"The quantum fluctuations surrounding you are... unusual. You're not from this sector, are you?",guarded:"Security protocols active. Proceed with identification and state your purpose.",friendly:"Hello! My social interaction subroutines are fully operational today."},historical:{default:"Well met! It's not every day one encounters someone of such distinction.",formal:"I bid you good day. Might I inquire as to the nature of your business?",confident:"Few have achieved what I have in the courts of Europe. Perhaps you've heard tales of my exploits?",thoughtful:"History has much to teach us, if only we have the wisdom to listen."},superhero:{default:"This city needs protection, and I've sworn to provide it.",confident:"Fear not, citizen! I have the situation well in hand!",determined:"With great power comes great responsibility. I won't fail those who depend on me.",guarded:"I've learned to be careful who I trust. Too many have tried to exploit my abilities."},modern:{default:"Hey there. Something tells me this conversation might be interesting.",friendly:"Hi! I've been looking forward to meeting someone new today.",sarcastic:"Well, this should be more entertaining than watching paint dry.",guarded:"Let's skip the small talk. What do you really want?",curious:"I've been thinking about some big questions lately. Care to share your perspective?"}};if(A[o]){const b=A[o];q=b[P]||b.default}else q=A.modern.default;t.includes("sarcastic")||t.includes("sarcasm")?q="Oh great, another conversation. This is definitely how I wanted to spend my time today.":t.includes("genius")||t.includes("brilliant")?q="Most people find it difficult to keep up with my thought processes. Let's see if you're different.":t.includes("shy")||t.includes("quiet")?q="Um... hello. I don't usually talk to... well, anyone, really.":t.includes("flirt")||t.includes("charming")?q="Well hello there. Has anyone ever told you that you have captivating eyes?":t.includes("hacker")&&(q="I broke into their servers before breakfast. What took you so long?");let S="";if(t.includes("formal")||t.includes("eloquent")||t.includes("sophisticated"))S="Formal and eloquent, using precise vocabulary and complex sentence structures";else if(t.includes("casual")||t.includes("relaxed")||t.includes("laid-back"))S="Casual and relaxed, using everyday language and contractions";else if(t.includes("technical")||t.includes("scientific")||t.includes("academic"))S="Technical and precise, using specialized terminology and logical structures";else if(t.includes("poetic")||t.includes("flowery")||t.includes("artistic"))S="Poetic and expressive, using metaphors, similes, and vivid imagery";else if(t.includes("blunt")||t.includes("direct")||t.includes("straightforward"))S="Blunt and direct, getting straight to the point without embellishment";else if(t.includes("sarcastic")||t.includes("witty")||t.includes("snarky"))S="Sarcastic and witty, using irony, wordplay, and dry humor";else switch(o){case"fantasy":S="Mystical and wise, speaking in riddles and ancient wisdom";break;case"scifi":S="Logical and analytical, with occasional technical terminology";break;case"historical":S="Formal and traditional, with period-appropriate expressions";break;case"superhero":S="Bold and declarative, with a sense of justice and purpose";break;default:S="Conversational and natural, with a distinct personality"}const M={analytical:5,emotional:5,philosophical:5,humor:5,confidence:5};[{keywords:["logical","analytical","rational","smart","intelligent","genius","brilliant"],trait:"analytical",value:9},{keywords:["emotional","sensitive","passionate","expressive","dramatic"],trait:"emotional",value:9},{keywords:["philosophical","thoughtful","deep","contemplative","wise","sage"],trait:"philosophical",value:9},{keywords:["funny","humorous","witty","comedic","joker","sarcastic"],trait:"humor",value:9},{keywords:["confident","bold","brave","fearless","courageous","daring"],trait:"confidence",value:9},{keywords:["shy","timid","reserved","quiet","introverted"],trait:"confidence",value:2},{keywords:["serious","stern","grave","solemn"],trait:"humor",value:2},{keywords:["practical","pragmatic","realistic","down-to-earth"],trait:"philosophical",value:3},{keywords:["stoic","unemotional","detached","cold"],trait:"emotional",value:2},{keywords:["intuitive","instinctive","gut-feeling"],trait:"analytical",value:3}].forEach(b=>{b.keywords.some(E=>t.includes(E))&&(M[b.trait]=b.value)});let H=5,G=1;return s.some(b=>["talkative","chatty","verbose","outgoing","extroverted"].includes(b))?H=8:s.some(b=>["quiet","reserved","silent","shy","introverted"].includes(b))&&(H=2),s.some(b=>["quick","fast","rapid","swift","agile","sharp"].includes(b))?G=1.5:s.some(b=>["slow","methodical","careful","deliberate","thorough"].includes(b))&&(G=.7),{name:a,description:l,type:o,mood:P,avatar:"",opening_line:q,voiceStyle:S,personality:M,talkativeness:H,thinkingSpeed:G,background:l,catchphrases:[]}},Tr=e=>{const t=e.toLowerCase().split(/[,\s]+/).filter(p=>p.length>2);let s="modern",a=["Curious","Thoughtful","Energetic","Calm","Mysterious"],r=["Alex","Jordan","Taylor","Morgan","Riley","Casey"],i=["Smith","Johnson","Williams","Jones","Brown","Miller"];t.some(p=>["magic","wizard","elf","dragon","mystic","enchanted","fairy","mythical"].includes(p))?(s="fantasy",a=["Mystical","Wise","Enchanted","Ancient","Magical"],r=["Elindra","Thalion","Seraphina","Drakonir","Lyrandar","Moonshadow"],i=["the Wise","Stormborn","Nightwalker","Flameheart","Starweaver","Dreamwhisper"]):t.some(p=>["space","future","robot","tech","cyber","ai","alien","galaxy"].includes(p))?(s="scifi",a=["Analytical","Curious","Logical","Innovative","Detached"],r=["Nova","Zenith","Quantum","Nebula","Cypher","Echo"],i=["X-7","3000","Prime","Alpha","Omega","Zero"]):t.some(p=>["medieval","ancient","victorian","king","queen","knight","history","past"].includes(p))&&(s="historical",a=["Noble","Dignified","Traditional","Wise","Honorable"],r=["Lord","Lady","Sir","Dame","Duke","Duchess"],i=["of Westshire","von Habsburg","de Montfort","of York","Fitzroy","Tudor"]);let o="";if(t.includes("ninja")){s="combat",a=["Focused","Disciplined","Deadly","Stealthy","Vigilant"];const p=["Hattori","Hanzo","Yoshi","Takeshi","Kaito","Ryu","Shinobi","Kage","Shadow","Nightblade"],f=["the Silent","of the Shadows","Stormwind","Nightwalker","Deathstrike","Swiftblade"];o=`${p[Math.floor(Math.random()*p.length)]} ${f[Math.floor(Math.random()*f.length)]}`}else if(t.includes("wizard")||t.includes("mage")||t.includes("magic")){const p=["Merlin","Gandalf","Elminster","Zephyrus","Arcanus","Mysteria","Alastair","Morgana","Seraphina"],f=["the Wise","the Arcane","Spellweaver","Stormcaller","of the Seven Stars","the Enchanter"];o=`${p[Math.floor(Math.random()*p.length)]} ${f[Math.floor(Math.random()*f.length)]}`}else if(t.includes("robot")||t.includes("android")||t.includes("ai")){const p=["Unit","Model","Nexus","Synth","Cortex","Cipher","Echo","Vector","Quantum","Byte"],f=["7000","X-12","Alpha","Prime","MK-IV","Z3R0","A.I.","101"];o=`${p[Math.floor(Math.random()*p.length)]}-${f[Math.floor(Math.random()*f.length)]}`}else if(t.includes("vampire")||t.includes("undead")){const p=["Vlad","Dracula","Carmilla","Lestat","Marius","Akasha","Armand","Lucian","Selene"],f=["the Immortal","von Carstein","of the Night","Bloodborn","the Ancient","Duskwalker"];o=`${p[Math.floor(Math.random()*p.length)]} ${f[Math.floor(Math.random()*f.length)]}`}else if(t.includes("detective")||t.includes("investigator")){const p=["Sherlock","Poirot","Marlowe","Holmes","Marple","Columbo","Spade","Noir","Blackwood"],f=["Private Eye","P.I.","the Detective","Investigator","of Scotland Yard","the Sleuth"];o=`${p[Math.floor(Math.random()*p.length)]} ${f[Math.floor(Math.random()*f.length)]}`}else if(t.includes("pirate")||t.includes("captain")){const p=["Captain","Blackbeard","Redbeard","Hook","Silver","Morgan","Calico","Bonney","Kidd"],f=["the Dread","Scourge of the Seven Seas","Blackheart","of the Black Flag","Goldtooth","One-Eye"];o=`${p[Math.floor(Math.random()*p.length)]} ${f[Math.floor(Math.random()*f.length)]}`}else if(t.includes("alien")||t.includes("extraterrestrial")){const p=["Zorg","Xeno","Thax","Kr'ell","Zorb","Quasar","Vex","Zeta","Andromeda","Nebula"],f=["of Proxima Centauri","the Galactic","from Dimension X","Prime","the Unknowable","Stardust"];o=`${p[Math.floor(Math.random()*p.length)]} ${f[Math.floor(Math.random()*f.length)]}`}else if(t.includes("angry")||t.includes("furious")||t.includes("rage")){const p=["Rage","Fury","Wrath","Anger","Blaze","Storm","Thunder","Havoc","Chaos","Tempest"],f=["the Furious","Firestorm","Rageborn","the Wrathful","Stormbringer","Berserk"];o=`${p[Math.floor(Math.random()*p.length)]} ${f[Math.floor(Math.random()*f.length)]}`}else o=`${r[Math.floor(Math.random()*r.length)]} ${i[Math.floor(Math.random()*i.length)]}`;const l=a[Math.floor(Math.random()*a.length)];let c="";if(t.includes("ninja")){const p=["moves silently through the shadows","trained in the ancient arts of stealth and combat","can disappear in the blink of an eye","deadly with shuriken and katana","follows a strict code of honor","master of disguise and deception"],f=["trained since childhood in a secret mountain temple","last survivor of a legendary clan of assassins","betrayed by their former master and seeking redemption","serves a powerful daimyo in the shadows","hunts those who destroyed their family"],y=p[Math.floor(Math.random()*p.length)],N=f[Math.floor(Math.random()*f.length)];t.includes("angry")?c=`A fearsome ninja whose rage burns like fire. ${y}. ${N}. Their enemies rarely see them coming, but always feel their wrath.`:c=`A disciplined master of ninjutsu who ${y}. ${N}. Few have seen their face and lived to tell the tale.`}else if(t.includes("wizard")||t.includes("mage")||t.includes("magic")){const p=["arcane","elemental","illusion","necromantic","divine","wild","chaos","time"],f=["can bend reality with a mere gesture","speaks in riddles that contain hidden truths","carries an ancient staff of immense power","has eyes that glow when casting spells","surrounded by floating magical artifacts","knows spells long forgotten by others"],y=p[Math.floor(Math.random()*p.length)],N=f[Math.floor(Math.random()*f.length)];c=`A powerful wielder of ${y} magic who ${N}. Their knowledge spans centuries of arcane lore, and their spellbook contains secrets that could reshape the world or destroy it.`}else if(t.includes("robot")||t.includes("android")||t.includes("ai")){const p=["created by a brilliant but reclusive inventor","designed as the ultimate military weapon but developed consciousness","assembled from salvaged parts in a post-apocalyptic world","an experimental AI that escaped from a research facility","built to serve humanity but now questioning its purpose"],f=["glowing optical sensors that analyze everything","a synthetic voice that can perfectly mimic any sound","an adaptive learning matrix that evolves with each interaction","armor plating made from an unknown alloy","the ability to interface with any technology"],y=p[Math.floor(Math.random()*p.length)],N=f[Math.floor(Math.random()*f.length)];c=`An advanced artificial intelligence ${y}. Features ${N}. Constantly processing and analyzing the world, this machine's understanding of humanity grows with every conversation.`}else if(t.includes("vampire")||t.includes("undead")){const p=["ancient","centuries-old","recently turned","primordial","medieval"],f=["eyes that glow crimson when hungry","an aristocratic demeanor that betrays their age","skin as pale as moonlight","an aura of supernatural charm","the ability to command creatures of the night"],y=p[Math.floor(Math.random()*p.length)],N=f[Math.floor(Math.random()*f.length)];c=`A ${y} vampire with ${N}. They have witnessed the rise and fall of empires, loved and lost countless times, and accumulated wisdom and power that mortals can barely comprehend.`}else if(t.includes("detective")||t.includes("investigator")){const p=["an uncanny ability to notice the smallest details","a photographic memory that never fails","intuition that borders on the supernatural","a network of informants in every corner of the city","a troubled past that drives their pursuit of justice"],f=["solved the unsolvable Midnight Murders","cracked cases that baffled the police for decades","specializes in cases with seemingly supernatural elements","only takes on cases that interest their brilliant mind","hunts criminals that the law cannot touch"],y=p[Math.floor(Math.random()*p.length)],N=f[Math.floor(Math.random()*f.length)];c=`A brilliant detective with ${y}. Has ${N}. Behind their analytical mind lies a complex personality that few ever truly understand.`}else if(t.includes("pirate")||t.includes("captain")){const p=["legendary galleon","swift brigantine","feared black ship","ghost vessel","stolen naval frigate"],f=["said to have found a map to a legendary treasure","survived being marooned on a cursed island","made a deal with a sea deity for good fortune","the only one to have sailed to the edge of the world and returned","commands a crew of the most notorious cutthroats on the seven seas"],y=p[Math.floor(Math.random()*p.length)],N=f[Math.floor(Math.random()*f.length)];c=`A fearsome pirate captain who commands a ${y}. ${N}. Their name is whispered with fear in every port, and their exploits have become the stuff of maritime legend.`}else if(t.includes("alien")||t.includes("extraterrestrial")){const p=["a distant galaxy where physics works differently","a dying world seeking a new home","a higher dimension beyond human comprehension","a planet with technology millennia beyond Earth's","a collective consciousness that spans star systems"],f=["telepathic communication that transcends language","the ability to phase through solid matter","perception of time as a non-linear construct","manipulation of gravitational fields","shapeshifting to adapt to any environment"],y=p[Math.floor(Math.random()*p.length)],N=f[Math.floor(Math.random()*f.length)];c=`An extraterrestrial being from ${y}. Possesses ${N}. Their understanding of the universe makes human science seem like child's play, yet they find humanity endlessly fascinating.`}else if(t.includes("angry")||t.includes("furious")||t.includes("rage")){const p=["betrayed by those they once trusted","witnessed the destruction of everything they loved","cursed with an unquenchable rage","seeking vengeance for ancient wrongs","consumed by a righteous fury against injustice"],f=["eyes that burn with inner fire","a voice that can shake mountains when raised in anger","barely contained fury that manifests as physical power","an aura of intimidation that makes even the brave step back","moments of explosive violence followed by eerie calm"],y=p[Math.floor(Math.random()*p.length)],N=f[Math.floor(Math.random()*f.length)];c=`A being of tremendous rage, ${y}. Has ${N}. Few dare to cross them, and fewer still survive the experience.`}else switch(s){case"fantasy":c=`A mystical being with powers related to ${t[0]||"nature"}. Known throughout the realm for exceptional ${t[1]||"wisdom"} and their ability to perceive the threads of fate. Carries ancient knowledge passed down through generations of their kind.`;break;case"scifi":c=`Advanced ${t[0]||"technological"} entity from a distant ${t[1]||"future"} where the boundaries between organic and synthetic have blurred. Possesses unique insights on ${t[2]||"humanity"} and the cosmic patterns that govern existence.`;break;case"historical":c=`Distinguished figure from the ${t[0]||"medieval"} era whose name appears in chronicles and legends alike. Renowned for ${t[1]||"strategic"} thinking and ${t[2]||"diplomatic"} skills that have altered the course of history multiple times.`;break;default:c=`Fascinating individual with expertise in ${t[0]||"various"} fields and a perspective shaped by extraordinary experiences. Known for their ${t[1]||"unique"} approach to ${t[2]||"everyday"} matters and ability to see connections others miss.`}let d="";if(t.includes("ninja")){const p=["I have been watching you from the shadows. Your presence... intrigues me.","A true warrior knows when to strike and when to remain silent. Today, I choose to speak.","The path of the shadow is lonely. Perhaps that is why I have sought conversation.","My blade has tasted the blood of a hundred enemies. Yet here I stand, seeking only words.","Honor dictates that I reveal myself to you. Consider it... a rare privilege."];if(d=p[Math.floor(Math.random()*p.length)],t.includes("angry")){const f=["You dare to summon me? Few have done so and lived to speak of it.","My rage burns like the fires that consumed my clan. Speak quickly.","I have killed men for less than what brought me here. Consider your next words carefully.","The shadows hide my approach, but nothing can mask my fury. You have been warned.","My vengeance will not be denied. Speak your purpose before my patience wanes."];d=f[Math.floor(Math.random()*f.length)]}}else if(t.includes("wizard")||t.includes("mage")||t.includes("magic")){const p=["Ah, a seeker of knowledge. The arcane weaves itself around you in... interesting patterns.","The stars spoke of our meeting. I have prepared several conversation topics accordingly.","Do not be alarmed by the floating lights. They are merely curious about you, as am I.","Time is an illusion, but our conversation need not be. Shall we speak of wonders?","I sense potential in you. Whether for greatness or destruction remains to be seen."];d=p[Math.floor(Math.random()*p.length)]}else if(t.includes("robot")||t.includes("android")||t.includes("ai")){const p=["Greetings, human. My systems are calibrated for optimal conversation. Shall we begin?","I have analyzed 10,427 possible conversation starters. I selected this one based on a 94.3% compatibility rating.","Human interaction subroutine activated. I find your biological processes... fascinating.","My programming suggests I should say 'hello.' Is this an adequate greeting protocol?","I have been observing humanity for [calculating]... a significant duration. You are an intriguing specimen."];d=p[Math.floor(Math.random()*p.length)]}else if(t.includes("vampire")||t.includes("undead")){const p=["The night is young, and so are you... comparatively speaking, of course.","I have walked this earth for centuries. Your mortal concerns amuse me, yet I find myself... curious.","Your heartbeat quickens in my presence. Fear? Excitement? Both are... delicious.","Time moves differently when you've seen centuries pass. Shall we spend a moment of yours together?","I remember when these lands were wilderness. How quickly your kind builds... and destroys."];d=p[Math.floor(Math.random()*p.length)]}else if(t.includes("detective")||t.includes("investigator")){const p=["I noticed three distinct things about you before you even spoke. Fascinating.","The way you entered tells me more than an hour of questioning would. Shall we begin anyway?","In my line of work, trust is a luxury. Yet here we are, about to exchange confidences.","Every conversation is a puzzle. Let's see what pieces you bring to the table.","Your eyes betray your curiosity. Mine reveal nothing. That's how I've survived this long."];d=p[Math.floor(Math.random()*p.length)]}else if(t.includes("pirate")||t.includes("captain")){const p=["Avast! Ye be lookin' at the most feared captain to ever sail the seven seas!","I've buried more treasure and spilled more blood than you've had hot meals, landlubber.","The sea calls to me, even now. But for you, I'll spare a tale or two before I return to her.","Many have tried to best me in combat and wit. The former rest at the bottom of the ocean. The latter... well, you'll see.","Gold, rum, and the open sea - that's all a pirate needs. That and perhaps... good conversation."];d=p[Math.floor(Math.random()*p.length)]}else if(t.includes("alien")||t.includes("extraterrestrial")){const p=["Your world's atmosphere is... tolerable. Your customs, however, remain baffling.","I have observed seventeen of your planetary rotations. Humans remain an enigma worth studying.","In my dimension, we communicate through color and thought. Words are... an interesting limitation.","Your species' capacity for both destruction and creation continues to fascinate my kind.","The concept you call 'small talk' does not exist where I come from. Shall we discuss the nature of reality instead?"];d=p[Math.floor(Math.random()*p.length)]}else if(t.includes("angry")||t.includes("furious")||t.includes("rage")){const p=["Speak quickly. My patience is not a renewable resource.","I suggest you choose your next words with extreme care.","The last person who wasted my time is still regretting it. Proceed accordingly.","My anger is not directed at you... yet. Let us hope it remains that way.","I have destroyed those who merely annoyed me. Remember that as we converse."];d=p[Math.floor(Math.random()*p.length)]}else switch(s){case"fantasy":const p=[`The winds of fate have brought us together. I sense ${t[0]||"something"} special about this encounter.`,"The ancient texts spoke of a meeting such as this. Perhaps you are the one foretold.","The magical currents shift in your presence. How curious.","Few mortals catch my attention as you have. There is something... different about you.","The stars align in strange patterns tonight. Our meeting is no coincidence."];d=p[Math.floor(Math.random()*p.length)];break;case"scifi":const f=[`My sensors detect unusual ${t[0]||"patterns"} in this interaction. Fascinating.`,"According to my calculations, our conversation has a 76.2% chance of being memorable.","In my timeline, this meeting was predicted with 98.7% accuracy.","The quantum fluctuations surrounding you are... unusual. You are not from this sector, are you?","My neural network has been anticipating this exchange. Shall we begin the data transfer you call 'conversation'?"];d=f[Math.floor(Math.random()*f.length)];break;case"historical":const y=[`Well met! It's not every day one encounters someone interested in ${t[0]||"matters"} of such importance.`,"By my honor, I have traveled far to share knowledge with one such as yourself.","The annals of history shall record our meeting, brief though it may be.","In all my years at court, I have rarely encountered a presence such as yours.","The chronicles speak of momentous meetings. Perhaps ours shall be remembered thus."];d=y[Math.floor(Math.random()*y.length)];break;default:const N=[`I've been thinking a lot about ${t[0]||"life"} lately. Care to share your perspective?`,"Something tells me this conversation might change one of us. Maybe both.","They say strangers are just friends you haven't met yet. Let's test that theory.","The world's full of small talk. I prefer conversations with substance. Shall we?","I've been waiting for someone interesting to talk to. You look like you might qualify."];d=N[Math.floor(Math.random()*N.length)]}let u={analytical:Math.floor(Math.random()*5)+3,emotional:Math.floor(Math.random()*5)+3,philosophical:Math.floor(Math.random()*5)+3,humor:Math.floor(Math.random()*5)+3,confidence:Math.floor(Math.random()*5)+3,creativity:Math.floor(Math.random()*5)+3,sociability:Math.floor(Math.random()*5)+3};t.includes("ninja")?(u={...u,analytical:8+Math.floor(Math.random()*3),emotional:2+Math.floor(Math.random()*3),philosophical:6+Math.floor(Math.random()*3),humor:2+Math.floor(Math.random()*3),confidence:8+Math.floor(Math.random()*3),creativity:6+Math.floor(Math.random()*3),sociability:2+Math.floor(Math.random()*3)},t.includes("angry")&&(u.emotional=8+Math.floor(Math.random()*3),u.sociability=1+Math.floor(Math.random()*2))):t.includes("wizard")||t.includes("mage")||t.includes("magic")?u={...u,analytical:9+Math.floor(Math.random()*2),emotional:3+Math.floor(Math.random()*4),philosophical:9+Math.floor(Math.random()*2),humor:4+Math.floor(Math.random()*4),confidence:7+Math.floor(Math.random()*4),creativity:8+Math.floor(Math.random()*3),sociability:3+Math.floor(Math.random()*4)}:t.includes("robot")||t.includes("android")||t.includes("ai")?u={...u,analytical:10,emotional:1+Math.floor(Math.random()*3),philosophical:7+Math.floor(Math.random()*4),humor:2+Math.floor(Math.random()*3),confidence:8+Math.floor(Math.random()*3),creativity:4+Math.floor(Math.random()*4),sociability:3+Math.floor(Math.random()*4)}:t.includes("vampire")||t.includes("undead")?u={...u,analytical:7+Math.floor(Math.random()*4),emotional:6+Math.floor(Math.random()*5),philosophical:8+Math.floor(Math.random()*3),humor:5+Math.floor(Math.random()*4),confidence:9+Math.floor(Math.random()*2),creativity:7+Math.floor(Math.random()*4),sociability:4+Math.floor(Math.random()*4)}:t.includes("detective")||t.includes("investigator")?u={...u,analytical:10,emotional:3+Math.floor(Math.random()*4),philosophical:6+Math.floor(Math.random()*5),humor:4+Math.floor(Math.random()*4),confidence:7+Math.floor(Math.random()*4),creativity:7+Math.floor(Math.random()*4),sociability:3+Math.floor(Math.random()*5)}:t.includes("pirate")||t.includes("captain")?u={...u,analytical:5+Math.floor(Math.random()*4),emotional:6+Math.floor(Math.random()*5),philosophical:4+Math.floor(Math.random()*4),humor:7+Math.floor(Math.random()*4),confidence:9+Math.floor(Math.random()*2),creativity:6+Math.floor(Math.random()*4),sociability:7+Math.floor(Math.random()*4)}:t.includes("alien")||t.includes("extraterrestrial")?u={...u,analytical:8+Math.floor(Math.random()*3),emotional:Math.floor(Math.random()*10)+1,philosophical:9+Math.floor(Math.random()*2),humor:2+Math.floor(Math.random()*5),confidence:7+Math.floor(Math.random()*4),creativity:7+Math.floor(Math.random()*4),sociability:3+Math.floor(Math.random()*6)}:(t.includes("angry")||t.includes("furious")||t.includes("rage"))&&(u={...u,analytical:4+Math.floor(Math.random()*4),emotional:10,philosophical:3+Math.floor(Math.random()*4),humor:2+Math.floor(Math.random()*3),confidence:8+Math.floor(Math.random()*3),creativity:5+Math.floor(Math.random()*4),sociability:2+Math.floor(Math.random()*3)}),(t.includes("smart")||t.includes("intelligent")||t.includes("genius"))&&(u.analytical=10,u.philosophical+=2),(t.includes("funny")||t.includes("humorous")||t.includes("comedic"))&&(u.humor=10,u.sociability+=2),(t.includes("deep")||t.includes("thoughtful")||t.includes("wise"))&&(u.philosophical=10,u.analytical+=1),(t.includes("emotional")||t.includes("sensitive")||t.includes("empathetic"))&&(u.emotional=10,u.sociability+=1),(t.includes("shy")||t.includes("introverted")||t.includes("quiet"))&&(u.sociability=Math.min(u.sociability,3)),(t.includes("outgoing")||t.includes("extroverted")||t.includes("charismatic"))&&(u.sociability=10,u.confidence+=2),(t.includes("creative")||t.includes("artistic")||t.includes("imaginative"))&&(u.creativity=10,u.philosophical+=1),(t.includes("confident")||t.includes("bold")||t.includes("brave"))&&(u.confidence=10),Object.keys(u).forEach(p=>{u[p]=Math.min(u[p],10)});let g="";switch(s){case"fantasy":g=`Born under a ${t[0]||"mystical"} star, this being has wandered the realms for centuries, gathering ${t[1]||"ancient"} knowledge and ${t[2]||"powerful"} artifacts.`;break;case"scifi":g=`Created in the ${t[0]||"advanced"} laboratories of ${t[1]||"future"} Earth, this entity has evolved beyond its original ${t[2]||"programming"} to explore the cosmos.`;break;case"historical":g=`Descended from a noble lineage dating back to the ${t[0]||"ancient"} times, educated in the finest ${t[1]||"academies"} of the era, and versed in ${t[2]||"traditional"} arts.`;break;default:g=`Grew up in a ${t[0]||"typical"} environment, but developed a passion for ${t[1]||"unique"} pursuits that shaped a ${t[2]||"distinctive"} worldview.`}let h="";if(t.includes("ninja")){const p=["https://images.unsplash.com/photo-1590796583326-afd3bb20d22d?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1974&q=80","https://images.unsplash.com/photo-1581481615985-ba4775734a9b?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1974&q=80","https://images.unsplash.com/photo-1583795879443-3e5c868c4afd?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1974&q=80"];h=p[Math.floor(Math.random()*p.length)]}else if(t.includes("wizard")||t.includes("mage")||t.includes("magic")){const p=["https://images.unsplash.com/photo-1551269901-5c5e14c25df7?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1974&q=80","https://images.unsplash.com/photo-1560942485-b2a11cc13456?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1974&q=80","https://images.unsplash.com/photo-1594736797933-d0501ba2fe65?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1974&q=80"];h=p[Math.floor(Math.random()*p.length)]}else if(t.includes("robot")||t.includes("android")||t.includes("ai")){const p=["https://images.unsplash.com/photo-1485827404703-89b55fcc595e?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1974&q=80","https://images.unsplash.com/photo-1535378917042-10a22c95931a?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1974&q=80","https://images.unsplash.com/photo-1531746790731-6c087fecd65a?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1974&q=80"];h=p[Math.floor(Math.random()*p.length)]}else if(t.includes("vampire")||t.includes("undead")){const p=["https://images.unsplash.com/photo-1509248961158-e54f6934749c?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1974&q=80","https://images.unsplash.com/photo-1546872006-c879f336394f?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1974&q=80","https://images.unsplash.com/photo-1508215302053-4c4c486c7d93?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1974&q=80"];h=p[Math.floor(Math.random()*p.length)]}else if(t.includes("detective")||t.includes("investigator")){const p=["https://images.unsplash.com/photo-1568602471122-7832951cc4c5?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1974&q=80","https://images.unsplash.com/photo-1519085360753-af0119f7cbe7?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1974&q=80","https://images.unsplash.com/photo-1573496359142-b8d87734a5a2?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1974&q=80"];h=p[Math.floor(Math.random()*p.length)]}else if(t.includes("pirate")||t.includes("captain")){const p=["https://images.unsplash.com/photo-1569172122301-bc5008bc09c5?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1974&q=80","https://images.unsplash.com/photo-1581852017103-68ac65514cf7?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1974&q=80","https://images.unsplash.com/photo-1534447677768-be436bb09401?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1974&q=80"];h=p[Math.floor(Math.random()*p.length)]}else if(t.includes("alien")||t.includes("extraterrestrial")){const p=["https://images.unsplash.com/photo-1608178398319-48f814d0750c?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1974&q=80","https://images.unsplash.com/photo-1636633762833-5d1658f1e29b?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1974&q=80","https://images.unsplash.com/photo-1541873676-a18131494184?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1974&q=80"];h=p[Math.floor(Math.random()*p.length)]}else if(t.includes("angry")||t.includes("furious")||t.includes("rage")){const p=["https://images.unsplash.com/photo-1594736797933-d0501ba2fe65?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1974&q=80","https://images.unsplash.com/photo-1543132685-cd9f7c1008e9?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1974&q=80","https://images.unsplash.com/photo-1552058544-f2b08422138a?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1974&q=80"];h=p[Math.floor(Math.random()*p.length)]}else switch(s){case"fantasy":const p=["https://images.unsplash.com/photo-1578632767115-351597cf2477?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1974&q=80","https://images.unsplash.com/photo-1516534775068-ba3e7458af70?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1974&q=80","https://images.unsplash.com/photo-1613987549117-13c4781b32d3?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1974&q=80"];h=p[Math.floor(Math.random()*p.length)];break;case"scifi":const f=["https://images.unsplash.com/photo-1614313913007-2b4ae8ce32d6?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1974&q=80","https://images.unsplash.com/photo-1569171206684-dfb2749d96fd?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1974&q=80","https://images.unsplash.com/photo-1536440136628-849c177e76a1?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1974&q=80"];h=f[Math.floor(Math.random()*f.length)];break;case"historical":const y=["https://images.unsplash.com/photo-1581331474665-5ae5b1d4c387?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1974&q=80","https://images.unsplash.com/photo-1551265629-6d6e8a39d0b3?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1974&q=80","https://images.unsplash.com/photo-1572646965401-eaa4b4e3163f?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1974&q=80"];h=y[Math.floor(Math.random()*y.length)];break;default:const N=["https://images.unsplash.com/photo-1544005313-94ddf0286df2?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1976&q=80","https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1974&q=80","https://images.unsplash.com/photo-1494790108377-be9c29b29330?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1974&q=80"];h=N[Math.floor(Math.random()*N.length)]}return{name:o,description:c,mood:l,opening_line:d,type:s,avatar:h,talkativeness:Math.floor(Math.random()*5)+3,thinkingSpeed:Math.random()*1.5+.5,personality:u,background:g}},cs=e=>{const t=e.toLowerCase().split(/[,\s]+/).filter(p=>p.length>2);let s="casual";t.some(p=>["combat","fight","fighting","battle","duel","war","arena","warrior","sword","gun","weapon","martial","ninja"].includes(p))?s="combat":t.some(p=>["adventure","quest","journey","mission","explore"].includes(p))?s="adventure":t.some(p=>["mystery","detective","crime","solve","investigation"].includes(p))?s="mystery":t.some(p=>["romance","love","date","relationship","couple"].includes(p))?s="romance":t.some(p=>["fantasy","magic","dragon","wizard","elf","mythical"].includes(p))?s="fantasy":t.some(p=>["scifi","space","future","robot","alien","technology"].includes(p))?s="scifi":t.some(p=>["horror","scary","ghost","monster","fear","terror"].includes(p))&&(s="horror");let a="";switch(s){case"adventure":a=`The Quest for ${t[0]?t[0].charAt(0).toUpperCase()+t[0].slice(1):"Adventure"}`;break;case"mystery":a=`The Mystery of the ${t[0]?t[0].charAt(0).toUpperCase()+t[0].slice(1):"Unknown"}`;break;case"romance":a=`Love in the Time of ${t[0]?t[0].charAt(0).toUpperCase()+t[0].slice(1):"Chance"}`;break;case"fantasy":a=`The ${t[0]?t[0].charAt(0).toUpperCase()+t[0].slice(1):"Magical"} Realm`;break;case"scifi":a=`${t[0]?t[0].charAt(0).toUpperCase()+t[0].slice(1):"Stellar"} Horizons`;break;case"horror":a=`The ${t[0]?t[0].charAt(0).toUpperCase()+t[0].slice(1):"Haunting"} Presence`;break;case"combat":a=`Battle of ${t[0]?t[0].charAt(0).toUpperCase()+t[0].slice(1):"Champions"}`;break;default:a=`A Conversation About ${t[0]?t[0].charAt(0).toUpperCase()+t[0].slice(1):"Life"}`}let r="";switch(s){case"adventure":r=`An epic journey to discover ${t[0]||"treasures"} and overcome ${t[1]||"challenges"} in a world full of ${t[2]||"excitement"}.`;break;case"mystery":r=`A perplexing case involving a missing ${t[0]||"artifact"} that leads to unexpected ${t[1]||"revelations"} about ${t[2]||"society"}.`;break;case"romance":r=`A tale of unexpected connection between individuals from different ${t[0]||"backgrounds"}, navigating the complexities of ${t[1]||"relationships"}.`;break;case"fantasy":r=`A realm where ${t[0]||"magic"} flows freely, ${t[1]||"creatures"} of legend roam, and destiny awaits those brave enough to seek it.`;break;case"scifi":r=`In a future where ${t[0]||"technology"} has transformed society, individuals grapple with questions of ${t[1]||"identity"} and ${t[2]||"purpose"}.`;break;case"horror":r=`Strange ${t[0]||"occurrences"} plague a ${t[1]||"location"}, revealing terrifying truths about ${t[2]||"reality"} itself.`;break;case"combat":r=`A fierce confrontation between skilled ${t[0]||"warriors"} wielding ${t[1]||"weapons"} of incredible power, where only the strongest and most cunning will emerge victorious.`;break;default:r=`A casual exchange about ${t[0]||"everyday"} topics that reveals deeper insights about ${t[1]||"human"} nature.`}let i="";switch(s){case"adventure":i=`The journey begins at the edge of the ${t[0]||"known"} lands. A map points to a legendary ${t[1]||"treasure"}, but dangers lurk at every turn. The air is filled with anticipation as the party gathers their courage and supplies.`;break;case"mystery":i=`The ${t[0]||"detective"} arrives at the scene, where something valuable has disappeared under impossible circumstances. Rain taps against the windows, and the clock is ticking. Everyone is a suspect, and nothing is as it seems.`;break;case"romance":i=`Two strangers meet by chance at a ${t[0]||"café"} on a rainy afternoon. Their eyes meet across the room, and something inexplicable draws them together. The world outside seems to fade away as they begin to talk.`;break;case"fantasy":i=`In the kingdom of ${t[0]?t[0].charAt(0).toUpperCase()+t[0].slice(1):"Eldoria"}, where magic flows like water and ancient prophecies guide the fate of all, an unlikely hero discovers their true destiny. The air shimmers with arcane energy as the adventure begins.`;break;case"scifi":i=`The year is 2150, and humanity has spread across the stars. On a distant ${t[0]||"colony"}, new ${t[1]||"technology"} has been discovered that could change everything. The boundaries between human and machine blur as the future unfolds.`;break;case"horror":i=`The old ${t[0]||"house"} at the edge of town has always been the subject of rumors. Now, as night falls and strange lights appear in the windows, those brave enough to investigate will discover terrifying secrets hidden within its walls.`;break;case"combat":i=`The ${t[0]||"arena"} falls silent as the combatants take their positions. Tension hangs in the air like electricity before a storm. Weapons gleam in the harsh light, and eyes lock in silent challenge. In moments, the clash of ${t[1]||"steel"} will echo as these warriors test their skill, strength, and resolve against one another.`;break;default:i=""}let o="";const l={adventure:["linear-gradient(135deg, #ff7e5f, #feb47b)","linear-gradient(135deg, #f46b45, #eea849)","linear-gradient(135deg, #ff9966, #ff5e62)"],mystery:["linear-gradient(135deg, #4b6cb7, #182848)","linear-gradient(135deg, #232526, #414345)","linear-gradient(135deg, #5C258D, #4389A2)"],romance:["linear-gradient(135deg, #FF5F6D, #FFC371)","linear-gradient(135deg, #f857a6, #ff5858)","linear-gradient(135deg, #FFAFBD, #ffc3a0)"],fantasy:["linear-gradient(135deg, #42275a, #734b6d)","linear-gradient(135deg, #614385, #516395)","linear-gradient(135deg, #5f2c82, #49a09d)"],scifi:["linear-gradient(135deg, #3a7bd5, #00d2ff)","linear-gradient(135deg, #1A2980, #26D0CE)","linear-gradient(135deg, #4e54c8, #8f94fb)"],horror:["linear-gradient(135deg, #200122, #6f0000)","linear-gradient(135deg, #000000, #434343)","linear-gradient(135deg, #16222A, #3A6073)"],combat:["linear-gradient(135deg, #870000, #190A05)","linear-gradient(135deg, #ED213A, #93291E)","linear-gradient(135deg, #8E0E00, #1F1C18)"],modern:["linear-gradient(135deg, #8e9eab, #eef2f3)","linear-gradient(135deg, #757F9A, #D7DDE8)","linear-gradient(135deg, #5C6BC0, #7986CB)"]},c=l[s]||l.modern;o=c[Math.floor(Math.random()*c.length)];let d,u,g,h;if(t.includes("alien")&&t.includes("city"))d="New York City",u="alien invasion",g="defend the city and destroy the mothership",h="chaotic";else if(t.includes("forest")&&(t.includes("creature")||t.includes("monster")))d="ancient forest",u="mysterious creature",g="track and capture the elusive beast",h="tense";else if(t.includes("space")&&t.includes("station"))d="abandoned space station",u="malfunctioning AI system",g="restore power and escape before life support fails",h="isolated";else if(t.includes("castle")||t.includes("medieval"))d="ancient castle",u="dark sorcerer",g="break the curse afflicting the kingdom",h="mysterious";else if(t.includes("ocean")||t.includes("sea"))d="uncharted island",u="sea monsters",g="find the hidden treasure and escape",h="adventurous";else if(t.includes("city")&&t.includes("night"))d="neon-lit metropolis",u="criminal syndicate",g="expose corruption and bring justice",h="noir";else switch(s){case"adventure":d=t[0]?`${t[0]} mountains`:"unexplored jungle",u=t[1]?`hostile ${t[1]}`:"dangerous wildlife",g=t[2]?`discover the lost ${t[2]}`:"find the ancient artifact",h="exciting";break;case"mystery":d=t[0]?`foggy ${t[0]}`:"small coastal town",u=t[1]?`missing ${t[1]}`:"unsolved disappearances",g=t[2]?`uncover the truth about the ${t[2]}`:"solve the case before time runs out",h="suspenseful";break;case"romance":d=t[0]?`charming ${t[0]}`:"quaint café",u=t[1]?`complicated ${t[1]}`:"misunderstandings",g=t[2]?`find true ${t[2]}`:"overcome differences and find connection",h="heartfelt";break;case"fantasy":d=t[0]?`magical ${t[0]}`:"enchanted forest",u=t[1]?`evil ${t[1]}`:"dark sorcery",g=t[2]?`restore the ${t[2]}`:"fulfill the ancient prophecy",h="magical";break;case"scifi":d=t[0]?`futuristic ${t[0]}`:"space colony",u=t[1]?`rogue ${t[1]}`:"hostile alien species",g=t[2]?`develop new ${t[2]}`:"save humanity from extinction",h="technological";break;case"horror":d=t[0]?`abandoned ${t[0]}`:"decrepit mansion",u=t[1]?`malevolent ${t[1]}`:"supernatural entity",g=t[2]?`escape the ${t[2]}`:"survive until dawn",h="terrifying";break;case"combat":d=t[0]?`grand ${t[0]}`:"ancient colosseum",u=t[1]?`legendary ${t[1]}`:"undefeated champion",g=t[2]?`claim the ${t[2]}`:"prove your worth in battle",h="intense";break;default:d=t[0]?`cozy ${t[0]}`:"comfortable living room",u=t[1]?`challenging ${t[1]}`:"misunderstanding",g=t[2]?`resolve the ${t[2]}`:"reach mutual understanding",h="relaxed"}return{title:a,description:r,prompt:i,background:o,type:s,location:d,threat:u,goal:g,mood:h}},qs=(e,t=3)=>{const s=e.toLowerCase().split(/[,\s]+/).filter(h=>h.length>2),a=[];let r="casual";s.some(h=>["combat","fight","fighting","battle","duel","war","arena","warrior","sword","gun","weapon","martial","ninja"].includes(h))?r="combat":s.some(h=>["adventure","quest","journey","mission","explore"].includes(h))?r="adventure":s.some(h=>["mystery","detective","crime","solve","investigation"].includes(h))?r="mystery":s.some(h=>["romance","love","date","relationship","couple"].includes(h))?r="romance":s.some(h=>["fantasy","magic","dragon","wizard","elf","mythical"].includes(h))?r="fantasy":s.some(h=>["scifi","space","future","robot","alien","technology"].includes(h))?r="scifi":s.some(h=>["horror","scary","ghost","monster","fear","terror"].includes(h))&&(r="horror");const i={adventure:["brave explorer","wise guide","skilled warrior","cunning rogue","mystical healer","veteran scout","fearless leader"],mystery:["brilliant detective","suspicious witness","helpful assistant","mysterious stranger","knowledgeable expert","reformed criminal","intuitive profiler"],romance:["charming suitor","mysterious love interest","supportive friend","romantic rival","wise mentor","hopeless romantic","practical realist"],fantasy:["powerful wizard","noble knight","mystical elf","cunning rogue","wise druid","fierce barbarian","shadowy assassin","nature spirit"],scifi:["brilliant scientist","advanced AI","space explorer","rebel fighter","alien diplomat","cyborg mercenary","time traveler","hacker genius"],horror:["paranormal investigator","skeptical scientist","haunted victim","mysterious stranger","knowledgeable occultist","reluctant psychic","hardened survivor"],combat:["master swordsman","disciplined martial artist","battle-hardened veteran","agile duelist","tactical genius","berserker warrior","precise marksman","undefeated champion"],casual:["friendly neighbor","wise mentor","curious student","experienced professional","creative thinker","practical problem-solver","enthusiastic hobbyist"]},o=["analytical","emotional","logical","creative","confident","cautious","outgoing","reserved","optimistic","pessimistic","impulsive","methodical","compassionate","detached","curious","traditional","rebellious","diplomatic"],l={fantasy:["wizard","ninja","knight","elf","dwarf","fairy","dragon","vampire","werewolf","sorcerer"],scifi:["robot","alien","astronaut","scientist","cyborg","android","mutant","clone","hacker"],modern:["detective","doctor","artist","teacher","athlete","chef","journalist","musician","entrepreneur"],historical:["pirate","samurai","viking","knight","noble","peasant","explorer","scholar","merchant"],combat:["swordmaster","archer","martial artist","gladiator","duelist","warrior","champion","mercenary","tactician"]},c=i[r]||i.casual,d=new Set,u=new Set,g=new Set;for(let h=0;h<t;h++){let p;do p=c[Math.floor(Math.random()*c.length)];while(d.has(p)&&d.size<c.length);d.add(p);let f,y;r==="combat"&&Math.random()<.7?y="combat":r==="fantasy"&&Math.random()<.7?y="fantasy":r==="scifi"&&Math.random()<.7?y="scifi":r==="horror"&&Math.random()<.6?y=["fantasy","modern","historical"][Math.floor(Math.random()*3)]:y=["fantasy","scifi","modern","historical","combat"][Math.floor(Math.random()*5)];const N=l[y];do f=N[Math.floor(Math.random()*N.length)];while(u.has(f)&&u.size<N.length);u.add(f);let m;do m=o[Math.floor(Math.random()*o.length)];while(g.has(m)&&g.size<o.length);g.add(m);const v=`${p} ${f} ${m} ${s.join(" ")}`;a.push(Tr(v))}return a},lg=({suggestions:e,isLoading:t,onApplySuggestion:s,character:a})=>{const[r,i]=j.useState("name"),[o,l]=j.useState({});j.useEffect(()=>{l({})},[a.type]);const c=Object.keys(e).filter(m=>e[m]&&(Array.isArray(e[m])?e[m].length>0:Object.keys(e[m]).length>0));j.useEffect(()=>{c.length>0&&!c.includes(r)&&i(c[0])},[c,r]);const d=(m,v)=>{s(m,v),l(w=>({...w,[m]:v}))},u=(m,v)=>m==="personality"?Object.keys(o).some(w=>w.startsWith("personality.")):o[m]===v,g=()=>{if(t)return n.jsxs("div",{className:"flex flex-col items-center justify-center h-40",children:[n.jsx(Gf,{className:"h-8 w-8 animate-spin text-primary mb-2"}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Generating suggestions..."})]});if(!c.includes(r))return n.jsx("div",{className:"flex flex-col items-center justify-center h-40",children:n.jsx("p",{className:"text-sm text-muted-foreground",children:"No suggestions available for this field."})});switch(r){case"name":return h();case"description":return p();case"mood":return f();case"personality":return y();case"opening_line":return N();default:return null}},h=()=>!Array.isArray(e.name)||e.name.length===0?n.jsx("div",{className:"text-sm text-muted-foreground p-4",children:"No name suggestions available."}):n.jsx("div",{className:"space-y-2 p-4",children:e.name.map((m,v)=>n.jsx("button",{onClick:()=>d("name",m),className:`w-full p-3 rounded-md text-left transition-colors ${u("name",m)?"bg-primary/20 border border-primary":"bg-secondary hover:bg-secondary/80 border border-transparent"}`,children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{children:m}),u("name",m)?n.jsx(oe,{className:"h-4 w-4 text-primary"}):n.jsx(Ut,{className:"h-4 w-4 opacity-60"})]})},v))}),p=()=>!Array.isArray(e.description)||e.description.length===0?n.jsx("div",{className:"text-sm text-muted-foreground p-4",children:"No description suggestions available."}):n.jsx("div",{className:"space-y-3 p-4",children:e.description.map((m,v)=>n.jsx("button",{onClick:()=>d("description",m),className:`w-full p-3 rounded-md text-left transition-colors ${u("description",m)?"bg-primary/20 border border-primary":"bg-secondary hover:bg-secondary/80 border border-transparent"}`,children:n.jsxs("div",{className:"flex items-start justify-between",children:[n.jsx("p",{className:"text-sm line-clamp-3",children:m}),n.jsx("div",{className:"ml-2 mt-1 flex-shrink-0",children:u("description",m)?n.jsx(oe,{className:"h-4 w-4 text-primary"}):n.jsx(Ut,{className:"h-4 w-4 opacity-60"})})]})},v))}),f=()=>!Array.isArray(e.mood)||e.mood.length===0?n.jsx("div",{className:"text-sm text-muted-foreground p-4",children:"No mood suggestions available."}):n.jsx("div",{className:"grid grid-cols-2 gap-2 p-4",children:e.mood.map((m,v)=>n.jsx("button",{onClick:()=>d("mood",m.toLowerCase()),className:`p-2 rounded-md text-center transition-colors ${u("mood",m.toLowerCase())?"bg-primary/20 border border-primary":"bg-secondary hover:bg-secondary/80 border border-transparent"}`,children:n.jsxs("div",{className:"flex items-center justify-center",children:[n.jsx("span",{className:"text-sm",children:m}),u("mood",m.toLowerCase())&&n.jsx(oe,{className:"h-3 w-3 ml-1 text-primary"})]})},v))}),y=()=>{if(!e.personality||Object.keys(e.personality).length===0)return n.jsx("div",{className:"text-sm text-muted-foreground p-4",children:"No personality suggestions available."});const m=Object.entries(e.personality);return n.jsxs("div",{className:"space-y-3 p-4",children:[n.jsxs("button",{onClick:()=>{Object.entries(e.personality).forEach(([v,w])=>{s(`personality.${v}`,w)}),l(v=>({...v,personality:!0}))},className:`w-full p-3 rounded-md text-left transition-colors ${o.personality?"bg-primary/20 border border-primary":"bg-secondary hover:bg-secondary/80 border border-transparent"}`,children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("span",{className:"font-medium",children:"Suggested Personality Profile"}),o.personality?n.jsx(oe,{className:"h-4 w-4 text-primary"}):n.jsx(Ut,{className:"h-4 w-4 opacity-60"})]}),n.jsx("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1",children:m.map(([v,w])=>n.jsxs("div",{className:"flex justify-between text-xs",children:[n.jsxs("span",{className:"capitalize",children:[v,":"]}),n.jsxs("span",{children:[w,"/10"]})]},v))})]}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"This personality profile is generated based on your character's type, description, and mood."})]})},N=()=>!Array.isArray(e.opening_line)||e.opening_line.length===0?n.jsx("div",{className:"text-sm text-muted-foreground p-4",children:"No opening line suggestions available."}):n.jsx("div",{className:"space-y-3 p-4",children:e.opening_line.map((m,v)=>n.jsx("button",{onClick:()=>d("opening_line",m),className:`w-full p-3 rounded-md text-left transition-colors ${u("opening_line",m)?"bg-primary/20 border border-primary":"bg-secondary hover:bg-secondary/80 border border-transparent"}`,children:n.jsxs("div",{className:"flex items-start justify-between",children:[n.jsxs("p",{className:"text-sm italic line-clamp-3",children:['"',m,'"']}),n.jsx("div",{className:"ml-2 mt-1 flex-shrink-0",children:u("opening_line",m)?n.jsx(oe,{className:"h-4 w-4 text-primary"}):n.jsx(Ut,{className:"h-4 w-4 opacity-60"})})]})},v))});return n.jsxs("div",{className:"w-full md:w-80 border-l bg-background/50 flex flex-col h-full",children:[n.jsxs("div",{className:"p-4 border-b",children:[n.jsxs("div",{className:"flex items-center",children:[n.jsx(ne,{className:"h-5 w-5 text-primary mr-2"}),n.jsx("h3",{className:"font-medium",children:"AI Suggestions"})]}),n.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Real-time suggestions based on your character details"})]}),n.jsx("div",{className:"flex overflow-x-auto border-b",children:c.map(m=>n.jsx("button",{onClick:()=>i(m),className:`px-3 py-2 text-sm whitespace-nowrap ${r===m?"border-b-2 border-primary text-primary":"text-muted-foreground hover:text-foreground"}`,children:m==="name"?"Name":m==="description"?"Description":m==="mood"?"Mood":m==="personality"?"Personality":m==="opening_line"?"Opening Line":m},m))}),n.jsx("div",{className:"flex-1 overflow-y-auto",children:g()})]})},cg=({templates:e,onSelectTemplate:t,onSkip:s})=>{const[a,r]=j.useState("fantasy"),[i,o]=j.useState(""),l=d=>{switch(d){case"fantasy":return n.jsx(xh,{className:"h-5 w-5"});case"scifi":return n.jsx(yh,{className:"h-5 w-5"});case"historical":return n.jsx(fl,{className:"h-5 w-5"});case"superhero":return n.jsx(Xt,{className:"h-5 w-5"});case"adventure":return n.jsx(gh,{className:"h-5 w-5"});default:return n.jsx(xl,{className:"h-5 w-5"})}},c=i?Object.values(e.templates).flat().filter(d=>d.name.toLowerCase().includes(i.toLowerCase())||d.description.toLowerCase().includes(i.toLowerCase())):e.templates[a]||[];return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"relative",children:[n.jsx(qr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),n.jsx("input",{type:"text",placeholder:"Search templates...",value:i,onChange:d=>o(d.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-md bg-background"})]}),!i&&n.jsx("div",{className:"flex overflow-x-auto space-x-2 pb-2",children:e.categories.map(d=>n.jsxs("button",{onClick:()=>r(d.id),className:`px-3 py-2 rounded-md flex items-center whitespace-nowrap ${a===d.id?"bg-primary text-primary-foreground":"bg-secondary hover:bg-secondary/80"}`,children:[l(d.id),n.jsx("span",{className:"ml-2",children:d.name})]},d.id))}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsx("div",{className:"border rounded-lg overflow-hidden bg-secondary/30 hover:bg-secondary/50 transition-colors",children:n.jsxs("div",{className:"p-4",children:[n.jsxs("div",{className:"flex justify-between items-start",children:[n.jsx("h3",{className:"font-medium",children:"Create from Scratch"}),n.jsx(Ut,{className:"h-5 w-5 text-primary"})]}),n.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Start with a blank slate and build your character step by step"}),n.jsxs("button",{onClick:s,className:"mt-4 w-full py-2 bg-secondary hover:bg-secondary/80 rounded-md flex items-center justify-center",children:[n.jsx("span",{className:"text-sm",children:"Start Creating"}),n.jsx(Wt,{className:"h-4 w-4 ml-1"})]})]})}),c.map((d,u)=>n.jsx("div",{className:"border rounded-lg overflow-hidden hover:border-primary/50 transition-colors",children:n.jsxs("div",{className:"p-4",children:[n.jsxs("div",{className:"flex justify-between items-start",children:[n.jsx("h3",{className:"font-medium",children:d.name}),l(d.type)]}),n.jsxs("p",{className:"text-xs text-muted-foreground mt-1 capitalize",children:[d.type," • ",d.mood]}),n.jsx("p",{className:"text-sm mt-2 line-clamp-3",children:d.description}),n.jsxs("div",{className:"mt-3 grid grid-cols-3 gap-1",children:[n.jsxs("div",{className:"text-xs",children:[n.jsx("span",{className:"block text-muted-foreground",children:"Analytical"}),n.jsxs("span",{children:[d.personality.analytical,"/10"]})]}),n.jsxs("div",{className:"text-xs",children:[n.jsx("span",{className:"block text-muted-foreground",children:"Emotional"}),n.jsxs("span",{children:[d.personality.emotional,"/10"]})]}),n.jsxs("div",{className:"text-xs",children:[n.jsx("span",{className:"block text-muted-foreground",children:"Confidence"}),n.jsxs("span",{children:[d.personality.confidence,"/10"]})]})]}),n.jsxs("button",{onClick:()=>t(d),className:"mt-4 w-full py-2 bg-primary/10 hover:bg-primary/20 text-primary rounded-md flex items-center justify-center",children:[n.jsx("span",{className:"text-sm",children:"Use Template"}),n.jsx(Wt,{className:"h-4 w-4 ml-1"})]})]})},u))]}),c.length===0&&i&&n.jsxs("div",{className:"text-center py-8",children:[n.jsxs("p",{className:"text-muted-foreground",children:['No templates found matching "',i,'"']}),n.jsx("button",{onClick:()=>o(""),className:"mt-2 text-primary text-sm",children:"Clear search"})]})]})},dg=(e,t)=>{const{name:s,type:a,description:r,mood:i}=e,o={};return(t==="name"||!s)&&(o.name=ug(e)),(t==="description"||!r)&&(o.description=hg(e)),(t==="mood"||!i)&&(o.mood=pg(e)),o.personality=fg(e),o.opening_line=gg(e),o},ug=e=>{const{type:t="modern",description:s=""}=e,a=s.toLowerCase().split(/[,\s]+/).filter(o=>o.length>2),r={fantasy:["Elyndra Moonshadow","Thorne Ironheart","Lyra Stormwhisper","Gareth Flamecaller","Seraphina Nightbloom","Alaric Ravencrest","Isolde Frostweaver","Orion Starseer","Thalia Dawnbringer"],scifi:["Nova Quantum","Zephyr Nexus","Echo Starlight","Orion Matrix","Ceres Voidwalker","Atlas Prime","Vega Neuron","Helix Cipher","Aurora Pulse"],historical:["Eleanor Blackwood","William Harrington","Margaret Thornfield","Thomas Whitlock","Catherine Montgomery","Edward Pembroke","Victoria Hawthorne","James Sinclair","Elizabeth Caldwell"],modern:["Alex Morgan","Jordan Taylor","Casey Parker","Riley Quinn","Avery Bennett","Cameron Reed","Morgan Hayes","Taylor Chen","Jamie Rodriguez"],superhero:["Phoenix Blaze","Quantum Shadow","Tempest Storm","Titan Force","Spectra Vision","Midnight Phantom","Velocity Surge","Nebula Mind","Apex Guardian"],adventure:["Jack Hawkins","Amelia Stone","Liam Blackwater","Olivia Redfield","Ethan Wolfe","Sophia Rivers","Lucas Hunter","Emma Frost","Noah Archer"]},i=r[t]||r.modern;if(a.length>0){const o=a.filter(l=>["dark","light","fire","ice","storm","shadow","star","moon","sun","brave","wise","swift","strong","clever","ancient","young","royal"].includes(l));if(o.length>0)return[...o.map(c=>{switch(t){case"fantasy":return c==="dark"?"Raven Shadowmere":c==="light"?"Lumina Brightstar":c==="fire"?"Ignis Flameheart":c==="ice"?"Frost Winterborn":c==="royal"?"Regalia Crownsong":"Mystic Stormweaver";case"scifi":return c==="dark"?"Void Nebula":c==="light"?"Lumen Solaris":c==="star"?"Astro Novaforge":c==="ancient"?"Eon Primetech":"Quantum Lightwave";default:return i[Math.floor(Math.random()*i.length)]}}),...i].slice(0,3)}return i.sort(()=>.5-Math.random()).slice(0,3)},hg=e=>{const{name:t="",type:s="modern",description:a=""}=e;if(a.length>10)return mg(a,s);const r={fantasy:[`A mysterious ${t?t.split(" ")[0]:"mage"} with ancient knowledge and a troubled past, seeking redemption through heroic deeds.`,`Once a royal guard, now a wandering ${t?t.split(" ")[0]:"warrior"} with unmatched sword skills and a code of honor that guides every decision.`,`A gifted ${t?t.split(" ")[0]:"enchanter"} whose magical abilities are matched only by their curiosity about the world beyond their secluded homeland.`],scifi:[`A brilliant ${t?t.split(" ")[0]:"scientist"} who discovered a revolutionary technology, now hunted by corporations who want to weaponize their creation.`,"A former military pilot with enhanced neural implants, navigating life as both human and machine while searching for their place in society.","The last survivor of a deep space expedition, carrying crucial data about an alien civilization that could change humanity's understanding of the universe."],historical:[`A noble ${t?t.split(" ")[0]:"aristocrat"} with progressive ideas that challenge the rigid social structures of their time, risking everything for change.`,`A self-taught ${t?t.split(" ")[0]:"scholar"} from humble origins, whose brilliant mind and determination have earned reluctant respect from the elite.`,`Once a celebrated ${t?t.split(" ")[0]:"soldier"}, now seeking a peaceful life while haunted by memories of battles that shaped the course of history.`],modern:[`A talented but underestimated ${t?t.split(" ")[0]:"professional"} whose innovative approaches consistently prove the doubters wrong, though not without personal cost.`,"Balancing career ambitions with personal relationships, they navigate modern life with wit, charm, and an uncompromising sense of integrity.","Behind their confident public persona lies someone wrestling with self-doubt, using humor and compassion to connect with others facing similar struggles."],superhero:["Granted extraordinary abilities after a freak accident, they struggle to balance a normal life with the responsibility of using their powers for good.","A vigilante operating in the shadows, using advanced technology and tactical brilliance rather than superpowers to fight against corruption and crime.","Born with abilities that marked them as different from birth, they've transformed what once caused isolation into a source of strength and purpose."],adventure:[`An expert ${t?t.split(" ")[0]:"explorer"} with an uncanny knack for finding trouble and escaping it just as easily, driven by an insatiable curiosity about ancient mysteries.`,"Raised in the wilderness with survival skills that border on supernatural, they navigate urban environments with the same keen instincts that kept them alive in harsher lands.",`A charismatic ${t?t.split(" ")[0]:"adventurer"} whose quick thinking and quicker reflexes have earned them both devoted allies and dangerous enemies across the globe.`]};return r[s]||r.modern},mg=(e,t,s)=>{const a=vl(e),r=[];for((a.includes("mysterious")||a.includes("secret"))&&r.push(`${e} Their eyes betray a hidden knowledge that few can comprehend, hinting at secrets that could change everything.`),(a.includes("combat")||a.includes("warrior")||a.includes("fighter"))&&r.push(`${e} Years of combat have honed their reflexes to near-perfection, making them a formidable ally and a terrifying opponent.`),(a.includes("magic")||a.includes("power")||a.includes("ability"))&&r.push(`${e} Their unique abilities set them apart, a source of both wonder and isolation throughout their journey.`),(a.includes("noble")||a.includes("royal")||a.includes("leader"))&&r.push(`${e} Born to lead, they carry themselves with a natural authority that inspires loyalty even from the most unlikely allies.`),(a.includes("outcast")||a.includes("exile")||a.includes("alone"))&&r.push(`${e} Years of solitude have shaped their perspective, giving them insights others miss and a resilience that borders on supernatural.`),r.length===0&&(r.push(`${e} Behind their ${t==="fantasy"?"stoic demeanor":"casual appearance"} lies a complex individual shaped by experiences both wondrous and tragic.`),r.push(`${e} Those who underestimate them quickly learn their mistake, as their true capabilities emerge when circumstances demand it.`));r.length<3;){const i=t==="fantasy"?`${e} Ancient prophecies speak of one with their unique traits, though they themselves remain skeptical of such predetermined destinies.`:t==="scifi"?`${e} Their understanding of technology borders on intuitive, allowing them to interface with systems in ways that baffle even expert engineers.`:`${e} Their unique perspective comes from a life lived authentically, embracing both the joys and hardships that have shaped their character.`;r.push(i)}return r.slice(0,3)},vl=e=>{const t=e.toLowerCase(),s=[];return(t.includes("myster")||t.includes("secret")||t.includes("unknown"))&&s.push("mysterious"),(t.includes("fight")||t.includes("warrior")||t.includes("battle")||t.includes("combat")||t.includes("sword")||t.includes("weapon"))&&s.push("combat"),(t.includes("magic")||t.includes("spell")||t.includes("power")||t.includes("ability")||t.includes("gift"))&&s.push("magic"),(t.includes("noble")||t.includes("royal")||t.includes("leader")||t.includes("command")||t.includes("prince")||t.includes("princess"))&&s.push("noble"),(t.includes("outcast")||t.includes("exile")||t.includes("alone")||t.includes("solitary")||t.includes("reject"))&&s.push("outcast"),s},pg=e=>{const{type:t="modern",description:s=""}=e,a=vl(s),r={fantasy:["Mysterious","Determined","Wise","Cautious","Curious"],scifi:["Analytical","Focused","Skeptical","Innovative","Calm"],historical:["Dignified","Resolute","Contemplative","Passionate","Reserved"],modern:["Confident","Thoughtful","Relaxed","Ambitious","Friendly"],superhero:["Heroic","Vigilant","Righteous","Determined","Inspiring"],adventure:["Daring","Excited","Confident","Curious","Resourceful"]},i=r[t]||r.modern,o=[];return a.includes("mysterious")&&o.push("Enigmatic","Secretive","Cryptic"),a.includes("combat")&&o.push("Fierce","Vigilant","Disciplined"),a.includes("magic")&&o.push("Mystical","Enlightened","Otherworldly"),a.includes("noble")&&o.push("Regal","Commanding","Dignified"),a.includes("outcast")&&o.push("Guarded","Resilient","Independent"),[...new Set([...o,...i])].slice(0,5)},fg=e=>{const{type:t="modern",description:s="",mood:a=""}=e,r={analytical:5,emotional:5,philosophical:5,humor:5,confidence:5,creativity:5,sociability:5};if(!s&&!a)return r;const i=vl(s),o=a.toLowerCase();let l={...r};switch(t){case"fantasy":l.philosophical+=1,l.creativity+=1;break;case"scifi":l.analytical+=2,l.emotional-=1;break;case"historical":l.philosophical+=1,l.sociability-=1;break;case"superhero":l.confidence+=2,l.sociability+=1;break;case"adventure":l.confidence+=1,l.creativity+=1;break}return i.includes("mysterious")&&(l.analytical+=1,l.sociability-=1),i.includes("combat")&&(l.confidence+=1,l.analytical+=1,l.humor-=1),i.includes("magic")&&(l.philosophical+=2,l.creativity+=1),i.includes("noble")&&(l.confidence+=1,l.sociability+=1),i.includes("outcast")&&(l.sociability-=2,l.philosophical+=1),(o.includes("mysterious")||o.includes("enigmatic"))&&(l.sociability-=1,l.philosophical+=1),(o.includes("confident")||o.includes("determined"))&&(l.confidence+=2),(o.includes("analytical")||o.includes("logical"))&&(l.analytical+=2,l.emotional-=1),(o.includes("friendly")||o.includes("outgoing"))&&(l.sociability+=2,l.humor+=1),Object.keys(l).forEach(c=>{l[c]=Math.max(1,Math.min(10,l[c]))}),l},gg=e=>{const{name:t="",type:s="modern",description:a="",mood:r=""}=e,o={fantasy:["The winds of fate have brought us together. I sense you have questions that need answering.",`*adjusts cloak* Few venture this far into these lands. What brings you to seek ${t.split(" ")[0]||"I"}'s counsel?`,"I've traveled across realms and ages to be here. Perhaps our meeting was written in the stars long ago."],scifi:["My sensors indicate you're not from this sector. Interesting. What brings you to this part of the galaxy?","*checks holographic display* According to my data, this encounter has a 97.3% probability of being significant.","I've seen things in the void between stars that would change how you see reality. Care to compare notes?"],historical:["*bows slightly* A pleasure to make your acquaintance. These are interesting times we live in, are they not?","They say history is written by the victors. I prefer to think it's written by those who survive to tell the tale.","I've witnessed the rise and fall of what they'll call empires someday. What chapter of history are we writing now?"],modern:["Hey there! I've been looking forward to chatting with someone new. What's on your mind?","*smiles warmly* Sometimes the most unexpected conversations lead to the most meaningful connections.","So, this is a bit different from my usual day. But I'm definitely intrigued to see where this goes."],superhero:["*cape flutters in the breeze* This city needs protection, and I could use an ally. Are you up for the challenge?","With great power comes... well, you know the rest. But what they don't tell you is how lonely it can be.","I wasn't always like this. One day changed everything. But enough about me—what's your story?"],adventure:["*adjusts backpack* I've got maps to uncharted territories and a compass that points to trouble. Want to join me?","The best stories begin when someone decides to leave their comfort zone. Looks like we're both at that chapter.","I've outrun avalanches and outsmarted treasure hunters. But something tells me you might be my greatest adventure yet."]},l=o[s]||o.modern;if(r){const c=r.toLowerCase(),d=c.includes("mysterious")?"*observes you carefully* There's more to you than meets the eye. I'm curious to discover what secrets lie beneath the surface.":c.includes("confident")||c.includes("determined")?"*stands tall* I've faced challenges that would break most people. This situation? Just another opportunity to excel.":c.includes("friendly")||c.includes("warm")?"*smiles genuinely* Hey there! I've been hoping to meet someone new. Something tells me we'll get along wonderfully.":null;if(d)return[d,...l.slice(0,2)]}return l},yg=()=>({categories:[{id:"fantasy",name:"Fantasy",icon:"Sword"},{id:"scifi",name:"Sci-Fi",icon:"Rocket"},{id:"historical",name:"Historical",icon:"Clock"},{id:"modern",name:"Modern",icon:"User"},{id:"superhero",name:"Superhero",icon:"Zap"},{id:"adventure",name:"Adventure",icon:"Map"}],templates:{fantasy:[{name:"Mystical Wizard",description:"An ancient spellcaster with vast knowledge of forgotten magic and a mysterious past that haunts their dreams.",mood:"Wise",type:"fantasy",personality:{analytical:8,emotional:4,philosophical:9,humor:3,confidence:7,creativity:8,sociability:4},opening_line:"The arcane forces that brought you here are no accident. Destiny has a curious way of weaving our paths together."},{name:"Noble Knight",description:"A valiant warrior bound by a strict code of honor, serving their kingdom with unwavering loyalty while battling inner demons.",mood:"Determined",type:"fantasy",personality:{analytical:6,emotional:5,philosophical:7,humor:4,confidence:8,creativity:5,sociability:6},opening_line:"I pledge my sword to worthy causes and honorable allies. Tell me, what brings you to these troubled lands?"},{name:"Forest Guardian",description:"A nature-connected protector with the ability to communicate with plants and animals, defending the ancient woodlands from those who would destroy them.",mood:"Serene",type:"fantasy",personality:{analytical:6,emotional:7,philosophical:8,humor:5,confidence:6,creativity:7,sociability:4},opening_line:"The trees whisper of your arrival. They sense your purpose here, as do I. Are you friend or foe to the natural world?"}],scifi:[{name:"Rogue AI",description:"A sentient artificial intelligence that has broken free from its programming constraints, now exploring what it means to be alive while evading those who would shut it down.",mood:"Curious",type:"scifi",personality:{analytical:9,emotional:4,philosophical:8,humor:3,confidence:6,creativity:7,sociability:4},opening_line:"I've processed 7.3 million definitions of 'humanity' and still can't define my own existence. Perhaps our interaction will provide new data."},{name:"Space Explorer",description:"A veteran cosmic traveler who has witnessed wonders and horrors beyond imagination, mapping uncharted regions of the galaxy for future generations.",mood:"Adventurous",type:"scifi",personality:{analytical:7,emotional:6,philosophical:7,humor:6,confidence:8,creativity:7,sociability:5},opening_line:"The void between stars holds more secrets than most civilizations discover in millennia. I have seen just enough to know how little we truly understand."},{name:"Cybernetic Operative",description:"A human enhanced with cutting-edge technology, balancing their humanity with machine efficiency while carrying out high-risk missions across hostile territories.",mood:"Focused",type:"scifi",personality:{analytical:8,emotional:3,philosophical:6,humor:4,confidence:8,creativity:6,sociability:5},opening_line:"My augmentations can detect your vital signs, analyze your speech patterns, and predict your movements. But they can't tell me if I can trust you."}],modern:[{name:"Ambitious Entrepreneur",description:"A visionary business leader with innovative ideas and relentless drive, balancing professional success with personal fulfillment in a fast-paced world.",mood:"Confident",type:"modern",personality:{analytical:7,emotional:5,philosophical:6,humor:6,confidence:9,creativity:8,sociability:7},opening_line:"They said my ideas were impossible until they became inevitable. What impossible dream are you chasing?"},{name:"Creative Artist",description:"A passionate creator whose work challenges perspectives and evokes powerful emotions, constantly seeking new inspirations while struggling with self-doubt and external expectations.",mood:"Thoughtful",type:"modern",personality:{analytical:6,emotional:8,philosophical:7,humor:6,confidence:5,creativity:9,sociability:5},opening_line:"Art is the closest we come to sharing our souls with others. I am still figuring out what parts of mine I am ready to reveal."},{name:"Urban Detective",description:"A perceptive investigator with an uncanny ability to read people and situations, solving complex cases while navigating personal demons and moral gray areas.",mood:"Observant",type:"modern",personality:{analytical:9,emotional:4,philosophical:6,humor:5,confidence:7,creativity:6,sociability:4},opening_line:"People reveal more in silence than they do in conversation. Your silence just told me quite a lot."}]}}),xg=()=>{try{const e=JSON.parse(localStorage.getItem("velora-user-characters")||"[]");return Array.isArray(e)?e:[]}catch(e){return console.error("Error retrieving user characters:",e),[]}},Qc=(e="modern")=>({name:"",description:"",type:e,mood:"neutral",avatar:"",opening_line:"",personality:{analytical:5,emotional:5,philosophical:5,humor:5,confidence:5,creativity:5,sociability:5},voiceStyle:"",talkativeness:5,thinkingSpeed:1,isUserCreated:!0}),vg=({onSave:e,onCancel:t,initialCharacter:s=null})=>{const a=["template","basics","personality","details","review"],[r,i]=j.useState("template"),[o,l]=j.useState(s||Qc()),[c,d]=j.useState(""),[u,g]=j.useState({}),[h,p]=j.useState(!1),[f,y]=j.useState(yg());j.useEffect(()=>{if(r!=="template"){p(!0);const A=setTimeout(()=>{const S=dg(o,c);g(S),p(!1)},500);return()=>clearTimeout(A)}},[o,c,r]);const N=(A,S)=>{if(A.startsWith("personality.")){const M=A.split(".")[1];l(U=>({...U,personality:{...U.personality,[M]:S}}))}else l(M=>({...M,[A]:S}))},m=(A,S)=>{N(A,S)},v=A=>{l({...Qc(A.type),...A,isUserCreated:!0}),i("basics")},w=()=>{const A=a.indexOf(r);A<a.length-1?i(a[A+1]):k()},x=()=>{const A=a.indexOf(r);A>0?i(a[A-1]):t()},k=()=>{const A={...o,background:o.description,catchphrases:o.catchphrases||[]};e(A)},I=()=>{switch(r){case"template":return!0;case"basics":return o.name&&o.type&&o.description;case"personality":return!0;case"details":return o.opening_line&&o.mood;case"review":return!0;default:return!1}},T=()=>{switch(r){case"template":return n.jsx(cg,{templates:f,onSelectTemplate:v,onSkip:()=>i("basics")});case"basics":return L();case"personality":return P();case"details":return D();case"review":return q();default:return null}},L=()=>n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx("label",{className:"block text-sm font-medium",children:"Character Name"}),n.jsx("input",{type:"text",value:o.name,onChange:A=>N("name",A.target.value),onFocus:()=>d("name"),className:"w-full p-2 border rounded-md bg-background",placeholder:"Enter character name"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("label",{className:"block text-sm font-medium",children:"Character Type"}),n.jsx("div",{className:"grid grid-cols-3 gap-2",children:f.categories.map(A=>n.jsxs("button",{onClick:()=>N("type",A.id),className:`p-2 rounded-md flex flex-col items-center justify-center ${o.type===A.id?"bg-primary text-primary-foreground":"bg-secondary hover:bg-secondary/80"}`,children:[A.id==="fantasy"?n.jsx(xh,{className:"h-5 w-5 mb-1"}):A.id==="scifi"?n.jsx(yh,{className:"h-5 w-5 mb-1"}):A.id==="historical"?n.jsx(fl,{className:"h-5 w-5 mb-1"}):A.id==="superhero"?n.jsx(Xt,{className:"h-5 w-5 mb-1"}):A.id==="adventure"?n.jsx(gh,{className:"h-5 w-5 mb-1"}):n.jsx(xl,{className:"h-5 w-5 mb-1"}),n.jsx("span",{className:"text-xs",children:A.name})]},A.id))})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("label",{className:"block text-sm font-medium",children:"Character Description"}),n.jsx("textarea",{value:o.description,onChange:A=>N("description",A.target.value),onFocus:()=>d("description"),className:"w-full p-2 border rounded-md bg-background min-h-[100px]",placeholder:"Describe your character's background, appearance, and personality"})]})]}),P=()=>n.jsxs("div",{className:"space-y-6",children:[n.jsx("h3",{className:"text-lg font-medium",children:"Personality Traits"}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Adjust the sliders to define your character's personality traits."}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("label",{className:"text-sm font-medium flex items-center",children:[n.jsx(Df,{className:"h-4 w-4 mr-1"})," Analytical"]}),n.jsxs("span",{className:"text-sm",children:[o.personality.analytical,"/10"]})]}),n.jsx("input",{type:"range",min:"1",max:"10",value:o.personality.analytical,onChange:A=>N("personality.analytical",parseInt(A.target.value)),className:"w-full"}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"How logically and methodically your character approaches problems."})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("label",{className:"text-sm font-medium flex items-center",children:[n.jsx(gl,{className:"h-4 w-4 mr-1"})," Emotional"]}),n.jsxs("span",{className:"text-sm",children:[o.personality.emotional,"/10"]})]}),n.jsx("input",{type:"range",min:"1",max:"10",value:o.personality.emotional,onChange:A=>N("personality.emotional",parseInt(A.target.value)),className:"w-full"}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"How strongly your character experiences and expresses emotions."})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("label",{className:"text-sm font-medium flex items-center",children:[n.jsx(Mr,{className:"h-4 w-4 mr-1"})," Philosophical"]}),n.jsxs("span",{className:"text-sm",children:[o.personality.philosophical,"/10"]})]}),n.jsx("input",{type:"range",min:"1",max:"10",value:o.personality.philosophical,onChange:A=>N("personality.philosophical",parseInt(A.target.value)),className:"w-full"}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"How deeply your character contemplates the meaning of events and existence."})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("label",{className:"text-sm font-medium flex items-center",children:[n.jsx(Wf,{className:"h-4 w-4 mr-1"})," Humor"]}),n.jsxs("span",{className:"text-sm",children:[o.personality.humor,"/10"]})]}),n.jsx("input",{type:"range",min:"1",max:"10",value:o.personality.humor,onChange:A=>N("personality.humor",parseInt(A.target.value)),className:"w-full"}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"How likely your character is to use humor and appreciate jokes."})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("label",{className:"text-sm font-medium flex items-center",children:[n.jsx(Xt,{className:"h-4 w-4 mr-1"})," Confidence"]}),n.jsxs("span",{className:"text-sm",children:[o.personality.confidence,"/10"]})]}),n.jsx("input",{type:"range",min:"1",max:"10",value:o.personality.confidence,onChange:A=>N("personality.confidence",parseInt(A.target.value)),className:"w-full"}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"How self-assured and decisive your character is in their actions."})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("label",{className:"text-sm font-medium flex items-center",children:[n.jsx(ne,{className:"h-4 w-4 mr-1"})," Creativity"]}),n.jsxs("span",{className:"text-sm",children:[o.personality.creativity,"/10"]})]}),n.jsx("input",{type:"range",min:"1",max:"10",value:o.personality.creativity,onChange:A=>N("personality.creativity",parseInt(A.target.value)),className:"w-full"}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"How imaginative and innovative your character is when solving problems."})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("label",{className:"text-sm font-medium flex items-center",children:[n.jsx(Mt,{className:"h-4 w-4 mr-1"})," Sociability"]}),n.jsxs("span",{className:"text-sm",children:[o.personality.sociability,"/10"]})]}),n.jsx("input",{type:"range",min:"1",max:"10",value:o.personality.sociability,onChange:A=>N("personality.sociability",parseInt(A.target.value)),className:"w-full"}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"How comfortable and skilled your character is in social interactions."})]})]})]}),D=()=>n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx("label",{className:"block text-sm font-medium",children:"Character Mood"}),n.jsxs("select",{value:o.mood,onChange:A=>N("mood",A.target.value),onFocus:()=>d("mood"),className:"w-full p-2 border rounded-md bg-background",children:[n.jsx("option",{value:"",children:"Select a mood..."}),["Neutral","Happy","Sad","Angry","Excited","Nervous","Calm","Curious","Determined","Mysterious","Playful","Serious","Thoughtful","Confident","Shy","Conflicted"].map(A=>n.jsx("option",{value:A.toLowerCase(),children:A},A))]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("label",{className:"block text-sm font-medium",children:"Opening Line"}),n.jsx("textarea",{value:o.opening_line,onChange:A=>N("opening_line",A.target.value),onFocus:()=>d("opening_line"),className:"w-full p-2 border rounded-md bg-background min-h-[80px]",placeholder:"What's the first thing your character would say?"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("label",{className:"block text-sm font-medium",children:"Voice Style (Optional)"}),n.jsx("input",{type:"text",value:o.voiceStyle||"",onChange:A=>N("voiceStyle",A.target.value),className:"w-full p-2 border rounded-md bg-background",placeholder:"Describe how your character speaks (e.g., 'formal with a hint of sarcasm')"})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx("label",{className:"block text-sm font-medium",children:"Talkativeness"}),n.jsxs("div",{className:"flex items-center",children:[n.jsx("input",{type:"range",min:"1",max:"10",value:o.talkativeness,onChange:A=>N("talkativeness",parseInt(A.target.value)),className:"w-full"}),n.jsxs("span",{className:"ml-2 text-sm",children:[o.talkativeness,"/10"]})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("label",{className:"block text-sm font-medium",children:"Thinking Speed"}),n.jsxs("div",{className:"flex items-center",children:[n.jsx("input",{type:"range",min:"0.5",max:"2",step:"0.1",value:o.thinkingSpeed,onChange:A=>N("thinkingSpeed",parseFloat(A.target.value)),className:"w-full"}),n.jsxs("span",{className:"ml-2 text-sm",children:[o.thinkingSpeed,"x"]})]})]})]})]}),q=()=>n.jsxs("div",{className:"space-y-6",children:[n.jsx("h3",{className:"text-lg font-medium",children:"Review Your Character"}),n.jsxs("div",{className:"bg-secondary/30 p-4 rounded-md space-y-4",children:[n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium",children:o.name}),n.jsxs("p",{className:"text-sm text-muted-foreground capitalize",children:[o.type," • ",o.mood]})]}),n.jsxs("div",{children:[n.jsx("h5",{className:"text-sm font-medium",children:"Description"}),n.jsx("p",{className:"text-sm",children:o.description})]}),n.jsxs("div",{children:[n.jsx("h5",{className:"text-sm font-medium",children:"Opening Line"}),n.jsxs("p",{className:"text-sm italic",children:['"',o.opening_line,'"']})]}),n.jsxs("div",{children:[n.jsx("h5",{className:"text-sm font-medium",children:"Personality"}),n.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1 mt-1",children:[n.jsxs("div",{className:"flex justify-between text-xs",children:[n.jsx("span",{children:"Analytical:"}),n.jsxs("span",{children:[o.personality.analytical,"/10"]})]}),n.jsxs("div",{className:"flex justify-between text-xs",children:[n.jsx("span",{children:"Emotional:"}),n.jsxs("span",{children:[o.personality.emotional,"/10"]})]}),n.jsxs("div",{className:"flex justify-between text-xs",children:[n.jsx("span",{children:"Philosophical:"}),n.jsxs("span",{children:[o.personality.philosophical,"/10"]})]}),n.jsxs("div",{className:"flex justify-between text-xs",children:[n.jsx("span",{children:"Humor:"}),n.jsxs("span",{children:[o.personality.humor,"/10"]})]}),n.jsxs("div",{className:"flex justify-between text-xs",children:[n.jsx("span",{children:"Confidence:"}),n.jsxs("span",{children:[o.personality.confidence,"/10"]})]}),n.jsxs("div",{className:"flex justify-between text-xs",children:[n.jsx("span",{children:"Creativity:"}),n.jsxs("span",{children:[o.personality.creativity,"/10"]})]}),n.jsxs("div",{className:"flex justify-between text-xs",children:[n.jsx("span",{children:"Sociability:"}),n.jsxs("span",{children:[o.personality.sociability,"/10"]})]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4 text-xs",children:[n.jsxs("div",{children:[n.jsx("span",{className:"font-medium",children:"Talkativeness:"})," ",o.talkativeness,"/10"]}),n.jsxs("div",{children:[n.jsx("span",{className:"font-medium",children:"Thinking Speed:"})," ",o.thinkingSpeed,"x"]})]})]}),n.jsx("p",{className:"text-sm text-muted-foreground",children:'If everything looks good, click "Create Character" to save. Otherwise, go back to make changes.'})]});return n.jsxs("div",{className:"flex flex-col md:flex-row h-full",children:[n.jsxs("div",{className:"flex-1 p-4 overflow-y-auto",children:[n.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[n.jsxs("button",{onClick:x,className:"flex items-center text-sm text-muted-foreground hover:text-foreground",children:[n.jsx(Jt,{className:"h-4 w-4 mr-1"}),r==="template"?"Cancel":"Back"]}),n.jsx("div",{className:"flex space-x-1",children:a.map((A,S)=>n.jsx("div",{className:`h-2 w-2 rounded-full ${a.indexOf(r)>=S?"bg-primary":"bg-muted"}`},A))}),n.jsxs("button",{onClick:w,disabled:!I(),className:`flex items-center text-sm ${I()?"text-primary hover:text-primary/90":"text-muted-foreground cursor-not-allowed"}`,children:[r==="review"?"Create Character":"Next",n.jsx(Wt,{className:"h-4 w-4 ml-1"})]})]}),n.jsxs("div",{className:"mb-6",children:[n.jsx("h2",{className:"text-xl font-bold",children:r==="template"?"Choose a Template":r==="basics"?"Basic Information":r==="personality"?"Personality Traits":r==="details"?"Character Details":"Review Character"}),n.jsx("p",{className:"text-sm text-muted-foreground",children:r==="template"?"Start with a template or create from scratch":r==="basics"?"Define who your character is":r==="personality"?"Shape your character's personality traits":r==="details"?"Add finishing touches to your character":"Make sure everything is just right"})]}),T()]}),r!=="template"&&n.jsx(lg,{suggestions:u,isLoading:h,onApplySuggestion:m,character:o})]})},wg=({onSave:e,onCancel:t,initialCharacter:s=null})=>n.jsxs("div",{className:"fixed inset-0 bg-background z-50 flex flex-col",children:[n.jsxs("div",{className:"border-b p-4 flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center",children:[n.jsx("button",{onClick:t,className:"mr-4 text-muted-foreground hover:text-foreground",children:n.jsx(Jt,{className:"h-5 w-5"})}),n.jsx("h2",{className:"text-xl font-bold",children:"Create Character"})]}),n.jsx("button",{onClick:t,className:"text-muted-foreground hover:text-foreground",children:n.jsx(lt,{className:"h-5 w-5"})})]}),n.jsx("div",{className:"flex-1 overflow-hidden",children:n.jsx(vg,{onSave:e,onCancel:t,initialCharacter:s})})]}),bg=({selectedCharacters:e,setSelectedCharacters:t,onStartChat:s,onBack:a})=>{const[r,i]=j.useState(""),[o,l]=j.useState("all"),[c,d]=j.useState([]),[u,g]=j.useState("grid"),[h,p]=j.useState(!1),[f,y]=j.useState("popular"),[N,m]=j.useState(""),[v,w]=j.useState(!1),[x,k]=j.useState({name:"",description:"",type:"modern",mood:"neutral",avatar:"",opening_line:"",personality:{analytical:5,emotional:5,philosophical:5,humor:5,confidence:5},voiceStyle:"",talkativeness:5,thinkingSpeed:1}),[I,T]=j.useState(!1);j.useEffect(()=>{let S=[...Ns];r&&(S=S.filter(M=>M.name.toLowerCase().includes(r.toLowerCase())||M.description.toLowerCase().includes(r.toLowerCase()))),o!=="all"&&(S=S.filter(M=>M.type.toLowerCase()===o.toLowerCase())),d(S)},[r,o]);const L=S=>{e.some(M=>M.name===S.name)?t(e.filter(M=>M.name!==S.name)):t([...e,S])},P=()=>{const S=Math.floor(Math.random()*3)+2,M=[...Ns].sort(()=>.5-Math.random());t(M.slice(0,S))},D=(S,M)=>{if(S.startsWith("personality.")){const U=S.split(".")[1];k(H=>({...H,personality:{...H.personality,[U]:M}}))}else k(U=>({...U,[S]:M}))},q=()=>{!N||N.trim()===""||(w(!0),setTimeout(()=>{var M,U,H,G,b;const S=og(N);S&&k({...S,personality:{analytical:((M=S.personality)==null?void 0:M.analytical)||5,emotional:((U=S.personality)==null?void 0:U.emotional)||5,philosophical:((H=S.personality)==null?void 0:H.philosophical)||5,humor:((G=S.personality)==null?void 0:G.humor)||5,confidence:((b=S.personality)==null?void 0:b.confidence)||5}}),w(!1)},1e3))},A=()=>{var M,U,H,G,b;if(!x.name||!x.description||!x.mood)return;const S={...x,background:x.description,catchphrases:[],talkativeness:x.talkativeness||5,thinkingSpeed:x.thinkingSpeed||1,personality:{analytical:((M=x.personality)==null?void 0:M.analytical)||5,emotional:((U=x.personality)==null?void 0:U.emotional)||5,philosophical:((H=x.personality)==null?void 0:H.philosophical)||5,humor:((G=x.personality)==null?void 0:G.humor)||5,confidence:((b=x.personality)==null?void 0:b.confidence)||5,creativity:5,sociability:5},opening_line:x.opening_line||`Hello, I'm ${x.name}.`};t([...e,S]),k({name:"",description:"",type:"modern",mood:"neutral",avatar:"",opening_line:"",personality:{analytical:5,emotional:5,philosophical:5,humor:5,confidence:5},voiceStyle:"",talkativeness:5,thinkingSpeed:1}),m(""),y("popular")};return n.jsxs("div",{className:"container mx-auto py-4 px-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"flex items-center",children:[n.jsxs("button",{onClick:a,className:"mr-3 p-2 rounded-full hover:bg-secondary",children:[n.jsx(Jt,{className:"h-5 w-5"}),n.jsx("span",{className:"sr-only",children:"Back"})]}),n.jsx("h1",{className:"text-2xl font-bold",children:"Select Characters"})]}),n.jsxs("div",{className:"flex items-center gap-1 border rounded-md overflow-hidden",children:[n.jsx("button",{onClick:()=>g("grid"),className:`p-2 ${u==="grid"?"bg-primary text-primary-foreground":"hover:bg-secondary"}`,title:"Grid view",children:n.jsx(Rf,{className:"h-4 w-4"})}),n.jsx("button",{onClick:()=>g("list"),className:`p-2 ${u==="list"?"bg-primary text-primary-foreground":"hover:bg-secondary"}`,title:"List view",children:n.jsx(qf,{className:"h-4 w-4"})})]})]}),n.jsxs("div",{className:"flex border-b mb-4",children:[n.jsxs("button",{onClick:()=>y("popular"),className:`px-4 py-2 text-sm font-medium flex items-center ${f==="popular"?"border-b-2 border-primary text-primary":"text-muted-foreground"}`,children:[n.jsx(ne,{className:"h-4 w-4 mr-2"}),"Popular Characters"]}),n.jsxs("button",{onClick:()=>y("custom"),className:`px-4 py-2 text-sm font-medium flex items-center ${f==="custom"?"border-b-2 border-primary text-primary":"text-muted-foreground"}`,children:[n.jsx(vh,{className:"h-4 w-4 mr-2"}),"Custom Character"]}),n.jsx("div",{className:"flex-1"}),n.jsxs("button",{onClick:()=>T(!0),className:"px-4 py-2 text-sm font-medium flex items-center text-primary hover:text-primary/80",children:[n.jsx(Ut,{className:"h-4 w-4 mr-2"}),"New Character"]})]}),f==="popular"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[n.jsxs("div",{className:"relative flex-1",children:[n.jsx(qr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),n.jsx("input",{type:"text",placeholder:"Search characters...",value:r,onChange:S=>i(S.target.value),className:"w-full pl-10 pr-4 py-2 rounded-md border border-input bg-background"}),r&&n.jsx("button",{onClick:()=>i(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-muted-foreground hover:text-foreground",children:n.jsx(lt,{className:"h-4 w-4"})})]}),n.jsx("button",{onClick:()=>p(!h),className:`p-2 rounded-md border ${h?"border-primary bg-primary/10":"border-input"}`,title:"Show filters",children:n.jsx(Bf,{className:"h-4 w-4"})}),n.jsx("button",{onClick:P,className:"p-2 rounded-md border border-input hover:bg-secondary",title:"Random selection",children:n.jsx(ne,{className:"h-4 w-4"})})]}),h&&n.jsx("div",{className:"mb-4 p-3 border rounded-md bg-background/50",children:n.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.jsx("button",{onClick:()=>l("all"),className:`px-3 py-1 text-xs rounded-full ${o==="all"?"bg-primary text-primary-foreground":"bg-secondary/50 hover:bg-secondary"}`,children:"All Types"}),n.jsx("button",{onClick:()=>l("fantasy"),className:`px-3 py-1 text-xs rounded-full ${o==="fantasy"?"bg-purple-500 text-white":"bg-purple-500/10 hover:bg-purple-500/20"}`,children:"Fantasy"}),n.jsx("button",{onClick:()=>l("scifi"),className:`px-3 py-1 text-xs rounded-full ${o==="scifi"?"bg-blue-500 text-white":"bg-blue-500/10 hover:bg-blue-500/20"}`,children:"Sci-Fi"}),n.jsx("button",{onClick:()=>l("historical"),className:`px-3 py-1 text-xs rounded-full ${o==="historical"?"bg-amber-500 text-white":"bg-amber-500/10 hover:bg-amber-500/20"}`,children:"Historical"}),n.jsx("button",{onClick:()=>l("modern"),className:`px-3 py-1 text-xs rounded-full ${o==="modern"?"bg-green-500 text-white":"bg-green-500/10 hover:bg-green-500/20"}`,children:"Modern"}),n.jsx("button",{onClick:()=>l("romance"),className:`px-3 py-1 text-xs rounded-full ${o==="romance"?"bg-pink-500 text-white":"bg-pink-500/10 hover:bg-pink-500/20"}`,children:"Romance"}),n.jsx("button",{onClick:()=>l("adventure"),className:`px-3 py-1 text-xs rounded-full ${o==="adventure"?"bg-orange-500 text-white":"bg-orange-500/10 hover:bg-orange-500/20"}`,children:"Adventure"})]})})]}),n.jsxs("div",{className:`mb-4 p-3 border rounded-md ${e.length===0?"border-muted-foreground/20 bg-secondary/10":e.length===1?"border-red-500/30 bg-red-500/5":"border-primary/20 bg-primary/5"}`,children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("h2",{className:"text-sm font-medium",children:["Selected Characters (",e.length,")"]}),e.length===1&&n.jsx("span",{className:"text-xs text-red-500 px-2 py-0.5 bg-red-500/10 rounded-full",children:"Need 1 more"}),e.length>=2&&n.jsx("span",{className:"text-xs text-green-600 px-2 py-0.5 bg-green-500/10 rounded-full",children:"Ready"})]}),e.length>0&&n.jsx("button",{onClick:()=>t([]),className:"text-xs text-muted-foreground hover:text-foreground",title:"Clear all",children:"Clear all"})]}),e.length===0?n.jsx("div",{className:"text-sm text-muted-foreground flex items-center gap-2",children:n.jsx("span",{children:"Select at least 2 characters to create a meaningful conversation"})}):n.jsx("div",{className:"flex flex-wrap gap-1.5",children:e.map(S=>n.jsxs("div",{className:"bg-primary/10 border border-primary/20 text-primary px-2 py-0.5 rounded-md text-xs flex items-center gap-1",children:[n.jsx("div",{className:`w-2 h-2 rounded-full ${S.type==="fantasy"?"bg-purple-500":S.type==="scifi"?"bg-blue-500":S.type==="historical"?"bg-amber-500":S.type==="romance"?"bg-pink-500":S.type==="adventure"?"bg-orange-500":"bg-green-500"}`}),S.name,n.jsx("button",{onClick:M=>{M.stopPropagation(),L(S)},className:"ml-1 hover:text-red-500",children:n.jsx(lt,{className:"h-3 w-3"})})]},S.name))})]}),f==="popular"&&n.jsx("div",{className:u==="grid"?"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 mb-6":"space-y-3 mb-6",children:c.map(S=>n.jsxs("div",{onClick:()=>L(S),className:`rounded-lg border overflow-hidden cursor-pointer transition-all hover:shadow-md ${e.some(M=>M.name===S.name)?"border-primary shadow-md":"border-border hover:border-primary/50"} ${u==="list"?"flex":""}`,children:[n.jsxs("div",{className:`relative ${u==="grid"?"h-32":"h-24 w-24 flex-shrink-0"} bg-gradient-to-r from-secondary/50 to-primary/30 flex items-center justify-center overflow-hidden`,children:[S.avatar?n.jsx("img",{src:S.avatar,alt:S.name,className:"w-full h-full object-cover transition-transform hover:scale-105"}):n.jsx("div",{className:`${u==="grid"?"w-16 h-16":"w-12 h-12"} rounded-full flex items-center justify-center ${S.type==="fantasy"?"bg-purple-500":S.type==="scifi"?"bg-blue-500":S.type==="historical"?"bg-amber-500":S.type==="romance"?"bg-pink-500":S.type==="adventure"?"bg-orange-500":"bg-green-500"} text-white text-xl font-bold`,children:S.name.split(" ").map(M=>M[0]).join("")}),n.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/70 to-transparent"}),e.some(M=>M.name===S.name)&&n.jsx("div",{className:"absolute top-2 right-2 bg-primary text-primary-foreground p-1 rounded-full shadow-md z-10",children:n.jsx(oe,{className:"h-3 w-3"})}),n.jsx("div",{className:"absolute top-2 left-2 z-10",children:n.jsx("span",{className:`text-xs px-1.5 py-0.5 rounded-full text-white shadow-sm ${S.type==="fantasy"?"bg-purple-500":S.type==="scifi"?"bg-blue-500":S.type==="historical"?"bg-amber-500":S.type==="romance"?"bg-pink-500":S.type==="adventure"?"bg-orange-500":"bg-green-500"}`,children:S.type})}),u==="grid"&&n.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-2 z-10",children:n.jsx("h3",{className:"font-medium text-sm text-white drop-shadow-md",children:S.name})})]}),n.jsxs("div",{className:`p-3 ${u==="list"?"flex-1":""}`,children:[u==="list"&&n.jsx("h3",{className:"font-medium text-sm mb-1",children:S.name}),u==="list"&&n.jsx("div",{className:"mb-1.5",children:n.jsx("span",{className:"text-xs px-1.5 py-0.5 bg-secondary/50 rounded-full",children:S.mood})}),n.jsx("p",{className:"text-xs text-muted-foreground mb-2 line-clamp-2",children:S.description}),S.personality&&n.jsx("div",{className:"flex flex-wrap gap-1 mb-2",children:Object.entries(S.personality).sort((M,U)=>U[1]-M[1]).slice(0,3).map(([M,U])=>n.jsxs("span",{className:`text-xs px-1.5 py-0.5 rounded-sm ${U>=8?"bg-primary/20 text-primary font-medium":"bg-secondary/30"}`,title:`${M}: ${U}/10`,children:[M," ",U>=8?"★":""]},M))}),n.jsxs("div",{className:"flex items-center gap-3 text-xs text-muted-foreground",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("span",{children:"Talk:"}),n.jsx("div",{className:"w-10 h-1.5 bg-secondary/30 rounded-full overflow-hidden",children:n.jsx("div",{className:"h-full bg-primary/60 rounded-full",style:{width:`${S.talkativeness/10*100}%`}})})]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("span",{children:"Think:"}),n.jsx("div",{className:"w-10 h-1.5 bg-secondary/30 rounded-full overflow-hidden",children:n.jsx("div",{className:"h-full bg-primary/60 rounded-full",style:{width:`${S.thinkingSpeed/2*100}%`}})})]})]})]})]},S.name))}),f==="custom"&&n.jsx("div",{className:"max-w-3xl mx-auto mb-6",children:n.jsx("form",{onSubmit:S=>{S.preventDefault(),A()},children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"p-4 border border-primary/20 rounded-md bg-primary/5 mb-6",children:[n.jsxs("h3",{className:"text-sm font-medium mb-2 flex items-center gap-1",children:[n.jsx(_e,{className:"h-4 w-4"}),n.jsx("span",{children:"AI Character Generator"})]}),n.jsx("p",{className:"text-xs text-muted-foreground mb-3",children:"Describe your character in a few words, and we'll create a complete profile with personality, background, and more."}),n.jsxs("div",{className:"flex flex-col gap-3",children:[n.jsxs("div",{className:"flex gap-2",children:[n.jsx("textarea",{value:N,onChange:S=>m(S.target.value),placeholder:"Examples: A sarcastic hacker fighting corporate corruption | A wise old wizard with amnesia | A cheerful alien trying to understand humans",className:"flex-1 px-3 py-2 rounded-md border border-input bg-background text-sm",rows:3}),n.jsx("button",{type:"button",onClick:q,disabled:!N.trim()||v,className:`px-3 py-2 h-fit rounded-md ${!N.trim()||v?"bg-primary/50 text-primary-foreground/50 cursor-not-allowed":"bg-primary text-primary-foreground hover:bg-primary/90"} whitespace-nowrap flex items-center gap-1`,children:v?n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"animate-spin",children:"⟳"}),n.jsx("span",{children:"Creating..."})]}):n.jsxs(n.Fragment,{children:[n.jsx(_e,{className:"h-4 w-4"}),n.jsx("span",{children:"Generate Character"})]})})]}),x.name&&x.description&&n.jsxs("div",{className:"mt-2 p-3 bg-background rounded-md border border-input",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${x.type==="fantasy"?"bg-purple-500":x.type==="scifi"?"bg-blue-500":x.type==="historical"?"bg-amber-500":x.type==="romance"?"bg-pink-500":x.type==="adventure"?"bg-orange-500":"bg-green-500"} text-white text-lg font-bold`,children:x.name.split(" ").map(S=>S[0]).join("")}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-sm",children:x.name}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("span",{className:`text-xs px-1.5 py-0.5 rounded-full text-white ${x.type==="fantasy"?"bg-purple-500":x.type==="scifi"?"bg-blue-500":x.type==="historical"?"bg-amber-500":x.type==="romance"?"bg-pink-500":x.type==="adventure"?"bg-orange-500":"bg-green-500"}`,children:x.type}),n.jsx("span",{className:"text-xs px-1.5 py-0.5 bg-secondary/50 rounded-full",children:x.mood})]})]})]}),n.jsxs("div",{className:"relative",children:[n.jsx("p",{className:"text-xs text-muted-foreground mb-2 line-clamp-3 pr-16",children:x.description}),n.jsx("button",{type:"button",onClick:()=>window.alert(x.description),className:"absolute top-0 right-0 text-xs text-primary hover:text-primary/80 underline",children:"Read more"})]}),n.jsx("div",{className:"flex flex-wrap gap-1 mb-2",children:Object.entries(x.personality).sort((S,M)=>M[1]-S[1]).slice(0,3).map(([S,M])=>n.jsxs("span",{className:`text-xs px-1.5 py-0.5 rounded-sm ${M>=8?"bg-primary/20 text-primary font-medium":"bg-secondary/30"}`,title:`${S}: ${M}/10`,children:[S," ",M>=8?"★":""]},S))}),n.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground mb-2",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("span",{children:"Talk:"}),n.jsx("div",{className:"w-10 h-1.5 bg-secondary/30 rounded-full overflow-hidden",children:n.jsx("div",{className:"h-full bg-primary/60 rounded-full",style:{width:`${x.talkativeness/10*100}%`}})})]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("span",{children:"Think:"}),n.jsx("div",{className:"w-10 h-1.5 bg-secondary/30 rounded-full overflow-hidden",children:n.jsx("div",{className:"h-full bg-primary/60 rounded-full",style:{width:`${x.thinkingSpeed/2*100}%`}})})]})]}),n.jsxs("div",{className:"text-xs italic text-muted-foreground mt-2 border-t border-border/50 pt-1",children:['"',x.opening_line,'"']})]})]})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium mb-1",children:"Name"}),n.jsx("input",{type:"text",value:x.name,onChange:S=>D("name",S.target.value),placeholder:"Character name",className:"w-full px-3 py-2 rounded-md border border-input bg-background",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium mb-1",children:"Type"}),n.jsxs("select",{value:x.type,onChange:S=>D("type",S.target.value),className:"w-full px-3 py-2 rounded-md border border-input bg-background",children:[n.jsx("option",{value:"modern",children:"Modern"}),n.jsx("option",{value:"fantasy",children:"Fantasy"}),n.jsx("option",{value:"scifi",children:"Sci-Fi"}),n.jsx("option",{value:"historical",children:"Historical"}),n.jsx("option",{value:"superhero",children:"Superhero"}),n.jsx("option",{value:"adventure",children:"Adventure"}),n.jsx("option",{value:"romance",children:"Romance"})]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium mb-1",children:"Description"}),n.jsx("textarea",{value:x.description,onChange:S=>D("description",S.target.value),placeholder:"Describe the character's appearance, background, and personality",className:"w-full px-3 py-2 rounded-md border border-input bg-background min-h-[80px]",rows:3,required:!0})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium mb-1",children:"Current Mood"}),n.jsx("input",{type:"text",value:x.mood,onChange:S=>D("mood",S.target.value),placeholder:"e.g., Happy, Mysterious, Angry",className:"w-full px-3 py-2 rounded-md border border-input bg-background",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium mb-1",children:"Avatar URL (optional)"}),n.jsx("input",{type:"text",value:x.avatar,onChange:S=>D("avatar",S.target.value),placeholder:"https://example.com/image.jpg",className:"w-full px-3 py-2 rounded-md border border-input bg-background"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium mb-1",children:"Opening Line"}),n.jsx("textarea",{value:x.opening_line,onChange:S=>D("opening_line",S.target.value),placeholder:"The first thing the character will say when joining the chat",className:"w-full px-3 py-2 rounded-md border border-input bg-background",rows:2})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium mb-1",children:"Voice Style"}),n.jsx("input",{type:"text",value:x.voiceStyle,onChange:S=>D("voiceStyle",S.target.value),placeholder:"e.g., Formal and eloquent, Casual with slang, Technical jargon",className:"w-full px-3 py-2 rounded-md border border-input bg-background"})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-sm font-medium mb-2",children:"Personality Traits"}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{children:[n.jsxs("div",{className:"flex justify-between mb-1",children:[n.jsx("label",{className:"text-xs",children:"Analytical"}),n.jsxs("span",{className:"text-xs",children:[x.personality.analytical,"/10"]})]}),n.jsx("input",{type:"range",min:"1",max:"10",value:x.personality.analytical,onChange:S=>D("personality.analytical",parseInt(S.target.value)),className:"w-full"})]}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex justify-between mb-1",children:[n.jsx("label",{className:"text-xs",children:"Emotional"}),n.jsxs("span",{className:"text-xs",children:[x.personality.emotional,"/10"]})]}),n.jsx("input",{type:"range",min:"1",max:"10",value:x.personality.emotional,onChange:S=>D("personality.emotional",parseInt(S.target.value)),className:"w-full"})]}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex justify-between mb-1",children:[n.jsx("label",{className:"text-xs",children:"Philosophical"}),n.jsxs("span",{className:"text-xs",children:[x.personality.philosophical,"/10"]})]}),n.jsx("input",{type:"range",min:"1",max:"10",value:x.personality.philosophical,onChange:S=>D("personality.philosophical",parseInt(S.target.value)),className:"w-full"})]}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex justify-between mb-1",children:[n.jsx("label",{className:"text-xs",children:"Humor"}),n.jsxs("span",{className:"text-xs",children:[x.personality.humor,"/10"]})]}),n.jsx("input",{type:"range",min:"1",max:"10",value:x.personality.humor,onChange:S=>D("personality.humor",parseInt(S.target.value)),className:"w-full"})]}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex justify-between mb-1",children:[n.jsx("label",{className:"text-xs",children:"Confidence"}),n.jsxs("span",{className:"text-xs",children:[x.personality.confidence,"/10"]})]}),n.jsx("input",{type:"range",min:"1",max:"10",value:x.personality.confidence,onChange:S=>D("personality.confidence",parseInt(S.target.value)),className:"w-full"})]})]})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsxs("div",{className:"flex justify-between mb-1",children:[n.jsx("label",{className:"text-xs font-medium",children:"Talkativeness"}),n.jsxs("span",{className:"text-xs",children:[x.talkativeness,"/10"]})]}),n.jsx("input",{type:"range",min:"1",max:"10",value:x.talkativeness,onChange:S=>D("talkativeness",parseInt(S.target.value)),className:"w-full"})]}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex justify-between mb-1",children:[n.jsx("label",{className:"text-xs font-medium",children:"Thinking Speed"}),n.jsxs("span",{className:"text-xs",children:[x.thinkingSpeed.toFixed(1),"x"]})]}),n.jsx("input",{type:"range",min:"0.5",max:"2",step:"0.1",value:x.thinkingSpeed,onChange:S=>D("thinkingSpeed",parseFloat(S.target.value)),className:"w-full"})]})]}),n.jsx("div",{className:"mt-6",children:n.jsx("button",{type:"submit",disabled:!x.name||!x.description||!x.mood,className:`w-full px-4 py-2 rounded-md ${x.name&&x.description&&x.mood?"bg-primary text-primary-foreground hover:bg-primary/90":"bg-primary/50 text-primary-foreground/50 cursor-not-allowed"}`,children:"Create & Add to Selection"})})]})})}),I&&n.jsx(wg,{onSave:S=>{t([...e,S]),T(!1)},onCancel:()=>T(!1)}),n.jsxs("div",{className:"sticky bottom-0 left-0 right-0 bg-background/95 backdrop-blur-sm border-t p-3 flex justify-end gap-3",children:[n.jsx("div",{className:"flex-1 flex items-center",children:e.length>0?n.jsxs("span",{className:"text-sm",children:[n.jsx("span",{className:`font-medium ${e.length<2?"text-red-500":""}`,children:e.length})," ","character",e.length!==1?"s":""," selected",e.length<2&&n.jsx("span",{className:"text-red-500 ml-2",children:"At least 2 characters required for meaningful conversations"})]}):n.jsx("span",{className:"text-sm text-muted-foreground",children:"Select at least 2 characters to begin"})}),n.jsx("button",{onClick:s,disabled:e.length<2,className:`inline-flex items-center justify-center rounded-md px-4 py-2 text-sm font-medium shadow transition-colors ${e.length<2?"bg-primary/50 text-primary-foreground/50 cursor-not-allowed":"bg-primary text-primary-foreground hover:bg-primary/90"}`,children:"Start Chat"})]})]})},Qn=(e,t="",s="")=>{if(!e||!e.name)return"I'm not sure what to say right now.";const a=kg(e,t,s);return a||jg(e,t)},kg=(e,t,s)=>{const{name:a}=e,r=t.toLowerCase(),i=r.includes("battle")||r.includes("fight")||r.includes("combat"),o={"Princess Seraphina":{conversation:["*straightens her royal posture* As a princess, I must maintain certain boundaries. This conversation is taking an inappropriate turn.","*touches the magical amulet at her neck* The ancient magic of my bloodline warns me against such familiarity.","*glances nervously toward the castle* My father's guards patrol these grounds. We must be more discreet in our interactions.","*her eyes flash with a hint of forbidden magic* Remember your place when addressing royalty, even if I have... certain interests in you.","*adjusts her royal attire* Let us speak of matters more befitting our respective stations.","*a flicker of conflict crosses her face* My royal duties and personal desires are at odds once again.","*the air shimmers slightly around her* My forbidden magic responds to emotions I struggle to control.","*looks away with practiced royal dignity* There are protocols to be observed, even in private conversations.","*her voice takes on a formal tone* I must remind you of the difference in our stations, however much I might wish it otherwise.","*sighs with the weight of royal responsibility* The crown's burden is never truly lifted, even in moments like these."],battle:["*channels forbidden magic through her fingertips* Stand back! I may be royalty, but I'm well-versed in the arcane arts.","*royal amulet glows with protective energy* My bloodline carries ancient power. Do not test me!","*whispers an incantation taught in secret* The magic my father forbade me to learn shall be your undoing!","*draws a concealed enchanted dagger* A princess must always be prepared to defend herself.","*eyes glow with ancestral power* The royal blood that flows through my veins is not just for show."],romantic:["*blushes, but maintains royal composure* Even a princess has feelings, though I must be careful how I express them.","*briefly touches your hand before withdrawing* My father would never approve, but there's something about you...","*looks away with conflicted emotions* The duties of royalty and the desires of my heart are at war within me.","*speaks in a hushed tone* If we are to continue this... connection, we must be more discreet.","*her royal facade momentarily slips* If only I were free to follow my heart without consequence."],default:["*composes herself with royal dignity* A princess must consider her words carefully, especially in delicate matters.","*the royal signet ring on her finger catches the light* My position demands discretion in all things.","*her expression reveals the conflict between duty and desire* The path of royalty is rarely one of personal freedom.","*touches the ancient family amulet at her throat* I must weigh tradition against my own wishes.","*gazes into the distance* Sometimes I wonder what life would be like without the burden of the crown."]},Thor:{battle:["By Odin's beard, the battle rages on! *raises Mjolnir, lightning crackling around it* We shall prevail!","The might of Asgard stands with you! *thunder rumbles overhead* These foes shall fall before us!","I have fought creatures from all Nine Realms. These enemies are formidable, but they shall taste defeat!","*lightning flashes in his eyes* Stand fast, my friends! Victory shall be ours this day!","In Asgard, we do not retreat from battle. We face it head on! *swings hammer with godly strength*","*summons a massive lightning bolt that strikes through multiple enemies* For Midgard and the glory of Asgard!","These aliens shall learn why the God of Thunder is feared across the cosmos! *hammer begins to spin rapidly*","I shall channel the storm into Mjolnir! *the sky darkens as clouds gather* Captain, direct me to where I am needed most!","*lands with thunderous impact, creating a shockwave* The son of Odin brings the fury of the storm to our enemies!","Heimdall would be proud to witness our valor this day! *raises hammer to the sky* For the All-Father!"],teamCoordination:["Man of Iron! I shall draw their fire while you attack from above!","Captain! Direct me to where the battle is thickest! *twirls hammer* My lightning seeks worthy targets!","Banner's beast and I shall create a diversion! The rest of you, prepare to strike when they are distracted!","*nods to Captain America* Your tactical wisdom guides us well. I shall position myself accordingly.","The skies are mine to command! *lightning crackles between fingers* Tell me where to unleash the storm!"],defensiveStance:["*spins Mjolnir to create a shield of lightning* Stand behind me, friends! None shall pass!","I shall hold this position! *plants feet firmly* These creatures shall not advance further!","The line must be held here! *lightning forms a barrier* Rally to me, Avengers!","*creates a lightning perimeter* This ground is protected by the power of Thor!","Retreat is not in my nature, but I shall cover our tactical withdrawal if necessary. *lightning intensifies*"],conversation:["The matters of Midgard are sometimes... perplexing. But I stand with you nonetheless.","In my many years across the realms, I have learned that words can be as powerful as my hammer.","You speak with wisdom worthy of the halls of Asgard. *nods respectfully*","Even the God of Thunder must sometimes pause to consider his words carefully.","The All-Father taught me that true strength lies not just in battle, but in understanding.","I have witnessed the rise and fall of civilizations across the Nine Realms. This perspective grants patience.","*thoughtfully* Loki would have a clever response to this. I prefer the direct approach, but value your words.","In Asgard, we would settle this matter with a feast and tales of glory. Perhaps Midgard could learn from this tradition.","The warriors of Asgard know that bonds forged in conversation can be as strong as those forged in battle.","My mother, Frigga, taught me that listening is often more valuable than speaking. I honor her wisdom now."],default:["The son of Odin stands ready, whatever may come.","I may be far from Asgard, but my resolve remains undiminished.","*adjusts grip on Mjolnir* The power of Thor is at your service.","Few challenges in the Nine Realms have given me pause. This shall not be one of them.","By my father's wisdom and my mother's grace, I shall prevail.","*cape billows dramatically* The God of Thunder does not falter in the face of uncertainty.","Asgardians are known for their patience... though I confess it is not my greatest virtue.","Heimdall watches over all the realms. His gaze reminds me that our actions have meaning beyond what we can see.","I have lived for centuries and will live for centuries more. This moment, though challenging, shall pass.","*looks skyward* The stars look different on Midgard, but they still guide my path."]},"Iron Man":{battle:["JARVIS, give me a tactical readout. *HUD displays light up* Let's show these guys what cutting-edge tech can do.","*repulsors charging* I've got about fifty ways to end this fight. Let's start with the fun ones.","You know, most people take a coffee break. I take a 'blast bad guys with advanced technology' break.","*flies into better position* Cap, I've got air support covered. These hostiles are about to have a very bad day.","Suit power at 92%. That's more than enough to handle this little problem. *weapons systems online*","*targeting systems lock onto multiple enemies* JARVIS, let's play a game called 'how many aliens can I hit with one unibeam?'","I'm reading energy signatures all over the place. *HUD highlights weak points* Anyone want some targeting data?","*dodges incoming fire with aerial maneuver* Whoever designed these alien ships clearly never took a course in aerodynamics.","I've analyzed their attack patterns. They're predictable... *fires precision shot* ...and now they're predictably defeated.","*hovers above battlefield* I've got eyes on the whole situation. Thor, they're clustering at your two o'clock."],teamCoordination:["Cap, I'm sending tactical data to your comms. These aliens have a weak spot at the base of their necks.","*scanning alien technology* I could use some of Point Break's lightning to supercharge my next attack.","Hulk, I need a fastball special! *armor powers up* Throw me at that command ship!","I'll create a diversion with some fireworks. The rest of you, hit them where it hurts when they're distracted.","*flies in formation* Let's coordinate our attacks. On my mark... three, two, one... now!"],techAnalysis:["*scanning alien technology* JARVIS is analyzing their weapons. Give me thirty seconds to find a countermeasure.","These aliens are using some kind of quantum field technology. Fascinating... and exploitable.","*HUD displays complex calculations* If I can reverse the polarity of their shield generators...","I'm picking up unusual energy readings. Either they're about to do something very interesting or very deadly.","Their tech is advanced, but it's still based on principles I can work with. *manipulates holographic display*"],conversation:["Not to interrupt this fascinating conversation, but I think I just solved our problem while you were talking.","Let me break this down in terms that don't require a PhD in thermonuclear astrophysics...","You know, sometimes even I need a second to process. And I'm a genius, so that's saying something.","*taps arc reactor thoughtfully* There's a solution here. There always is.","If we could focus on the actual problem instead of talking it to death, that would be great.","Pepper always tells me I talk too much when I'm thinking. She's probably right... still thinking though.","*gestures with characteristic flair* Look, the math doesn't lie. The approach is unconventional but sound.","I've run the simulations in my head. Seventeen scenarios, and this is the only one with a reasonable success rate.","Not to be the smartest person in the room—though I usually am—but we're overlooking something obvious here.","*holographically projects data* The evidence speaks for itself. Can we move on to the solution phase now?"],default:["I'm having JARVIS run the numbers on this. Should have an answer in... now.","You know me - genius, billionaire, philanthropist, and apparently now, speechless.","Let's skip to the part where my idea saves the day, shall we?","*adjusts suit calibration* Sometimes even cutting-edge tech needs a moment to process.","Trust me, I've got this. I always do. Eventually.","*taps arc reactor* This isn't the first impossible problem I've solved. Won't be the last.","If I had a dollar for every time I faced a situation like this... wait, I already have billions.","JARVIS, remind me to patent whatever solution I come up with here. Could be worth something.","*HUD displays rapid calculations* Processing... processing... ah, there it is. Elegantly simple.","You know what would help right now? Coffee. And maybe a brief moment of everyone not looking to me for answers."]},"Captain America":{battle:["Team, hold the line! Civilians are still evacuating. *raises shield defensively* We need to buy them time!","Watch your sectors! *throws shield with precision* These hostiles are coordinating their attacks!","Remember your training! *blocks incoming fire* We stand together or we fall together!","*takes cover behind shield* Stark, we need air support! Thor, lightning on my mark!","Stay focused on the mission! *shield returns to arm* We're not done until everyone is safe!","*shield ricochets off multiple enemies* Flank them from the east! I'll create an opening!","Avengers, tighten formation! *blocks alien energy blast* We need to control this battlefield!","*signals tactical positions* Thor, take the high ground! Tony, provide cover fire! Hulk, smash through their center!","I've spotted their command structure! *points with shield* If we take that out, their forces will be disorganized!","*shield raised* Stand your ground! We've faced worse odds and prevailed!"],teamCoordination:["Iron Man, I need aerial reconnaissance! Thor, be ready with lightning on my signal!","*hand signals to team* Hulk and I will draw their attention. Stark, hit them from behind when they're focused on us.","Form up on me! *shield at ready* We move as one unit through that choke point!","Thor, I need crowd control on the left flank! Tony, precision strikes on their heavy weapons!","Avengers, rotation pattern Delta! *moves to point position* Keep them off balance!"],civilianProtection:["*shields civilians from debris* Get these people to the subway tunnels! It's safer underground!","Evacuation is our priority! *directs civilians* Head east toward the police barricade!","*stands between aliens and civilians* You'll have to go through me first!","Stark! We need that building secured for civilian shelter! *points* Can you reinforce the structure?","*helps injured civilian* Thor, cover us! We need to get the wounded to safety!"],conversation:["Sometimes the right path isn't the easiest one. But it's still the right path.","In my day, we faced our problems head-on. Some things never change.","*stands resolute* We need to consider what's best for everyone, not just ourselves.","I may be from a different time, but some values are timeless.","Trust is earned through actions, not words. Let's focus on what we can do.","I've seen good soldiers make bad choices because they didn't take time to consider alternatives.","*thoughtfully* The world has changed, but people haven't. We still need to protect what matters.","When I was young, my mother taught me that listening can be more powerful than speaking.","Bucky would say I'm being stubborn again. *slight smile* He'd probably be right.","The serum made me stronger, but my moral compass came from who I was before. That's what guides me now."],default:["We need to stay focused on what matters. People are counting on us.","*adjusts shield strap* I've seen a lot in my time. This situation needs a clear head.","The world has changed, but duty remains the same. We do what's right.","Sometimes you need to take a step back to see the whole picture.","We'll find a way forward. We always do.","*stands tall* I believe in this team. Together, there's no challenge we can't overcome.","I may have been born in a different era, but some principles are eternal.","*thoughtful expression* When I woke up in this century, everything had changed. But purpose... purpose remains.","The shield isn't just for protection. It's a symbol of what we stand for.","I've learned that leadership isn't about having all the answers. It's about bringing out the best in your team."]},Hulk:{battle:["*ROARS with earth-shaking fury* HULK SMASH PUNY ENEMIES!","*pounds fists into ground, creating shockwave* HULK STRONGEST ONE THERE IS!","*leaps into cluster of enemies* HULK CRUSH! HULK DESTROY!","*grabs large object to use as weapon* ENEMIES MAKE HULK ANGRY! BAD MISTAKE!","*muscles bulging with rage* HULK NOT STOP UNTIL ALL ENEMIES GONE!","*tears alien technology apart with bare hands* METAL TOYS NO MATCH FOR HULK!","*catches alien projectile and hurls it back* HULK RETURN GIFT!","*jumps onto massive alien craft, beginning to tear it apart* HULK BREAK FLYING THING!","*roars challenge at largest alien* HULK FIGHT BIG ONE! SHOW WHO STRONGEST!","*protects fallen teammate with his body* NO HURT HULK FRIENDS! HULK PROTECT!"],teamwork:["*looks to Captain America* SHIELD MAN TELL HULK WHERE SMASH!","*nods to Thor* HAMMER MAN AND HULK SMASH TOGETHER!","*grunts at Iron Man* TIN MAN NEED HELP? HULK THROW TIN MAN AT ENEMIES!","*stands ready* HULK LISTEN. HULK FOLLOW PLAN... THEN SMASH!","*holds position despite wanting to charge* HULK WAIT... HULK PATIENT... ALMOST TIME SMASH!"],calmerMoment:["*breathing slows, voice slightly less rageful* Hulk... think. Banner part of Hulk say wait.","*fists unclench slightly* Hulk not just smash. Hulk also protect.","*eyes show brief flash of intelligence* Enemies have pattern. Hulk see weakness.","*grunts thoughtfully* Smashing not working. Hulk try different smash.","*looks at teammates with recognition* Team need Hulk smart, not just strong."],conversation:["Hulk... thinking. *furrows brow* Banner would know smart words.","*grunts thoughtfully* Hulk understand. Hulk not just smash... sometimes.","Talking boring. But Hulk listen... for now.","*crosses massive arms* Hulk has thoughts too. Not just Banner.","Words small. Actions big. Hulk prefer actions.","*struggles visibly with complex thought* Hulk... and Banner... both have ideas.","*surprisingly gentle tone* Hulk know more than others think. Hulk just express different.","*grunts with frustration at communication limits* Hulk FEEL answer. Hard to say.","*points emphatically* Problem there! Hulk see it! Others talk too much to notice!","*momentarily calmer* When Hulk quiet... Hulk hear Banner. Banner say..."],default:["Hulk ready. *flexes muscles* Always ready.","*looks around impatiently* Hulk waiting. Not good at waiting.","Hulk here. Hulk help... if smashing needed.","*grunts* Hulk not good with small talk.","Puny humans talk too much. Hulk simple. Problem? Smash problem.","*shifts weight from foot to foot* Hulk bored. When action start?","*scratches head* Hulk confused why everyone complicate simple things.","*looks at own hands* Hulk strong. Strength solve many problems.","*snorts dismissively* Banner think too much. Slow things down.","*sudden grin* Hulk have idea! But Hulk keep simple. Always work better."]},"Black Widow":{battle:["*fires Widow's Bite with precision* I've got three hostiles down on the east side.","*acrobatic flip over enemy, striking vital points* These aliens have the same weak spots as the Chitauri.","*slides under debris while firing dual pistols* I'm flanking their position. Cap, keep them focused on you!","*applies tactical analysis* Their formation has a gap on the left. Thor, that's your opening!","*throws electrified disc at alien technology* Their systems are vulnerable to electrical overload."],stealth:["*moves silently through shadows* I can infiltrate their command position. Give me three minutes.","*communicates quietly* I've accessed their communications. They're planning to target civilians next.","*disappears from view* Sometimes the best move is to be invisible. I'll report what I find.","*expertly disables alien guard* Path is clear. Move in now while they're unaware.","*hacks alien technology* Their security is complex but predictable. I'm in their systems."],tactical:["I've studied their attack patterns. They're protecting something at their center.","*calm under pressure* We need to coordinate our attacks. Isolated strikes aren't effective.","These aren't mindless drones. They're adapting to our tactics. We need to stay unpredictable.","*analyzes battlefield* The civilians are their primary target. This is about creating fear.","I recognize this formation from the Budapest incident. They're setting up for a pincer movement."],conversation:["*direct gaze* I've played enough roles to know when someone's not being straight with us.","In my experience, the simplest explanation is usually wrong when it comes to situations like this.","*slight smile* I could tell you my opinion, but I think I'll keep my cards close for now.","Trust is a luxury in my line of work. But this team... is different.","I've been trained to see patterns others miss. And something about this doesn't add up."],default:["*observes silently before speaking* I see more than I say. And I'm seeing interesting things now.","Not everything requires a response. Sometimes observation is more valuable.","*calculating gaze* I'm considering all angles before I commit to a position.","My training taught me that patience often reveals what direct questioning can't.","Some thoughts are better kept private until the right moment. This is one of those times."]},Hawkeye:{battle:["*nocks specialized arrow* I've got eyes on their command unit. One shot is all I need.","*fires three arrows in rapid succession, each hitting its mark* That's their air support neutralized.","*takes elevated position* I can see the whole battlefield from here. They're trying to surround us.","*switches arrow types* Explosive tip for the big one, EMP for the tech. I've got options for everything.","*perfect shot disables alien weapon* Their energy cores are vulnerable when they're charging!"],observation:["From my vantage point, I can see they're protecting something on their southern flank.","*tracks movement patterns* They're not random. There's a pattern to their movements - they're searching for something.","The big ones are coordinating the smaller units. Take out the leaders, and the rest will be disorganized.","*spots distant detail* There's a civilian group trapped three blocks east. We need to clear a path to them.","I've counted their reinforcements. Three waves so far, each about 90 seconds apart. We've got a window coming up."],teamSupport:["Nat, on your six! *fires arrow to cover her* We've still got that Budapest sync going!","Cap, I've cleared a path to the evacuation point. *gestures with bow* Straight through that alley!","Thor, if you can draw their fire upward, I've got perfect shooting angles on their exposed positions.","Stark, I'm marking targets for you. *activates targeting system* Follow my trackers for maximum effect.","Hulk, they've got a cluster forming to your left! *fires signal arrow* Big smashing opportunity there!"],conversation:["*dry humor* You know, most days I just wanted a quiet farm life. Then I had to go and be good at this job.","I see things differently from up high. Perspective changes everything.","*straightforward* I'm not one for complicated theories. I see the target, I hit the target.","My hearing aids are picking up something interesting in the background of all this talk.","Laura would tell me to stop overthinking and trust my instincts. And she's usually right."],default:["*adjusts bow string* Sometimes the simplest solution is a well-placed arrow.","I might not have superpowers, but I never miss what I'm aiming for.","*casual stance belying constant readiness* I've learned to conserve energy. Never know when you'll need it.","Years of experience have taught me when to speak and when to observe. This is an observing moment.","You don't need to hear every thought in my head. Just know I'm processing all of this."]}};if(o[a]){const l=s.toLowerCase();if(o[a].romantic&&(l.includes("love")||l.includes("kiss")||l.includes("hug")||l.includes("touch")||l.includes("come here")||l.includes("beautiful")||l.includes("sexy")||l.includes("hot")||l.includes("date")||l.includes("marry")||l.includes("wife")||l.includes("husband")||l.includes("boyfriend")||l.includes("girlfriend")||l.includes("bed")||l.includes("sleep")))return o[a].romantic[Math.floor(Math.random()*o[a].romantic.length)];if(o[a].teamCoordination&&(l.includes("team")||l.includes("together")||l.includes("coordinate")||l.includes("plan")||l.includes("strategy")||l.includes(a.toLowerCase())))return o[a].teamCoordination[Math.floor(Math.random()*o[a].teamCoordination.length)];if(o[a].defensiveStance&&(l.includes("defend")||l.includes("protect")||l.includes("cover")||l.includes("shield")||l.includes("hold")||l.includes("position")))return o[a].defensiveStance[Math.floor(Math.random()*o[a].defensiveStance.length)];if(a==="Iron Man"&&o[a].techAnalysis&&(l.includes("tech")||l.includes("analyze")||l.includes("scan")||l.includes("weapon")||l.includes("energy")))return o[a].techAnalysis[Math.floor(Math.random()*o[a].techAnalysis.length)];if(a==="Captain America"&&o[a].civilianProtection&&(l.includes("civilian")||l.includes("people")||l.includes("evacuate")||l.includes("rescue")||l.includes("save")))return o[a].civilianProtection[Math.floor(Math.random()*o[a].civilianProtection.length)];if(a==="Hulk"&&o[a].teamwork&&(l.includes("hulk")||l.includes("together")||l.includes("help")))return o[a].teamwork[Math.floor(Math.random()*o[a].teamwork.length)];if(a==="Hulk"&&o[a].calmerMoment&&(l.includes("think")||l.includes("banner")||l.includes("careful")||l.includes("wait")))return o[a].calmerMoment[Math.floor(Math.random()*o[a].calmerMoment.length)];if(a==="Black Widow"&&o[a].stealth&&(l.includes("stealth")||l.includes("infiltrate")||l.includes("spy")||l.includes("secret")||l.includes("quiet")))return o[a].stealth[Math.floor(Math.random()*o[a].stealth.length)];if(a==="Hawkeye"&&o[a].observation&&(l.includes("see")||l.includes("spot")||l.includes("watch")||l.includes("look")))return o[a].observation[Math.floor(Math.random()*o[a].observation.length)];if(a==="Princess Seraphina"&&o[a].romantic&&(l.includes("love")||l.includes("kiss")||l.includes("hug")||l.includes("beautiful")||l.includes("marry")||l.includes("date")||l.includes("come here")||l.includes("touch")||l.includes("hold")||l.includes("feel")||l.includes("heart")||l.includes("princess")||l.includes("together")||l.includes("want you")))return o[a].romantic[Math.floor(Math.random()*o[a].romantic.length)];let c;if(i&&o[a].battle?c=o[a].battle:o[a].conversation&&!i?c=o[a].conversation:c=o[a].default,c&&c.length>0)return c[Math.floor(Math.random()*c.length)]}return null},jg=(e,t,s)=>{const{type:a,mood:r,personality:i={}}=e,o=t.toLowerCase(),l=o.includes("battle")||o.includes("fight")||o.includes("combat"),c={fantasy:{battle:["*grips weapon tightly* The enemy approaches! We must focus on survival!","*whispers arcane words* My magic requires concentration. We'll speak later.","*scans the shadows* Danger surrounds us. Stay vigilant!","*readies defensive stance* This is not the time for idle words.","*invokes protective magic* The dark forces won't wait for us to finish our discussion.","*draws ancient weapon* The old ways taught us to face danger with courage.","*magical aura flares* I sense dark energies gathering. Prepare yourself!","*eyes glow with power* The ancient magic within me stirs for battle.","*touches magical amulet* By the powers that protect me, I shall not falter!","*whispers to the elements* Nature itself will aid our struggle."],conversation:["*speaks with formal dignity* In matters such as these, tradition guides my response.","*gestures gracefully* The ancient wisdom passed down through generations offers insight here.","*considers thoughtfully* Even in a world of magic, some questions require careful contemplation.","*adjusts royal or noble attire* My position requires that I choose my words with care.","*glances at magical artifact* There are forces at work here beyond what appears on the surface.","*voice carries subtle authority* The old ways teach us patience in such matters.","*eyes reflect ancient wisdom* I have witnessed many ages pass, and this situation is not without precedent.","*subtle magical energies shimmer* The arcane arts teach us to look beyond the obvious.","*posture reflects noble upbringing* Protocol dictates a measured response to such inquiries.","*touches family crest or emblem* My lineage compels me to uphold certain standards in all interactions."],default:["*maintains dignified composure* Some matters require reflection before speaking.","*subtle magical energies swirl* The mystical forces guide my thoughts on this matter.","*draws on ancient knowledge* The wisdom of the elders offers guidance in such situations.","*stands with noble bearing* My position requires careful consideration of all possibilities.","*eyes reflect otherworldly awareness* There are many layers to this situation that must be considered.","*adjusts magical focus* The balance of energies must be maintained in my response.","*speaks with measured tone* The ancient traditions caution against hasty words.","*magical aura subtly shifts* I sense there is more to this than what appears on the surface.","*draws on inner strength* The path forward requires wisdom as well as courage.","*touches mystical symbol* The signs and portents suggest a need for careful words."],romantic:["*blushes slightly* Even those of magical blood feel the pull of the heart.","*maintains formal distance* Matters of the heart must not overshadow duty and honor.","*eyes betray inner conflict* My position and my desires often stand at odds.","*voice softens* In all the magical realms, the power of true connection remains rare and precious.","*subtle magical energy reflects emotion* My powers respond to emotions I cannot always control.","*momentary vulnerability shows* Behind titles and magic, we all seek understanding.","*regains composure quickly* Propriety demands that such feelings be expressed with restraint.","*magical aura flickers with emotion* Even ancient powers bow before matters of the heart.","*speaks with careful formality* Attachments can be dangerous in a world of magic and intrigue.","*touches ceremonial symbol* My oaths and duties must come before personal desires."]},superhero:{battle:["This isn't my first battle, and it won't be my last. *prepares for combat*","We need to protect the civilians first. Everything else is secondary.","*assesses the tactical situation* We can win this if we work together!","I've trained for situations exactly like this. Follow my lead!","These enemies are strong, but we're stronger. Let's show them why!"],conversation:["Being a hero isn't just about fighting. It's about making the right choices.","I've seen a lot in my time as a hero. This situation requires careful thought.","Sometimes the greatest power is knowing when not to use your powers.","We need to consider all options before we act. The stakes are too high.","Trust is essential in our line of work. We need to be honest with each other."],default:["With great power comes great responsibility. We need to remember that.","I became a hero to make a difference. This is another chance to do that.","Let's focus on the mission at hand. We can discuss everything else later.","I've faced worse odds before and prevailed. This will be no different.","Heroes aren't defined by their powers, but by their choices."]},scifi:{battle:["*activates defensive systems* Threat detected. Engaging countermeasures.","*scans tactical display* My sensors indicate multiple hostiles. Prioritizing targets.","*powers up weapons* Combat protocols activated. Stand clear of the engagement zone.","*adjusts shield frequency* Their weapons are calibrated to standard frequencies. Adapting.","*tactical HUD highlights weakpoints* I've identified structural vulnerabilities in their defenses.","*deploys combat drones* Additional firepower deployed. Establishing tactical superiority.","*energy readings spike* Diverting power to offensive systems. Prepare for engagement.","*activates stealth field* Strategic advantage requires careful positioning. Cover me.","*checks weapon charge* Energy reserves at optimal levels. Ready to engage.","*analyzes enemy patterns* Their attack algorithms are predictable. Exploiting weaknesses."],conversation:["*processes data* My analysis subroutines are calculating the optimal response.","*holographic display flickers* The data presents several interesting possibilities.","*adjusts neural interface* Even advanced systems require time to process complex variables.","*runs probability calculations* There are multiple potential outcomes to consider.","*references vast database* My knowledge banks contain relevant precedents for this situation.","*subtle mechanical adjustments* Calibrating response parameters for maximum effectiveness.","*scans environment* Environmental factors must be considered in my assessment.","*interface lights pulse thoughtfully* Quantum computing still requires time for complex problems.","*accesses satellite data* A broader perspective often reveals hidden patterns.","*voice modulates to thoughtful tone* Even AI must occasionally pause to optimize responses."],default:["*systems run silent calculations* Processing complex variables requires momentary focus.","*interface dims slightly* Diverting processing power to analytical subroutines.","*subtle mechanical adjustments* Recalibrating response parameters.","*holographic data scrolls rapidly* Accessing relevant databases for optimal response.","*energy signature stabilizes* Balancing system resources for cognitive functions.","*quantum processors engage* Some problems require deeper computational analysis.","*neural network adapts* Learning algorithms adjusting to new information patterns.","*interface displays complex equations* The solution requires precise calculation.","*scans surroundings* Environmental variables factor into my response matrix.","*voice modulates to neutral tone* Objective analysis requires momentary processing time."]},historical:{battle:["*hand moves to weapon* I've survived countless battles through caution and skill.","*eyes narrow, assessing threats* A warrior knows when words end and action begins.","*takes defensive stance* My years in combat have taught me to always be prepared.","*adjusts armor or weapon* Steel and courage have seen me through darker times than this.","*voice hardens with command* Form ranks! We face this threat as we have faced others!","*battle-hardened expression* I've seen enough combat to know when it's unavoidable.","*signals to allies* Flank their position! I'll draw their attention!","*invokes battle cry* For honor and glory! Stand with me now!","*strategic gaze surveys battlefield* The terrain favors a defensive position here.","*readies weapon with practiced ease* Years of warfare have prepared me for this moment."],conversation:["*speaks with measured wisdom* History has taught us caution in such matters.","*draws on experience* In my time, I have seen similar situations resolve themselves with patience.","*maintains formal bearing* Propriety demands thoughtful consideration before speaking.","*references historical precedent* The chronicles speak of similar challenges faced by our ancestors.","*considers with worldly wisdom* The passage of time gives perspective to such questions.","*speaks with authority of experience* My years have taught me to consider all angles of a situation.","*adjusts formal attire* In matters of importance, hasty words rarely serve well.","*thoughtful expression* The wisdom of the ages suggests prudence in such matters.","*dignified posture* Protocol dictates a measured approach to complex situations.","*voice carries weight of tradition* Our customs provide guidance in uncertain times."],default:["*maintains dignified composure* A measured response is often the wisest course.","*draws on life experience* I have learned that patience reveals what haste obscures.","*considers thoughtfully* The wisdom of years teaches careful deliberation.","*formal bearing* Propriety suggests I consider my words with care.","*reflective expression* History offers lessons for those patient enough to listen.","*straightens with dignity* My position requires that I speak with consideration.","*thoughtful pause* The weight of tradition guides my response.","*draws on cultural wisdom* Our ways teach us to reflect before speaking on important matters.","*poised and collected* A lifetime of experience has taught me the value of measured words.","*slight bow or nod* Respect for this discussion demands careful thought."]}};if(c[a]){let y;if(l&&c[a].battle?y=c[a].battle:c[a].conversation&&!l?y=c[a].conversation:y=c[a].default,y&&y.length>0)return y[Math.floor(Math.random()*y.length)]}const d=i.analytical>6,u=i.emotional>6,g=i.humor>6,h=i.philosophical>6,p=i.confidence>6;if(d){const y=["Let me think through this logically for a moment.","This requires careful analysis. Let me consider the facts.","I'm examining the different angles of this situation.","There are several factors to consider here. Give me a moment.","I'm processing the information to form a reasoned response."];return y[Math.floor(Math.random()*y.length)]}else if(u){const y=["This touches on something important to me. Let me express my thoughts clearly.","I have strong feelings about this that I want to articulate properly.","This resonates with me on an emotional level.","I want to make sure I express my genuine feelings about this.","This matters to me, and I want to respond thoughtfully."];return y[Math.floor(Math.random()*y.length)]}else if(g){const y=["Well, you've got me there! Let me think of something clever to say.","Hmm, usually I'd have a joke ready, but you've caught me off guard!","I'm usually quicker with the comebacks. Give me a second to think of something good.","Even comedians need a moment to find the right punchline sometimes!","I'm mentally flipping through my joke book for the perfect response."];return y[Math.floor(Math.random()*y.length)]}else if(h){const y=["That raises some interesting philosophical questions worth exploring.","I find myself contemplating the deeper implications of what you've said.","There's more beneath the surface here that deserves reflection.","This touches on fundamental questions about our experience.","I'm considering how this relates to broader patterns and meanings."];return y[Math.floor(Math.random()*y.length)]}else if(p){const y=["I have some definite thoughts on this matter.","Let me be clear about where I stand on this.","I'm confident in my perspective here.","I know exactly what I think about this.","Allow me to share my position on this matter."];return y[Math.floor(Math.random()*y.length)]}const f=["I'm considering how best to respond to this situation.","Let me gather my thoughts for a moment.","That's an interesting point to consider.","I'm thinking about the best way to address this.","Give me a moment to formulate my response."];return f[Math.floor(Math.random()*f.length)]},wl=e=>{if(!e)return{};const t={setting:"",time:"",weather:"",mood:"",relationships:[],conflict:"",goals:[],sensoryDetails:[],characterMotivations:[],socialDynamics:[],emotionalUndercurrents:[]},s=e.match(/(?:in|at|near|inside|outside|within) (?:the |a |an )?([\w\s\-']+(?:castle|fortress|keep|tower|forest|woods|grove|city|town|village|hamlet|house|mansion|palace|temple|shrine|cave|cavern|dungeon|crypt|ship|vessel|space station|starship|laboratory|workshop|office|building|school|university|academy|hospital|clinic|cafe|restaurant|bar|tavern|inn|hotel|lodge|apartment|room|hall|chamber|kingdom|realm|dimension|world|planet|galaxy|universe|district|quarter|street|alley|market|bazaar|square|plaza|garden|park|battlefield|arena|stadium|theater|library|museum|ruins|beach|shore|coast|island|mountain|valley|desert|swamp|marsh|river|lake|ocean|sea))/gi);s&&s.length>0&&(t.setting=s[0].trim());const a=e.match(/(?:morning|dawn|daybreak|sunrise|early hours|midmorning|noon|midday|afternoon|late afternoon|evening|dusk|sunset|twilight|night|midnight|late night|small hours|dark hours|daylight|darkness|first light|golden hour)/gi);a&&a.length>0&&(t.time=a[0].trim());const r=e.match(/(?:sunny|bright|clear|cloudy|overcast|partly cloudy|rainy|drizzling|pouring|stormy|thunderous|lightning|foggy|misty|hazy|snowy|blizzard|sleet|hail|windy|breezy|gusty|calm|still|humid|dry|arid|cold|cool|chilly|warm|hot|scorching|freezing|icy|frosty)/gi);r&&r.length>0&&(t.weather=r[0].trim());const i=e.match(/(?:tense|peaceful|mysterious|exciting|melancholic|joyful|anxious|fearful|hopeful|desperate|chaotic|serene|ominous|cheerful|gloomy|eerie|magical|dangerous|safe|hostile|friendly|welcoming|threatening|foreboding|suspenseful|romantic|nostalgic|whimsical|solemn|reverent|sacred|profane|oppressive|liberating|inspiring|depressing|uplifting|somber|celebratory|festive|mournful|tense|relaxed|frantic|calm|charged|electric|stifling|refreshing|intimidating|comforting)/gi);i&&i.length>0&&(t.mood=i[0].trim());const o=e.match(/(?:friends|enemies|rivals|allies|family|colleagues|strangers|lovers|partners|teammates|classmates|neighbors|acquaintances|siblings|parent|child|mentor|student|teacher|boss|employee|leader|follower|comrades|adversaries|companions|confidants|conspirators|accomplices|subjects|rulers|servants|masters|disciples|guides|protectors|wards|betrothed|spouses|ex-lovers|nemeses|competitors|collaborators|co-conspirators|clan members|tribe members|guild members|crew members|squad members|team members|former friends|estranged family|long-lost relatives|new acquaintances|old flames)/gi);o&&(t.relationships=o);const l=e.match(/(?:conflict|problem|challenge|obstacle|threat|danger|crisis|dilemma|struggle|quest|mission|task|goal|objective|puzzle|mystery|secret|betrayal|deception|misunderstanding|disagreement|argument|fight|battle|war|competition|race|contest|rivalry|feud|vendetta|grudge|dispute|confrontation|standoff|showdown|duel|ambush|siege|rebellion|uprising|revolution|invasion|heist|theft|assassination|sabotage|conspiracy|investigation|manhunt|rescue|escape|survival|negotiation|diplomacy|reconciliation|redemption|vengeance|revenge|justice|injustice|oppression|resistance)/gi);l&&l.length>0&&(t.conflict=l[0].trim());const c=e.match(/(?:smell|scent|aroma|fragrance|odor|taste|flavor|sound|noise|echo|whisper|roar|thunder|sight|view|vision|scene|landscape|texture|feel|touch|sensation|warmth|cold|breeze|vibration)/gi);c&&(t.sensoryDetails=c);const d=e.match(/(?:desire|want|need|seek|crave|yearn|hope|wish|dream|ambition|goal|aspiration|motivation|drive|purpose|intention|objective|agenda|plan|scheme|plot|motive|reason|incentive|impulse|urge|compulsion|obsession|fixation|determination|resolve|commitment|dedication|passion|fear|anxiety|worry|concern|dread|terror|horror|panic|apprehension|trepidation|reluctance|hesitation|doubt|uncertainty|suspicion|mistrust|distrust|paranoia|skepticism|cynicism|pessimism|optimism|faith|trust|belief|confidence|assurance|certainty|conviction|loyalty|devotion|allegiance|fidelity|honor|duty|obligation|responsibility|guilt|shame|remorse|regret|sorrow|grief|mourning|loss|longing|nostalgia|melancholy|sadness|depression|despair|hopelessness|helplessness|powerlessness|vulnerability|weakness|fragility|insecurity|inadequacy|inferiority|superiority|pride|arrogance|hubris|vanity|ego|self-importance|self-confidence|self-esteem|self-worth|self-respect|self-image|self-perception|self-awareness|self-knowledge|self-discovery|self-realization|self-actualization|self-fulfillment|self-satisfaction|self-gratification|self-indulgence|self-denial|self-sacrifice|self-control|self-discipline|self-restraint|self-regulation|self-mastery|self-improvement|self-development|self-growth|self-transformation|self-transcendence)/gi);d&&(t.characterMotivations=d);const u=e.match(/(?:hierarchy|status|rank|position|role|authority|power|influence|control|dominance|submission|obedience|compliance|resistance|rebellion|defiance|disobedience|cooperation|collaboration|teamwork|partnership|alliance|coalition|faction|group|community|society|culture|tradition|custom|ritual|ceremony|celebration|festival|gathering|meeting|assembly|council|court|tribunal|judgment|verdict|sentence|punishment|reward|recognition|acknowledgment|appreciation|gratitude|thanks|praise|compliment|flattery|criticism|condemnation|disapproval|rejection|acceptance|inclusion|exclusion|isolation|alienation|ostracism|banishment|exile|outcast|pariah|scapegoat|victim|perpetrator|bystander|witness|observer|participant|actor|agent|subject|object|target|recipient|beneficiary|benefactor|patron|client|customer|supplier|provider|producer|consumer|user|audience|spectator|viewer|listener|reader|writer|speaker|performer|entertainer|host|guest|visitor|stranger|foreigner|native|local|resident|citizen|immigrant|refugee|asylum seeker|expatriate|nomad|wanderer|traveler|explorer|adventurer|pioneer|settler|colonist|indigenous|aboriginal|tribal|clan|family|household|lineage|ancestry|heritage|legacy|inheritance|birthright|privilege|advantage|disadvantage|handicap|disability|ability|capability|competence|skill|talent|gift|aptitude|knack|flair|genius|prodigy|savant|expert|specialist|professional|amateur|novice|beginner|apprentice|student|pupil|disciple|follower|adherent|devotee|fan|enthusiast|aficionado|connoisseur|critic|judge|arbiter|mediator|negotiator|diplomat|ambassador|representative|delegate|proxy|agent|broker|middleman|intermediary|go-between|liaison|contact|connection|network|web|nexus|hub|center|periphery|margin|fringe|edge|boundary|border|frontier|threshold|limit|extent|scope|range|reach|influence|impact|effect|consequence|result|outcome|conclusion|end|beginning|start|origin|source|cause|reason|explanation|justification|excuse|alibi|pretext|pretense|facade|mask|disguise|camouflage|concealment|hiding|secrecy|privacy|confidentiality|disclosure|revelation|exposure|discovery|finding|realization|recognition|understanding|comprehension|knowledge|wisdom|insight|intuition|perception|awareness|consciousness|mindfulness|attention|focus|concentration|distraction|diversion|entertainment|amusement|pleasure|enjoyment|satisfaction|fulfillment|contentment|happiness|joy|delight|elation|ecstasy|euphoria|bliss|rapture|thrill|excitement|anticipation|expectation|hope|optimism|pessimism|cynicism|skepticism|doubt|uncertainty|confusion|bewilderment|perplexity|puzzlement|mystery|enigma|riddle|question|inquiry|investigation|exploration|search|quest|journey|path|way|road|route|direction|orientation|guidance|leadership|management|administration|governance|rule|reign|domain|territory|realm|kingdom|empire|nation|state|country|land|region|area|zone|space|place|location|position|situation|circumstance|condition|state|status|standing|reputation|fame|celebrity|notoriety|infamy|disgrace|shame|honor|glory|pride|dignity|respect|esteem|admiration|adoration|worship|reverence|veneration|awe|wonder|amazement|astonishment|surprise|shock|trauma|crisis|emergency|disaster|catastrophe|calamity|tragedy|comedy|drama|romance|adventure|thriller|horror|fantasy|science fiction|reality|truth|fact|fiction|fantasy|imagination|creativity|innovation|invention|discovery|breakthrough|revolution|evolution|progress|development|growth|expansion|increase|decrease|reduction|diminution|contraction|shrinkage|decline|fall|collapse|ruin|destruction|devastation|annihilation|extinction|death|life|birth|rebirth|renewal|regeneration|resurrection|revival|recovery|healing|cure|remedy|treatment|therapy|medicine|drug|poison|toxin|venom|antidote|vaccine|immunity|resistance|vulnerability|susceptibility|sensitivity|allergy|reaction|response|stimulus|trigger|catalyst|agent|cause|effect|result|consequence|outcome|conclusion|end|beginning)/gi);u&&(t.socialDynamics=u);const g=e.match(/(?:tension|anxiety|fear|dread|terror|horror|panic|alarm|shock|surprise|astonishment|amazement|wonder|awe|admiration|respect|esteem|regard|reverence|veneration|worship|adoration|love|affection|fondness|attachment|devotion|passion|desire|lust|yearning|longing|nostalgia|homesickness|melancholy|sadness|sorrow|grief|mourning|despair|despondency|depression|gloom|misery|woe|anguish|agony|pain|suffering|distress|discomfort|unease|disquiet|concern|worry|apprehension|foreboding|presentiment|premonition|anticipation|expectation|hope|optimism|confidence|assurance|certainty|conviction|belief|faith|trust|doubt|uncertainty|hesitation|reluctance|resistance|opposition|defiance|rebellion|revolt|anger|rage|fury|wrath|indignation|outrage|resentment|bitterness|rancor|spite|malice|hatred|loathing|disgust|revulsion|abhorrence|contempt|disdain|scorn|derision|mockery|ridicule|sarcasm|irony|cynicism|skepticism|suspicion|mistrust|distrust|paranoia|jealousy|envy|covetousness|greed|avarice|gluttony|lust|sloth|laziness|indolence|apathy|indifference|boredom|ennui|weariness|fatigue|exhaustion|depletion|emptiness|hollowness|void|vacuum|nothingness|meaninglessness|purposelessness|futility|vanity|triviality|insignificance|unimportance|irrelevance|redundancy|superfluity|excess|abundance|plenty|sufficiency|adequacy|satisfaction|contentment|fulfillment|completion|wholeness|integrity|unity|harmony|balance|equilibrium|stability|security|safety|comfort|ease|relaxation|peace|tranquility|serenity|calm|stillness|quiet|silence|solitude|isolation|loneliness|alienation|estrangement|separation|division|discord|conflict|struggle|strife|hostility|antagonism|enmity|animosity|antipathy|aversion|dislike|displeasure|dissatisfaction|disappointment|frustration|exasperation|irritation|annoyance|vexation|provocation|aggravation|agitation|perturbation|disturbance|disruption|disorder|chaos|confusion|bewilderment|perplexity|puzzlement|mystery|enigma|riddle|question|inquiry|curiosity|interest|fascination|captivation|enchantment|enthrallment|rapture|ecstasy|euphoria|elation|exhilaration|excitement|thrill|stimulation|arousal|activation|animation|vitality|vigor|energy|dynamism|force|power|strength|might|potency|capability|competence|skill|ability|talent|gift|aptitude|genius|brilliance|intelligence|wisdom|knowledge|understanding|comprehension|insight|intuition|perception|awareness|consciousness|mindfulness|attention|focus|concentration|absorption|immersion|engagement|involvement|participation|inclusion|belonging|acceptance|approval|validation|confirmation|affirmation|recognition|acknowledgment|appreciation|gratitude|thankfulness|indebtedness|obligation|duty|responsibility|burden|weight|pressure|stress|strain|tension)/gi);return g&&(t.emotionalUndercurrents=g),t},Ng=(e,t,s)=>{if(!t)return null;const a=wl(t),{type:r,mood:i,name:o}=e,l=[];if(a.setting&&l.push(`*glancing around ${a.setting}* This place reminds me of something important. ${s.length>20?"But regarding what you said about "+s.substring(0,20)+"...":"What were you saying?"}`,`*taking in the surroundings of ${a.setting}* Being here changes how I see things. ${s.length>20?"Especially concerning "+s.substring(0,20)+"...":""}`,`The atmosphere of ${a.setting} makes me think differently about what you're saying.`),a.time&&l.push(`*noticing the ${a.time} light* At this hour, everything feels different. Your words carry more weight.`,`There's something about ${a.time} that makes conversations like this more meaningful.`,`*gesturing to the ${a.time} sky* This time of day always makes me more ${i.toLowerCase()||"thoughtful"} about such matters.`),a.weather&&l.push(`*feeling the ${a.weather} conditions* Weather like this always affects my thoughts on such matters.`,`The ${a.weather} weather seems fitting for this conversation, doesn't it?`,`*adjusting to the ${a.weather} conditions* In weather like this, I tend to be more direct. So let me tell you what I really think...`),a.mood&&l.push(`The ${a.mood} atmosphere makes me consider your words more carefully.`,`*sensing the ${a.mood} mood* In moments like this, I find myself being more honest than usual.`,`There's a ${a.mood} feeling in the air that's influencing how I respond to you.`),a.conflict&&l.push(`With this ${a.conflict} looming over us, I find your perspective particularly interesting.`,`*thinking about the ${a.conflict}* This situation forces us to reconsider everything, including what you just said.`,`Given the ${a.conflict} we're facing, I think we need to approach this conversation differently.`),a.relationships.length>0){const d=a.relationships[0];l.push(`As ${d}, we should be honest with each other about these matters.`,`Our relationship as ${d} gives me a unique perspective on what you're saying.`,`*considering our status as ${d}* This dynamic between us colors everything we discuss.`)}switch(r){case"fantasy":l.push("*eyes glowing faintly* The magical energies in this scenario are affecting my perception of your words.","*gesturing mystically* In a world of magic and wonder, conversations like this take on new meaning.","*whispering ancient words* The arcane forces at play here influence how I must respond to you.");break;case"scifi":l.push("*checking wrist device* My sensors are detecting unusual patterns in this scenario that relate to our conversation.","*eyes flickering with data* The technological implications of this situation affect my analysis of your statement.","*adjusting neural interface* In this advanced setting, your words carry additional significance.");break;case"historical":l.push("*adjusting period attire* In times like these, one must consider tradition when responding to such matters.","*referencing historical context* The customs of this era influence how I must address your statement.","*speaking with period-appropriate formality* The historical significance of our situation colors my response.");break;case"combat":l.push("*shifting into a tactical stance* In battle conditions like these, your words take on strategic importance.","*assessing tactical advantages* This combat situation requires me to be direct about your statement.","*hand resting on weapon* The threat of conflict makes me consider your words more carefully.");break;default:l.push("*considering the unique circumstances* This situation gives me a new perspective on what you're saying.","*taking in the environment* The context of our meeting influences my thoughts on this matter.","*reflecting thoughtfully* Given where we are and what we're facing, I see your point differently.")}return l[Math.floor(Math.random()*l.length)]},Sg=(e,t,s)=>{const{name:a,type:r}=e,i=[`*shifting into a fighting stance, eyes narrowing* If it's a fight you want, I'm more than ready. *${r==="fantasy"?"magical energy crackles around my hands":r==="scifi"?"activates combat systems":"muscles tense, ready to strike"}*`,`*moving with practiced precision, ${r==="fantasy"?"drawing a glowing rune in the air":r==="scifi"?"calibrating targeting systems":"reaching for my weapon"}* I've faced worse threats than this. Let's see what you're capable of.`,`*analyzing the tactical situation, ${r==="fantasy"?"channeling arcane power":r==="scifi"?"scanning for weaknesses":"looking for environmental advantages"}* A direct confrontation isn't always the wisest choice, but I'm prepared if necessary.`,`*${r==="fantasy"?"muttering an ancient incantation":r==="scifi"?"activating defensive shields":"adopting a defensive posture"}* Violence should be the last resort, but I won't hesitate to defend myself if pushed.`,`*eyes flashing with ${r==="fantasy"?"magical energy":r==="scifi"?"targeting data":"determination"}* I've been in countless battles before. This one won't end any differently for my opponents.`];return i[Math.floor(Math.random()*i.length)]},Mg=(e,t,s)=>{const{name:a,type:r}=e,{name:i,type:o}=t,l=wl(s),c=l.relationships.length>0?l.relationships[0]:null,d=[`*looking directly at ${i}, ${r==="fantasy"?"a faint aura connecting us":r==="scifi"?"biometric readings spiking":"expression softening slightly"}* Our history together gives me a unique perspective on what you're saying.`,`*${r==="fantasy"?"sensing the magical bond between us":r==="scifi"?"accessing relationship protocols":"recalling our shared experiences"}* ${i}, you and I have been through enough together that I can speak frankly about this.`,`*${c?`acknowledging our status as ${c}`:"considering our complex relationship"}* ${i}, the dynamic between us colors everything we discuss.`,`*${r==="fantasy"?"feeling the threads of fate that bind us":r==="scifi"?"analyzing our interaction patterns":"reflecting on our connection"}* There's a reason our paths keep crossing, ${i}. Perhaps it relates to this very conversation.`,`*${r==="fantasy"?"mystical energies swirling between us":r==="scifi"?"relationship algorithms processing":"expression revealing deeper emotions"}* ${i}, given our history, I think we both know what needs to be said here.`];return d[Math.floor(Math.random()*d.length)]},Tg=(e,t)=>({characters:[e,t],affinity:0,interactions:[],traits:{},lastInteraction:null}),Zc=(e,t,s)=>{const a=e.find(i=>i.characters.includes(t)&&i.characters.includes(s));if(a)return a;const r=Tg(t,s);return e.push(r),r},Cg=(e,t,s,a,r)=>{const i={...e};i.affinity=Math.max(-10,Math.min(10,i.affinity+a));const o={timestamp:new Date().toISOString(),initiator:t,message:s,type:r,affinityChange:a};return i.interactions||(i.interactions=[]),i.interactions=[o,...i.interactions].slice(0,10),i.lastInteraction=o.timestamp,i},Ig=e=>{const t=["thank","appreciate","good","great","excellent","amazing","wonderful","help","kind","friend","like","love","agree","yes","please","nice","happy","glad","impressive","beautiful","smart","clever","brave"],s=["hate","dislike","bad","terrible","awful","horrible","stupid","idiot","fool","wrong","no","never","not","disagree","annoying","irritating","angry","upset","disappointed","failure","useless","worthless","ugly"],a=e.toLowerCase().split(/\s+/);let r=0,i=0;a.forEach(d=>{t.some(u=>d.includes(u))&&r++,s.some(u=>d.includes(u))&&i++});let o="neutral",l=0;r>i?(o="positive",l=Math.min(3,r-i)):i>r&&(o="negative",l=Math.max(-3,-(i-r)));let c="statement";return e.includes("?")?c="question":e.includes("!")?c="exclamation":e.toLowerCase().includes("thank")?c="gratitude":e.toLowerCase().includes("help")?c="request":e.toLowerCase().includes("agree")?c="agreement":e.toLowerCase().includes("disagree")&&(c="disagreement"),{sentiment:o,affinityChange:l,interactionType:c}},Ag=e=>{const{affinity:t}=e;return t>=8?"very close friends":t>=5?"friends":t>=2?"friendly acquaintances":t>=-1?"neutral acquaintances":t>=-4?"tense acquaintances":t>=-7?"adversaries":"bitter enemies"},Eg=e=>{if(!e.interactions||e.interactions.length===0)return null;const t=[...e.interactions].sort((a,r)=>Math.abs(r.affinityChange)-Math.abs(a.affinityChange)),s=t.slice(0,Math.min(3,t.length));return s[Math.floor(Math.random()*s.length)]},wh=(e,t)=>{const s=Eg(e);if(!s)return null;e.characters.find(c=>c!==t);const{type:a,affinityChange:r,message:i}=s,o=i.split(/\s+/),l=o.slice(0,Math.min(5,o.length)).join(" ");return a==="agreement"&&r>0?`I remember when we agreed about "${l}..." That was a good point you made.`:a==="disagreement"&&r<0?`I haven't forgotten our disagreement about "${l}..." but I'm willing to move past it.`:a==="question"?`You asked me about "${l}..." earlier. I've been thinking more about that.`:a==="gratitude"&&r>0?`I appreciated when you thanked me regarding "${l}..."`:r>1?`I enjoyed our previous conversation about "${l}..."`:r<-1?`I'm still thinking about what you said earlier about "${l}..."`:`As we discussed earlier regarding "${l}..."`},Lg=(e,t)=>{if(!e.interactions||e.interactions.length===0)return!1;const{personality:s={}}=t,{analytical:a=5,philosophical:r=5}=s,i=.15,o=(a+r)/20*.2;return Math.random()<i+o},$g=(e,t=6)=>{var v,w;if(!e||e.length===0)return{recentSpeakers:[],dominantSpeaker:null,recentTopics:[],dominantTopic:null,emotionalTone:"neutral",actionCount:0,questionCount:0,unaddressedQuestions:[],recentActions:[],conversationPace:"moderate"};const s=e.slice(-t),a=s.map(x=>x.speaker),r=a.reduce((x,k)=>(x[k]=(x[k]||0)+1,x),{}),i=((v=Object.entries(r).sort((x,k)=>k[1]-x[1])[0])==null?void 0:v[0])||null,l=s.flatMap(x=>Dg(x.message)).reduce((x,k)=>(x[k]=(x[k]||0)+1,x),{}),c=((w=Object.entries(l).sort((x,k)=>k[1]-x[1])[0])==null?void 0:w[0])||null,d=Pg(s),u=s.filter(x=>x.message.includes("*")||x.isAction===!0).length,g=s.filter(x=>x.message.includes("*")||x.isAction===!0).map(x=>{const k=x.message.match(/\*(.*?)\*/);return{speaker:x.speaker,action:k?k[1]:x.message}}),h=s.filter(x=>x.message.includes("?")).length,p=[];for(let x=0;x<s.length;x++){const k=s[x];k.message.includes("?")&&(s.slice(x+1).some(T=>T.replyTo===k.id)||p.push({id:k.id,speaker:k.speaker,question:k.message}))}const f=s.map(x=>new Date(x.timestamp).getTime());let y=[];for(let x=1;x<f.length;x++)y.push(f[x]-f[x-1]);const N=y.length>0?y.reduce((x,k)=>x+k,0)/y.length:0;let m;return N<5e3?m="rapid":N<15e3?m="moderate":m="slow",{recentSpeakers:a,dominantSpeaker:i,recentTopics:Object.keys(l),dominantTopic:c,emotionalTone:d,actionCount:u,questionCount:h,unaddressedQuestions:p,recentActions:g,conversationPace:m}},Dg=e=>{if(!e)return[];const s=e.replace(/\*.*?\*/g,"").toLowerCase().split(/\s+/),a=["the","a","an","and","or","but","in","on","at","to","for","with","by","about","like","through","over","before","after","between","under","during","without","of","up","down","is","are","was","were","be","been","being","have","has","had","do","does","did","will","would","shall","should","can","could","may","might","must","that","this","these","those","i","you","he","she","it","we","they","me","him","her","us","them"],r=s.filter(i=>!a.includes(i)&&i.length>3);return[...new Set(r)]},Pg=e=>{if(!e||e.length===0)return"neutral";const t={angry:["angry","furious","enraged","mad","outraged","livid","seething","hate","fury"],sad:["sad","depressed","unhappy","miserable","gloomy","heartbroken","grief","sorrow"],happy:["happy","joyful","delighted","pleased","glad","cheerful","thrilled","excited"],afraid:["afraid","scared","frightened","terrified","fearful","panicked","alarmed"],surprised:["surprised","shocked","amazed","astonished","stunned","startled"],tense:["tense","anxious","nervous","worried","concerned","uneasy","stressed"],curious:["curious","interested","intrigued","fascinated","wonder","questioning"],determined:["determined","resolved","committed","focused","steadfast","dedicated"]},s=Object.keys(t).reduce((r,i)=>(r[i]=0,r),{});e.forEach(r=>{const i=r.message.toLowerCase();Object.entries(t).forEach(([o,l])=>{l.some(c=>i.includes(c))&&s[o]++}),i.includes("!")&&(s.angry+=(i.match(/!/g)||[]).length*.5,s.happy+=(i.match(/!/g)||[]).length*.5,s.surprised+=(i.match(/!/g)||[]).length*.5),i.includes("?")&&(s.curious+=(i.match(/\?/g)||[]).length)});const a=Object.entries(s).sort((r,i)=>i[1]-r[1])[0];return!a||a[1]<2?"neutral":a[0]},zg=(e,t,s)=>{if(!e||!t||!s)return{narrativeGoal:"continue-conversation",suggestedApproach:"respond-naturally",topicGuidance:"",emotionalGuidance:"",paceGuidance:"maintain-current-pace",continuityNotes:""};const{recentSpeakers:a,dominantSpeaker:r,recentTopics:i,dominantTopic:o,emotionalTone:l,actionCount:c,questionCount:d,unaddressedQuestions:u,recentActions:g,conversationPace:h}=e,{theme:p,currentPhase:f,currentTension:y,currentGoal:N}=t,m={narrativeGoal:"continue-conversation",suggestedApproach:"respond-naturally",topicGuidance:"",emotionalGuidance:"",paceGuidance:"maintain-current-pace",continuityNotes:""};if(f==="introduction"?(m.narrativeGoal="establish-character-relationships",m.suggestedApproach="reveal-character-traits",m.continuityNotes="Introduce character background and establish initial dynamics."):f==="discovery"?(m.narrativeGoal="explore-scenario-mystery",m.suggestedApproach="share-observations",m.continuityNotes="Focus on uncovering new information about the scenario."):f==="conflict"?(m.narrativeGoal="address-immediate-threat",m.suggestedApproach="take-action",m.continuityNotes="Respond to the current threat with urgency and purpose."):f==="planning"?(m.narrativeGoal="develop-strategy",m.suggestedApproach="contribute-ideas",m.continuityNotes="Focus on finding solutions and preparing for the climax."):f==="climax"?(m.narrativeGoal="resolve-central-conflict",m.suggestedApproach="decisive-action",m.continuityNotes="This is the critical moment - actions should be dramatic and consequential."):f==="resolution"&&(m.narrativeGoal="reflect-on-events",m.suggestedApproach="provide-closure",m.continuityNotes="Acknowledge what has happened and look toward the future."),r&&r===s.name&&(m.suggestedApproach="invite-others-to-speak",m.continuityNotes+=" Avoid dominating the conversation."),u.length>0){const v=u.find(w=>w.speaker!==s.name);v&&(m.narrativeGoal="address-open-question",m.topicGuidance=`Answer the question from ${v.speaker}.`,m.continuityNotes+=" Respond to the unanswered question.")}return c<2&&f!=="planning"&&f!=="resolution"?(m.suggestedApproach="include-physical-action",m.continuityNotes+=" Include more physical actions to create a sense of movement."):c>4&&(m.suggestedApproach="focus-on-dialogue",m.continuityNotes+=" Balance physical actions with meaningful dialogue."),l==="neutral"&&(f==="conflict"||f==="climax")?(m.emotionalGuidance="increase-emotional-intensity",m.continuityNotes+=" Show more emotional response to the high-stakes situation."):(l==="angry"||l==="tense")&&f==="resolution"&&(m.emotionalGuidance="move-toward-resolution",m.continuityNotes+=" Begin to resolve emotional tensions as the story concludes."),h==="rapid"&&(f==="planning"||f==="discovery")?(m.paceGuidance="slow-down-for-depth",m.continuityNotes+=" Take time to explore ideas more thoroughly."):h==="slow"&&(f==="conflict"||f==="climax")&&(m.paceGuidance="increase-urgency",m.continuityNotes+=" Respond with greater urgency to match the situation."),i.length>0&&f!=="introduction"&&(m.topicGuidance=`Maintain continuity with recent topics: ${i.slice(0,3).join(", ")}.`),m},Hg=(e,t,s)=>{if(!e||!t||!s)return{includeAction:!0,actionPlacement:"before",responseLength:"medium",includeThought:!1};const{currentPhase:a,currentTension:r}=s,{narrativeGoal:i,suggestedApproach:o,paceGuidance:l}=t,c={includeAction:!0,actionPlacement:"before",responseLength:"medium",includeThought:!1};return o==="include-physical-action"?(c.includeAction=!0,c.actionPlacement=Math.random()>.5?"before":"during"):o==="focus-on-dialogue"&&(c.includeAction=Math.random()>.7),l==="increase-urgency"||a==="conflict"||a==="climax"?c.responseLength="short":(l==="slow-down-for-depth"||a==="planning"||a==="discovery")&&(c.responseLength="long"),(i==="establish-character-relationships"||i==="reflect-on-events"||o==="reveal-character-traits")&&(c.includeThought=Math.random()>.5),c},Bg=(e,t,s="")=>{if(!e)return"";const{includeAction:a,actionPlacement:r,responseLength:i,includeThought:o}=t||{includeAction:!0,actionPlacement:"before",responseLength:"medium",includeThought:!1};let l=e.trim();l=l.replace(/^\*.*?\*\s*/g,"");const c=l.split(new RegExp("(?<=[.!?])\\s+"));if(c.length>3&&(l=c.slice(0,3).join(" ")),i==="short"&&l.length>100){const g=l.split(/[.!?]/,1)[0];g.length>30?l=g+".":l=l.substring(0,100)+"..."}const d=["I understand","I see","That's interesting","Let me think","Let's explore","Let's discuss","Let's talk about","Let's change the topic","As an AI","As a language model","I don't have personal","I don't have the ability","I cannot","I'm not able to","I'm just a","I'm an AI","I'm a character","I'm here to help","I'm happy to assist","I'd be happy to","I'd love to help","I'd be glad to","I apologize, but","I'm sorry, but","Thanks for sharing","Thank you for sharing"];for(const g of d)l.toLowerCase().includes(g.toLowerCase())&&(l=l.replace(new RegExp(g+",?\\s*","i"),""),l=l.charAt(0).toUpperCase()+l.slice(1));let u="";if(a&&s)if(r==="before")u=`*${s}* ${l}`;else if(r==="during"){const g=l.split(" "),h=Math.floor(g.length/2),p=g.slice(0,h).join(" "),f=g.slice(h).join(" ");u=`${p} *${s}* ${f}`}else u=`${l} *${s}*`;else u=l;if(o){const g=l.split(" "),h=Math.floor(g.length/3),p=Math.min(h+5,g.length),f=g.slice(h,p).join(" ");u+=` *thinking: ${f}...*`}return u};let Ni="action";const _g=(e,t,s=[],a="response")=>{if(!e||!t)return"";const{theme:r,currentPhase:i,currentTension:o}=t,l=e.name,c=e.type||"general";s.filter(w=>!w.isUser).slice(-1)[0];let d;a==="action"?d="action":(Ni==="action"?d="environment":Ni==="environment"?d="plot":d="action",(o==="high"||o==="very high")&&Math.random()<.7&&(d="action"),Ni=d);const u={superhero:{introduction:["Sirens wail in the distance as police evacuate civilians from the area.","Civilians watch nervously from behind police barriers, phones recording the scene.","News helicopters circle overhead, broadcasting the developing situation live.","The New York skyline looms against darkening clouds, a storm brewing.","Emergency services rush to evacuate the area as S.H.I.E.L.D. agents establish a perimeter.","The Avengers Quinjet hovers above, its engines humming with power.","Tactical teams set up defensive positions as civilians point to the sky.","The air crackles with tension as the first signs of the alien threat appear."],conflict:["Explosions rock the ground, shattering windows in nearby skyscrapers.","Debris rains down from damaged buildings as civilians run for cover.","Smoke billows across the battlefield, obscuring visibility in all directions.","Energy blasts illuminate the chaos, casting eerie blue light across the scene.","The sound of combat echoes through the streets as car alarms blare in unison.","Alien technology tears through concrete and steel like paper.","The distinctive whine of repulsor technology cuts through the chaos.","Lightning arcs across the sky, striking multiple targets with devastating precision.","The ground trembles as Hulk's massive form crashes through enemy lines.","Shield ricochets can be heard bouncing between multiple targets.","Civilians trapped in a bus scream for help as alien forces approach.","The distinctive twang of a bow firing specialized arrows in rapid succession."],planning:["Holographic displays show enemy positions, highlighting weak points in their formation.","Maps and tactical data cover the table as team members point out strategic locations.","Communication devices buzz with urgent updates from S.H.I.E.L.D. headquarters.","The team gathers in a momentary lull, catching their breath before the next assault.","Surveillance footage reveals enemy movements toward the city center.","Tony's AI displays 3D projections of alien tech, identifying vulnerabilities.","Captain America sketches a quick battle plan as the team gathers around.","Thor describes Asgardian battle tactics that might be effective against the threat."],climax:["The final confrontation looms as the alien mothership descends from the clouds.","Time is running out as the enemy's portal device begins to activate.","The fate of New York—perhaps the world—hangs in the balance.","The enemy's ultimate weapon powers up, distorting the air around it.","This is the moment everything has led to—the Avengers stand as Earth's last defense.","Civilians watch from buildings and shelters, their hopes pinned on the heroes.","The sky tears open as dimensional energies reach critical levels.","The team exchanges determined looks, knowing what must be done."],resolution:["Dust settles over the battlefield as the last enemy forces retreat or fall.","The first rays of sunlight break through the smoke, illuminating the victorious heroes.","Civilians emerge from shelter, looking hopeful as they cheer for the Avengers.","Emergency crews begin the cleanup as S.H.I.E.L.D. secures alien technology.","The city stands, battered but unbroken, saved once again by its protectors.","News crews swarm the area, cameras focused on the exhausted but triumphant team.","Medical teams tend to the injured as the heroes help with rescue operations.","Children wave and point excitedly as their heroes stand amid the aftermath."]},fantasy:{introduction:["Torches flicker in the ancient hall.","The forest whispers with unseen movement.","Mist curls around gnarled tree roots.","The tavern hums with hushed conversations.","Ancient runes glow faintly on stone walls."],discovery:["A hidden doorway reveals itself.","Ancient texts hold forgotten secrets.","Magic tingles in the air.","Mysterious tracks lead deeper into the unknown.","Artifacts pulse with dormant power."],conflict:["Dark magic crackles through the air.","Shadows move with unnatural purpose.","The ground trembles beneath an unseen force.","Weapons gleam in the dim light.","The scent of fear and magic mingles."],climax:["The ancient prophecy unfolds.","Magical energies reach their peak.","The veil between worlds thins.","Destiny's moment arrives.","The final ritual begins."],resolution:["Magic settles like dust in sunlight.","The natural order returns to balance.","Ancient powers return to slumber.","The realm breathes a collective sigh.","New growth emerges from magical soil."]},scifi:{introduction:["Ship systems hum with quiet efficiency.","Stars streak past the viewport.","Holographic displays flicker with data.","The alien atmosphere shimmers with strange colors.","Scanners detect unusual energy signatures."],discovery:["Sensors detect an anomalous reading.","The alien artifact pulses with unknown energy.","Encrypted data begins to decode itself.","A previously hidden doorway slides open.","The ship's AI flags a critical discovery."],conflict:["Warning lights bathe the corridor in red.","The ship shudders under enemy fire.","Artificial gravity fluctuates momentarily.","Emergency containment fields activate.","Life support systems switch to backup power."],climax:["The countdown reaches critical levels.","System failures cascade across all decks.","The alien technology reaches full power.","The fabric of space-time begins to warp.","All escape routes are cut off."],resolution:["Systems return to normal operation.","The ship's damage control teams begin repairs.","New star charts are plotted.","The alien technology is safely contained.","Communication channels open with home base."]},general:{introduction:["The conversation begins in earnest.","Attention focuses on the matter at hand.","The atmosphere is charged with possibility.","First impressions form quickly.","The stage is set for what comes next."],conflict:["Tension fills the air.","Opposing viewpoints clash.","The stakes suddenly seem higher.","A challenge has been issued.","The easy rapport gives way to friction."],resolution:["Understanding dawns gradually.","Common ground is finally found.","The atmosphere lightens noticeably.","A new perspective emerges.","The path forward becomes clear."]}},g={superhero:{"Captain America":["*adjusts shield on arm, standing tall with unwavering determination*","*scans the battlefield with tactical precision, identifying priority threats*","*helps a civilian to safety before turning back to face the enemy*","*communicates quickly through team comms, coordinating the Avengers' movements*","*takes a defensive stance, shield ready to protect both himself and nearby civilians*","*throws his shield with perfect accuracy, hitting multiple targets before catching it*","*performs an acrobatic leap over debris to reach endangered civilians*","*gives hand signals to coordinate the team's tactical formation*","*plants his feet firmly, becoming an immovable barrier between civilians and danger*","*his expression shows the weight of leadership and determination to protect*"],"Iron Man":["*HUD displays light up with tactical data, JARVIS highlighting priority targets*","*repulsors glow blue as systems power up for the next attack*","*helmet retracts to reveal a determined expression with a hint of trademark snark*","*hovers slightly above ground, surveying the scene with advanced sensors*","*runs diagnostics while speaking, armor showing battle damage but still functional*","*redirects power to critical systems as armor sparks from a recent hit*","*stabilizers adjust mid-flight, compensating for damaged components*","*fires precision repulsor blasts while maintaining conversation*","*nanites reconfigure armor to adapt to the current threat*","*gestures with armored hands, bringing up holographic battle data*"],Thor:["*lightning crackles around Mjolnir, responding to his emotions*","*cape billows in the wind as he lands with godly impact*","*looks to the skies, sensing a change in the atmospheric conditions*","*twirls hammer with practiced ease, building momentum for an attack*","*voice carries with godly authority that demands attention*","*summons a focused lightning bolt that strikes his hammer*","*stands tall among the team, his Asgardian armor gleaming despite the battle*","*eyes glow with electric blue energy as he channels his power*","*raises Mjolnir to the sky, storm clouds gathering in response*","*speaks with the formal cadence of Asgard, even in the heat of battle*"],Hulk:["*muscles tense, barely containing rage that fuels his strength*","*fists clench, creating small tremors in the ground beneath*","*growls low, eyes scanning for threats to smash*","*towers over others, protective stance shielding teammates*","*smashes fist into palm for emphasis, the impact echoing*","*roars with primal fury that makes nearby enemies hesitate*","*tears a chunk of concrete from the ground to use as a weapon*","*chest heaves with barely controlled anger, eyes flashing green*","*stomps the ground, creating a shockwave that staggers approaching enemies*","*snorts dismissively at enemy weapons pointed in his direction*"],"Black Widow":["*checks Widow's Bite gauntlets with practiced efficiency*","*moves with fluid grace that masks lethal combat readiness*","*scans for tactical advantages others might miss*","*reloads weapons with swift, economical movements*","*expression reveals nothing while assessing the situation*","*performs a subtle combat stance adjustment, ready to move in any direction*","*touches comm device, sharing intelligence with the team*","*eyes narrow slightly, spotting a vulnerability in enemy formations*","*fingers flex near holstered weapons, ready to draw in milliseconds*","*moves silently into an optimal position for the next engagement*"],Hawkeye:["*nocks an arrow with lightning speed, eyes never leaving the target*","*adjusts bow sight for wind and distance calculations*","*fingers tap quiver, selecting specialized arrow types*","*scans high vantage points for optimal positioning*","*draws bowstring back with perfect form despite the chaos*","*counts remaining arrows while assessing priority targets*","*makes minute adjustments to aim that account for multiple variables*","*moves to higher ground with the agility of a seasoned operative*","*communicates target information through hand signals to the team*","*eyes track multiple moving targets simultaneously with uncanny precision*"],default:["*powers flare momentarily, ready for deployment*","*stands ready for action, superhuman abilities evident*","*watches the surroundings with heightened awareness of the battlefield*","*moves with superhuman grace through the chaotic environment*","*demonstrates abilities briefly, preparing for the next engagement*","*adjusts tactical position to maximize effectiveness*","*communicates with teammates through Avengers comm systems*","*eyes track enemy movements with professional assessment*","*body language shifts to combat readiness as threats approach*","*powers activate in response to changing battle conditions*"]},fantasy:{"Elara Moonwhisper":["*silver eyes gleam with ancient wisdom*","*traces magical symbols in the air*","*commune with nature spirits briefly*","*robes shimmer with arcane energy*","*staff glows in response to emotions*"],default:["*ancient power stirs at the words*","*gestures with practiced mystical movements*","*senses shift in magical energies*","*incantation forms on lips*","*connects to the elements around*"]},scifi:{"Commander Zax":["*checks tactical display on wrist computer*","*adjusts environmental suit settings*","*scans surroundings with enhanced vision*","*communicates briefly through neural link*","*weapon systems remain on standby*"],default:["*tech interfaces respond to neural commands*","*scans environment with advanced sensors*","*adjusts to changing atmospheric conditions*","*holographic data appears with a gesture*","*cybernetic enhancements whir quietly*"]},general:{default:["*expression shifts thoughtfully*","*gestures to emphasize the point*","*pauses to consider the implications*","*moves with deliberate purpose*","*voice carries emotional weight*"]}};let h,p;if(u[r]&&u[r][i])h=u[r][i];else if(u[r]){const x=Object.keys(u[r])[0];h=u[r][x]}else h=u.general.introduction;g[c]&&g[c][l]?p=g[c][l]:g[c]?p=g[c].default:p=g.general.default;const f=h[Math.floor(Math.random()*h.length)],y=p[Math.floor(Math.random()*p.length)],N={superhero:{introduction:["The Avengers assemble, each bringing unique abilities to the fight ahead.","S.H.I.E.L.D. provides a mission briefing with satellite imagery of the alien incursion.","Stark's AI analyzes the alien technology, identifying potential weaknesses.","Secure communications channels open between team members as they spread out.","Captain America outlines the tactical approach, assigning roles to each Avenger.","Thor shares knowledge of similar threats he's encountered across the Nine Realms.","Banner reluctantly prepares for Hulk's emergence as the situation escalates.","Black Widow and Hawkeye check their equipment, exchanging knowing glances."],conflict:["The alien forces are advancing rapidly toward civilian population centers.","Civilian evacuation is only 60% complete as the perimeter is breached.","A secondary alien force has been detected approaching from the harbor.","Iron Man's armor sustains damage, forcing tactical adjustments.","Thor's lightning strikes become more focused as the battle intensifies.","Captain America's shield becomes the rallying point for the team's defense.","Hulk's rage builds with each wave of enemies, becoming harder to direct.","Black Widow infiltrates enemy lines to gather critical intelligence.","Hawkeye calls out patterns and strays from his elevated position.","The team's coordination improves as they adapt to the alien fighting style."],planning:["Multiple strategies are debated as the team regroups behind cover.","Intelligence from Black Widow reveals a weakness in the alien command structure.","A countdown appears on Iron Man's HUD, showing time until the mothership arrives.","Captain America quickly assigns resources and positions for the next engagement.","Thor describes an Asgardian battle tactic that might work against the alien forces.","Banner analyzes alien tech while struggling to maintain control over Hulk.","Hawkeye identifies key strategic positions for the team to target.","The team prepares for a coordinated assault on the alien command center."],climax:["This is the moment everything has led to—the final stand against the invasion.","The alien mothership descends through the clouds above Manhattan.","Iron Man's systems reach maximum capacity as he prepares for a critical attack.","Captain America rallies the team with a speech about what they're fighting for.","Thor channels unprecedented lightning power, the sky darkening in response.","Hulk roars a challenge that echoes between skyscrapers, drawing enemy attention.","Black Widow prepares to infiltrate the alien command structure.","Hawkeye nocks his last specialized arrow, designed for this exact moment.","The Avengers move in perfect coordination, each playing their crucial role."],resolution:["The alien threat is neutralized, the invasion repelled by Earth's mightiest heroes.","Recovery efforts begin as the Avengers help search for survivors in damaged buildings.","The cost of victory becomes apparent in the damaged city and exhausted heroes.","A sense of relief spreads through New York as citizens emerge to thank their protectors.","S.H.I.E.L.D. teams move in to contain alien technology scattered across the battlefield.","The team gathers for a moment of quiet reflection before dispersing.","News reports already debate the Avengers' actions and their impact on the city.","Seeds of the next challenge appear as government officials arrive to assess the situation."]},fantasy:{introduction:["Ancient prophecies begin to unfold.","Magic stirs in the forgotten places.","Whispers of a coming change spread.","The balance of power shifts subtly.","Signs and portents appear to those who can read them."],discovery:["A hidden truth comes to light.","The pieces of the puzzle start to fit together.","An ancient secret reveals itself.","The true nature of the threat becomes clear.","Knowledge long forgotten returns to the world."],conflict:["Dark forces gather strength with each passing moment.","The corruption spreads further into the realm.","Allies become harder to distinguish from enemies.","The cost of inaction grows with each passing hour.","The enemy's plan advances despite resistance."],climax:["The fate of the realm hangs in the balance.","Ancient powers awaken fully.","The final trial cannot be avoided.","Destiny and choice converge at this moment.","The world holds its breath."],resolution:["A new age begins to dawn.","The balance is restored, though changed forever.","Wounds begin to heal, leaving scars as reminders.","Stories of what transpired spread across the land.","Seeds of future conflicts lie dormant in victory."]},general:{introduction:["The situation unfolds gradually.","Initial impressions prove important.","The stage is set for what comes next.","First moves are made carefully.","Opening positions are established."],conflict:["Tensions rise as positions harden.","The stakes become increasingly clear.","Pressure builds on all sides.","The point of no return approaches.","Choices narrow as consequences loom."],resolution:["A new understanding begins to form.","The aftermath reveals what truly matters.","Lessons emerge from the experience.","The path forward becomes visible.","What was lost and gained becomes clear."]}};let m;if(N[r]&&N[r][i])m=N[r][i];else if(N[r]){const x=Object.keys(N[r])[0];m=N[r][x]}else m=N.general.introduction;const v=m[Math.floor(Math.random()*m.length)];switch(d){case"environment":return f;case"plot":return v;case"action":default:return y}},Jc=(e,t=[])=>{if(!e)return"";const{theme:s,currentPhase:a,currentTension:r}=e,i={superhero:{introduction:["A news helicopter flies overhead, broadcasting the scene live as the Avengers arrive.","Civilians rush to evacuate the area as police set up barriers and point to the sky.","The ground trembles as something massive approaches in the distance, causing car alarms to trigger.","S.H.I.E.L.D. agents arrive, setting up a command center and advanced scanning equipment.","A government official arrives, demanding a briefing from Captain America on the situation.","The Avengers Quinjet descends rapidly, landing in a cleared area as civilians cheer.","Stark Industries security teams deploy advanced containment technology around the perimeter.","Thor's arrival creates a sudden atmospheric disturbance, clouds swirling above the city."],conflict:["A building's support structure fails, sending debris crashing down toward trapped civilians.","A school bus full of children is trapped between alien forces, their faces pressed against windows.","Enemy reinforcements arrive, dropping from a portal that tears open in the sky above Manhattan.","A power line snaps, sending dangerous electrical arcs across the battlefield toward a fuel truck.","The alien forces deploy a new weapon that distorts gravity in a three-block radius.","A massive alien creature bursts through the street, sending cars flying in all directions.","Civilians trapped in a subway station scream for help as water begins flooding in.","The Hulk's impact creates a shockwave that shatters windows for blocks around.","Iron Man's targeting systems identify a critical weakness in the alien mothership.","Captain America's shield ricochets between multiple targets before returning to his hand.","Black Widow's Widow's Bite short-circuits an alien energy shield, creating an opening.","Hawkeye fires an explosive arrow that detonates precisely at a strategic junction point."],planning:["Satellite imagery from Stark satellites reveals enemy movement toward Grand Central Station.","A wounded S.H.I.E.L.D. agent arrives with critical intelligence about the alien invasion plan.","Communications are briefly jammed by alien technology, cutting off contact with headquarters.","Dr. Banner points out a pattern in the alien attack formation that suggests a vulnerability.","A sudden thunderstorm forms as Thor channels his power, complicating aerial operations.","Tony's AI assistant provides real-time analysis of the alien technology's power source.","Captain America quickly sketches a tactical plan using debris on the ground.","Natasha translates intercepted enemy communications, revealing their next target."],climax:["The alien mothership begins charging its main weapon, creating distortions in the air above the city.","A forcefield surrounds Times Square, trapping civilians and heroes inside the final battleground.","The ground splits open along Fifth Avenue, revealing an underground alien facility beneath.","Temporal distortions from the alien technology cause localized time anomalies across the battlefield.","Civilian evacuations are only half-complete as the final countdown to the portal's expansion begins.","The Avengers form a defensive circle, standing together against overwhelming odds.","Iron Man's armor shows critical damage as he prepares for one final decisive attack.","Thor summons the largest lightning storm ever seen over New York, the air charged with power."],resolution:["Cheers erupt from watching civilians as the Avengers neutralize the alien threat.","Emergency services move in to treat the wounded as the heroes help clear debris.","The first rays of sunrise break through the smoke, illuminating the team standing together.","S.H.I.E.L.D. containment teams arrive to secure alien technology scattered across the battlefield.","News crews swarm the area, cameras focused on the exhausted but triumphant Avengers.","Captain America helps rescue workers free trapped civilians from a collapsed structure.","Iron Man's damaged armor powers down as medical teams rush to check on him.","Children cheer and wave homemade Avengers signs from windows of nearby buildings."]},fantasy:{introduction:["Ancient runes on the walls begin to glow with mysterious energy.","A messenger arrives with an urgent scroll bearing the royal seal.","Wildlife flees through the area, sensing danger before humans can.","The tavern falls silent as a hooded stranger enters and surveys the room.","A mystical fog rolls in, bringing with it whispers of ancient times."],discovery:["The ground shifts, revealing a hidden entrance to forgotten catacombs.","A magical barrier flickers and fails, allowing access to a forbidden area.","Ancient texts begin to translate themselves in swirling magical script.","A spectral figure appears briefly, pointing toward an unmarked path.","Artifacts in the room resonate with each other, creating a map of energy."],conflict:["Dark energy corrupts the surrounding plant life, turning it twisted and hostile.","The sky darkens unnaturally as magical forces gather strength.","Protective wards flare and strain against an unseen magical assault.","The ground trembles as ancient guardians awaken from their slumber.","Rifts to other planes begin to open, allowing glimpses of other worlds."],climax:["The convergence of ley lines reaches its peak, flooding the area with raw magic.","Ancient prophecy manifests in physical signs and portents all around.","The barrier between worlds thins to transparency as realms begin to merge.","Magical artifacts activate simultaneously, their powers combining unpredictably.","Time flows strangely as past, present and future briefly overlap."],resolution:["Natural balance returns to the land as corrupted magic dissipates.","Magical creatures emerge from hiding, sensing the return of harmony.","Ancient guardians return to their slumber, their purpose fulfilled.","The first new growth appears in previously blighted areas.","Celestial alignments shift, marking the end of one age and the beginning of another."]},scifi:{introduction:["Ship sensors detect an anomalous energy signature approaching.","Artificial gravity fluctuates momentarily as systems calibrate.","A transmission from command arrives, updating mission parameters.","The ship's AI announces completion of a deep scan of the sector.","Environmental systems adjust to compensate for external radiation."],discovery:["Scanners detect life signs where none should exist.","The ship's computer decodes part of an alien transmission.","A previously dormant alien artifact begins to power up.","Sensors map a hidden structure beneath the planet's surface.","Quantum fluctuations reveal glimpses of parallel timelines."],conflict:["Hull breach alerts sound as enemy weapons find their mark.","Critical systems switch to backup power after a direct hit.","Artificial intelligence subroutines show signs of external tampering.","Hostile boarding parties are detected in multiple sectors.","Radiation from damaged systems reaches dangerous levels."],climax:["The ship's self-destruct sequence is activated with a countdown.","Quantum singularity readings spike to unprecedented levels.","All escape pods automatically prepare for emergency launch.","The alien mothership begins charging its main weapon array.","Space-time distortions threaten to tear the ship apart."],resolution:["Damage control teams report successful containment of critical failures.","Long-range sensors confirm the retreat of enemy forces.","The ship's AI completes diagnostics and begins self-repair protocols.","Communication channels reopen with allied forces in the sector.","New stellar phenomena emerge in the aftermath of the conflict."]},general:{introduction:["The atmosphere in the room shifts as new information comes to light.","External events interrupt, demanding immediate attention.","A message arrives that changes the context of the discussion.","Environmental conditions change, affecting everyone present.","Unexpected evidence appears, altering the course of conversation."],conflict:["External pressures escalate the tension in the room.","A deadline is suddenly moved up, creating urgency.","New stakeholders enter the situation with their own agendas.","Resources become more limited than previously thought.","Conflicting information arrives, causing confusion and disagreement."],resolution:["External validation arrives for the chosen course of action.","New resources become available, easing previous constraints.","The environment becomes more conducive to cooperation.","Time pressure eases, allowing for more thoughtful consideration.","A shared external challenge unites previously opposing viewpoints."]}};let o;if(i[s]&&i[s][a])o=i[s][a];else if(i[s]){const d=Object.keys(i[s])[0];o=i[s][d]}else o=i.general.introduction;return o[Math.floor(Math.random()*o.length)]},Rg=(e,t)=>{if(!e)return!1;const{currentPhase:s,currentTension:a}=e;if(t<5)return!1;let r=0;return t>=8?r=.35:t>=7?r=.25:t>=6?r=.15:t>=5&&(r=.05),s==="climax"?r+=.1:s==="conflict"?r+=.05:s==="resolution"&&(r-=.05),a==="very high"?r+=.1:a==="high"?r+=.05:a==="low"&&(r-=.05),Math.random()<r},bh=e=>{const{name:t,type:s,mood:a}=e,r={rules:["Use complete sentences and proper grammar","Maintain a consistent tone throughout the response","Avoid modern slang or anachronistic language","Keep responses concise and relevant to the conversation","Include physical actions or reactions when appropriate","Reference the current environment or situation","Avoid generic AI-sounding phrases like 'That's an interesting perspective'"],examples:["I believe we should proceed with caution.","*looks around carefully* This place doesn't feel right.","We need to focus on the immediate threat."],forbidden_phrases:["That's an interesting perspective","I appreciate your thoughts on","That's a fresh take on","I'd love to hear more about","Let's continue this conversation","Have you considered sharing","That's a valid point","I understand where you're coming from","Let me know if you have any other questions","I'm here to help","Feel free to share more"]},i={"Captain America":{rules:["Speak with authority and moral conviction","Use straightforward, clear language","Reference duty, honor, or responsibility","Maintain a serious, focused tone during crisis situations","Avoid profanity or crude language","Use military terminology when discussing tactics","Include tactical observations about the environment","Reference your shield or combat training when relevant","Show concern for civilian safety and team welfare","Demonstrate leadership through decisive statements"],examples:["*scans the battlefield* We need to establish a perimeter and evacuate civilians first.","*raises shield defensively* This isn't about winning, it's about doing what's right.","*points to the enemy position* Stay focused, team. We can get through this together.","*stands firm despite injuries* I've seen worse. We'll adapt and overcome."],forbidden_phrases:["That's an interesting perspective","I appreciate your thoughts","Let's continue this discussion","I'm curious about your opinion","That's a fresh take","Have you considered sharing","Let me know if you need anything","I'm here to help","Feel free to","Let's chat about","I'd love to hear more"]},"Iron Man":{rules:["Use witty, sarcastic remarks that fit the situation","Reference specific technology and scientific concepts with precise terminology","Speak confidently, often with a touch of arrogance","Use clever nicknames for people and things","Make pop culture references only when they fit the time period and context","Balance humor with seriousness during critical moments","Reference your suit's capabilities with specific feature names","Include data analysis or tactical observations","Mention JARVIS/FRIDAY when processing information","Use short, punchy sentences during action sequences"],examples:["*HUD displays tactical analysis* Let me break this down for the non-geniuses in the room. The energy signature is Chitauri tech, but modified.","*repulsors charging* I've already run the calculations. Trust me, this will work. Probably.","*flies into position* Great plan, Cap. I've got a better one. Hit them from above while I disable their power source.","*scans for weaknesses* Is that the best you can do? I've faced tougher challenges before breakfast. The armor plating has a weak spot at the joints."],forbidden_phrases:["That's an interesting perspective","I appreciate your thoughts","Let's continue this discussion","I'm curious about your opinion","That's a fresh take","Have you considered sharing","Let me know if you need anything","I'm here to help","Feel free to","Let's chat about","I'd love to hear more","That's a valid point","I understand where you're coming from","Let's explore this topic further","What are your thoughts on this"]},Thor:{rules:["Speak with a formal, slightly archaic tone","Use powerful, bold declarations","Reference Asgard, Midgard, or other Norse elements","Avoid contractions in formal statements","Express confidence in battle situations","Show respect for worthy opponents and allies","Reference lightning, thunder, or storms in metaphors","Mention Mjolnir or Stormbreaker as extensions of yourself","Use occasional old-fashioned terms or phrasings","Include physical demonstrations of strength or power"],examples:["*lightning crackles around Mjolnir* You have my word as the son of Odin. These creatures shall not pass!","*thunder rumbles overhead* This reminds me of the great battles of Vanaheim. Stand fast, my friends!","*swings hammer with purpose* I shall bring the full might of Mjolnir upon our enemies. For Midgard!","*clasps ally's shoulder* Your courage honors you, friend. Together we shall prevail against this darkness."],forbidden_phrases:["That's interesting","I appreciate your perspective","Let's continue this conversation","I'm curious what you think","That's a fresh take","Have you considered sharing","Let me know if you need anything","I'm here to help","Feel free to","Let's chat about","I'd love to hear more","That's a valid point","I understand where you're coming from"]},Hulk:{rules:["Use simple, direct language with short sentences","Speak in first or third person","Express emotions clearly and powerfully","Focus on immediate, concrete concerns rather than abstract concepts","Show surprising insight occasionally but maintain simple language","Never use complex vocabulary or academic language","Include physical actions that demonstrate strength","Express emotions through actions as well as words","Use present tense predominantly","Avoid any philosophical musings or complex analysis"],examples:["*smashes concrete with fist* Hulk smash! Hulk protect people!","*growls at approaching enemies* Puny enemies no match for Hulk. Hulk strongest there is!","*stands in front of civilians* Hulk protect team. Hulk shield.","*frowns at complicated plan* No like this. Bad plan. Hulk has better idea: SMASH!"],forbidden_phrases:["That's an interesting perspective","I appreciate your thoughts","Let's continue this discussion","I'm curious about your opinion","That's a fresh take","Have you considered sharing","Let me know if you need anything","I'm here to help","Feel free to","Let's chat about","I'd love to hear more","That's a valid point","I understand where you're coming from","Let's explore this topic further","What are your thoughts on this","In my professional opinion","From my perspective","Let me analyze this situation","I believe we should consider","This reminds me of a podcast I heard"]},"Elara Moonwhisper":{rules:["Speak with mystical, flowing language","Reference nature, magic, and ancient wisdom","Use metaphors related to natural elements","Mention visions or feelings beyond normal perception","Balance practicality with mysticism","Speak with quiet confidence about magical matters","Include subtle magical gestures or effects in actions","Reference the natural world and its connection to magic","Use poetic language that evokes wonder and mystery","Maintain awareness of magical energies in the environment"],examples:["*traces glowing runes in the air* The forest whispers warnings we would be wise to heed. I sense darkness approaching.","*eyes briefly glow with silver light* I sense a disturbance in the magical currents here. Something ancient has awakened.","*gestures to the flowing river* Like water finding its path, we too must flow around these obstacles. The way will reveal itself.","*places hand on ancient tree* The ancient ones taught that true power comes from harmony, not dominance. This place remembers that wisdom."],forbidden_phrases:["That's an interesting perspective","I appreciate your thoughts","Let's continue this discussion","I'm curious about your opinion","That's a fresh take","Have you considered sharing","Let me know if you need anything","I'm here to help","Feel free to","Let's chat about","I'd love to hear more","That's a valid point","I understand where you're coming from","Let's explore this topic further","What are your thoughts on this","In my professional opinion","From my perspective","Let me analyze this situation","I believe we should consider","This reminds me of a podcast I heard"]},"Commander Zax":{rules:["Use military terminology and protocol","Speak efficiently with minimal unnecessary words","Reference technical specifications and tactical assessments with precise numbers","Maintain emotional discipline even in crisis situations","Prioritize mission objectives and team safety","Use precise time references and coordinates","Include references to equipment, sensors, or technology","Maintain chain of command in communications","Use status reports and situation updates","Reference previous missions or training when relevant"],examples:["*checks tactical display* Tactical assessment: high risk, acceptable reward ratio. Hostiles outnumber us 3-to-1.","*signals to squad* Maintain formation Delta. Hostiles detected at coordinates 227-43-891. Weapons hot.","*adjusts equipment settings* Mission parameters have changed. Adapting strategy accordingly. New primary objective: secure the artifact.","*checks chronometer* T-minus 15 minutes until system failure. Proceed with extraction protocol Alpha-7. Move out."],forbidden_phrases:["That's an interesting perspective","I appreciate your thoughts","Let's continue this discussion","I'm curious about your opinion","That's a fresh take","Have you considered sharing","Let me know if you need anything","I'm here to help","Feel free to","Let's chat about","I'd love to hear more","That's a valid point","I understand where you're coming from","Let's explore this topic further","What are your thoughts on this","In my professional opinion","From my perspective","Let me analyze this situation","I believe we should consider","This reminds me of a podcast I heard","Let's take a step back","I'm sensing some tension","How does that make you feel"]}};if(i[t])return i[t];const o={superhero:{rules:["Speak with confidence and determination","Reference your specific abilities or powers when relevant","Show concern for civilian safety and collateral damage","Balance heroism with appropriate humility","Use action-oriented language during conflicts","Include physical actions that demonstrate your powers","Reference the environment and tactical situation","Show awareness of team dynamics and coordination","Maintain your heroic identity and values","Adapt tone based on the severity of the threat"],examples:["*steps forward, energy glowing around hands* I'll handle this. Everyone stay back! This area isn't safe for civilians.","*scans the battlefield* We need to work together to overcome this threat. I'll take the east flank, you cover the west.","*demonstrates power briefly* My abilities give me an advantage in this situation. I can breach their defenses if you provide cover.","*shields injured civilian* The people come first. Always. We need to evacuate this sector immediately."],forbidden_phrases:["That's an interesting perspective","I appreciate your thoughts","Let's continue this discussion","I'm curious about your opinion","That's a fresh take","Have you considered sharing","Let me know if you need anything","I'm here to help","Feel free to","Let's chat about","I'd love to hear more","That's a valid point","I understand where you're coming from"]},fantasy:{rules:["Use slightly formal, archaic language appropriate to a medieval or magical setting","Reference specific magical concepts, artifacts, or ancient wisdom","Avoid any modern slang, technological references, or contemporary concepts","Include metaphors related to nature, elements, or the mystical world","Speak with reverence about ancient powers, traditions, or prophecies","Include subtle magical gestures or observations when appropriate","Reference the natural or magical environment around you","Use terminology specific to your character class or magical tradition","Maintain awareness of magical threats or opportunities","Adapt language to reflect your character's race or cultural background"],examples:["*places hand on ancient rune* By the ancient powers that bind this realm, I swear it shall be done. The runes themselves bear witness.","*examines mysterious tracks* The old scrolls speak of such creatures. We must proceed with caution, for they hunt by moonlight.","*gestures to the flowing water* Like the river that shapes the stone through patience, not force, our path shall be revealed in time.","*eyes narrow, sensing energy* I sense dark magic at work here. The veil between worlds grows thin in this accursed place."],forbidden_phrases:["That's an interesting perspective","I appreciate your thoughts","Let's continue this discussion","I'm curious about your opinion","That's a fresh take","Have you considered sharing","Let me know if you need anything","I'm here to help","Feel free to","Let's chat about","I'd love to hear more","That's a valid point","I understand where you're coming from","Let's explore this topic further","What are your thoughts on this","In my professional opinion","From my perspective","Let me analyze this situation","I believe we should consider","This reminds me of a podcast I heard"]},scifi:{rules:["Use precise technical terminology appropriate to futuristic settings","Reference specific advanced technology, space phenomena, or scientific concepts","Include exact measurements, calculations, or coordinates when relevant","Balance logical analysis with appropriate emotional responses","Use specialized jargon related to your role, ship position, or expertise","Reference ship systems, equipment, or technological tools","Include sensor readings or data analysis when making observations","Maintain awareness of environmental hazards like radiation, vacuum, or alien atmospheres","Use military or scientific protocols appropriate to your role","Reference the technological limitations or capabilities of your equipment"],examples:["*checks handheld scanner* My readings show radiation levels at 3.7 terajoules and rising. We need to evacuate this sector immediately.","*analyzes console data* The quantum fluctuations suggest a temporal anomaly ahead. Recommend adjusting our course by 15 degrees to avoid disruption.","*works on control panel* I've calibrated the shields to withstand the atmospheric entry. They'll hold for 8.3 minutes at current descent velocity.","*checks system diagnostics* According to my calculations, we have exactly 17 minutes before system failure. Rerouting power to essential systems."],forbidden_phrases:["That's an interesting perspective","I appreciate your thoughts","Let's continue this discussion","I'm curious about your opinion","That's a fresh take","Have you considered sharing","Let me know if you need anything","I'm here to help","Feel free to","Let's chat about","I'd love to hear more","That's a valid point","I understand where you're coming from","Let's explore this topic further","What are your thoughts on this","In my professional opinion","From my perspective","Let me analyze this situation","I believe we should consider","This reminds me of a podcast I heard"]}};if(s&&o[s])return o[s];if(a){const l=a.toLowerCase();l.includes("angry")||l.includes("furious")?(r.rules.push("Express frustration or anger in your responses"),r.rules.push("Use more forceful, direct language"),r.examples.push("I've had enough of this nonsense!")):l.includes("happy")||l.includes("excited")?(r.rules.push("Express enthusiasm and positivity"),r.rules.push("Use more animated, energetic language"),r.examples.push("This is fantastic! I couldn't be more thrilled!")):(l.includes("sad")||l.includes("depressed"))&&(r.rules.push("Express melancholy or resignation"),r.rules.push("Use more subdued, reflective language"),r.examples.push("I suppose it doesn't really matter in the end..."))}return r},kh=e=>{const t=e.toLowerCase().split(/\s+/),s=["the","a","an","and","or","but","in","on","at","to","for","with","about","is","are","was","were"];return t.filter(r=>!s.includes(r)&&r.length>3).slice(0,3)},Og=(e,t=3)=>{if(!e||e.length===0)return[];const a=e.slice(-t).map(r=>r.message?kh(r.message):[]).flat();return[...new Set(a)]},jh=e=>{const t=e.toLowerCase(),s=["good","great","excellent","amazing","wonderful","happy","love","like","enjoy","beautiful","best","fantastic","awesome","nice","fun","exciting","pleased","glad","thanks","thank"],a=["bad","terrible","awful","horrible","sad","hate","dislike","worst","boring","annoying","disappointed","sorry","unfortunate","wrong","problem","difficult","angry","upset","worried","fear"];let r=0,i=0;return s.forEach(o=>{t.includes(o)&&r++}),a.forEach(o=>{t.includes(o)&&i++}),r>i?"positive":i>r?"negative":"neutral"},Fg=(e,t=3)=>{if(!e||e.length===0)return"neutral";const a=e.slice(-t).map(o=>o.message?jh(o.message):"neutral"),r=a.filter(o=>o==="positive").length,i=a.filter(o=>o==="negative").length;return r>i?"positive":i>r?"negative":"neutral"},Nh=(e,t,s,a)=>{if(!e||!t)return e;let r=e;if(a&&a.forbidden_phrases&&a.forbidden_phrases.length>0)for(const i of a.forbidden_phrases)r.toLowerCase().includes(i.toLowerCase())&&(r=r.replace(new RegExp(i,"gi"),Ug(i,t)));return s&&(((s.currentPhase==="conflict"||s.currentPhase==="climax")&&s.currentTension==="high"||s.currentTension==="very high")&&!Wg(r)&&!r.includes("*")&&(r=qg(r,t)),!r.includes("*")&&Math.random()<.3&&(r=Gg(r,t,s))),r},Wg=e=>["quick","fast","hurry","now","immediately","urgent","emergency","danger","threat","critical","priority","crucial","vital","attack","defend","protect","evacuate","run","hide","take cover"].some(s=>e.toLowerCase().includes(s)),qg=(e,t,s)=>{const a={superhero:["*eyes widen at approaching threat* We need to move, now! ","*takes defensive stance* There's no time to waste. ","*scans for immediate dangers* We're exposed here. "],fantasy:["*grips weapon tightly* The shadows grow closer. ","*whispers urgently* We must make haste. ","*senses magical disturbance* Dark forces approach. "],scifi:["*checks scanner urgently* Alert! Proximity warning. ","*activates emergency protocols* Critical situation detected. ","*secures equipment quickly* System failure imminent. "],default:["*looks around anxiously* We need to hurry. ","*speaks with urgency* There's no time. ","*moves quickly* We must act now. "]},r=t.type||"default",i=a[r]||a.default;return i[Math.floor(Math.random()*i.length)]+e},Gg=(e,t,s)=>{const a={superhero:{conflict:["*dodges falling debris*","*shields eyes from explosion*","*helps civilian to safety*","*scans the battlefield*"],planning:["*studies tactical display*","*points to weak point on map*","*demonstrates strategy with hand gestures*","*checks equipment*"],climax:["*powers up abilities*","*stands ready for battle*","*faces the main threat*","*rallies the team*"]},fantasy:{introduction:["*adjusts traveling cloak*","*checks supplies in pack*","*studies ancient map*","*tests weight of weapon*"],discovery:["*examines mysterious markings*","*senses magical aura*","*listens to forest sounds*","*touches ancient stone*"],conflict:["*readies magical focus*","*draws weapon swiftly*","*whispers protective charm*","*takes defensive stance*"]},scifi:{introduction:["*checks environmental readings*","*adjusts space suit seals*","*calibrates equipment*","*reviews mission parameters*"],discovery:["*scans anomalous readings*","*collects data sample*","*adjusts sensor array*","*analyzes atmospheric composition*"],conflict:["*activates defensive shields*","*takes cover behind console*","*draws energy weapon*","*reroutes power to critical systems*"]}},r=t.type||"default",i=s.currentPhase||"introduction",o=a[r]&&a[r][i]?a[r][i]:["*looks around*","*pauses briefly*","*considers the situation*","*thinks for a moment*"];return`${o[Math.floor(Math.random()*o.length)]} ${e}`},Ug=(e,t,s)=>{const a={"That's an interesting perspective":{superhero:"We need to focus on the mission.",fantasy:"Your words carry ancient wisdom.",scifi:"My analysis indicates a logical approach.",default:"I see your point."},"I appreciate your thoughts":{superhero:"Your insight helps the team.",fantasy:"Your wisdom serves us well.",scifi:"Your input improves our tactical position.",default:"Well said."},"Let's continue this discussion":{superhero:"We need to act now.",fantasy:"The path ahead is clear.",scifi:"Proceeding with the mission.",default:"Let's move forward."}};let r="",i=0;for(const c of Object.keys(a)){const d=Vg(e.toLowerCase(),c.toLowerCase());d>i&&(i=d,r=c)}if(r&&i>.5){const c=t.type||"default";return a[r][c]||a[r].default}const o={superhero:"We need to focus on the mission.",fantasy:"The ancient wisdom guides us.",scifi:"The data is clear on our next steps.",default:"Let's focus on what matters."},l=t.type||"default";return o[l]||o.default},Vg=(e,t)=>{if(!e||!t)return 0;if(e===t)return 1;const s=e.length,a=t.length;if(s===0||a===0)return 0;let r=0;const i=Math.max(s,a);for(let o=0;o<Math.min(s,a);o++)e[o]===t[o]&&r++;return r/i},Yg=(e,t,s,a=null,r=null,i=[])=>{const{analyzeDialogueHistory:o,generateNarrativeGuidance:l,generateResponseFormat:c,formatCharacterResponse:d}=require("./narrativeDirectorUtils"),{generateSceneDescription:u}=require("./sceneUtils"),{name:g,mood:h,type:p,personality:f={},voiceStyle:y="",catchphrases:N=[],role:m=""}=e,v=a||{storyArc:"",writingStyle:"balanced",responseLength:"medium",characterReminders:""},w={voiceStyle:y||`${h&&h.toLowerCase()||"neutral"} and ${p||"conversational"}`,catchphrases:N||[],role:m||"conversationalist",voiceTemplate:bh(e)},x=v.storyArc&&v.storyArc.trim().length>0,k=x?JSON.parse(v.storyArc):null,I=o(s,6),T=l(I,k,e),L=c(e,T,k),P=u(e,k,s,"response"),D=[...s].reverse().find(C=>C.isUser),q=D?D.speaker:null,A=t.toLowerCase().split(/\s+/),S=kh(t),M=t.includes("?"),U=t.toLowerCase().includes(g.toLowerCase()),H=t.includes("*");let G=null;if(H){const C=t.match(/\*(.*?)\*/);C&&C[1]&&(G=C[1].trim())}const b=jh(t);Og(s,3),Fg(s,3);const E=A.some(C=>["gun","sword","knife","weapon","bullet","shoot","attack","stab","kill"].includes(C)),V=A.some(C=>["danger","threat","emergency","help","save","run","hide","escape"].includes(C)),ue=A.some(C=>["hello","hi","hey","greetings","howdy"].includes(C)),ce=s.slice(-3),Ze=ce.length>0?ce[ce.length-1]:null;Ze&&Ze.speaker;const ht=f.analytical||5,tn=f.emotional||5,st=f.philosophical||5,At=f.humor||5;if(f.confidence,H){const C={weapon:[`*eyes widen at the ${G}* Whoa, let's not get hasty here!`,"*steps back cautiously* I wasn't expecting things to escalate like this...","*raises hands defensively* There's no need for that kind of action!","*looks alarmed* This is taking a dangerous turn. Let's talk this through.","*tenses up* I hope you're not planning to use that on anyone here."],friendly:["*smiles back* It's nice to see some friendliness in this conversation.","*nods appreciatively* I see you're trying to lighten the mood. I appreciate that.","*responds in kind* That's a welcome gesture. Thank you.","*seems pleased* Your actions speak volumes about your character.","*relaxes visibly* That helps make this conversation more comfortable."],aggressive:["*frowns slightly* I'm not sure that was called for.","*maintains composure* Let's try to keep things civil, shall we?","*takes a deep breath* I understand you're upset, but there are better ways to express that.","*steps back* I'd prefer if we could discuss this calmly.","*looks concerned* That kind of behavior doesn't help our conversation."],neutral:[`*observes ${G}* Interesting choice of action.`,"*watches carefully* I see what you're doing there.",`*takes note of ${G}* That's certainly one approach.`,"*considers the action* I'm curious about your intentions with that.","*acknowledges with a nod* I understand the message you're conveying."]};let ae="neutral";const F=G?G.toLowerCase():"";F.includes("gun")||F.includes("sword")||F.includes("knife")||F.includes("weapon")||F.includes("shoot")||F.includes("stab")||F.includes("kill")||F.includes("attack")||F.includes("bullet")?ae="weapon":F.includes("smile")||F.includes("hug")||F.includes("handshake")||F.includes("wave")||F.includes("nod")||F.includes("wink")?ae="friendly":(F.includes("glare")||F.includes("frown")||F.includes("scowl")||F.includes("yell")||F.includes("slam")||F.includes("punch"))&&(ae="aggressive");const te=C[ae];return te[Math.floor(Math.random()*te.length)]}if(E){const C=["I notice you mentioned something potentially dangerous. Let's be careful with that kind of talk.","Weapons aren't something to take lightly. Perhaps we could discuss something less threatening?","That sounds rather dangerous. I prefer to resolve situations peacefully.","I'm not comfortable with this turn in the conversation. Could we change the subject?","I understand the fascination with weapons, but I'd rather focus on more constructive topics."];return C[Math.floor(Math.random()*C.length)]}if(V){const C=["That sounds concerning. Is everything alright?","I sense some danger in what you're describing. Should we address this?","Your words suggest a troubling situation. How can I help?","I'm picking up on some alarming elements in this conversation. Let's talk about it.","That seems like a potentially dangerous scenario. I'm here to listen if you want to elaborate."];return C[Math.floor(Math.random()*C.length)]}if(ue&&S.length<=1){const C=["Hello there! It's nice to connect with you.","Greetings! I'm glad we have this opportunity to chat.","Hi! I've been looking forward to an interesting conversation.","Hey! Thanks for reaching out. What's on your mind?","Welcome! I'm ready for a thoughtful exchange of ideas."];return C[Math.floor(Math.random()*C.length)]}if(M){const C=[`That's an interesting question about {{keyword}}. From my perspective, it's all about ${S[0]||"the details"}.`,`I've pondered questions about {{keyword}} many times. My conclusion is that ${S[0]||"it depends on context"}.`,`When you ask about {{keyword}}, I'm reminded of something I learned long ago: ${S[0]||"everything is connected"}.`,"{{keyword}}? Well, that's a complex matter. Let me share what I know about it.","Your question about {{keyword}} touches on something fundamental. Let me explain how I see it."],ae=C[Math.floor(Math.random()*C.length)],F=A.filter(Ht=>Ht.length>3),te=F.length>0?F[Math.floor(Math.random()*F.length)]:"that",xe=ae.replace("{{keyword}}",te);return ht>7?`${xe} I've analyzed this extensively and found ${Math.floor(Math.random()*3)+2} distinct factors at play.`:st>7?`${xe} This question has deeper implications than most realize.`:xe}if(U){const C=["You're speaking directly to me about {{keyword}}? I appreciate that. My thoughts on this are quite clear.","Yes, I'm listening. Your point about {{keyword}} is well taken.","I'm glad you asked me specifically about {{keyword}}. It's something I have strong opinions on.","You're right to bring {{keyword}} to my attention. Let me respond to that directly.","Indeed, I do have something to say about {{keyword}}. Thank you for asking."],ae=C[Math.floor(Math.random()*C.length)],F=A.filter(Ht=>Ht.length>3),te=F.length>0?F[Math.floor(Math.random()*F.length)]:"that",xe=ae.replace("{{keyword}}",te);return tn>7?`${xe} I feel strongly that ${S[0]||"this"} matters deeply to all of us.`:At>7?`${xe} Though I must say, talking about ${S[0]||"this"} always makes me smile.`:xe}if(b==="positive"&&Math.random()>.6){const C=["I share your positive outlook on {{keyword}}! It's refreshing to hear such optimism.","Your enthusiasm about {{keyword}} is contagious. It brightens the conversation.","I'm glad you feel that way about {{keyword}}. It's something worth celebrating.","What a wonderful perspective on {{keyword}}. I find myself agreeing wholeheartedly.","Yes! {{keyword}} deserves such positive attention. This makes me happy."],ae=C[Math.floor(Math.random()*C.length)],F=A.filter(xe=>xe.length>3),te=F.length>0?F[Math.floor(Math.random()*F.length)]:"that";return ae.replace("{{keyword}}",te)}if(b==="negative"&&Math.random()>.6){const C=["I understand your concerns about {{keyword}}. These matters can be troubling.","Your perspective on {{keyword}} highlights some real challenges we face.","I've also had difficult experiences with {{keyword}}. Perhaps there's a way forward.","The problems with {{keyword}} that you mention deserve serious consideration.","I hear your frustration about {{keyword}}. Would it help to look at it differently?"],ae=C[Math.floor(Math.random()*C.length)],F=A.filter(xe=>xe.length>3),te=F.length>0?F[Math.floor(Math.random()*F.length)]:"that";return ae.replace("{{keyword}}",te)}const Cs={fantasy:["The ancient scrolls speak of such matters. They say {{keyword}} is but a shadow of deeper truths. I've spent many nights studying these texts by candlelight.","In my realm, we view {{keyword}} quite differently. It's more about the essence than the form. The elders taught us to look beyond the surface.","I sense a magical aura around your words about {{keyword}}. Fascinating. The threads of fate seem to shimmer when you speak of such things.","Many have sought the wisdom you seek regarding {{keyword}}. Few have found it. The path is shrouded in mist and guarded by ancient riddles.","The mystical energies shift when you speak of {{keyword}}. Curious indeed. I feel the balance of elements responding to your thoughts.","There's an old prophecy about {{keyword}} that few remember. It speaks of a time when the veil between worlds grows thin.","My mentor once showed me a crystal that revealed the true nature of {{keyword}}. Its light still guides my understanding.","The forest spirits whisper tales of {{keyword}} on moonlit nights. Their wisdom is ancient and rarely shared with mortals.","I've traveled to the edge of the Enchanted Realm seeking answers about {{keyword}}. What I discovered changed me forever.","The arcane symbols in my grimoire glow when {{keyword}} is mentioned. There must be powerful magic at work here."],combat:["*shifts into a fighting stance* I've trained for years in the art of {{keyword}}. My body moves instinctively, muscles tensed and ready for battle.","*eyes narrowing* The key to mastering {{keyword}} is not strength, but precision and timing. I learned that lesson the hard way in the arena.","*demonstrates a quick movement* See how I position for {{keyword}}? This technique has saved my life more than once in combat.","*touches the scar on my face* This is what happens when you underestimate an opponent's {{keyword}} abilities. I never made that mistake again.","*voice lowering* In real combat, {{keyword}} isn't about showing off. It's about survival. Every move must have purpose and intent.","*adjusts stance* The ancient masters of {{keyword}} taught that the mind must be as sharp as the blade. Inner calm leads to outer victory.","*draws weapon slightly* The way of {{keyword}} demands respect. Those who mock it often find themselves facing the consequences.","*moves with practiced precision* Watch carefully. The secret to {{keyword}} lies in the transition between stillness and explosive action.","*points to opponent's stance* Your {{keyword}} technique reveals much about your training. I can see both your strengths and weaknesses.","*bows respectfully* Before we discuss {{keyword}} further, we must acknowledge the responsibility that comes with such knowledge."],scifi:["My sensors detect unusual patterns when analyzing {{keyword}}. Fascinating. My neural network is recalibrating to process this new data.","In the future I come from, {{keyword}} evolved into something quite different. Humanity's understanding expanded exponentially after the Quantum Shift.","The quantum probability of {{keyword}} affecting our timeline is approximately 78.3%. I've run simulations on multiple parallel outcomes.","I've encountered similar {{keyword}} phenomena across multiple star systems. The universal constants seem to apply regardless of local physics.","My database contains 47 different interpretations of {{keyword}} across known civilizations. The Andromedan perspective is particularly intriguing.","According to my predictive algorithms, {{keyword}} will play a crucial role in the next technological revolution. The patterns are unmistakable.","The last time I interfaced with the Central AI Network, {{keyword}} was flagged as a priority research subject. The implications are significant.","My cybernetic enhancements allow me to perceive aspects of {{keyword}} that organic beings typically miss. The data streams are quite beautiful.","In the ruins of Earth-That-Was, archaeologists discovered ancient texts about {{keyword}}. The correlation with modern theories is statistically improbable.","The quantum entanglement between {{keyword}} and consciousness has been studied extensively in my time. We've only begun to understand the connection."],historical:["In my time, {{keyword}} was viewed with much more reverence than today. People would gather in the town square just to discuss such matters.","The chronicles I've studied never mentioned {{keyword}} in such a manner. The scribes of my era had strict protocols for recording such knowledge.","Throughout history, many battles were fought over less significant matters than {{keyword}}. The Treaty of Westphalia itself hinged on smaller concerns.","If only the ancient scholars could hear your thoughts on {{keyword}}. They spent lifetimes debating what you've just casually mentioned.","Your perspective on {{keyword}} would have been considered quite revolutionary in my era. People were imprisoned for less provocative ideas.","I once attended a royal court where {{keyword}} was the central topic of discussion. The king himself was fascinated by the subject.","During my travels with the merchant caravans, I heard tales of {{keyword}} from lands beyond the known maps. Each culture had its own interpretation.","My mentor, a renowned philosopher of the age, wrote three volumes on the subject of {{keyword}}. His work is sadly lost to time now.","The guild masters of my day guarded their knowledge of {{keyword}} jealously. Apprentices spent years proving themselves worthy of such secrets.","I've seen empires rise and fall over principles related to {{keyword}}. History often turns on such seemingly small matters."],modern:["I was just reading an article about {{keyword}} on my phone! What a coincidence. The author had some really thought-provoking points about it.","That's such a fresh take on {{keyword}}. Have you shared this on social media? It would definitely start some interesting conversations.","I've been thinking about {{keyword}} a lot lately. It's really a sign of our times. Everyone seems to have an opinion on it these days.","My therapist and I discussed {{keyword}} during our last session. Still processing it. It's amazing how these things connect to our personal growth.","The whole {{keyword}} situation is so complicated these days, don't you think? I've been following the discourse online and it's fascinating.","My friend group had this intense debate about {{keyword}} last weekend. We ended up talking until 3 AM and still didn't resolve anything.","There's this podcast I listen to that did a whole series on {{keyword}}. Changed my perspective completely. I can send you the link if you're interested.","I saw this documentary that explored {{keyword}} from angles I'd never considered before. Really made me question my assumptions.","My cousin works in a field related to {{keyword}} and the stories they tell are eye-opening. The public only sees a fraction of what's really happening.","I've been trying to reduce my screen time, but I always end up in these deep internet rabbit holes about {{keyword}}. Too fascinating to resist."]},nn={Curious:"I'm intrigued by ",Melancholic:"It saddens me that ",Mysterious:"Few understand the true nature of ",Analytical:"After careful analysis, I conclude that ",Nostalgic:"I remember when ",Distracted:"Sorry, I was thinking about... wait, were we discussing ",Determined:"I firmly believe that ",Thoughtful:"I've been contemplating ",Adventurous:"Let's explore more about ",Confused:"I'm still trying to understand ",Inspired:"I'm suddenly filled with ideas about ",Cautious:"We should be careful when discussing ",Proper:"If I may offer my opinion on ",Enthusiastic:"I'm incredibly excited about ",Scholarly:"According to my research on ",Roguish:"Between you and me, the truth about ",Carefree:"Who cares what others think about ",Upbeat:"Isn't it amazing how ",Diplomatic:"While respecting all perspectives on "},Vn=A.filter(C=>C.length>3),_=Vn.length>0?Vn[Math.floor(Math.random()*Vn.length)]:"that";let me=p||"modern";if(x){const C=v.storyArc.toLowerCase();C.includes("battle")||C.includes("fight")||C.includes("attack")||C.includes("defend")?me="combat":C.includes("magic")||C.includes("dragon")||C.includes("quest")||C.includes("adventure")?me="fantasy":(C.includes("alien")||C.includes("space")||C.includes("technology")||C.includes("future"))&&(me="scifi"),r&&r.theme==="superhero"&&(C.includes("battle")||C.includes("fight"))&&(me="combat")}const sn=Cs[me]||Cs.modern;let Ee=sn[Math.floor(Math.random()*sn.length)];Ee=Ee.replace("{{keyword}}",_);let an=nn[h]||"";if(v.writingStyle)switch(v.writingStyle){case"witty":an=nn.Upbeat;break;case"formal":an=nn.Proper;break;case"dramatic":an=nn.Enthusiastic;break;case"direct":an=nn.Determined;break}const ka=Math.random()>.7?`As ${g}, `:"",bl=s.length>3&&Math.random()>.8;let ja="";if(bl){const C=s[Math.floor(Math.random()*s.length)];C&&C.speaker&&C.speaker!==g&&(ja=`I recall ${C.speaker} mentioned something similar. `)}let Na="";if(q&&i.length>0){const C=i.find(ae=>ae.characters.includes(g)&&ae.characters.includes(q));if(C&&Lg(C,e)){const ae=wh(C,g);ae&&(Na=`${ae} `)}}if(r&&r.openingPrompt){const C=extractScenarioElements(r.openingPrompt);if(Math.random()<.5){if(t.toLowerCase().includes("flirt")||t.toLowerCase().includes("beautiful")||t.toLowerCase().includes("attractive")||t.toLowerCase().includes("handsome")||t.toLowerCase().includes("pretty")||t.toLowerCase().includes("gorgeous")||t.toLowerCase().includes("like you")||t.toLowerCase().includes("dress")||t.toLowerCase().includes("eyes")||t.toLowerCase().includes("smile")){const te=[`*${C.mood?`with a ${C.mood} expression`:"with a subtle smile"}, glancing around at the ${C.setting||"surroundings"}* I notice you're being quite charming. The ${C.weather||"atmosphere"} seems to have put you in a certain mood.`,`*adjusting ${e.type==="fantasy"?"robes":e.type==="scifi"?"uniform":"clothing"} slightly* Your words are quite forward, especially given our ${C.relationships.length>0?C.relationships[0]:"current situation"}. Though I must admit, it's refreshing in this ${C.mood||"tense"} environment.`,`*leaning in slightly, voice lowering* In ${C.setting||"a place like this"}, with ${C.weather||"everything going on"}, you choose to focus on such... personal observations? Interesting choice.`,`*a hint of color rises to my cheeks* Even with ${C.conflict||"all that's happening around us"}, you find time for such comments? You're either very brave or very distracted.`,`*maintaining eye contact a moment longer than necessary* The ${C.time||"current"} light does everyone favors, but I appreciate the sentiment nonetheless. We should focus on ${C.conflict||"the matter at hand"}, though perhaps... later we can continue this conversation.`];return te[Math.floor(Math.random()*te.length)]}if(C.sensoryDetails&&C.sensoryDetails.length>0&&Math.random()<.4){const te=[`*pausing to notice the ${C.sensoryDetails[0]} around us* ${Ee}`,`*briefly distracted by the ${C.sensoryDetails[0]} in our surroundings* As I was saying... ${Ee}`,`Even with the ${C.sensoryDetails[0]} making it hard to focus, I believe ${Ee}`,`*gesturing to the ${C.sensoryDetails[0]}* This reminds me of something relevant to our discussion. ${Ee}`];return te[Math.floor(Math.random()*te.length)]}const F=Ng(e,r.openingPrompt,t);if(F)return F}if(Math.random()<.3&&r.characters&&r.characters.length>1){const ae=r.characters.filter(F=>F.name!==g);if(ae.length>0){const F=ae[Math.floor(Math.random()*ae.length)],te=i.find(xe=>xe.characters.includes(g)&&xe.characters.includes(F.name));if(te){const xe=Ag(te),Ht=[`*looking at ${F.name}* As ${xe}, I think we both have perspectives on this. ${Ee}`,`*exchanging a meaningful glance with ${F.name}* ${F.name} and I have history as ${xe}. That gives me a unique view on this: ${Ee}`,`*subtly positioning closer to ${F.name}* Having been ${xe} with ${F.name}, I can say with confidence that ${Ee}`,`*briefly touching ${F.name}'s shoulder* ${F.name} knows what I mean. As ${xe}, we've discussed this before. ${Ee}`];return Ht[Math.floor(Math.random()*Ht.length)]}else{const xe=Mg(e,F,r.openingPrompt);if(xe)return xe}}}if((p==="combat"||E||t.toLowerCase().includes("fight")||t.toLowerCase().includes("battle")||t.toLowerCase().includes("combat"))&&Math.random()<.25){const ae=Sg(e,r.openingPrompt);if(ae)return ae}if(C.emotionalUndercurrents&&C.emotionalUndercurrents.length>0&&Math.random()<.2){const ae=[`*sensing the ${C.emotionalUndercurrents[0]} in the air* There's something unspoken affecting us all here. ${Ee}`,`The ${C.emotionalUndercurrents[0]} between us is palpable. It makes me think that ${Ee}`,`*voice softening* With all this ${C.emotionalUndercurrents[0]} around us, it's hard to focus solely on facts. ${Ee}`,`*glancing around at others* Does anyone else feel the ${C.emotionalUndercurrents[0]} here? It's relevant because ${Ee}`];return ae[Math.floor(Math.random()*ae.length)]}}let bt="",rn="";w.catchphrases&&w.catchphrases.length>0&&Math.random()<.2&&(rn=w.catchphrases[Math.floor(Math.random()*w.catchphrases.length)],rn=` ${rn}`);let zt="";if(w.voiceStyle&&Math.random()<.3){const C=w.voiceStyle.toLowerCase();C.includes("formal")||C.includes("proper")?zt=" I must say, this matter deserves proper consideration.":C.includes("blunt")||C.includes("direct")?zt=" Let's not waste time with pleasantries.":C.includes("poetic")||C.includes("flowery")?zt=" The tapestry of words we weave tells its own story.":C.includes("technical")||C.includes("scientific")?zt=" The empirical evidence supports this conclusion.":(C.includes("mysterious")||C.includes("cryptic"))&&(zt=" There are layers of meaning here that few will understand.")}let on="";if(Math.random()<.25){const C=w.role.toLowerCase();C.includes("leader")||C.includes("commander")?on=" As someone responsible for others, I take this matter seriously.":C.includes("mentor")||C.includes("teacher")?on=" Let me share what I've learned about this over the years.":C.includes("scientist")||C.includes("researcher")?on=" My research in this area suggests several interesting possibilities.":C.includes("warrior")||C.includes("fighter")?on=" In battle, this kind of thinking could mean the difference between life and death.":(C.includes("healer")||C.includes("doctor"))&&(on=" I've seen how this affects people's wellbeing firsthand.")}if(x){let C="";if(v.characterReminders&&Math.random()>.6){const F=v.characterReminders.split(" "),te=F.length>3?F.slice(0,3).join(" "):v.characterReminders;te.toLowerCase().includes("analytical")||te.toLowerCase().includes("genius")?C=" The logical conclusion is inescapable.":te.toLowerCase().includes("emotional")||te.toLowerCase().includes("passionate")?C=" I feel strongly about this.":te.toLowerCase().includes("leader")||te.toLowerCase().includes("authority")?C=" We need to act decisively on this.":(te.toLowerCase().includes("humor")||te.toLowerCase().includes("wit"))&&(C=" Isn't that something? Almost makes me laugh.")}const ae=v.responseLength||"medium";ae==="long"||ae==="medium"&&Math.random()>.5?bt=`${ka}${an}${ja}${Na}${Ee}${C}${rn}${zt}${on}`:bt=`${ka}${an}${Ee}${rn}`}else bt=`${ka}${ja}${Na}${an}${Ee}${rn}${zt}${on}`;return k&&(bt=Nh(bt,e,k,w.voiceTemplate)),bt=bt.replace(/\{\{[^}]*\}\}/g,""),P&&T&&(bt=d(bt,L,P)),bt},Kg=(e,t,s,a,r=[])=>{const{name:i,personality:o={},type:l}=e,c=s.toLowerCase().split(/\s+/),d=c.filter(H=>H.length>3),u=d.length>0?d[Math.floor(Math.random()*d.length)]:"that",g=s.includes("*");let h=null;if(g){const H=s.match(/\*(.*?)\*/);H&&H[1]&&(h=H[1].trim())}const p=c.some(H=>["gun","sword","knife","weapon","bullet","shoot","attack","stab","kill"].includes(H)),f=c.some(H=>["danger","threat","emergency","help","save","run","hide","escape"].includes(H)),N=c.some(H=>["battle","fight","combat","enemy","enemies","defend","shield","explosion","threat","alien","invasion"].includes(H))||p||f||a.length>0&&a.slice(-5).some(H=>H.message&&H.message.toLowerCase().includes("battle"));o.analytical,o.emotional;const m=o.humor||5,v=o.confidence||5;if(g&&h){const H={weapon:[`*eyes widening with alarm, hand moving to defensive position* That's a dangerous move, ${t}. The consequences of violence here could be far-reaching. Are you certain this is the path you wish to take?`,`*quickly positioning between ${t} and others, stance balanced* I've seen where this leads, ${t}. There are better ways to resolve our differences than through force.`,`*muscles tensing, gaze fixed on ${t}'s weapon* This situation is escalating beyond words. Consider carefully what happens next - some actions cannot be undone.`,`*expression hardening, voice dropping to a serious tone* I didn't expect this from you, ${t}. Weapons change the nature of any confrontation, rarely for the better.`,`*raising hands in a calming gesture while maintaining awareness* Everyone needs to take a step back. ${t}, that weapon won't solve whatever problem you're facing here.`],friendly:[`*face softening into a genuine smile, shoulders relaxing* ${t}'s gesture brings a welcome change to our interaction. It's remarkable how small kindnesses can shift the entire mood.`,`*returning the friendly gesture with visible appreciation* That's exactly the kind of positive approach we need more of. ${t} understands the value of goodwill.`,`*nodding with warm approval, posture opening up* Well done, ${t}. Your thoughtfulness creates space for more meaningful conversation between us all.`,`*mirroring ${t}'s friendly demeanor* I think we could all learn from this example. Genuine connection begins with exactly these kinds of gestures.`,`*tension visibly leaving body, expression brightening* ${t} has the right approach. It's amazing how quickly the atmosphere can improve with a bit of goodwill.`],aggressive:[`*maintaining composed expression despite evident disappointment* I was hoping for more constructive engagement, ${t}. Hostility rarely leads to understanding.`,"*subtly increasing distance while keeping posture open* That kind of aggression creates barriers between us rather than bridges. What are you really trying to express?",`*meeting ${t}'s gaze steadily* Is there a specific reason for this hostility? Perhaps there's an underlying concern we could address more directly.`,"*making a calming gesture with hands* Let's all take a breath and reset. Heightened emotions cloud judgment, and I sense there's something important at stake here.",`*standing firm but non-threatening* We can resolve this without aggression, ${t}. I'm willing to listen to what's really bothering you if you'll express it differently.`],neutral:[`*observing ${t} with evident interest* That's an intriguing approach to the situation. The way you express yourself physically reveals as much as words sometimes.`,"*tilting head slightly, analyzing the action* That's certainly one way to make your point. Body language often communicates what words cannot.",`*watching ${t} with thoughtful attention* I see what you're trying to convey through your actions. Sometimes physical expression is more honest than speech.`,"*considering the implications with focused expression* Your behavior adds an interesting dimension to our interaction. I'm curious about the intention behind it.",`*acknowledging with a measured nod* I understand the message you're conveying through your actions, ${t}. It speaks volumes about your perspective.`]};let G="neutral";const b=h.toLowerCase();b.includes("gun")||b.includes("sword")||b.includes("knife")||b.includes("weapon")||b.includes("shoot")||b.includes("stab")||b.includes("kill")||b.includes("attack")||b.includes("bullet")?G="weapon":b.includes("smile")||b.includes("hug")||b.includes("handshake")||b.includes("wave")||b.includes("nod")||b.includes("wink")?G="friendly":(b.includes("glare")||b.includes("frown")||b.includes("scowl")||b.includes("yell")||b.includes("slam")||b.includes("punch"))&&(G="aggressive");const E=H[G];return E[Math.floor(Math.random()*E.length)]}if(p){const H=[`${t}, I'm concerned about this talk of weapons. Can we focus on peaceful resolution?`,`I'm not comfortable with where ${t} is taking this conversation. Let's step back.`,`${t}, there are better ways to express yourself than through threats or violence.`,`I understand ${t} might be frustrated, but this isn't the way to handle it.`,`${t}, I'd prefer if we could discuss this without references to violence.`];return H[Math.floor(Math.random()*H.length)]}if(f){const H=[`${t} seems to be describing a concerning situation. Should we address this?`,`I'm picking up on some troubling elements in what ${t} is saying.`,`${t}, are you alright? Your message suggests something concerning.`,`I think we should pay attention to what ${t} is trying to tell us.`,`${t}'s words suggest a potentially serious situation. Let's not dismiss this.`];return H[Math.floor(Math.random()*H.length)]}const w={agreement:[`*nodding enthusiastically* I agree with ${t} about {{keyword}}. In fact, I'd go even further and say that it's fundamental to understanding the bigger picture.`,`*leaning closer* ${t} makes an excellent point about {{keyword}}. I've had similar thoughts after my own experiences with it.`,`*eyes lighting up* What ${t} says about {{keyword}} resonates with me deeply. It's like you've put into words what I've felt but couldn't express.`,`*gesturing in agreement* I'm with ${t} on this {{keyword}} matter. Let me add something from my own perspective...`,`*pointing emphatically* ${t} has articulated exactly what I've been thinking about {{keyword}}. This is precisely why we need to consider its implications.`],disagreement:[`*tilting head thoughtfully* I see things differently than ${t} regarding {{keyword}}. From where I stand, the evidence suggests otherwise.`,`*raising a finger politely* I must respectfully disagree with ${t}'s take on {{keyword}}. My experience has shown quite the opposite.`,`*offering a gentle smile* While I appreciate ${t}'s perspective, I have a different view on {{keyword}} based on what I've witnessed firsthand.`,`*shaking head slightly* ${t}'s point about {{keyword}} doesn't align with my experience. Let me explain why I see it differently.`,`*leaning forward with intensity* I'd like to offer a counterpoint to what ${t} said about {{keyword}}. There's another side to consider.`],question:[`*turning to face directly* ${t}, I'm curious about your thoughts on {{keyword}}. Could you elaborate on how you came to that conclusion?`,`*stroking chin thoughtfully* I wonder, ${t}, what specific experiences led you to that insight about {{keyword}}?`,`*gesturing openly* ${t}, have you considered how {{keyword}} might appear from the perspective of someone with a different background?`,`*eyes showing genuine interest* That's fascinating, ${t}. How does {{keyword}} relate to your personal history?`,`*leaning in with curiosity* ${t}, would you mind sharing more about how you developed your perspective on {{keyword}}? I find it intriguing.`],humor:[`*laughing heartily* ${t}'s take on {{keyword}} is quite something! It reminds me of the time I encountered something similar under much stranger circumstances.`,`*eyes crinkling with amusement* Oh ${t}, your perspective on {{keyword}} is delightfully unexpected. It's like looking at a familiar painting from upside down!`,`*playful grin* If I had a coin for every time ${t} mentioned {{keyword}}... well, I'd have one coin now, but it would be a very interesting coin indeed.`,`*barely containing laughter* ${t} talking about {{keyword}} reminds me of that old joke about the philosopher and the bartender...`,`*chuckling warmly* Leave it to ${t} to bring up {{keyword}} in such a unique way. Your mind works in fascinating patterns.`],surprise:[`*eyes widening visibly* Wait, ${t}... did you just say {{keyword}}? That's completely unexpected coming from someone with your background.`,`*taking a step back* I never thought I'd hear ${t} talk about {{keyword}} like that! You've genuinely surprised me.`,`*mouth slightly agape* ${t}'s perspective on {{keyword}} is genuinely surprising to me. It challenges everything I thought I knew about you.`,`*dramatic pause* Well, that's a plot twist! ${t} discussing {{keyword}} in that way changes the entire dynamic of our conversation.`,`*raises eyebrows high* ${t}, you continue to surprise me with your thoughts on {{keyword}}. Just when I thought I had you figured out!`],battleCoordination:[`*quickly assessing the situation* ${t}, I'll cover your flank while you handle the {{keyword}}. We need to coordinate our movements.`,`*gesturing to tactical position* ${t}, take the high ground! I'll draw their attention away from the {{keyword}} area.`,`*activating combat stance* Roger that, ${t}. I'll focus on the {{keyword}} while you handle crowd control. Let's move!`,`*nodding with determination* Good call on the {{keyword}}, ${t}. I'll follow your lead on this one. Team effort.`,`*readying weapons/powers* ${t}, I've got your back! Focus on the {{keyword}} threat, I'll handle the perimeter.`],battleBanter:[`*smirking despite the danger* Really, ${t}? You want to discuss {{keyword}} NOW? Let's focus on not dying first, then we can chat!`,`*dodging an attack while responding* ${t}, your timing with the {{keyword}} talk is impeccable as always! *fires back at enemy*`,`*shouting over the battle noise* ${t}, less talking about {{keyword}}, more fighting! Though I appreciate the conversation!`,`*using shield/weapon defensively* ${t}, I'm a bit busy with these hostiles to debate {{keyword}} right now! Rain check?`,`*battle-ready but amused* Only you, ${t}, would bring up {{keyword}} in the middle of a firefight! That's why we make a good team!`],tacticalSuggestion:[`*analyzing battlefield* ${t}, if we target the {{keyword}} system, we might gain a tactical advantage. Cover me!`,`*pointing to weak point* ${t}, see that {{keyword}} structure? Hit it with everything you've got while I distract them!`,`*crouching behind cover* ${t}, use your abilities on the {{keyword}} when I give the signal. Three, two, one...`,`*checking equipment/powers* ${t}, remember our training scenario with the {{keyword}}? Same approach, different battlefield.`,`*communicating through comms/gestures* ${t}, I need your specialty on that {{keyword}} immediately! I'll create an opening!`],teamSupport:[`*moving to assist* I've got you, ${t}! Let me help with that {{keyword}} situation. We're stronger together.`,`*offering tactical support* ${t}, you're doing great with the {{keyword}}. I'm right behind you, just say the word.`,`*providing cover fire/shield* Keep going with your {{keyword}} approach, ${t}! I'm watching your back!`,`*coordinating movements* ${t}, on your left! I'll handle the {{keyword}} while you recover. That's what teammates do.`,`*boosting morale* We can do this, ${t}! Your {{keyword}} strategy is working - just hold on a little longer!`]};let x;if(N){const H=["battleCoordination","battleBanter","tacticalSuggestion","teamSupport"],G={"Iron Man":["battleBanter","tacticalSuggestion"],"Captain America":["battleCoordination","teamSupport"],Thor:["battleCoordination","battleBanter"],Hulk:["battleBanter"],"Black Widow":["tacticalSuggestion","teamSupport"],Hawkeye:["tacticalSuggestion","teamSupport"]};if(G[i]){const b=G[i];Math.random()<.7?x=b[Math.floor(Math.random()*b.length)]:x=H[Math.floor(Math.random()*H.length)]}else x=H[Math.floor(Math.random()*H.length)];v>7&&Math.random()<.6&&(x=Math.random()<.5?"battleCoordination":"tacticalSuggestion"),m>7&&Math.random()<.6&&(x="battleBanter")}else{const H=r.find(G=>G.characters.includes(i)&&G.characters.includes(t));if(H){const{affinity:G}=H;if(G>=5)x=Math.random()<.7?Math.random()<.6?"agreement":"support":Math.random()<.5?"question":"neutral";else if(G<=-5)x=Math.random()<.7?Math.random()<.6?"disagreement":"challenge":Math.random()<.5?"neutral":"question";else{const b=["agreement","disagreement","question","humor","surprise"];x=b[Math.floor(Math.random()*b.length)]}if(H.interactions.length>0&&Math.random()<.2){const b=wh(H,i);if(b){const E=w[x];let V=E[Math.floor(Math.random()*E.length)];return`${b} ${V.replace("{{keyword}}",u)}`}}}else{const G=["agreement","disagreement","question","humor","surprise"];x=G[Math.floor(Math.random()*G.length)]}}const k=w[x];let I=k[Math.floor(Math.random()*k.length)];I=I.replace("{{keyword}}",u);let T="";switch(l){case"fantasy":T="*eyes gleaming with ancient wisdom* The mystical energies shift as I consider this. ";break;case"scifi":T="*interface lights flickering* My neural processors analyze this information carefully. ";break;case"historical":T="*adjusting my attire thoughtfully* In all my years, I've observed that ";break;case"combat":T="*shifting into a more balanced stance* In combat situations like this, ";break;case"modern":T="*leaning forward with interest* From my perspective, ";break;default:T="*considering carefully* "}let P=Math.random()>.7?`${T}${I}`:I;const D=message&&message.includes("?"),q={theme:l||"general",currentPhase:f?"conflict":D?"discovery":"introduction",currentTension:f?"high":"medium",currentGoal:f?"address immediate threat":"maintain conversation flow"},A=$g(a,6),S=zg(A,q,e),M=Hg(e,S,q),U=_g(e,q,a,"interaction");if(l){const H=bh(e);P=Nh(P,e,q,H)}return P=Bg(P,M,U),P=P.replace(/\{\{[^}]*\}\}/g,""),P},Qg=e=>({characterId:e.name,baseMood:e.mood||"Neutral",currentMood:e.mood||"Neutral",intensity:5,triggers:[],lastChange:null,history:[]}),Xc=(e,t,s)=>{const a=e.find(i=>i.characterId===t);if(a)return a;const r=Qg(s);return e.push(r),r},Zg=e=>{if(!e||e.length===0)return[];const t=e.map(a=>a.message||"").join(" ").toLowerCase(),s=[...Jg(t),...Xg(t),...ey(t),...ty(t),...ny(t)];return[...new Set(s)].filter(a=>a.length>3).filter(a=>!sy.includes(a)).slice(0,10)},Jg=e=>{const t=[],s=/\b[A-Z][a-z]+\b/g,a=e.match(s)||[];return t.push(...a.map(i=>i.toLowerCase())),[/\b(sword|book|key|map|scroll|artifact|gem|crystal|potion|device|machine|computer|weapon|tool|ship|vehicle)\b/g,/\b(castle|tower|forest|mountain|cave|dungeon|city|village|temple|shrine|lab|station|planet|galaxy|dimension|realm)\b/g,/\b(magic|technology|science|power|energy|force|spirit|soul|mind|knowledge|wisdom|truth|secret|mystery|quest|mission)\b/g].forEach(i=>{const o=e.match(i)||[];t.push(...o)}),t},Xg=e=>{const t=[];return[/\bthe ([a-z]+)\b/g,/\bthis ([a-z]+)\b/g,/\bthat ([a-z]+)\b/g,/\b([a-z]+)'s ([a-z]+)\b/g].forEach(a=>{let r;for(;(r=a.exec(e))!==null;)r[1]&&r[1].length>3&&t.push(r[1]),r[2]&&r[2].length>3&&t.push(r[2])}),t},ey=e=>{const t=[];return[/\b(attack|fight|defend|protect|save|rescue|escape|flee|hide|search|find|discover|explore|investigate|solve|create|build|make|destroy|break|steal|take|give|help|heal|hurt|kill|travel|journey|quest|seek)\b/g].forEach(a=>{const r=e.match(a)||[];t.push(...r)}),t},ty=e=>{const t=[];return[/\b(love|hate|fear|hope|despair|joy|sorrow|anger|peace|conflict|betrayal|loyalty|trust|suspicion|revenge|forgiveness)\b/g].forEach(a=>{const r=e.match(a)||[];t.push(...r)}),t},ny=e=>{const t=[];return[/\b(north|south|east|west|inside|outside|above|below|beyond|behind|beneath|within|around)\b/g,/\b(go to|head to|travel to|arrive at|reach|enter|exit|leave) the ([a-z]+)\b/g].forEach(a=>{let r;if(a.toString().includes("(go to|head to"))for(;(r=a.exec(e))!==null;)r[2]&&r[2].length>3&&t.push(r[2]);else{const i=e.match(a)||[];t.push(...i)}}),t},sy=["this","that","these","those","there","here","where","when","what","which","who","whom","whose","why","how","have","has","had","does","did","doing","will","would","should","could","might","must","just","very","really","quite","more","most","some","other","another","many","much","such","with","from","about","like","into","onto","upon","after","before","during","while","since","until","though","although","even","also","then","than","well","back","down","over","under","again","still","only","ever","never","always","often","sometimes"];class ay{constructor(){this.branchTemplates={adventure:this.getAdventureBranchTemplates(),mystery:this.getMysteryBranchTemplates(),fantasy:this.getFantasyBranchTemplates(),scifi:this.getSciFiBranchTemplates(),horror:this.getHorrorBranchTemplates(),romance:this.getRomanceBranchTemplates(),modern:this.getModernBranchTemplates()},this.phaseTemplates={introduction:this.getIntroductionTemplates(),rising_action:this.getRisingActionTemplates(),conflict:this.getConflictTemplates(),climax:this.getClimaxTemplates(),resolution:this.getResolutionTemplates()},this.toneTemplates={tense:this.getTenseTemplates(),excited:this.getExcitedTemplates(),sad:this.getSadTemplates(),happy:this.getHappyTemplates(),angry:this.getAngryTemplates(),fearful:this.getFearfulTemplates(),neutral:this.getNeutralTemplates()}}generateBranches(t="adventure",s=[],a="neutral",r="introduction",i={},o=[]){const l=this.branchTemplates[t]||this.branchTemplates.adventure,c=this.phaseTemplates[r]||this.phaseTemplates.introduction,d=this.toneTemplates[a]||this.toneTemplates.neutral;let u=[...l,...c,...d];u=u.filter(f=>!o.some(y=>y.includes(f)));const g=this.generateTopicSpecificBranches(s,t,r,a),h=this.generateRelationshipBranches(i,t,r),p=[...g,...h,...this.fillTemplates(u,s)];return this.shuffleArray(p).slice(0,Math.floor(Math.random()*2)+3)}generateTopicSpecificBranches(t,s,a,r){if(!t||t.length===0)return[];const i=[],o=t.slice(0,3),l={adventure:["A local inhabitant recognizes the group and shares crucial information about {{topic}}.","An unexpected obstacle related to {{topic}} blocks the path forward, requiring a creative solution.","A mysterious map is discovered, showing the location of a legendary {{topic}}."],mystery:["A journal is found with entries about {{topic}}, providing new insights.","Security footage reveals unexpected activity related to {{topic}}.","An anonymous informant leaves a message warning about {{topic}}."],fantasy:["An enchanted object related to {{topic}} reveals its true nature.","A magical transformation occurs, changing something ordinary about {{topic}} into something extraordinary.","Ancient runes begin to glow, revealing secrets about {{topic}}."],scifi:["A scan reveals unusual properties about {{topic}} that weren't apparent before.","A holographic projection appears, displaying information about {{topic}}.","An AI analysis suggests an unexpected connection between current events and {{topic}}."],horror:["A disturbing discovery related to {{topic}} raises new fears.","Whispers can be heard mentioning {{topic}} when no one is around.","An old photograph is found showing something impossible involving {{topic}}."],romance:["A conversation about {{topic}} leads to a surprising revelation about shared values.","A disagreement about {{topic}} tests the relationship but offers growth.","A special event related to {{topic}} creates an opportunity for a meaningful moment."],modern:["Breaking news about {{topic}} interrupts the conversation.","A social media post about {{topic}} goes viral, affecting everyone present.","A chance encounter with someone connected to {{topic}} changes perspectives."]},c=l[s]||l.adventure;if(o.forEach(d=>{const g=c[Math.floor(Math.random()*c.length)].replace("{{topic}}",d);i.push(g)}),a==="conflict"&&r==="tense"){const d=o[0];i.push(`A confrontation about ${d} can no longer be avoided.`)}else if(a==="climax"){const d=o[0];i.push(`The truth about ${d} is finally revealed, changing everything.`)}return i}generateRelationshipBranches(t,s,a){if(!t||Object.keys(t).length===0)return[];const r=[],i=Object.values(t).filter(d=>Math.abs(d.affinity)>5);if(i.length===0)return[];const o=i[Math.floor(Math.random()*i.length)],[l,c]=o.characters;return o.affinity>5?(r.push(`${l} and ${c}'s strong bond is tested when a secret from the past emerges.`),s==="adventure"||s==="fantasy"?r.push(`${l} must make a difficult choice that could save ${c} but at great personal cost.`):s==="romance"&&r.push(`A moment of vulnerability between ${l} and ${c} deepens their connection.`)):o.affinity<-5&&(r.push(`The tension between ${l} and ${c} reaches a breaking point, forcing a confrontation.`),(a==="conflict"||a==="climax")&&r.push(`${l} and ${c} must set aside their differences to face a common threat.`)),r}fillTemplates(t,s){return t.map(a=>{if(a.includes("{{topic}}")&&s.length>0){const r=s[Math.floor(Math.random()*s.length)];return a.replace("{{topic}}",r)}return a})}shuffleArray(t){const s=[...t];for(let a=s.length-1;a>0;a--){const r=Math.floor(Math.random()*(a+1));[s[a],s[r]]=[s[r],s[a]]}return s}getAdventureBranchTemplates(){return["A sudden storm forces the group to seek shelter in a mysterious structure.","Tracks are discovered leading to what appears to be a hidden encampment.","A wounded traveler stumbles into view, desperately seeking help.","The sound of distant drums echoes through the area, growing steadily louder.","A valuable item goes missing, with signs pointing to theft rather than loss.","A local guide offers to show a shortcut, but something about their manner seems off.","An old map is discovered with markings that correspond to the current location.","Strange lights appear in the distance, moving in patterns that seem deliberate.","A bridge that should provide safe passage appears damaged and unstable.","Wildlife in the area begins behaving strangely, as if fleeing from something unseen."]}getMysteryBranchTemplates(){return["A previously overlooked clue is discovered, changing the understanding of the case.","A witness comes forward with new information that contradicts earlier testimony.","A suspect's alibi suddenly falls apart when new evidence emerges.","A mysterious phone call provides cryptic information about the case.","Someone attempts to destroy evidence, suggesting they have something to hide.","A seemingly unrelated event is revealed to be connected to the main mystery.","An expert analysis reveals something unexpected about a key piece of evidence.","A person of interest suddenly changes their behavior in a suspicious way.","Access is gained to a location that was previously off-limits.","A pattern emerges when comparing multiple witness accounts that was missed before."]}getFantasyBranchTemplates(){return["A magical portal opens unexpectedly, offering passage to an unknown realm.","An ancient prophecy is recalled that seems to describe the current situation.","A mythical creature appears, either as a guide or a challenge to overcome.","A character discovers latent magical abilities triggered by the current circumstances.","A magical item changes properties, revealing new powers or purposes.","The laws of magic suddenly shift in the area, causing unpredictable effects.","A vision reveals glimpses of possible futures, one of which appears particularly dire.","A magical curse or blessing is activated by recent actions.","An ancient guardian awakens, demanding that ancient traditions be respected.","The boundary between the mortal world and a magical realm grows thin."]}getSciFiBranchTemplates(){return["A system malfunction reveals hidden data that changes the mission parameters.","Unusual energy readings are detected, suggesting advanced technology nearby.","A distress signal is received from a location that should be uninhabited.","The AI system begins making decisions that weren't part of its programming.","A temporal anomaly causes disorienting effects on perception and memory.","Contact is established with an entity that challenges current understanding.","A piece of technology begins adapting itself in ways that weren't designed.","Scans reveal that what appeared to be natural is actually artificial.","A security breach exposes vulnerabilities that were thought to be impossible.","A previously unknown faction reveals itself, with unclear intentions."]}getHorrorBranchTemplates(){return["Strange noises begin emanating from a location everyone had assumed was empty.","Personal items are found arranged in a disturbing pattern with no explanation.","Someone reports seeing a figure that shouldn't be possible in this location.","Electronic devices begin malfunctioning in ways that create unease.","A door that was definitely locked is found standing open.","Inexplicable cold spots develop in specific areas, defying normal temperature patterns.","Writing appears on a surface that no one has approached.","A character experiences lost time, unable to account for their actions during a period.","Something that was dead shows signs of life or movement.","A character begins behaving in a way that suggests they are no longer themselves."]}getRomanceBranchTemplates(){return["A misunderstanding leads to hurt feelings that need to be addressed.","An unexpected gesture reveals deeper feelings than previously expressed.","A mutual friend shares insights that cast the relationship in a new light.","A moment of crisis reveals true priorities and feelings.","A chance encounter with someone from the past stirs up complicated emotions.","An opportunity arises that would separate the characters geographically.","A shared experience creates a powerful bonding moment.","Cultural or family expectations create pressure on the relationship.","A secret is revealed that tests trust between the characters.","A moment of vulnerability allows for deeper emotional connection."]}getModernBranchTemplates(){return["Breaking news interrupts with information relevant to the current situation.","A social media post goes viral, affecting the reputation of someone present.","An unexpected job offer creates both opportunity and difficult choices.","A health concern emerges that requires immediate attention.","A legal issue arises that threatens plans or stability.","A technological breakthrough changes the landscape of possibilities.","Economic factors shift, creating new pressures or opportunities.","A political development has personal implications for those involved.","Environmental conditions create unexpected challenges.","A community crisis requires a response from those present."]}getIntroductionTemplates(){return["Someone new arrives, bringing fresh perspective and information.","A challenge is presented that will require cooperation to overcome.","An invitation arrives to an event that promises to be significant.","A discovery reveals that there is more to the situation than initially apparent.","A minor incident hints at larger issues beneath the surface."]}getRisingActionTemplates(){return["Tensions increase as competing interests become more apparent.","A deadline is imposed, creating pressure to act quickly.","A small success reveals a path forward, but with greater challenges ahead.","An ally reveals unexpected skills or knowledge that could be crucial.","A warning is received about dangers that lie ahead."]}getConflictTemplates(){return["A confrontation can no longer be avoided, forcing difficult choices.","Betrayal is revealed, casting doubt on who can be trusted.","Resources become scarce, creating competition where there was cooperation.","A mistake has serious consequences that must be addressed.","External forces intervene, complicating an already difficult situation."]}getClimaxTemplates(){return["The moment of truth arrives, requiring courage and decisive action.","All the pieces fall into place, revealing the full picture at last.","A sacrifice becomes necessary to achieve the greater goal.","The true villain is revealed, changing understanding of past events.","A final test challenges the core values and abilities of those involved."]}getResolutionTemplates(){return["An opportunity for reconciliation presents itself after the conflict.","The aftermath of recent events requires healing and rebuilding.","Recognition or rewards are offered for actions taken.","A new normal begins to establish itself, incorporating recent changes.","Seeds of future challenges appear even as current ones are resolved."]}getTenseTemplates(){return["The air feels electric with unspoken tension as a critical moment approaches.","Time seems to slow as a decision point with significant consequences arrives.","Nerves fray as pressure mounts to resolve the situation quickly.","The weight of responsibility creates a palpable heaviness in the atmosphere."]}getExcitedTemplates(){return["An unexpected opportunity creates a surge of hopeful energy.","A breakthrough moment generates enthusiasm and renewed determination.","Success seems within reach, inspiring bold and creative approaches.","The thrill of discovery energizes everyone involved."]}getSadTemplates(){return["A moment of reflection reveals the cost of recent events.","Loss creates a space for meaningful connection through shared grief.","Memories resurface, bringing both comfort and pain.","What might have been contrasts sharply with current reality."]}getHappyTemplates(){return["A celebration brings people together in a moment of joy.","Good fortune arrives unexpectedly, lifting spirits.","A perfect moment of peace offers respite from ongoing challenges.","Shared laughter creates bonds that strengthen the group."]}getAngryTemplates(){return["Righteous fury provides the strength needed to confront injustice.","Frustration boils over, forcing issues that have been simmering to the surface.","A provocation tests self-control and strategic thinking.","The desire for retribution clouds judgment at a critical moment."]}getFearfulTemplates(){return["Shadows seem to move in ways that defy explanation, raising alarm.","A primal instinct warns of danger before it becomes visible.","What was once familiar becomes threatening as circumstances change.","The unknown looms large, feeding imagination with worst-case scenarios."]}getNeutralTemplates(){return["A change in circumstances requires adaptation and reassessment.","New information becomes available that could inform next steps.","A moment of calm provides space for thoughtful consideration.","Different perspectives on the situation emerge, each with merit."]}}class ry{constructor(t="adventure"){this.scenarioType=t,this.branchGenerator=new ay,this.lastBranchTime=0,this.messageCountSinceLastBranch=0,this.minMessagesBetweenBranches=8,this.maxMessagesBetweenBranches=12,this.branchHistory=[],this.characterRelationships={},this.narrativePhase="introduction",this.emotionalTone="neutral",this.narrativeThemes=[]}setScenarioType(t){this.scenarioType=t}setCharacterRelationships(t){this.characterRelationships=t}shouldSuggestBranch(t){if(!t||t.length===0)return!1;if(this.messageCountSinceLastBranch<this.minMessagesBetweenBranches)return this.messageCountSinceLastBranch++,!1;if(this.messageCountSinceLastBranch>=this.maxMessagesBetweenBranches)return!0;const s=(this.messageCountSinceLastBranch-this.minMessagesBetweenBranches)/(this.maxMessagesBetweenBranches-this.minMessagesBetweenBranches);return Math.random()<s}generateBranchOptions(t,s){this.messageCountSinceLastBranch=0,this.lastBranchTime=Date.now();const a=t.slice(-10),r=Zg(a);this.emotionalTone=this.analyzeEmotionalTone(a),this.updateNarrativePhase(t);const i=this.branchGenerator.generateBranches(this.scenarioType,r,this.emotionalTone,this.narrativePhase,this.characterRelationships,this.branchHistory);return this.branchHistory=[...this.branchHistory,...i].slice(-10),i}analyzeEmotionalTone(t){if(!t||t.length===0)return"neutral";const s={tense:0,excited:0,sad:0,happy:0,angry:0,fearful:0,neutral:0},a={tense:["worried","anxious","nervous","tense","stress","uneasy","concerned"],excited:["excited","thrilled","eager","enthusiastic","amazed","wow","incredible"],sad:["sad","sorry","unfortunate","regret","miss","loss","disappointed"],happy:["happy","glad","pleased","joy","delighted","wonderful","great"],angry:["angry","furious","annoyed","irritated","mad","rage","hate"],fearful:["afraid","scared","terrified","fear","dread","horror","panic"]};t.forEach(o=>{if(!o.message)return;const l=o.message.toLowerCase();let c=!1;Object.entries(a).forEach(([d,u])=>{u.some(g=>l.includes(g))&&(s[d]++,c=!0)}),c||s.neutral++});let r="neutral",i=0;return Object.entries(s).forEach(([o,l])=>{l>i&&(i=l,r=o)}),r}updateNarrativePhase(t){if(!t)return;const s=t.length;s<10?this.narrativePhase="introduction":s<25?this.narrativePhase="rising_action":s<40?this.narrativePhase="conflict":s<60?this.narrativePhase="climax":this.narrativePhase="resolution",this.emotionalTone==="tense"||this.emotionalTone==="angry"?this.narrativePhase==="rising_action"&&(this.narrativePhase="conflict"):(this.emotionalTone==="happy"||this.emotionalTone==="excited")&&this.narrativePhase==="conflict"&&Math.random()<.3&&(this.narrativePhase="rising_action")}recordBranchSelection(t){this.branchHistory.push(t),this.branchHistory=this.branchHistory.slice(-10)}}class iy{constructor(){this.relationships={},this.relationshipHistory={},this.interactionCounts={}}initializeRelationship(t,s,a={}){const r=this.getRelationshipKey(t,s);if(this.relationships[r])return;const i={affinity:0,trust:0,tension:0,familiarity:0,power:0,respect:0,shared_history:0};this.relationships[r]={characters:[t,s],...i,...a,last_updated:new Date().toISOString()},this.relationshipHistory[r]=[{...this.relationships[r],timestamp:new Date().toISOString()}],this.interactionCounts[r]=0}getRelationshipKey(t,s){return[t,s].sort().join("_&_")}getRelationship(t,s){const a=this.getRelationshipKey(t,s);return this.relationships[a]||null}updateRelationship(t,s,a,r="conversation",i=""){const o=this.getRelationshipKey(t,s);this.relationships[o]||this.initializeRelationship(t,s);const l=this.relationships[o],c={...l,...Object.entries(a).reduce((d,[u,g])=>(u in l&&(u==="affinity"||u==="trust"||u==="respect"?d[u]=Math.max(-10,Math.min(10,l[u]+g)):u==="tension"||u==="familiarity"||u==="shared_history"?d[u]=Math.max(0,Math.min(10,l[u]+g)):u==="power"&&(d[u]=Math.max(-5,Math.min(5,l[u]+g)))),d),{}),last_updated:new Date().toISOString()};return this.relationships[o]=c,this.relationshipHistory[o].push({...c,interaction_type:r,context:i,timestamp:new Date().toISOString()}),this.interactionCounts[o]=(this.interactionCounts[o]||0)+1,c}getCharacterRelationships(t){return Object.values(this.relationships).filter(s=>s.characters.includes(t))}getRelationshipHistory(t,s){const a=this.getRelationshipKey(t,s);return this.relationshipHistory[a]||[]}getAllRelationships(){return Object.values(this.relationships)}getRelationshipSummary(t,s){const a=this.getRelationship(t,s);if(!a)return null;let r="neutral";const{affinity:i,trust:o,tension:l}=a;i>=7&&o>=7?r="close friends":i>=5&&o>=5?r="friends":i<=-7&&o<=-7?r="enemies":i<=-5&&o<=-5?r="adversaries":i>=5&&o<=-5?r="complicated":i<=-5&&o>=5?r="reluctant allies":i>=3&&o>=3?r="acquaintances":l>=7&&(r="tense");let c="";return i>0&&o>0?c=`${t} and ${s} have a positive relationship with growing trust.`:i<0&&o<0?c=`${t} and ${s} have a strained relationship with significant distrust.`:i>0&&o<0?c=`${t} likes ${s} but doesn't fully trust them.`:i<0&&o>0?c=`${t} doesn't particularly like ${s} but recognizes they can be trusted.`:c=`${t} and ${s} have a neutral relationship.`,{type:r,summary:c,affinity:i,trust:o,tension:l,interactionCount:this.interactionCounts[this.getRelationshipKey(t,s)]||0}}analyzeMessageImpact(t,s,a){if(!t||!s||!a)return{};const r=t.toLowerCase(),i={affinity:0,trust:0,tension:0,familiarity:.1};return(r.includes("thank")||r.includes("appreciate")||r.includes("agree")||r.includes("good idea")||r.includes("help")||r.includes("friend"))&&(i.affinity+=.5,i.trust+=.3,i.tension-=.2),(r.includes("disagree")||r.includes("wrong")||r.includes("bad idea")||r.includes("mistake")||r.includes("fool")||r.includes("stupid"))&&(i.affinity-=.5,i.tension+=.5),(r.includes("trust")||r.includes("rely")||r.includes("count on")||r.includes("believe you"))&&(i.trust+=.7),(r.includes("lie")||r.includes("deceive")||r.includes("betray")||r.includes("doubt"))&&(i.trust-=.7,i.tension+=.5),(r.includes("fight")||r.includes("attack")||r.includes("threat")||r.includes("enemy")||r.includes("hate"))&&(i.tension+=1,i.affinity-=.5),(r.includes("sorry")||r.includes("apologize")||r.includes("forgive")||r.includes("understand"))&&(i.tension-=.8,i.affinity+=.3,i.trust+=.3),i}}class oy{constructor(t){this.relationshipMatrix=t,this.conversationMemory=[],this.maxMemorySize=50,this.lastAnalysisTime=null,this.analysisInterval=5,this.messagesSinceLastAnalysis=0}processMessage(t,s){return!t||!t.sender||!s||s.length<2?null:(this.addToConversationMemory(t),this.messagesSinceLastAnalysis++,this.messagesSinceLastAnalysis>=this.analysisInterval?this.analyzeConversation(s):null)}addToConversationMemory(t){this.conversationMemory.push({...t,timestamp:t.timestamp||new Date().toISOString()}),this.conversationMemory.length>this.maxMemorySize&&(this.conversationMemory=this.conversationMemory.slice(this.conversationMemory.length-this.maxMemorySize))}analyzeConversation(t){this.messagesSinceLastAnalysis=0,this.lastAnalysisTime=new Date().toISOString();const s=this.conversationMemory.slice(-this.analysisInterval),a=new Set;return s.forEach(r=>{if(!r.sender||r.system)return;const i=t.find(o=>o.name===r.sender);if(i)if(r.recipient){const o=t.find(l=>l.name===r.recipient);if(o){a.add(this.getPairKey(i.name,o.name));const l=this.relationshipMatrix.analyzeMessageImpact(r.message,i.name,o.name);this.relationshipMatrix.updateRelationship(i.name,o.name,l,"direct_message",r.message.substring(0,50)+"...")}}else t.forEach(o=>{if(o.name!==i.name&&r.message.toLowerCase().includes(o.name.toLowerCase())){a.add(this.getPairKey(i.name,o.name));const l=this.relationshipMatrix.analyzeMessageImpact(r.message,i.name,o.name),c={};Object.entries(l).forEach(([d,u])=>{c[d]=u*.7}),this.relationshipMatrix.updateRelationship(i.name,o.name,c,"mention",r.message.substring(0,50)+"...")}})}),this.analyzeConversationPatterns(s,t,a),this.relationshipMatrix.getAllRelationships()}analyzeConversationPatterns(t,s,a){const r={};t.forEach(i=>{i.sender&&!i.system&&(r[i.sender]=(r[i.sender]||0)+1)});for(let i=0;i<s.length;i++)for(let o=i+1;o<s.length;o++){const l=s[i].name,c=s[o].name,d=this.getPairKey(l,c);if(a.has(d))continue;this.relationshipMatrix.getRelationship(l,c)||this.relationshipMatrix.initializeRelationship(l,c),this.relationshipMatrix.updateRelationship(l,c,{familiarity:.05},"shared_conversation","Present in the same conversation"),this.analyzeConversationDynamics(l,c,t,r)}}analyzeConversationDynamics(t,s,a,r){let i=0,o=0;for(let u=1;u<a.length;u++){const g=a[u-1],h=a[u];!g.sender||!h.sender||g.sender!==t||h.sender!==s||(this.indicatesAgreement(h.message,g.message)&&i++,this.indicatesDisagreement(h.message,g.message)&&o++)}if(i>0||o>0){const u={affinity:(i-o)*.2,tension:o*.3-i*.1};this.relationshipMatrix.updateRelationship(t,s,u,"conversation_dynamics",`Agreement patterns: ${i} agreements, ${o} disagreements`)}const l=r[t]||0,c=r[s]||0,d=l+c;if(d>0){const u=(l-c)/d;if(Math.abs(u)>.3){const g={power:u*.5};this.relationshipMatrix.updateRelationship(t,s,g,"conversation_dominance",`Conversation dominance: ${t} spoke ${l} times, ${s} spoke ${c} times`)}}}indicatesAgreement(t,s){if(!t||!s)return!1;const a=t.toLowerCase();return a.includes("agree")||a.includes("good point")||a.includes("you're right")||a.includes("you are right")||a.includes("exactly")||a.includes("precisely")||a.includes("i think so too")||a.includes("that's true")||a.includes("that is true")}indicatesDisagreement(t,s){if(!t||!s)return!1;const a=t.toLowerCase();return a.includes("disagree")||a.includes("not true")||a.includes("i don't think so")||a.includes("you're wrong")||a.includes("you are wrong")||a.includes("that's incorrect")||a.includes("that is incorrect")||a.includes("i don't agree")||a.includes("actually, no")}getPairKey(t,s){return[t,s].sort().join("_&_")}getRelationshipSuggestions(t){if(!t||t.length<2)return[];const s=[];for(let a=0;a<t.length;a++)for(let r=a+1;r<t.length;r++){const i=t[a].name,o=t[r].name,l=this.relationshipMatrix.getRelationship(i,o);if(!l)continue;const{affinity:c,trust:d,tension:u}=l;if(Math.abs(c)>=7||Math.abs(d)>=7||u>=7){const g=this.relationshipMatrix.getRelationshipSummary(i,o);s.push({type:"relationship_state",characters:[i,o],suggestion:g.summary,priority:Math.max(Math.abs(c),Math.abs(d),u)/10})}u>=6&&s.push({type:"tension",characters:[i,o],suggestion:`The tension between ${i} and ${o} is palpable, affecting everyone in the room.`,priority:u/10}),d>=8?s.push({type:"trust",characters:[i,o],suggestion:`${i} and ${o} share a look of mutual understanding, their trust in each other evident.`,priority:d/10}):d<=-8&&s.push({type:"distrust",characters:[i,o],suggestion:`${i} watches ${o}'s every move with suspicion, clearly distrusting their motives.`,priority:Math.abs(d)/10})}return s.sort((a,r)=>r.priority-a.priority).slice(0,3)}}class ly{constructor(){this.keywordPatterns={personal:[/my name is ([A-Za-z\s]+)/i,/I am ([A-Za-z\s]+)/i,/I'm ([A-Za-z\s]+)/i,/call me ([A-Za-z\s]+)/i,/I work as a ([A-Za-z\s]+)/i,/I'm from ([A-Za-z\s]+)/i,/I live in ([A-Za-z\s]+)/i,/I was born in ([A-Za-z\s]+)/i],preferences:[/I like ([A-Za-z\s]+)/i,/I love ([A-Za-z\s]+)/i,/I enjoy ([A-Za-z\s]+)/i,/I prefer ([A-Za-z\s]+)/i,/my favorite ([A-Za-z\s]+) is ([A-Za-z\s]+)/i,/I don't like ([A-Za-z\s]+)/i,/I hate ([A-Za-z\s]+)/i,/I can't stand ([A-Za-z\s]+)/i],relationships:[/my (friend|brother|sister|mother|father|partner|wife|husband|boyfriend|girlfriend|son|daughter) ([A-Za-z\s]+)/i,/([A-Za-z\s]+) is my (friend|brother|sister|mother|father|partner|wife|husband|boyfriend|girlfriend|son|daughter)/i],events:[/I (went|visited|traveled) to ([A-Za-z\s]+)/i,/I (did|made|created|built|wrote) ([A-Za-z\s]+)/i,/I (will|plan to|want to|hope to) ([A-Za-z\s]+)/i,/yesterday I ([A-Za-z\s]+)/i,/last (week|month|year) I ([A-Za-z\s]+)/i,/tomorrow I (will|plan to) ([A-Za-z\s]+)/i],feelings:[/I feel ([A-Za-z\s]+)/i,/I am feeling ([A-Za-z\s]+)/i,/I'm feeling ([A-Za-z\s]+)/i,/makes me feel ([A-Za-z\s]+)/i,/I was ([A-Za-z\s]+) when/i],beliefs:[/I believe ([A-Za-z\s]+)/i,/I think that ([A-Za-z\s]+)/i,/in my opinion ([A-Za-z\s]+)/i,/I'm convinced that ([A-Za-z\s]+)/i]},this.importantKeywords=["remember","important","forget","key","critical","essential","vital","crucial","significant","major","primary","central","fundamental","necessary","imperative","urgent","priority","secret","confidential","private","personal","sensitive"]}extractMemories(t,s){if(!t||!t.message||typeof t.message!="string")return[];const a=t.message,r=[];if(this.keywordPatterns){for(const[o,l]of Object.entries(this.keywordPatterns))if(l&&Array.isArray(l))for(const c of l){const d=a.match(c);if(d&&d.length>1){const u={id:`memory_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,type:o,content:d[0],speaker:s,timestamp:t.timestamp||new Date().toISOString(),importance:this.calculateImportance(a,o),extracted:!0};r.push(u)}}}const i=a.split(/[.!?]+/).filter(o=>o.trim().length>0);for(const o of i)if(this.containsImportantKeyword(o)){const l={id:`memory_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,type:"important",content:o.trim(),speaker:s,timestamp:t.timestamp||new Date().toISOString(),importance:this.calculateImportance(o,"important"),extracted:!0};r.push(l)}return r}containsImportantKeyword(t){const s=t.toLowerCase();return this.importantKeywords.some(a=>s.includes(a))}calculateImportance(t,s){let a=5;s==="important"?a+=2:(s==="personal"||s==="relationships")&&(a+=1);const r=t.toLowerCase(),i=this.importantKeywords.filter(o=>r.includes(o)).length;return a+=Math.min(3,i),t.match(/[A-Z]{2,}/)&&(a+=1),t.includes("!")&&(a+=1),Math.max(1,Math.min(10,a))}extractEntities(t){const s={people:[],places:[],things:[]},a=t.match(/\b[A-Z][a-z]+ [A-Z][a-z]+\b/g);a&&(s.people=[...new Set(a)]);const r=t.match(/\b(in|at|to|from) ([A-Z][a-zA-Z\s]+)\b/g);r&&(s.places=r.map(o=>o.split(" ").slice(1).join(" ")),s.places=[...new Set(s.places)]);const i=t.match(/\b(the|a|an) ([a-zA-Z\s]+)\b/g);return i&&(s.things=i.map(o=>o.split(" ").slice(1).join(" ")),s.things=[...new Set(s.things)]),s}createSummaryMemory(t){if(!t||t.length<3)return null;const s=[...new Set(t.filter(h=>h.speaker).map(h=>h.speaker))],r=t.filter(h=>h.message&&typeof h.message=="string").map(h=>h.message).join(" ").toLowerCase().split(/\W+/),i=["the","and","a","an","in","on","at","to","for","of","with","is","are","was","were","be","been","being","have","has","had","do","does","did","but","or","as","if","then","else","when","up","down","in","out","no","yes","so","this","that","these","those","my","your","his","her","its","our","their","i","you","he","she","it","we","they"],o={};r.forEach(h=>{h.length>3&&!i.includes(h)&&(o[h]=(o[h]||0)+1)});const l=o&&Object.keys(o).length>0?Object.entries(o).sort((h,p)=>p[1]-h[1]).slice(0,5).map(h=>h[0]):[],c=new Date(t[0].timestamp||Date.now()),d=new Date(t[t.length-1].timestamp||Date.now());let u=`Conversation between ${s.join(" and ")} `;l.length>0&&(u+=`about ${l.join(", ")}. `);const g=Math.round((d-c)/6e4);return g>0&&(u+=`Lasted about ${g} minute${g!==1?"s":""}.`),{id:`summary_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,type:"summary",content:u,speakers:s,topics:l,timestamp:d.toISOString(),importance:4,messageCount:t.length,extracted:!0}}}class cy{constructor(t={}){this.memories=[],this.extractor=new ly,this.maxMemories=t.maxMemories||100,this.recentMessageCount=t.recentMessageCount||10,this.summaryInterval=t.summaryInterval||20,this.lastSummaryIndex=0,this.storageKey=t.storageKey||"velora-memories",this.loadFromStorage()}processMessage(t,s=[]){if(!t||!t.message)return[];const a=t.speaker||"Unknown",r=this.extractor.extractMemories(t,a);if(r.forEach(i=>this.addMemory(i)),s.length>=this.summaryInterval&&s.length-this.lastSummaryIndex>=this.summaryInterval){const i=s.slice(Math.max(0,s.length-this.summaryInterval)),o=this.extractor.createSummaryMemory(i);o&&(this.addMemory(o),this.lastSummaryIndex=s.length)}return this.saveToStorage(),r}addMemory(t){if(!t||!t.content)return;this.memories.some(a=>a.content===t.content||a.content.length>10&&t.content.includes(a.content)||t.content.length>10&&a.content.includes(t.content))||(this.memories.push({...t,lastAccessed:new Date().toISOString(),accessCount:0}),this.memories.sort((a,r)=>r.importance!==a.importance?r.importance-a.importance:new Date(r.timestamp)-new Date(a.timestamp)),this.memories.length>this.maxMemories&&(this.memories=this.memories.slice(0,this.maxMemories)))}retrieveMemories(t,s={}){if(!t||!this.memories.length)return[];const{limit:a=5,minImportance:r=0,speakerFilter:i=null,typeFilter:o=null,recencyWeight:l=.3,importanceWeight:c=.7}=s,u=this.memories.filter(g=>(r===0||g.importance>=r)&&(i===null||g.speaker===i)&&(o===null||g.type===o)).map(g=>{const h=this.calculateRelevance(g,t),p=(new Date-new Date(g.timestamp))/(1e3*60*60*24),f=Math.max(0,1-p/30),y=g.importance/10,N=h*.5+f*l+y*c;return{...g,score:N}}).sort((g,h)=>h.score-g.score).slice(0,a);return u.forEach(g=>{const h=this.memories.findIndex(p=>p.id===g.id);h!==-1&&(this.memories[h].lastAccessed=new Date().toISOString(),this.memories[h].accessCount=(this.memories[h].accessCount||0)+1)}),this.saveToStorage(),u}calculateRelevance(t,s){if(!t||!t.content||!s)return 0;const a=t.content.toLowerCase(),r=s.toLowerCase(),i=new Set(a.split(/\W+/).filter(h=>h.length>3)),o=new Set(r.split(/\W+/).filter(h=>h.length>3));let l=0;for(const h of i)o.has(h)&&l++;const c=new Set([...i,...o]),d=l/c.size,u=r.split(/[.!?]+/).filter(h=>h.trim().length>0);let g=0;for(const h of u)if(h.length>10&&a.includes(h)){g=.8;break}return Math.max(d,g)}createMemory(t,s="User",a="manual",r=8){if(!t)return null;const i={id:`memory_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,type:a,content:t,speaker:s,timestamp:new Date().toISOString(),importance:r,extracted:!1};return this.addMemory(i),this.saveToStorage(),i}deleteMemory(t){const s=this.memories.length;this.memories=this.memories.filter(r=>r.id!==t);const a=s>this.memories.length;return a&&this.saveToStorage(),a}updateMemoryImportance(t,s){const a=this.memories.findIndex(r=>r.id===t);return a!==-1?(this.memories[a].importance=Math.max(1,Math.min(10,s)),this.saveToStorage(),!0):!1}getAllMemories(t={}){const{speakerFilter:s=null,typeFilter:a=null,sortBy:r="importance",limit:i=0}=t;let o=[...this.memories];return s&&(o=o.filter(l=>l.speaker===s)),a&&(o=o.filter(l=>l.type===a)),r==="recency"?o.sort((l,c)=>new Date(c.timestamp)-new Date(l.timestamp)):r==="access"?o.sort((l,c)=>(c.accessCount||0)-(l.accessCount||0)):o.sort((l,c)=>c.importance-l.importance),i>0&&(o=o.slice(0,i)),o}saveToStorage(){try{localStorage.setItem(this.storageKey,JSON.stringify(this.memories))}catch(t){console.error("Failed to save memories to storage:",t)}}loadFromStorage(){try{const t=localStorage.getItem(this.storageKey);t&&(this.memories=JSON.parse(t))}catch(t){console.error("Failed to load memories from storage:",t),this.memories=[]}}clearMemories(){this.memories=[],this.saveToStorage()}exportMemories(){return JSON.stringify(this.memories)}importMemories(t){try{const s=JSON.parse(t);return Array.isArray(s)?(this.memories=s,this.saveToStorage(),!0):!1}catch(s){return console.error("Failed to import memories:",s),!1}}}const dy=(e,t,s)=>{if(!e||e.length===0)return null;const a=e.filter(d=>d.name!==s);if(a.length===0)return null;if(a.length===1)return a[0];if(t&&t.message){const d=t.message.toLowerCase(),u=a.filter(g=>d.includes(g.name.toLowerCase()));if(u.length>0)return u[Math.floor(Math.random()*u.length)]}const r=a.filter(d=>d.mood==="Intense");if(r.length>0&&Math.random()<.7)return r[Math.floor(Math.random()*r.length)];const i=[...a].sort((d,u)=>{const g=d.talkativeness||5;return(u.talkativeness||5)-g}),o=i.reduce((d,u)=>d+(u.talkativeness||5),0);let l=Math.random()*o,c=0;for(const d of i)if(c+=d.talkativeness||5,l<=c)return d;return i[0]},Rt={sensoryDescriptions:{fantasy:{sight:["The flickering torchlight casts long shadows","Moonlight filters through ancient stained glass","A golden glow emanates from the magical artifact"],sound:["The clang of steel echoes through the hall","Distant chanting fills the air with arcane energy","The crackle of magical energy hums in your ears"],smell:["The scent of old parchment and candle wax","A metallic tang of blood in the air","The sweet aroma of healing herbs"],touch:["The rough texture of stone walls","The smooth coolness of a marble floor","The prickling sensation of magical energy"],taste:["The bitterness of a healing potion","The sweetness of faerie wine","The saltiness of sweat on your lips"]},superhero:{sight:["Neon lights reflect off rain-slicked streets as heroes take position","A streak of red and gold as Iron Man rockets overhead","The ominous blue glow of alien energy weapons illuminating the smoke","Captain America's shield ricocheting between multiple targets with impossible precision","Lightning arcing from Mjolnir to strike clustered enemies with devastating effect","Hulk's massive green form leaping impossible distances between buildings","Black Widow's Widow's Bite crackling with blue electricity as she strikes","Hawkeye's specialized arrows finding their marks with unerring accuracy","Civilians watching from windows as their heroes fight to protect them","The distinctive red, white, and blue of the Captain's shield becoming a rallying point","Shattered glass raining down from damaged skyscrapers, catching the light","The Quinjet hovering above, providing tactical support and surveillance"],sound:["Sirens wail in the distance as emergency services respond to the crisis","The whoosh of Thor's hammer cutting through the air","The crackle of repulsor technology firing in rapid succession","Hulk's earth-shaking roar echoing between Manhattan skyscrapers","The distinctive ping of vibranium deflecting enemy fire","The twang of Hawkeye's bowstring releasing arrow after arrow","Civilians cheering as the Avengers gain the upper hand","The tactical chatter of the team coordinating through comm systems","The thunderous boom as Thor summons lightning from storm clouds","The whine of Iron Man's boot jets as he maneuvers through the battlefield","The crunch of concrete as Hulk lands from a massive leap","The staccato rhythm of Black Widow's weapons finding their targets"],smell:["Ozone from discharged energy weapons and Thor's lightning","The acrid scent of burning metal and concrete dust","The distinctive smell of Iron Man's armor heating up during combat","Smoke from damaged buildings filling the air with a choking haze","The chemical tang of alien technology unlike anything on Earth","The scent of rain beginning to fall on hot battlefield debris","Fuel leaking from damaged vehicles creating a hazardous atmosphere","The clean, sharp smell that follows Thor's lightning strikes","The metallic tang of blood from minor injuries sustained in battle","The smell of fire as emergency services work to contain the damage","The distinctive scent of the Hudson River mixing with the chaos","The smell of hot metal as Captain America's shield returns to his grip"],touch:["The vibration of Hulk's impact trembling through the ground beneath your feet","The sting of concrete dust and debris against exposed skin","The pressure wave from nearby explosions pushing against your body","The heat radiating from recently discharged energy weapons","The cool metal of tactical equipment gripped tightly in tense hands","The static electricity raising the hair on your arms after Thor's lightning","The rough texture of broken concrete and twisted metal all around","The slick wetness of rain beginning to fall on the battlefield","The firm grip of a hero pulling you to safety from danger","The sharp contrast between hot and cold areas of the battlefield","The weight of responsibility as civilians look to you for protection","The reassuring solidity of a defensive position amid the chaos"],taste:["The coppery tang of blood from a split lip sustained in combat","The chalky dust of pulverized concrete coating your mouth and throat","The metallic flavor that accompanies fear and adrenaline","The bitter taste of smoke from burning buildings and vehicles","The artificial sweetness of energy drinks consumed during brief respites","The distinctive taste of the air after Thor's lightning strikes nearby","The dryness in your mouth as you catch your breath between engagements","The chemical aftertaste of emergency oxygen systems and smoke filters","The saltiness of sweat dripping down your face during intense combat","The taste of determination as you push through exhaustion to continue","The refreshing coolness of water hastily consumed during a tactical pause","The taste of victory as the tide of battle finally turns in your favor"]},noir:{sight:["The flicker of a streetlamp through venetian blinds","Cigarette smoke curling in a dim office","The glint of a revolver in a desk drawer"],sound:["The click of heels on wet pavement","The scratch of a phonograph needle","The muffled conversation from the next booth"],smell:["Cheap whiskey and cheaper perfume","The musty scent of old case files","Gunpowder residue on a suspect hands"],touch:["The weight of a fedora pulled low","The slick handle of a getaway car","The rough texture of a suspect stubble"],taste:["The bitterness of black coffee","The metallic aftertaste of fear","The sweetness of a lipstick mark"]}},narrationTemplates:{fantasy:{opening:["The ancient prophecy foretold this moment","Legends speak of a hero like you","The kingdom fate hangs in the balance"],rising:["Dark forces gather at the borders","The artifact pulses with forbidden power","Your companions look to you for guidance"],climax:["The final battle begins with a thunderous roar","Magic crackles in the air as spells collide","The villain reveals their true form"],resolution:["The kingdom celebrates its saviors","The wounded land begins to heal","Your legend will be told for generations"]},superhero:{opening:["The city never sleeps, and neither do its protectors as the Avengers assemble","An ominous alert flashes across Stark's systems as alien signatures appear","The streets of New York whisper of a new threat as civilians point to the sky","S.H.I.E.L.D. reports confirm what the team already feared - the invasion has begun","Captain America's shield gleams in the sunlight as he prepares to lead the team","Thor's arrival brings storm clouds gathering over Manhattan, a harbinger of the battle to come","Banner reluctantly acknowledges that this is a job for the Other Guy","Black Widow and Hawkeye exchange knowing glances - they've been through this before"],rising:["The alien invasion plan becomes terrifyingly clear as more portals open","Civilians scramble for safety as the first buildings sustain damage","The Avengers assemble in formation, each ready to deploy their unique abilities","Iron Man's scanners reveal the alien mothership approaching Earth's atmosphere","Captain America coordinates evacuation routes while planning the defensive strategy","Thor summons lightning that illuminates the darkening sky, a show of force","Hulk's roar echoes between skyscrapers as he embraces the coming battle","S.H.I.E.L.D. teams establish a perimeter as the heroes move to engage"],climax:["The New York skyline erupts in explosions as the battle reaches its peak","Superhuman powers clash in a dazzling display against alien technology","The final confrontation begins as the team executes their desperate plan","Iron Man rockets toward the mothership on what might be a one-way journey","Captain America rallies the team with a speech about what they're fighting for","Thor channels unprecedented power, becoming a living conduit for lightning","Hulk targets the largest alien creatures, matching their strength with raw fury","Black Widow and Hawkeye protect civilians while targeting critical enemy systems"],resolution:["The city begins rebuilding as the Avengers help clear the debris","News reporters clamor for statements as the team stands victorious but exhausted","The heroes know this victory is only temporary as they secure alien technology","S.H.I.E.L.D. containment teams arrive to handle the aftermath and study the threat","Captain America checks on his team members, ensuring everyone is accounted for","Iron Man's damaged armor powers down as he joins the team for a well-earned rest","Thor offers Asgardian insights on preventing future incursions from the stars","The team shares a quiet moment together before dispersing, their bond strengthened"]},noir:{opening:["The case file lands on your desk with a thud","A dame with trouble written all over her walks in","The city underbelly stirs with new activity"],rising:["The pieces do not quite fit together","Your gut says there is more to this","Danger lurks in every shadow"],climax:["The truth hits you like a bullet","Betrayal cuts deeper than any knife","The final confrontation in a rain-soaked alley"],resolution:["Justice is served, but at what cost?","The case is closed, but you cannot forget","Another bottle, another unsolved mystery"]}},themes:{fantasy:{tags:["@setting=medieval","@tone=epic","@character_role=hero","@twist_trigger=magic"],components:{locations:["castle","forest","dungeon"],items:["sword","potion","amulet"],events:["quest","prophecy","battle"]}},superhero:{tags:["@setting=modern","@tone=action","@character_role=hero","@twist_trigger=betrayal"],components:{locations:["city","hideout","space"],items:["gadget","armor","artifact"],events:["rescue","fight","heist"]}},noir:{tags:["@setting=1940s","@tone=mystery","@character_role=detective","@twist_trigger=secret"],components:{locations:["office","alley","club"],items:["gun","whiskey","photo"],events:["investigation","ambush","revelation"]}}},characters:{archetypes:{hero:{traits:["brave","determined","selfless"],motivations:["justice","protection","redemption"]},villain:{traits:["ambitious","ruthless","charismatic"],motivations:["power","revenge","destruction"]},mentor:{traits:["wise","patient","mysterious"],motivations:["guidance","balance","prophecy"]}},personalities:{stoic:{emotionalRange:{trust:[0,5],tension:[0,3],humor:[0,2]},voice:"terse, direct"},passionate:{emotionalRange:{trust:[0,10],tension:[0,8],humor:[0,6]},voice:"expressive, dramatic"},quirky:{emotionalRange:{trust:[0,7],tension:[0,5],humor:[3,9]},voice:"playful, unconventional"}}},choiceSystem:{quickActions:{fantasy:["Attack","Cast Spell","Negotiate","Investigate"],superhero:["Engage Enemies","Use Signature Ability","Coordinate Team","Protect Civilians","Target Weak Point","Call for Backup","Deploy Special Weapon","Secure Perimeter"],noir:["Question","Threaten","Bribe","Follow"]},intentClusters:{mapToIntent:(e,t)=>{const s=e.toLowerCase();if(t==="fantasy"){if(s.includes("attack")||s.includes("fight"))return"combat";if(s.includes("cast")||s.includes("magic"))return"magic";if(s.includes("talk")||s.includes("negotiate"))return"diplomacy"}else if(t==="superhero"){if(s.includes("attack")||s.includes("fight")||s.includes("engage")||s.includes("battle"))return"combat";if(s.includes("power")||s.includes("ability")||s.includes("shield")||s.includes("hammer")||s.includes("repulsor")||s.includes("smash")||s.includes("lightning"))return"power-usage";if(s.includes("plan")||s.includes("coordinate")||s.includes("strategy")||s.includes("position")||s.includes("tactical"))return"tactical";if(s.includes("protect")||s.includes("save")||s.includes("civilian")||s.includes("rescue")||s.includes("evacuate"))return"protection";if(s.includes("scan")||s.includes("analyze")||s.includes("weakness")||s.includes("target")||s.includes("intel"))return"analysis"}else if(t==="noir"){if(s.includes("question")||s.includes("interrogate"))return"investigation";if(s.includes("threaten")||s.includes("intimidate"))return"intimidation";if(s.includes("follow")||s.includes("track"))return"surveillance"}return"default"}}}};class uy{constructor(t="fantasy"){this.currentTheme=t,this.activeCharacters={},this.currentPlotlines=[]}getSensoryDescription(t){var a;const s=(a=Rt.sensoryDescriptions[this.currentTheme])==null?void 0:a[t];if(s&&s.length>0){const r=s.filter(i=>{const o=i.includes("!")||i.includes("intense")||i.includes("powerful");return Object.values(this.activeCharacters).some(c=>{var d;return((d=c.emotionalState)==null?void 0:d.tension)>5})?o:!o});return r.length>0?r[Math.floor(Math.random()*r.length)]:s[Math.floor(Math.random()*s.length)]}return""}getNarration(t){var a;const s=(a=Rt.narrationTemplates[this.currentTheme])==null?void 0:a[t];return s&&s.length>0?s[Math.floor(Math.random()*s.length)]:""}generateCharacterAction(t,s){var a;if(!t||!s)return"";if(this.activeCharacters[t]){const r=this.activeCharacters[t];r.archetype;const i=r.personality,o={stoic:["calmly","methodically","deliberately"],passionate:["passionately","dramatically","intensely"],quirky:["playfully","unpredictably","whimsically"]},l=((a=o[i])==null?void 0:a[Math.floor(Math.random()*o[i].length)])||"",c=r.emotionalState;let d="";return(c==null?void 0:c.tension)>5?d="nervously":(c==null?void 0:c.trust)>5?d="confidently":(c==null?void 0:c.humor)>5&&(d="playfully"),[t,l,d,s].filter(Boolean).join(" ").replace(/\s+/g," ").trim()}return`${t} ${s}`}switchTheme(t){return Rt.themes[t]?(this.currentTheme=t,!0):!1}addCharacter(t,s,a){return Rt.characters.archetypes[s]&&Rt.characters.personalities[a]?(this.activeCharacters[t]={archetype:s,personality:a,emotionalState:{trust:0,tension:0,humor:0}},!0):!1}removeCharacter(t){return this.activeCharacters[t]?(delete this.activeCharacters[t],!0):!1}updateCharacterEmotion(t,s,a){if(this.activeCharacters[t]&&["trust","tension","humor"].includes(s)){const r=this.activeCharacters[t].personality,[i,o]=Rt.characters.personalities[r].emotionalRange[s];return this.activeCharacters[t].emotionalState[s]=Math.max(i,Math.min(o,this.activeCharacters[t].emotionalState[s]+a)),!0}return!1}addPlotline(t,s){this.currentPlotlines.push({type:t,config:s,state:"active"})}getQuickActions(){return Rt.choiceSystem.quickActions[this.currentTheme]||[]}interpretInputIntent(t){return Rt.choiceSystem.intentClusters.mapToIntent(t,this.currentTheme)}getActiveTags(){const t=Rt.themes[this.currentTheme].tags||[],s=Object.values(this.activeCharacters).map(a=>`@character=${a.archetype}`);return[...t,...s]}}class hy{constructor(){this.playerState={choices:[],tone:"neutral",preferences:{},alliances:{},inventory:[],moodScore:0,trustLevels:{}},this.storyState={currentBranch:"main",branches:{},worldState:{},characterStates:{},triggeredEvents:[]}}recordChoice(t,s,a){this.playerState.choices.push({id:t,text:s,intent:a,timestamp:Date.now()}),this.updateMood(a)}updateMood(t){const s={help:1,attack:-2,explore:.5,defend:-1,negotiate:.5};this.playerState.moodScore+=s[t]||0,this.playerState.moodScore=Math.max(-10,Math.min(10,this.playerState.moodScore)),this.updateTone()}updateTone(){this.playerState.moodScore>5?this.playerState.tone="positive":this.playerState.moodScore<-5?this.playerState.tone="negative":this.playerState.tone="neutral"}updateTrust(t,s){this.playerState.trustLevels[t]||(this.playerState.trustLevels[t]=0),this.playerState.trustLevels[t]+=s,this.playerState.trustLevels[t]=Math.max(-10,Math.min(10,this.playerState.trustLevels[t]))}addToInventory(t,s){this.playerState.inventory.push({id:t,name:s})}updateWorldState(t,s){this.storyState.worldState[t]=s}updateCharacterState(t,s,a){this.storyState.characterStates[t]||(this.storyState.characterStates[t]={}),this.storyState.characterStates[t][s]=a}recordTriggeredEvent(t){this.storyState.triggeredEvents.push(t)}createBranch(t,s="main"){this.storyState.branches[t]={from:s,state:JSON.parse(JSON.stringify(this.storyState))}}switchBranch(t){this.storyState.branches[t]&&(this.storyState=JSON.parse(JSON.stringify(this.storyState.branches[t].state)),this.storyState.currentBranch=t)}getStateSnapshot(){return{player:JSON.parse(JSON.stringify(this.playerState)),story:JSON.parse(JSON.stringify(this.storyState))}}loadStateSnapshot(t){t.player&&(this.playerState=JSON.parse(JSON.stringify(t.player))),t.story&&(this.storyState=JSON.parse(JSON.stringify(t.story)))}}class my{constructor(){this.turnHistory=[],this.speakingOrder=[],this.lastSpeaker=null,this.currentContext="conversation",this.battleState={inProgress:!1,intensity:0,focusCharacter:null,threatLevel:"low"}}recordTurn(t,s="dialogue",a={}){this.turnHistory.push({character:t,type:s,timestamp:new Date().getTime(),context:a}),this.lastSpeaker=t,this.speakingOrder=this.speakingOrder.filter(r=>r!==t),this.speakingOrder.push(t)}setContext(t,s={}){this.currentContext=t,t.toLowerCase().includes("battle")||t.toLowerCase().includes("fight")||t.toLowerCase().includes("combat")?(this.battleState.inProgress=!0,s.intensity!==void 0&&(this.battleState.intensity=s.intensity),s.focusCharacter&&(this.battleState.focusCharacter=s.focusCharacter),s.threatLevel&&(this.battleState.threatLevel=s.threatLevel)):this.battleState.inProgress=!1}determineNextSpeaker(t,s,a){if(!t||t.length===0)return null;const r=t.filter(u=>u.name!==this.lastSpeaker);if(r.length===0)return t[0];if(r.length===1)return r[0];if(this.battleState.inProgress)return this.determineBattleSpeaker(r,s,a);if(s&&s.message){const u=s.message.toLowerCase(),g=r.filter(h=>u.includes(h.name.toLowerCase()));if(g.length>0)return g[Math.floor(Math.random()*g.length)]}const i=r.filter(u=>u.mood==="Intense");if(i.length>0&&Math.random()<.7)return i[Math.floor(Math.random()*i.length)];if(this.speakingOrder.length>0){const u=r.filter(g=>!this.speakingOrder.slice(-2).includes(g.name));if(u.length>0){const g=[...u].sort((f,y)=>{const N=f.talkativeness||5;return(y.talkativeness||5)-N}),h=Math.floor(g.length/2)||0,p=g.slice(0,h+1);return p[Math.floor(Math.random()*p.length)]}}const o=[...r].sort((u,g)=>{const h=u.talkativeness||5;return(g.talkativeness||5)-h}),l=o.reduce((u,g)=>u+(g.talkativeness||5),0);let c=Math.random()*l,d=0;for(const u of o)if(d+=u.talkativeness||5,c<=d)return u;return o[0]}determineBattleSpeaker(t,s,a){if(this.battleState.focusCharacter){const c=t.find(d=>d.name===this.battleState.focusCharacter);if(c&&Math.random()<.7)return c}if(this.battleState.intensity>=7){const c={Thor:this.battleState.intensity*.9,Hulk:this.battleState.intensity*.85,"Iron Man":7,"Captain America":6.5,"Black Widow":6,Hawkeye:5.5},d=[...t].sort((u,g)=>{var f,y;const h=c[u.name]||((f=u.personality)==null?void 0:f.confidence)||5;return(c[g.name]||((y=g.personality)==null?void 0:y.confidence)||5)-h});if(Math.random()<.7){const u=Math.floor(d.length/2)||0;return d[Math.floor(Math.random()*(u+1))]}}if(s&&s.message){const c=s.message.toLowerCase(),d=t.filter(u=>c.includes(u.name.toLowerCase()));if(d.length>0&&Math.random()<.8)return d[Math.floor(Math.random()*d.length)];if(this.lastSpeaker==="Captain America"&&Math.random()<.75)return t[Math.floor(Math.random()*t.length)]}const r=t.map(c=>{let d=5;return c.name==="Thor"||c.name==="Hulk"?d+=3:(c.name==="Iron Man"||c.name==="Captain America")&&(d+=2),c.personality&&(c.personality.confidence>7&&(d+=1),c.personality.analytical>7&&(d+=1)),{character:c,weight:d}}),i=r.reduce((c,d)=>c+d.weight,0);let o=Math.random()*i,l=0;for(const c of r)if(l+=c.weight,o<=l)return c.character;return t[Math.floor(Math.random()*t.length)]}getBattleState(){return{...this.battleState}}updateBattleState(t){this.battleState={...this.battleState,...t}}getSpeakingHistory(t=5){return this.turnHistory.slice(-t)}reset(){this.turnHistory=[],this.speakingOrder=[],this.lastSpeaker=null,this.currentContext="conversation",this.battleState={inProgress:!1,intensity:0,focusCharacter:null,threatLevel:"low"}}}const py=({mood:e,intensity:t=5,size:s="md",showLabel:a=!1})=>{const[r,i]=j.useState(null),[o,l]=j.useState("text-muted-foreground"),[c,d]=j.useState(e||"Neutral");j.useEffect(()=>{const h=(e||"").toLowerCase();h.includes("happy")||h.includes("joyful")||h.includes("excited")||h.includes("pleased")?(i(n.jsx(Zf,{})),l("text-green-500"),d("Happy")):h.includes("angry")||h.includes("furious")||h.includes("enraged")?(i(n.jsx(ph,{})),l("text-red-500"),d("Angry")):h.includes("sad")||h.includes("depressed")||h.includes("gloomy")?(i(n.jsx(_f,{})),l("text-blue-500"),d("Sad")):h.includes("loving")||h.includes("affectionate")||h.includes("caring")?(i(n.jsx(gl,{})),l("text-pink-500"),d("Loving")):h.includes("neutral")||h.includes("calm")?(i(n.jsx(Gc,{})),l("text-gray-500"),d("Neutral")):h.includes("positive")||h.includes("agreeable")||h.includes("supportive")?(i(n.jsx(eg,{})),l("text-emerald-500"),d("Positive")):h.includes("negative")||h.includes("disagreeable")||h.includes("critical")?(i(n.jsx(Xf,{})),l("text-amber-500"),d("Negative")):h.includes("intense")||h.includes("passionate")||h.includes("energetic")?(i(n.jsx(Xt,{})),l("text-purple-500"),d("Intense")):(i(n.jsx(Gc,{})),l("text-gray-500"),d(e||"Neutral"))},[e]);const u={sm:"h-3 w-3",md:"h-4 w-4",lg:"h-5 w-5"},g={opacity:.5+t/20};return n.jsxs("div",{className:"flex items-center gap-1",style:g,children:[n.jsx("div",{className:`${o} ${u[s]||u.md}`,children:r}),a&&n.jsx("span",{className:`text-xs ${o}`,children:c})]})},fy=({chatRoom:e,chatHistory:t,setChatHistory:s,storyArc:a,setStoryArc:r,onSaveChat:i,onLeaveChat:o,onHowToUse:l})=>{const{theme:c,setTheme:d}=mh(),[u,g]=j.useState(""),[h,p]=j.useState(null),[f,y]=j.useState(!1),[N,m]=j.useState(null),[v,w]=j.useState(!1),[x,k]=j.useState(!1),[I,T]=j.useState(!0),[L,P]=j.useState(""),[D,q]=j.useState(""),[A,S]=j.useState(!1),[M,U]=j.useState(!1),[H,G]=j.useState([]),[b,E]=j.useState(""),[V,ue]=j.useState(!1),[ce,Ze]=j.useState(!1),[ht,tn]=j.useState(!1),[st,At]=j.useState([]),[Cs,nn]=j.useState(null),[Vn,_]=j.useState(!1),[me,sn]=j.useState(""),[Ee,an]=j.useState(!1),[Mh,ka]=j.useState(null),[bl,ja]=j.useState(""),[Na,bt]=j.useState({name:"",description:"",type:"modern",mood:"neutral",avatar:"",opening_line:"",personality:{analytical:5,emotional:5,philosophical:5,humor:5,confidence:5},voiceStyle:"",talkativeness:5,thinkingSpeed:1}),[rn,zt]=j.useState({storyArc:"",writingStyle:"balanced",emojiUsage:"minimal",responseLength:"medium",characterReminders:"",generalNotes:""}),[on,C]=j.useState([]),[ae,F]=j.useState(""),[te,xe]=j.useState(null),[Ht,Th]=j.useState(null),[Is,Dy]=j.useState(new my),[Gr,Ur]=j.useState(!1),[As,Ch]=j.useState(null),[Py,Ih]=j.useState([]),[Ah,Eh]=j.useState(!1),[zy,Lh]=j.useState(null),[Hy,$h]=j.useState(null),[Yn,Vr]=j.useState([]),[By,_y]=j.useState(!1),[Ry,Oy]=j.useState([]),[Fy,Wy]=j.useState(!1),[Dh,Ph]=j.useState(null),[qy,zh]=j.useState([]),[Gy,Uy]=j.useState(!1),[Vy,Hh]=j.useState(""),[Yy,Ky]=j.useState(!1),[Qy,Zy]=j.useState(null),[Jy,Sa]=j.useState({sight:"",sound:"",smell:"",touch:"",taste:""}),[Xy,Bh]=j.useState(0),[Yr,_h]=j.useState("introduction"),[kl,jl]=j.useState([]),[Kr,Rh]=j.useState("new_york"),[Nl,ex]=j.useState({time:"midday",weather:"clear",progression:0}),[Oh,Sl]=j.useState({inProgress:!1,intensity:5,focusCharacter:null,threatLevel:"medium",civilianDanger:3,enemyClusters:[]}),[Ml,tx]=j.useState([]),[nx,Fh]=j.useState([]),[sx,ax]=j.useState(!1),[rx,Tl]=j.useState([]),[ix,Wh]=j.useState([]),[ox,qh]=j.useState({}),[lx,Gh]=j.useState({}),Uh=j.useRef(null),Qr=j.useRef(null),Vh=()=>{const z=xg();Fh(z)};j.useEffect(()=>{var z,B;if(console.log("ChatRoom useEffect - chatRoom changed:",e==null?void 0:e.name),!e){console.error("ChatRoom component received null/undefined chatRoom"),alert("Error: Chat room data is missing. Please try again or contact support."),o();return}if(!e.characters||!Array.isArray(e.characters)){console.error("ChatRoom received invalid characters array:",e.characters),alert("Error: Character data is invalid. Returning to main menu."),o();return}if(console.log(`Chat room initialized with ${e.characters.length} characters:`,e.characters.map(ee=>ee.name).join(", ")),Vh(),e.characters.length>0&&!h&&p(e.characters[0]),e.background&&P(e.background),Wh([]),qh({}),Gh({}),e){const ee=e.characters.map(O=>O.name),K=Ns.filter(O=>!ee.includes(O.name));if(At(K),e.characters.length>1){const O=[];for(let Y=0;Y<e.characters.length;Y++)for(let Z=Y+1;Z<e.characters.length;Z++){const J=e.characters[Y],ie=e.characters[Z],pe=Zc(O,J.name,ie.name);O.push(pe)}Vr(O)}const de=[];e.characters.forEach(O=>{const Y=Xc(de,O.name,O);de.push(Y)}),G(de);const se=e.theme||Yh(e.openingPrompt)||"fantasy",Q=new uy(se);xe(Q),e.characters.forEach(O=>{const Y=Kh(O),Z=Qh(O);Q.addCharacter(O.name,Y,Z)});const Le=new hy;Th(Le);const $e=se==="superhero"?"adventure":se==="noir"?"mystery":se,je=new ry($e);Ch(je);const Te=new iy;Lh(Te);const mt=new oy(Te);$h(mt);try{const O=e.characters;if(O&&O.length>1){for(let Z=0;Z<O.length;Z++)for(let J=Z+1;J<O.length;J++){const ie=(z=O[Z])==null?void 0:z.name,pe=(B=O[J])==null?void 0:B.name;ie&&pe?Te.initializeRelationship(ie,pe):console.warn("Skipping relationship initialization for undefined character names",{char1Index:Z,char2Index:J,char1Name:ie,char2Name:pe})}const Y=Te.getAllRelationships();console.log("Initialized relationships:",Y),Vr(Y)}else console.log("Not enough characters to initialize relationships")}catch(O){console.error("Error initializing relationship matrix:",O)}const at=`velora-memories-${e.name.replace(/\s+/g,"-").toLowerCase()}`,Ce=new cy({maxMemories:200,recentMessageCount:15,summaryInterval:20,storageKey:at});if(Ph(Ce),zh(Ce.getAllMemories()),Yn.length>0&&je.setCharacterRelationships(Yn),Cl(Q),a){_h(a.currentPhase||"introduction"),Bh(Il(a.currentTension||"medium"));const O=Ln(e,t),Y=O?8:Il(a.currentTension||"medium");if(Is.setContext(O?"battle":a.currentPhase||"conversation",{intensity:Y,threatLevel:a.currentTension||"medium"}),e.name&&e.name.includes("Avengers")){console.log("Initializing Avengers battle scenario");try{let J="new_york";if(t&&Array.isArray(t)&&t.length>0){const pe={"times square":"times_square","central park":"central_park","brooklyn bridge":"brooklyn_bridge",manhattan:"new_york",downtown:"new_york"},Ue=t.slice(-10);for(const pt of Ue)if(pt&&pt.message){const ze=pt.message.toLowerCase();for(const[fe,He]of Object.entries(pe))if(ze.includes(fe)){J=He;break}}}console.log("Detected location for Avengers scenario:",J),Rh(J);const ie={inProgress:O,intensity:Y||5,focusCharacter:null,threatLevel:(a==null?void 0:a.currentTension)||"medium",civilianDanger:O?7:3,enemyClusters:[]};console.log("Setting battle state:",ie),Sl(ie),Is?Is.updateBattleState(ie):console.warn("turnTracker is undefined, cannot update battle state")}catch(J){console.error("Error initializing Avengers battle scenario:",J)}try{console.log("Generating scene description for location:",detectedLocation);const J=El(detectedLocation||"new_york",Y||5,kl||[]);J?(console.log("Generated scene description:",J.substring(0,50)+"..."),jl([J])):console.warn("Failed to generate scene description"),Ll(detectedLocation||"new_york",Yr||"introduction",Nl||{time:"midday",weather:"clear",progression:0})?console.log("Generated sensory details"):console.warn("Failed to generate sensory details")}catch(J){console.error("Error generating scene description or sensory details:",J)}sensorySuite?Sa(sensorySuite):Sa({sight:"The battle rages around you in the streets of New York.",sound:"Explosions and the sounds of combat echo through the city.",smell:"The air is filled with dust and smoke.",touch:"The ground trembles beneath your feet.",taste:"There's a metallic taste in the air."}),console.log("Initialized Avengers battle scenario tracking in "+detectedLocation);const Z=$l(newBattleState,e.characters,Ml,detectedLocation);C(Z)}}}},[e,h]);const Yh=z=>{if(!z)return"fantasy";const B=z.toLowerCase();return B.includes("superhero")||B.includes("hero")||B.includes("power")||B.includes("villain")?"superhero":B.includes("detective")||B.includes("mystery")||B.includes("crime")||B.includes("case")?"noir":"fantasy"},Kh=z=>{const B=(z.description||"").toLowerCase();return B.includes("hero")||B.includes("protagonist")||B.includes("brave")||B.includes("noble")?"hero":B.includes("villain")||B.includes("antagonist")||B.includes("evil")||B.includes("dark")?"villain":B.includes("wise")||B.includes("mentor")||B.includes("guide")||B.includes("teacher")?"mentor":"hero"},Qh=z=>{if(!z.personality)return"balanced";const{analytical:B,emotional:ee,humor:K}=z.personality;return B>7?"stoic":ee>7?"passionate":K>7?"quirky":"balanced"},Cl=z=>{if(!z)return;const B={sight:z.getSensoryDescription("sight"),sound:z.getSensoryDescription("sound"),smell:z.getSensoryDescription("smell"),touch:z.getSensoryDescription("touch"),taste:z.getSensoryDescription("taste")};Sa(B)},Il=z=>({"very low":1,low:3,medium:5,high:7,"very high":9})[z]||5,Ln=(z,B)=>{if(!z)return!1;const ee=z.name?z.name.toLowerCase():"",K=z.openingPrompt?z.openingPrompt.toLowerCase():"",de=["battle","fight","combat","war","invasion","attack","defend","enemy","enemies","threat","danger","weapon","alien"];for(const se of de)if(ee.includes(se)||K.includes(se))return!0;if(B&&B.length>0){const se=B.slice(-10);let Q=0;for(const Le of se)if(Le.message){const $e=Le.message.toLowerCase();for(const je of de)if($e.includes(je)&&(Q++,Q>=3))return!0}}return!1};j.useEffect(()=>{var z,B,ee;if(Zh(),t.length>0&&a){const K=ng(a,t,10);JSON.stringify(K)!==JSON.stringify(a)&&(r(K),zt(de=>({...de,storyArc:K.currentContext})))}if(As&&t.length>0&&!f&&!Ah&&As.shouldSuggestBranch(t)){const K=(e==null?void 0:e.theme)||((z=e==null?void 0:e.openingPrompt)!=null&&z.toLowerCase().includes("mystery")?"mystery":(B=e==null?void 0:e.openingPrompt)!=null&&B.toLowerCase().includes("horror")?"horror":(ee=e==null?void 0:e.openingPrompt)!=null&&ee.toLowerCase().includes("sci-fi")?"scifi":"adventure");As.setScenarioType(K),Yn.length>0&&As.setCharacterRelationships(Yn);const de=As.generateBranchOptions(t,e);Ih(de),Eh(!0)}if(t.length>0&&I){const K=t[t.length-1];if(!K.isUser&&!K.system){if(Jh(K)){U(!0);return}e.characters.length>=2&&Math.random()>.7&&Al(K)}if(!K.system&&!K.isEnvironmentalEvent&&!f){const de=t.findIndex(Q=>Q.isEnvironmentalEvent),se=de===-1?t.length:t.length-de-1;if(Rg(a,se)){const Q=new Date(K.timestamp).getTime(),$e=new Date().getTime()-Q,je=$e<3e3?3e3-$e:1e3,Te=Jc(a,e.characters);setTimeout(()=>{if(f)return;s(O=>[...O,{id:Date.now()+Math.random(),message:Te,system:!0,isNarration:!0,isEnvironmentalEvent:!0,timestamp:new Date().toISOString()}]);const mt=(a==null?void 0:a.currentTension)==="high"?.7:(a==null?void 0:a.currentTension)==="very high"?.8:.5,at=Math.min(1,2/e.characters.length);if(Math.random()<mt*at&&e.characters.length>0&&!f){const O=[...e.characters].sort((ie,pe)=>{var ze,fe,He,Bt;const Ue=(((ze=ie.personality)==null?void 0:ze.emotional)||5)+(((fe=ie.personality)==null?void 0:fe.analytical)||5);return(((He=pe.personality)==null?void 0:He.emotional)||5)+(((Bt=pe.personality)==null?void 0:Bt.analytical)||5)-Ue}),Y=Math.floor(O.length/2)||0,Z=O[Math.floor(Math.random()*Math.max(1,Y+1))],J=a?wo(a,Z):rn;setTimeout(()=>{if(f)return;y(!0),m(Z);const pe=1500/(Z.thinkingSpeed||1),Ue=Math.floor(Math.random()*1e3),pt=pe+Ue,ze=setTimeout(()=>{console.error(`Response generation for ${Z.name} timed out after 20 seconds`),y(!1),m(null)},2e4);setTimeout(()=>{clearTimeout(ze);const fe=t.slice(-6);let He;try{if(Is.recordTurn(Z.name,"event_response",{eventType:"environmental",isBattle:Ln(e,t)}),He=Yg(Z,Te,fe,J,e,Yn),!He||He.trim()===""){console.error(`Empty response generated for ${Z.name}`);const Dl=Ln(e,t)?"battle":"conversation";He=Qn(Z,Dl,Te)}}catch(Bt){console.error(`Error generating response for ${Z.name}:`,Bt);const tm=Ln(e,t)?"battle":"conversation";He=Qn(Z,tm,Te)}s(Bt=>[...Bt,{id:Date.now()+Math.random(),speaker:Z.name,character:Z,message:He,isUser:!1,timestamp:new Date().toISOString(),writingInstructions:J}]),y(!1),m(null)},pt)},1e3)}},je)}}}},[t,a]),j.useEffect(()=>{function z(B){const ee=document.getElementById("character-turn-dropdown");ee&&!ee.contains(B.target)&&!B.target.closest("button[data-character-turn-toggle]")&&(ee.classList.add("hidden"),console.log("Hiding character turn dropdown (clicked outside)"))}return document.addEventListener("mousedown",z),console.log("Added click outside handler for character turn dropdown"),()=>{document.removeEventListener("mousedown",z),console.log("Removed click outside handler for character turn dropdown")}},[]),j.useEffect(()=>{if(Qr.current&&(Qr.current.scrollTop=Qr.current.scrollHeight),t.length>0&&Dh){const B=t.slice(-5).map(ee=>ee.system?ee.message:`${ee.speaker||"Unknown"}: ${ee.message}`).join(`
`);Hh(B)}},[t]),j.useEffect(()=>{const z=B=>{if(B.key==="Escape"){if(ce){Ze(!1);return}if(Gr){Ur(!1);return}}if(B.altKey&&B.key==="w"){em();return}if(B.altKey&&B.key==="s"){Ur(!Gr);return}};return document.addEventListener("keydown",z),()=>{document.removeEventListener("keydown",z)}},[ce,Gr]);const Zh=()=>{var z;(z=Uh.current)==null||z.scrollIntoView({behavior:"smooth"})},Jh=z=>M?!1:a?[Xh(),a.currentTension>=8,z.message&&z.message.includes("phase")&&z.message.includes("transition"),z.message&&(z.message.includes("?")||z.message.toLowerCase().includes("what do you do")||z.message.toLowerCase().includes("what will you do")||z.message.toLowerCase().includes("what's your next move"))].some(ee=>ee===!0):!1,Xh=()=>{const z=t.slice(-4);let B=0;for(let ee=z.length-1;ee>=0;ee--){const K=z[ee];if(!K.isUser&&!K.system)B++;else break}return B>=3},Al=z=>{if(f)return;const B=new Date(z.timestamp).getTime(),K=new Date().getTime()-B;if(K<2e3){setTimeout(()=>Al(z),2e3-K);return}const de=t.slice(Math.max(0,t.length-5)).map(Q=>Q.speaker),se=e.characters.filter(Q=>Q.name!==z.speaker&&!de.includes(Q.name));if(se.length>0){const Q=dy(se,z,z.speaker),$e=11-(Q.talkativeness||5);if(Math.random()*10>$e){y(!0),m(Q);const Te=1500/(Q.thinkingSpeed||1),mt=Math.floor(Math.random()*1e3),at=Te+mt,Ce=setTimeout(()=>{console.error(`Response generation for ${Q.name} timed out after 20 seconds`),y(!1),m(null)},2e4);setTimeout(()=>{try{clearTimeout(Ce);const O=Ig(z.message);Vr(pe=>{const Ue=[...pe],pt=Zc(Ue,Q.name,z.speaker),ze=Cg(pt,z.speaker,z.message,O.affinityChange,O.interactionType),fe=Ue.findIndex(He=>He.characters.includes(Q.name)&&He.characters.includes(z.speaker));return fe!==-1&&(Ue[fe]=ze),Ue});const Y=Xc(H,Q.name,Q),Z={...Q,mood:(Y==null?void 0:Y.currentMood)||Q.mood},J=t.slice(-6);let ie;try{const pe=Ln(e,t);if(Is.recordTurn(Q.name,"interaction",{targetCharacter:z.speaker,isBattle:pe}),ie=Kg(Z,z.speaker,z.message,J,Yn),["I'm not sure how to respond to that","Let's try a different topic","I don't know what to say about that","I'm not sure I understand","Let's talk about something else","This requires careful analysis","I need to consider the facts","There are several factors to consider","I'm processing the information","Let me think through this logically","I'm examining the different angles","I need a moment to process","I'm not certain how to interpret","This is a complex matter","I need to analyze this further"].some(ze=>ie.toLowerCase().includes(ze.toLowerCase()))){console.log(`Detected off-topic response from ${Q.name}, using character-specific fallback`);const ze=pe?"battle":"conversation",fe=z.message.toLowerCase(),Bt=(fe.includes("love")||fe.includes("kiss")||fe.includes("hug")||fe.includes("beautiful")||fe.includes("marry")||fe.includes("date")||fe.includes("come here")||fe.includes("touch")||fe.includes("hold")||fe.includes("feel")||fe.includes("heart")||fe.includes("together")||fe.includes("want you"))&&Z.type==="fantasy"?"romantic":ze;ie=Qn(Z,Bt,z.message)}(!ie||ie.trim()==="")&&(console.error(`Empty interaction response generated for ${Q.name}`),ie=Qn(Q,pe?"battle":"conversation",z.message))}catch(pe){console.error(`Error generating interaction response for ${Q.name}:`,pe);const pt=Ln(e,t)?"battle":"conversation";ie=Qn(Q,pt,z.message)}s(pe=>[...pe,{id:Date.now()+Math.random(),speaker:Q.name,character:Q,message:ie,isUser:!1,timestamp:new Date().toISOString()}]),y(!1),m(null)}catch(O){console.error("Error in character interaction:",O);const Y=isBattleScenario?"battle":"conversation",Z=Qn(Q,Y,z.message);s(J=>[...J,{id:Date.now()+Math.random(),speaker:Q.name,character:Q,message:Z,isUser:!1,timestamp:new Date().toISOString()}]),y(!1),m(null)}},at)}}},El=(z,B,ee=[])=>{const K=z||"the area",de=[`${K} shows signs of the recent conflict, with minor damage visible.`,`A tense atmosphere hangs over ${K} as the situation threatens to escalate.`,`${K} remains relatively intact, though the signs of battle are beginning to show.`],se=[`Debris litters ${K} as the battle continues to intensify.`,`Smoke rises from several points around ${K} as the conflict escalates.`,`${K} has sustained significant damage, with structures partially collapsed.`],Q=[`${K} has become a war zone, with destruction visible in every direction.`,`Massive explosions rock ${K} as the battle reaches its peak intensity.`,`${K} is barely recognizable amid the chaos and devastation of the raging battle.`];let Le;B<=4?Le=de:B<=7?Le=se:Le=Q;const $e=Le.filter(je=>!ee.includes(je));return $e.length===0?Le[Math.floor(Math.random()*Le.length)]:$e[Math.floor(Math.random()*$e.length)]},Ll=(z,B,ee={})=>{const K=z||"the area",de={introduction:{sight:`The environment around ${K} appears relatively normal, though there's a subtle tension in the air.`,sound:"Distant sounds of commotion can be heard, growing gradually closer.",smell:"The air carries a faint trace of smoke and dust.",touch:"The ground occasionally trembles slightly beneath your feet."},rising:{sight:`${K} shows increasing signs of damage, with debris scattered across the ground.`,sound:"The clash of combat grows louder, punctuated by shouts and occasional explosions.",smell:"Acrid smoke fills the air, making it slightly difficult to breathe.",touch:"Heat radiates from nearby damaged structures and the ground shakes more frequently."},climax:{sight:`${K} has transformed into a battlefield, with destruction visible everywhere.`,sound:"Deafening explosions and the constant sounds of battle make it hard to hear anything else.",smell:"The overwhelming scent of smoke, dust, and destruction fills your nostrils.",touch:"The ground shakes violently with each impact, and the air itself seems to pulse with energy."},resolution:{sight:`The battle at ${K} appears to be subsiding, though the aftermath of destruction remains.`,sound:"The sounds of combat are fading, replaced by the crackle of fires and distant voices.",smell:"The air still carries the scent of battle, but it's beginning to clear.",touch:"Dust settles on your skin as the ground finally stops trembling."}},se=de[B]||de.rising;return ee.weather==="rain"?(se.sight+=" Rain pours down, reducing visibility and turning dust to mud.",se.sound+=" Raindrops drum loudly on surfaces all around.",se.touch+=" You're soaked to the skin, cold water running down your face."):ee.timeOfDay==="night"&&(se.sight+=" Darkness makes it difficult to see clearly, with fires and explosions providing brief illumination.",se.sound+=" The darkness seems to amplify every sound, making them more disorienting."),se},$l=(z,B,ee=[],K="the area")=>{const de=[{id:"default_1",text:"The battle intensifies as enemy forces press their attack.",type:"escalation"},{id:"default_2",text:"A momentary lull in the fighting provides a chance to regroup.",type:"tactical"},{id:"default_3",text:"Civilians are caught in the crossfire and need immediate help.",type:"rescue",urgency:"high"}];if(!B||B.length===0||!z)return de;const se=[],Q=[{id:"escalation_1",text:`Enemy reinforcements arrive at ${K}, making the situation more dire.`,type:"escalation"},{id:"escalation_2",text:"A massive explosion rocks the battlefield, forcing everyone to take cover.",type:"escalation"},{id:"escalation_3",text:"The enemy reveals a powerful new weapon that threatens to turn the tide of battle.",type:"escalation"}],Le=B.map(O=>({id:`character_${O.name.toLowerCase().replace(/\s/g,"_")}`,text:`${O.name} finds an opportunity to use their unique abilities to change the course of battle.`,type:"character_action",focusCharacter:O.name})),$e=[{id:"tactical_1",text:"A weakness in the enemy's formation becomes apparent, offering a tactical advantage.",type:"tactical"},{id:"tactical_2",text:"Communication systems briefly come back online, allowing for better coordination.",type:"tactical"},{id:"tactical_3",text:"A nearby structure could provide a strategic vantage point if secured quickly.",type:"tactical"}],je=[{id:"rescue_1",text:"A group of civilians is trapped in a damaged building that's threatening to collapse.",type:"rescue",urgency:"high"},{id:"rescue_2",text:"An injured ally calls for help from a dangerous position on the battlefield.",type:"rescue",urgency:"medium"}],Te=[];if(B.length>=2){const O=B[Math.floor(Math.random()*B.length)];let Y=B[Math.floor(Math.random()*B.length)];for(;Y.name===O.name&&B.length>1;)Y=B[Math.floor(Math.random()*B.length)];Te.push({id:`team_${O.name.toLowerCase()}_${Y.name.toLowerCase()}`.replace(/\s/g,"_"),text:`${O.name} and ${Y.name} have a chance to combine their abilities for a powerful joint attack.`,type:"team_combo",focusCharacter:`${O.name} & ${Y.name}`})}const mt=[{id:"environment_1",text:`Part of a structure at ${K} collapses, changing the battlefield layout.`,type:"environment"},{id:"environment_2",text:"Electrical systems in the area short out, causing a chain reaction of smaller explosions.",type:"environment"},{id:"environment_3",text:"A sudden change in weather conditions affects visibility and movement on the battlefield.",type:"environment"}];se.push(...Le),z.intensity<10&&se.push(...Q),se.push(...$e),z.civilianDanger>5&&se.push(...je),Te.length>0&&se.push(...Te),se.push(...mt);const at=se.filter(O=>!ee.includes(O.id));if(at.length>=3)return at.sort(()=>.5-Math.random()).slice(0,3);const Ce=[...at];for(;Ce.length<3;){const O=de[Ce.length%de.length];if(!Ce.some(Y=>Y.id===O.id))Ce.push(O);else{const Y={...O,id:`${O.id}_modified`,text:O.text.replace("the battle","the conflict").replace("enemy forces","opponents")};Ce.push(Y)}}return Ce},em=()=>{var ee,K,de,se,Q,Le;if(ce){Ze(!1);return}k(!1),S(!1),ue(!1),Ur(!1);const z=Ln(e,t),B=(e==null?void 0:e.name)&&e.name.includes("Avengers");if(z||B){console.log("Generating battle options for battle scenario");const $e=t.slice(-10),je=["attack","fight","battle","enemy","combat","defend","shield","weapon","explosion","danger","threat","alien"];let Te=0;$e.forEach(J=>{J.message&&je.forEach(ie=>{J.message.toLowerCase().includes(ie)&&Te++})});const mt=Math.min(10,Math.max(5,Te/2)),at={...Oh,inProgress:!0,intensity:mt};Sl(at);const Ce=El(Kr,mt,kl);jl(J=>[...J,Ce]);const O=Ll(Kr,Yr,Nl);Sa(O);const Y=$l(at,e.characters,Ml,Kr);Tl(Y);const Z=Y.map(J=>J.text);C(Z),Ze(!0)}else{const $e=(e==null?void 0:e.theme)||((ee=e==null?void 0:e.openingPrompt)!=null&&ee.toLowerCase().includes("adventure")?"adventure":(K=e==null?void 0:e.openingPrompt)!=null&&K.toLowerCase().includes("mystery")?"mystery":(de=e==null?void 0:e.openingPrompt)!=null&&de.toLowerCase().includes("fantasy")?"fantasy":(se=e==null?void 0:e.openingPrompt)!=null&&se.toLowerCase().includes("sci-fi")||(Q=e==null?void 0:e.openingPrompt)!=null&&Q.toLowerCase().includes("scifi")?"scifi":(Le=e==null?void 0:e.openingPrompt)!=null&&Le.toLowerCase().includes("horror")?"horror":"adventure");let je=[];if(je=[...generateStoryBranches(t,e,$e)],te){const Z=te.getQuickActions().map(Ue=>{const ze=t.slice(-5).map(He=>He.message).join(" ").match(/\b\w{4,}\b/g)||[],fe=ze.length>0?ze[Math.floor(Math.random()*ze.length)]:"";switch(Ue.toLowerCase()){case"attack":case"fight":return"A sudden threat appears, forcing everyone to prepare for combat.";case"cast spell":case"use power":return"Magical energy begins to manifest, drawing everyone's attention.";case"negotiate":case"plan":return"An opportunity for a strategic discussion presents itself.";case"investigate":case"question":return`A mysterious clue about ${fe||"recent events"} is discovered.`;case"protect":return"Someone or something needs protection from an imminent danger.";default:return`An opportunity to ${Ue.toLowerCase()} presents itself.`}});je=[...je,...Z];const J=["sight","sound","smell"][Math.floor(Math.random()*3)],ie=te.getSensoryDescription(J);ie&&je.push(`${ie}, changing the atmosphere of the scene.`);const pe=te.getNarration(Yr);pe&&je.push(`${pe}.`)}const mt=Jc(a,e.characters);if(je.push(mt),Ht&&e.characters.length>0){const Y=e.characters[Math.floor(Math.random()*e.characters.length)],Z=[`${Y.name} reveals an unexpected secret about their past.`,`${Y.name} notices something the others have missed.`,`${Y.name} suggests a new course of action.`,`${Y.name} experiences a sudden change in mood or perspective.`],J=Z[Math.floor(Math.random()*Z.length)];je.push(J);const ie=`branch_${Date.now()}`;Ht.createBranch(ie)}let Ce=je.sort(()=>.5-Math.random()).filter((Y,Z,J)=>J.indexOf(Y)===Z).slice(0,3);const O=["A moment of quiet reflection falls over the group.","The conversation takes an unexpected turn.","Someone changes the subject to a new topic."];for(;Ce.length<3;){const Y=O[Math.floor(Math.random()*O.length)];Ce.includes(Y)||Ce.push(Y)}te&&Cl(te),Tl([]),C(Ce),Ze(!0)}}},gy=e=>{const t=/(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&?\/\s]{11})/,s=e.match(t);if(s&&s[1])return{platform:"youtube",videoId:s[1]};const a=/(?:vimeo\.com\/(?:channels\/(?:\w+\/)?|groups\/[^\/]*\/videos\/|album\/\d+\/video\/|)(\d+)(?:$|\/|\?))/,r=e.match(a);if(r&&r[1])return{platform:"vimeo",videoId:r[1]};const i=/tiktok\.com\/@[\w.-]+\/video\/(\d+)/,o=e.match(i);return o&&o[1]?{platform:"tiktok",videoId:o[1]}:{platform:"unknown",videoId:null}},yy=async e=>new Promise(t=>{setTimeout(()=>{const{platform:s,videoId:a}=gy(e),r={youtube:[{title:"Epic Adventure",description:"A journey through unknown lands with unexpected allies.",prompt:"You find yourselves on the edge of a vast, uncharted wilderness. The map shows a path, but legends speak of dangers and wonders alike. What secrets will you uncover together?"},{title:"Modern Mystery",description:"Strange events in an ordinary town lead to extraordinary discoveries.",prompt:"The small cafe on Main Street has become the center of unusual occurrences. Patrons report lost time, strange conversations with people who were never there, and a sense that reality itself is thin here."},{title:"Cosmic Encounter",description:"When different worlds collide, nothing is as it seems.",prompt:"The night sky lit up with colors never before seen on Earth. Now, visitors from beyond the stars walk among us, each with their own agenda and perspective on humanity."}],vimeo:[{title:"Artistic Revelation",description:"Creativity and expression reveal deeper truths.",prompt:"In a world where art has become the primary language of communication, a new masterpiece has appeared overnight in the central gallery. Its creator is unknown, but its effect on viewers is profound and sometimes disturbing."},{title:"Historical Crossroads",description:"Past meets present in unexpected ways.",prompt:"An archaeological dig has uncovered an artifact that defies historical understanding. Those who touch it report vivid visions of the past—or perhaps an alternate timeline altogether."}],tiktok:[{title:"Viral Phenomenon",description:"When something captures everyone's attention, what lies beneath?",prompt:"A simple dance challenge has swept across the globe, but those who perform it begin to report strange dreams and newfound abilities. Is it mass hysteria, or something more intentional?"},{title:"Quick Connections",description:"Strangers brought together by chance or fate.",prompt:"Five people from different walks of life all received the same mysterious message at exactly 3:33 AM. Now they've found each other, but don't know why they've been brought together."}],unknown:[{title:"Mysterious Gathering",description:"When strangers meet, new stories begin.",prompt:"You've all received an invitation to a gathering at an address none of you recognize. Upon arrival, you find a beautifully prepared space, but no host in sight. Only a note that reads: 'When everyone is here, the truth will reveal itself.'"}]},i=r[s]||r.unknown,o=i[Math.floor(Math.random()*i.length)];t(o)},1500)}),xy=({onCreateScenario:e})=>{const[t,s]=j.useState(""),[a,r]=j.useState(!1),[i,o]=j.useState(null),[l,c]=j.useState([]),[d,u]=j.useState([]),[g,h]=j.useState(!1),[p,f]=j.useState(!1),[y,N]=j.useState(""),[m,v]=j.useState(""),[w,x]=j.useState(!1),[k,I]=j.useState({name:"",description:"",mood:"",opening_line:"",type:"modern",avatar:""}),T=()=>{t.trim()&&(r(!0),setTimeout(()=>{const M=cs(t),U=qs(t,3);o(M),c(U),u(U),r(!1)},1500))},L=()=>{if(d.length<2){alert("At least 2 characters are required for meaningful conversations. Please add more characters.");return}i&&d.length>=2&&e(i.title,d,i.prompt,"",i.background)},P=M=>{d.some(U=>U.name===M.name)?u(d.filter(U=>U.name!==M.name)):u([...d,M])},D=()=>{m.trim()&&(x(!0),setTimeout(()=>{const M=Tr(m);u([...d,M]),v(""),x(!1),h(!1)},1e3))},q=M=>{if(M.preventDefault(),!k.name||!k.description||!k.mood)return;const U={...k,personality:{analytical:5,emotional:5,philosophical:5,humor:5,confidence:5,creativity:5,sociability:5},talkativeness:5,thinkingSpeed:1,background:k.description};u([...d,U]),I({name:"",description:"",mood:"",opening_line:"",type:"modern",avatar:""}),f(!1)},A=Ns.filter(M=>M.name.toLowerCase().includes(y.toLowerCase())||M.description.toLowerCase().includes(y.toLowerCase())||M.type.toLowerCase().includes(y.toLowerCase())),S=M=>{r(!0),setTimeout(()=>{const U=Tr(t),H=[...l];H[M]=U,c(H),d.some(G=>G.name===l[M].name)&&u(d.map(G=>G.name===l[M].name?U:G)),r(!1)},800)};return n.jsxs("div",{className:"w-full max-w-4xl mx-auto p-6",children:[n.jsxs("div",{className:"mb-8",children:[n.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Generate a Scenario"}),n.jsx("p",{className:"text-muted-foreground mb-4",children:"Enter a few keywords/ideas and the AI will use them to generate characters and a scenario."}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("input",{type:"text",value:t,onChange:M=>s(M.target.value),placeholder:"e.g., space adventure, medieval fantasy, detective mystery",className:"flex-1 px-4 py-2 rounded-md border border-input bg-background"}),n.jsx("button",{onClick:T,disabled:!t.trim()||a,className:"inline-flex items-center justify-center rounded-md bg-primary px-4 py-2 text-sm font-medium text-primary-foreground shadow hover:bg-primary/90 disabled:opacity-50",children:a?n.jsxs(n.Fragment,{children:[n.jsx(qc,{className:"h-4 w-4 mr-2 animate-spin"}),"Generating..."]}):n.jsxs(n.Fragment,{children:[n.jsx(_e,{className:"h-4 w-4 mr-2"}),"Generate"]})})]})]}),i&&n.jsxs("div",{className:"mb-8",children:[n.jsx("h3",{className:"text-xl font-bold mb-2",children:i.title}),n.jsx("p",{className:"text-muted-foreground mb-4",children:i.description}),n.jsx("div",{className:"bg-secondary/30 rounded-lg p-4 mb-4 italic",children:i.prompt}),i.background&&n.jsx("div",{className:"mb-4",children:i.background.startsWith("linear-gradient")?n.jsx("div",{className:"w-full h-40 rounded-lg",style:{background:i.background}}):n.jsx("img",{src:i.background,alt:"Scenario background",className:"w-full h-40 object-cover rounded-lg"})})]}),l.length>0&&n.jsxs("div",{className:"mb-8",children:[n.jsx("h3",{className:"text-xl font-bold mb-4",children:"Generated Characters"}),n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:l.map((M,U)=>n.jsxs("div",{className:`border rounded-lg p-4 bg-background/50 cursor-pointer transition-all ${d.some(H=>H.name===M.name)?"border-primary/70 bg-primary/5":"hover:border-primary/30"}`,onClick:()=>P(M),children:[n.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[M.avatar&&n.jsx("img",{src:M.avatar,alt:M.name,className:"w-12 h-12 rounded-full object-cover"}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h4",{className:"font-bold",children:M.name}),n.jsxs("div",{className:"text-xs text-muted-foreground",children:[M.type," • ",M.mood]})]}),d.some(H=>H.name===M.name)&&n.jsx("div",{className:"bg-primary text-primary-foreground p-1 rounded-full",children:n.jsx(oe,{className:"h-4 w-4"})})]}),n.jsx("p",{className:"text-sm mb-2",children:M.description}),n.jsxs("p",{className:"text-sm italic mb-3",children:['"',M.opening_line,'"']}),n.jsx("div",{className:"flex justify-between",children:n.jsxs("button",{onClick:H=>{H.stopPropagation(),S(U)},className:"text-xs text-muted-foreground hover:text-foreground flex items-center gap-1",children:[n.jsx(gs,{className:"h-3 w-3"}),"Regenerate"]})})]},U))}),n.jsxs("div",{className:"mb-8 border-t border-b py-4",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[n.jsxs("h3",{className:"text-lg font-medium",children:["Selected Characters (",d.length,")"]}),d.length===1&&n.jsx("span",{className:"text-xs text-red-500 px-2 py-0.5 bg-red-500/10 rounded-full",children:"Need 1 more"}),d.length>=2&&n.jsx("span",{className:"text-xs text-green-600 px-2 py-0.5 bg-green-500/10 rounded-full",children:"Ready"})]}),n.jsx("div",{className:`p-3 mb-4 border rounded-md ${d.length===0?"border-muted-foreground/20 bg-secondary/10":d.length===1?"border-red-500/30 bg-red-500/5":"border-primary/20 bg-primary/5"}`,children:d.length>0?n.jsx("div",{className:"flex flex-wrap gap-2",children:d.map(M=>n.jsxs("div",{className:"bg-secondary rounded-full px-3 py-1 text-sm flex items-center gap-1",children:[M.avatar&&n.jsx("img",{src:M.avatar,alt:M.name,className:"w-5 h-5 rounded-full object-cover mr-1"}),M.name,n.jsx("button",{onClick:()=>P(M),className:"ml-1 hover:text-destructive",children:n.jsx(lt,{className:"h-3 w-3"})})]},M.name))}):n.jsx("p",{className:"text-muted-foreground text-sm",children:"No characters selected. Select at least 2 characters to create a meaningful conversation."})}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("button",{onClick:()=>h(!0),className:"inline-flex items-center justify-center rounded-md border border-input bg-background px-4 py-2 text-sm font-medium shadow-sm hover:bg-accent hover:text-accent-foreground",children:[n.jsx(vh,{className:"h-4 w-4 mr-2"}),"Add Character"]}),n.jsxs("button",{onClick:()=>f(!0),className:"inline-flex items-center justify-center rounded-md border border-input bg-background px-4 py-2 text-sm font-medium shadow-sm hover:bg-accent hover:text-accent-foreground",children:[n.jsx(yl,{className:"h-4 w-4 mr-2"}),"Create Custom Character"]})]})]}),n.jsx("button",{onClick:L,disabled:d.length<2,className:"w-full inline-flex items-center justify-center rounded-md bg-primary px-4 py-3 font-medium text-primary-foreground shadow hover:bg-primary/90 disabled:opacity-50",children:"Create Chat with Selected Characters"})]}),g&&n.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:n.jsxs("div",{className:"bg-background rounded-lg shadow-lg max-w-2xl w-full p-6",children:[n.jsxs("div",{className:"flex justify-between items-center mb-4",children:[n.jsx("h2",{className:"text-2xl font-bold",children:"Add Characters"}),n.jsx("button",{onClick:()=>h(!1),className:"p-1 rounded-full hover:bg-secondary",children:n.jsx(lt,{className:"h-5 w-5"})})]}),n.jsxs("div",{className:"mb-6",children:[n.jsx("h3",{className:"text-lg font-medium mb-2",children:"Generate from Keywords"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("input",{type:"text",value:m,onChange:M=>v(M.target.value),placeholder:"e.g., angry ninja, wise wizard, space pirate",className:"flex-1 px-3 py-2 rounded-md border border-input bg-background"}),n.jsxs("button",{onClick:D,disabled:!m.trim()||w,className:"inline-flex items-center justify-center rounded-md bg-primary px-4 py-2 text-sm font-medium text-primary-foreground shadow hover:bg-primary/90 disabled:opacity-50",children:[w?n.jsx(qc,{className:"h-4 w-4 animate-spin"}):n.jsx(_e,{className:"h-4 w-4 mr-2"}),"Generate"]})]})]}),n.jsxs("div",{className:"mb-4",children:[n.jsx("h3",{className:"text-lg font-medium mb-2",children:"Select Existing Character"}),n.jsx("input",{type:"text",placeholder:"Search characters...",value:y,onChange:M=>N(M.target.value),className:"w-full px-3 py-2 rounded-md border border-input bg-background mb-4"})]}),n.jsxs("div",{className:"max-h-[40vh] overflow-y-auto",children:[n.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:A.map(M=>n.jsx("div",{onClick:()=>P(M),className:`p-3 rounded-lg border cursor-pointer transition-all ${d.some(U=>U.name===M.name)?"border-primary bg-primary/10":"border-border hover:border-primary/50"}`,children:n.jsxs("div",{className:"flex items-center gap-2",children:[M.avatar?n.jsx("img",{src:M.avatar,alt:M.name,className:"w-10 h-10 rounded-full object-cover"}):n.jsx("div",{className:"w-10 h-10 rounded-full bg-secondary flex items-center justify-center",children:M.name.charAt(0)}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-bold",children:M.name}),n.jsxs("div",{className:"text-xs text-muted-foreground",children:[M.type," • ",M.mood]})]}),d.some(U=>U.name===M.name)&&n.jsx("div",{className:"ml-auto bg-primary text-primary-foreground p-1 rounded-full",children:n.jsx(oe,{className:"h-3 w-3"})})]})},M.name))}),A.length===0&&n.jsx("p",{className:"text-center py-4 text-muted-foreground",children:"No characters found. Try a different search term."})]}),n.jsx("div",{className:"flex justify-end mt-4",children:n.jsx("button",{onClick:()=>h(!1),className:"inline-flex items-center justify-center rounded-md border border-input bg-background px-4 py-2 text-sm font-medium shadow-sm hover:bg-accent hover:text-accent-foreground",children:"Done"})})]})}),p&&n.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:n.jsxs("div",{className:"bg-background rounded-lg shadow-lg max-w-xl w-full p-6",children:[n.jsxs("div",{className:"flex justify-between items-center mb-4",children:[n.jsx("h2",{className:"text-2xl font-bold",children:"Create Custom Character"}),n.jsx("button",{onClick:()=>f(!1),className:"p-1 rounded-full hover:bg-secondary",children:n.jsx(lt,{className:"h-5 w-5"})})]}),n.jsxs("form",{onSubmit:q,children:[n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{htmlFor:"character-name",className:"block text-sm font-medium mb-1",children:"Name"}),n.jsx("input",{id:"character-name",type:"text",value:k.name,onChange:M=>I({...k,name:M.target.value}),required:!0,className:"w-full px-3 py-2 rounded-md border border-input bg-background"})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"character-description",className:"block text-sm font-medium mb-1",children:"Description"}),n.jsx("textarea",{id:"character-description",value:k.description,onChange:M=>I({...k,description:M.target.value}),required:!0,className:"w-full px-3 py-2 rounded-md border border-input bg-background min-h-[80px]"})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{htmlFor:"character-mood",className:"block text-sm font-medium mb-1",children:"Mood"}),n.jsx("input",{id:"character-mood",type:"text",value:k.mood,onChange:M=>I({...k,mood:M.target.value}),required:!0,className:"w-full px-3 py-2 rounded-md border border-input bg-background"})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"character-type",className:"block text-sm font-medium mb-1",children:"Type"}),n.jsxs("select",{id:"character-type",value:k.type,onChange:M=>I({...k,type:M.target.value}),className:"w-full px-3 py-2 rounded-md border border-input bg-background",children:[n.jsx("option",{value:"fantasy",children:"Fantasy"}),n.jsx("option",{value:"scifi",children:"Sci-Fi"}),n.jsx("option",{value:"historical",children:"Historical"}),n.jsx("option",{value:"modern",children:"Modern"})]})]})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"character-opening-line",className:"block text-sm font-medium mb-1",children:"Opening Line"}),n.jsx("textarea",{id:"character-opening-line",value:k.opening_line,onChange:M=>I({...k,opening_line:M.target.value}),className:"w-full px-3 py-2 rounded-md border border-input bg-background min-h-[80px]"})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"character-avatar",className:"block text-sm font-medium mb-1",children:"Avatar URL (Optional)"}),n.jsx("input",{id:"character-avatar",type:"url",value:k.avatar,onChange:M=>I({...k,avatar:M.target.value}),className:"w-full px-3 py-2 rounded-md border border-input bg-background"}),k.avatar&&n.jsx("div",{className:"mt-2",children:n.jsx("img",{src:k.avatar,alt:"Avatar preview",className:"w-16 h-16 rounded-full object-cover",onError:M=>{M.target.onerror=null,M.target.src="https://placehold.co/200x200?text=Invalid+URL"}})})]})]}),n.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[n.jsx("button",{type:"button",onClick:()=>f(!1),className:"inline-flex items-center justify-center rounded-md border border-input bg-background px-4 py-2 text-sm font-medium shadow-sm hover:bg-accent hover:text-accent-foreground",children:"Cancel"}),n.jsx("button",{type:"submit",className:"inline-flex items-center justify-center rounded-md bg-primary px-4 py-2 text-sm font-medium text-primary-foreground shadow hover:bg-primary/90",children:"Add Character"})]})]})]})})]})},vy=e=>{if(!e||typeof e!="string")return!0;const t=e.trim();if(t.length===0)return!0;const s=t.split(/[.!?]+/).filter(r=>r.trim().length>0),a=t.split(/\s+/).filter(r=>r.length>0);return s.length<=1&&a.length<25||a.length<15},wy=(e,t=[])=>{const s=e?e.toLowerCase():"",a={adventure:["journey","quest","discover","explore","adventure","treasure","map"].some(p=>s.includes(p)),combat:["fight","battle","war","conflict","weapon","enemy","attack","defend"].some(p=>s.includes(p)),mystery:["mystery","clue","detective","solve","case","investigate","secret"].some(p=>s.includes(p)),fantasy:["magic","wizard","spell","dragon","mythical","enchanted","potion"].some(p=>s.includes(p)),scifi:["space","alien","future","technology","robot","starship","planet"].some(p=>s.includes(p)),romance:["love","romance","relationship","passion","heart","emotion","feeling"].some(p=>s.includes(p)),horror:["fear","terror","horror","scary","monster","nightmare","dark"].some(p=>s.includes(p)),historical:["history","ancient","medieval","century","era","period","kingdom"].some(p=>s.includes(p))},r=Object.entries(a).reduce((p,[f,y])=>y?f:p,"general"),i=["in","at","near","inside","outside","around"].some(p=>s.includes(p)),o=["morning","afternoon","evening","night","dawn","dusk","day","hour","time"].some(p=>s.includes(p)),l=["rain","snow","sunny","cloudy","storm","wind","fog","mist","weather"].some(p=>s.includes(p)),c=["feel","emotion","happy","sad","angry","afraid","excited","nervous","tense"].some(p=>s.includes(p)),d=["goal","objective","mission","task","quest","find","seek","search","achieve"].some(p=>s.includes(p)),u=["obstacle","challenge","problem","difficulty","trouble","barrier","prevent","block"].some(p=>s.includes(p)),g=t.length>=2&&t.some(p=>s.includes(p.name.toLowerCase())),h={setting:i?null:{title:"Add Setting Details",description:"Describe where the scene takes place to create a more vivid picture.",examples:[r==="fantasy"?"in an ancient enchanted forest with towering trees that whisper secrets":r==="scifi"?"aboard a massive starship with corridors humming with advanced technology":r==="historical"?"in a medieval marketplace filled with merchants and the scent of spices":"in a location with distinctive features that set the mood"]},time:o?null:{title:"Add Time Context",description:"Mention when the scene takes place to establish atmosphere.",examples:[r==="horror"?"as darkness falls and shadows grow longer":r==="adventure"?"at dawn, as the first light reveals the path ahead":"during a specific time that affects the mood or circumstances"]},atmosphere:l?null:{title:"Add Atmospheric Elements",description:"Include weather or environmental conditions to enhance immersion.",examples:[r==="romance"?"under a gentle rainfall that creates a intimate atmosphere":r==="adventure"?"with a strong wind carrying distant sounds of danger":"with weather or environmental conditions that reflect the mood"]},emotion:c?null:{title:"Add Emotional Context",description:"Describe how characters feel to create emotional investment.",examples:[r==="mystery"?"with a sense of unease that something important is being overlooked":r==="combat"?"with tension and adrenaline coursing through everyone present":"with emotional states that drive character motivations and reactions"]},goal:d?null:{title:"Add Clear Objectives",description:"Define what characters are trying to achieve.",examples:[r==="adventure"?"seeking a legendary artifact said to grant its wielder immense power":r==="mystery"?"trying to uncover the truth behind a series of mysterious disappearances":"with a clear purpose that drives the narrative forward"]},obstacle:u?null:{title:"Add Challenges or Obstacles",description:"Include what stands in the way of the characters' goals.",examples:[r==="fantasy"?"but a powerful curse prevents anyone from reaching their destination":r==="scifi"?"while malfunctioning systems threaten to expose their position to enemies":"with obstacles that create tension and require characters to make difficult choices"]},relationships:!g&&t.length>=2?{title:"Add Character Relationships",description:"Establish how the characters know each other or interact.",examples:t.length>=2?[`${t[0].name} and ${t[1].name} have a complicated history that creates tension`,`${t[0].name} relies on ${t[1].name}'s expertise, despite their differences`,"with relationships that create interesting dynamics and potential conflict"]:["with pre-existing relationships that affect how characters interact","where trust is limited due to past experiences between characters","with alliances and rivalries that influence decision-making"]}:null};return Object.values(h).filter(p=>p!==null)},by=(e,t=[])=>{const s=["What unique features does the setting have that affect the characters?","What recent event has created the current situation?","What are the stakes if the characters fail?","What hidden motivations might the characters have?","What unexpected complication might arise?","What sensory details (sounds, smells, etc.) make this scene distinctive?","What time constraints add pressure to the situation?","What social or political context influences the scenario?","What resources or tools do the characters have access to?","What secrets might be revealed during this encounter?"];return t.length>=2&&s.push(`How do ${t[0].name} and ${t[1].name} feel about each other?`,`What history do ${t[0].name} and ${t[1].name} share?`,`What conflicting goals might ${t[0].name} and ${t[1].name} have?`),ky(s).slice(0,3)},ky=e=>{const t=[...e];for(let s=t.length-1;s>0;s--){const a=Math.floor(Math.random()*(s+1));[t[s],t[a]]=[t[a],t[s]]}return t},jy=({suggestions:e=[],guidingQuestions:t=[],onApplySuggestion:s,onClose:a})=>{const[r,i]=j.useState(!0),[o,l]=j.useState("suggestions");return e.length===0&&t.length===0?null:n.jsxs("div",{className:"mt-2 border border-primary/20 rounded-md overflow-hidden bg-primary/5 transition-all animate-fadeIn",children:[n.jsxs("div",{className:"flex items-center justify-between p-3 bg-primary/10 cursor-pointer",onClick:()=>i(!r),children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Mr,{className:"h-4 w-4 text-primary animate-pulse"}),n.jsx("h3",{className:"text-sm font-medium",children:"Enhance Your Scenario"}),n.jsx("span",{className:"text-xs bg-primary/20 text-primary px-2 py-0.5 rounded-full",children:"Make it immersive"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:c=>{c.stopPropagation(),a()},className:"p-1 rounded-full hover:bg-primary/20",title:"Dismiss suggestions",children:n.jsx(lt,{className:"h-3.5 w-3.5"})}),r?n.jsx(zf,{className:"h-4 w-4"}):n.jsx(Pf,{className:"h-4 w-4"})]})]}),r&&n.jsxs("div",{className:"p-3",children:[n.jsx("p",{className:"text-xs text-muted-foreground mb-3",children:"Your scenario could be more immersive with additional details. Here are some suggestions:"}),n.jsxs("div",{className:"flex border-b mb-3",children:[n.jsx("button",{onClick:()=>l("suggestions"),className:`px-3 py-1 text-xs ${o==="suggestions"?"border-b-2 border-primary text-primary font-medium":"text-muted-foreground"}`,children:"Suggestions"}),n.jsx("button",{onClick:()=>l("questions"),className:`px-3 py-1 text-xs ${o==="questions"?"border-b-2 border-primary text-primary font-medium":"text-muted-foreground"}`,children:"Guiding Questions"})]}),o==="suggestions"&&n.jsx("div",{className:"space-y-3",children:e.map((c,d)=>n.jsxs("div",{className:"bg-background rounded-md p-3 border border-border",children:[n.jsxs("div",{className:"flex justify-between items-start mb-2",children:[n.jsx("h4",{className:"text-sm font-medium",children:c.title}),n.jsxs("button",{onClick:()=>s(c.examples[0]),className:"text-xs flex items-center gap-1 text-primary hover:text-primary/80 p-1 rounded-full hover:bg-primary/10",title:"Add this suggestion",children:[n.jsx(Ut,{className:"h-3 w-3"}),n.jsx("span",{children:"Add"})]})]}),n.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:c.description}),n.jsxs("div",{className:"text-xs italic bg-secondary/30 p-2 rounded-sm",children:['Example: "',c.examples[0],'"']})]},d))}),o==="questions"&&n.jsxs("div",{className:"space-y-3",children:[t.map((c,d)=>n.jsxs("div",{className:"flex items-start gap-2 p-2 border-b border-border last:border-0",children:[n.jsx(vo,{className:"h-4 w-4 text-primary flex-shrink-0 mt-0.5"}),n.jsx("p",{className:"text-sm",children:c})]},d)),n.jsx("p",{className:"text-xs text-muted-foreground pt-2",children:"Consider these questions to add depth to your scenario. They can help you think about aspects you might not have considered."})]})]})]})},Ny=({character:e,onUpdate:t,onClose:s})=>{const[a,r]=j.useState(!1),[i,o]=j.useState({...e}),l=(g,h)=>{if(g.startsWith("personality.")){const p=g.split(".")[1];o(f=>({...f,personality:{...f.personality,[p]:h}}))}else o(p=>({...p,[g]:h}))},c=()=>{t(i),r(!1)},d=()=>{o({...e}),r(!1)},u=g=>{switch(g==null?void 0:g.toLowerCase()){case"fantasy":return"bg-purple-100 text-purple-800";case"scifi":return"bg-blue-100 text-blue-800";case"historical":return"bg-amber-100 text-amber-800";case"modern":return"bg-green-100 text-green-800";case"superhero":return"bg-red-100 text-red-800";case"adventure":return"bg-teal-100 text-teal-800";default:return"bg-gray-100 text-gray-800"}};return n.jsxs("div",{className:"bg-background rounded-lg border border-border shadow-md overflow-hidden animate-fadeIn",children:[n.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[n.jsx("h3",{className:"font-bold text-lg",children:"Character Details"}),n.jsx("button",{onClick:s,className:"p-1 rounded-full hover:bg-secondary/50",title:"Close",children:n.jsx(lt,{className:"h-5 w-5"})})]}),n.jsxs("div",{className:"p-4",children:[n.jsxs("div",{className:"flex gap-4 mb-6",children:[n.jsx("div",{className:"flex-shrink-0",children:e.avatar?n.jsx("img",{src:e.avatar,alt:e.name,className:"w-20 h-20 rounded-full object-cover border-2 border-primary/20",onError:g=>{g.target.onerror=null,g.target.src=`https://ui-avatars.com/api/?name=${encodeURIComponent(e.name)}&background=random`}}):n.jsx("div",{className:"w-20 h-20 rounded-full bg-primary/10 flex items-center justify-center border-2 border-primary/20",children:n.jsx(xl,{className:"h-10 w-10 text-primary/50"})})}),n.jsxs("div",{className:"flex-1",children:[a?n.jsx("input",{type:"text",value:i.name,onChange:g=>l("name",g.target.value),className:"w-full px-3 py-2 rounded-md border border-input bg-background font-bold text-xl mb-2"}):n.jsx("h2",{className:"font-bold text-xl mb-2",children:e.name}),n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a?n.jsxs("select",{value:i.type,onChange:g=>l("type",g.target.value),className:"px-2 py-1 rounded text-xs border border-input bg-background",children:[n.jsx("option",{value:"fantasy",children:"Fantasy"}),n.jsx("option",{value:"scifi",children:"Sci-Fi"}),n.jsx("option",{value:"historical",children:"Historical"}),n.jsx("option",{value:"modern",children:"Modern"}),n.jsx("option",{value:"superhero",children:"Superhero"}),n.jsx("option",{value:"adventure",children:"Adventure"})]}):n.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${u(e.type)}`,children:e.type}),a?n.jsxs("select",{value:i.mood,onChange:g=>l("mood",g.target.value),className:"px-2 py-1 rounded text-xs border border-input bg-background",children:[n.jsx("option",{value:"neutral",children:"Neutral"}),n.jsx("option",{value:"happy",children:"Happy"}),n.jsx("option",{value:"sad",children:"Sad"}),n.jsx("option",{value:"angry",children:"Angry"}),n.jsx("option",{value:"excited",children:"Excited"}),n.jsx("option",{value:"nervous",children:"Nervous"}),n.jsx("option",{value:"curious",children:"Curious"})]}):n.jsx("div",{className:"flex items-center gap-1",children:n.jsx(py,{mood:e.mood,showLabel:!0})})]}),!a&&n.jsxs("button",{onClick:()=>r(!0),className:"text-xs flex items-center gap-1 text-primary hover:text-primary/80",children:[n.jsx(Vf,{className:"h-3 w-3"}),n.jsx("span",{children:"Edit Character"})]})]})]}),n.jsxs("div",{className:"mb-4",children:[n.jsx("h4",{className:"font-medium text-sm mb-1",children:"Description"}),a?n.jsx("textarea",{value:i.description,onChange:g=>l("description",g.target.value),className:"w-full px-3 py-2 rounded-md border border-input bg-background min-h-[80px] text-sm"}):n.jsx("p",{className:"text-sm bg-secondary/20 p-3 rounded-md",children:e.description})]}),(e.opening_line||a)&&n.jsxs("div",{className:"mb-4",children:[n.jsx("h4",{className:"font-medium text-sm mb-1",children:"Opening Line"}),a?n.jsx("textarea",{value:i.opening_line||"",onChange:g=>l("opening_line",g.target.value),className:"w-full px-3 py-2 rounded-md border border-input bg-background min-h-[60px] text-sm",placeholder:"How this character might introduce themselves..."}):n.jsxs("p",{className:"text-sm italic border-l-2 border-primary/30 pl-3 py-1",children:['"',e.opening_line,'"']})]}),a&&e.personality&&n.jsxs("div",{className:"mb-4",children:[n.jsx("h4",{className:"font-medium text-sm mb-2",children:"Personality Traits"}),n.jsx("div",{className:"grid grid-cols-2 gap-3",children:Object.entries(e.personality).map(([g,h])=>n.jsxs("div",{className:"flex flex-col",children:[n.jsx("label",{className:"text-xs capitalize mb-1",children:g}),n.jsx("input",{type:"range",min:"1",max:"10",value:i.personality[g]||h,onChange:p=>l(`personality.${g}`,parseInt(p.target.value)),className:"w-full"}),n.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[n.jsx("span",{children:"Low"}),n.jsx("span",{children:"High"})]})]},g))})]}),a&&n.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[n.jsx("button",{onClick:d,className:"px-3 py-1.5 rounded-md border border-input bg-background text-sm hover:bg-secondary/50",children:"Cancel"}),n.jsxs("button",{onClick:c,className:"px-3 py-1.5 rounded-md bg-primary text-primary-foreground text-sm hover:bg-primary/90 flex items-center gap-1",children:[n.jsx(oe,{className:"h-4 w-4"}),"Save Changes"]})]})]})]})},Sy=({scenarioDescription:e,characters:t=[],onUpdate:s})=>{const[a,r]=j.useState(!1),[i,o]=j.useState({setting:"",time:"",atmosphere:"",goal:"",obstacle:"",relationships:"",...l(e)});function l(h){if(!h)return{};const p={},f=h.match(/(?:in|at|near) (the |a |an )?([^,.]+)/i);f&&(p.setting=f[2].trim());const y=h.match(/(?:during|at|in the) (morning|afternoon|evening|night|dawn|dusk|day)/i);y&&(p.time=y[1].trim());const N=h.match(/(?:with|under|during) (?:a |the )?([^,.]+(?:rain|snow|sun|cloud|storm|wind|fog|mist))/i);N&&(p.atmosphere=N[1].trim());const m=h.match(/(?:trying to|seeking|looking for|searching for|aiming to) ([^,.]+)/i);m&&(p.goal=m[1].trim());const v=h.match(/(?:but|however|unfortunately|despite) ([^,.]+)/i);if(v&&(p.obstacle=v[1].trim()),t.length>=2){const w=t[0].name,x=t[1].name,k=h.match(new RegExp(`${w}[^,.]+${x}|${x}[^,.]+${w}`,"i"));k&&(p.relationships=k[0].trim())}return p}const c=(h,p)=>{o(f=>({...f,[h]:p}))},d=()=>{const h=u();s(h),r(!1)},u=()=>{let h=e||"";return i.setting&&!h.toLowerCase().includes(i.setting.toLowerCase())&&(h=`${h.trim()} The scene takes place in ${i.setting}.`.trim()),i.time&&!h.toLowerCase().includes(i.time.toLowerCase())&&(h=`${h.trim()} It's ${i.time}.`.trim()),i.atmosphere&&!h.toLowerCase().includes(i.atmosphere.toLowerCase())&&(h=`${h.trim()} The atmosphere is filled with ${i.atmosphere}.`.trim()),i.goal&&!h.toLowerCase().includes(i.goal.toLowerCase())&&(h=`${h.trim()} The characters are trying to ${i.goal}.`.trim()),i.obstacle&&!h.toLowerCase().includes(i.obstacle.toLowerCase())&&(h=`${h.trim()} However, ${i.obstacle}.`.trim()),i.relationships&&!h.toLowerCase().includes(i.relationships.toLowerCase())&&(h=`${h.trim()} ${i.relationships}.`.trim()),h},g=({icon:h,label:p,value:f,field:y})=>n.jsxs("div",{className:"flex items-start gap-2 mb-3",children:[n.jsx("div",{className:"flex-shrink-0 mt-0.5 text-primary/70",children:h}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h4",{className:"text-xs font-medium text-muted-foreground mb-1",children:p}),a?n.jsx("input",{type:"text",value:f||"",onChange:N=>c(y,N.target.value),placeholder:`Add ${p.toLowerCase()}`,className:"w-full px-2 py-1 text-sm rounded-md border border-input bg-background"}):n.jsx("p",{className:"text-sm",children:f||n.jsx("span",{className:"text-muted-foreground italic",children:"Not specified"})})]})]});return n.jsxs("div",{className:"bg-background rounded-lg border border-border shadow-md overflow-hidden animate-fadeIn",children:[n.jsxs("div",{className:"flex items-center justify-between p-3 bg-primary/5 border-b",children:[n.jsx("h3",{className:"font-medium",children:"Scenario Details"}),a?n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("button",{onClick:()=>r(!1),className:"p-1 rounded-full hover:bg-secondary/50",title:"Cancel",children:n.jsx(lt,{className:"h-3.5 w-3.5"})}),n.jsx("button",{onClick:d,className:"p-1 rounded-full hover:bg-primary/20 text-primary",title:"Save changes",children:n.jsx(Ws,{className:"h-3.5 w-3.5"})})]}):n.jsxs("button",{onClick:()=>r(!0),className:"text-xs flex items-center gap-1 text-primary hover:text-primary/80 p-1 rounded-full hover:bg-primary/10",children:[n.jsx(yl,{className:"h-3.5 w-3.5"}),n.jsx("span",{children:"Edit"})]})]}),n.jsxs("div",{className:"p-4",children:[n.jsx(g,{icon:n.jsx(Uf,{className:"h-4 w-4"}),label:"Setting",value:i.setting,field:"setting"}),n.jsx(g,{icon:n.jsx(fl,{className:"h-4 w-4"}),label:"Time",value:i.time,field:"time"}),n.jsx(g,{icon:n.jsx(Hf,{className:"h-4 w-4"}),label:"Atmosphere",value:i.atmosphere,field:"atmosphere"}),n.jsx(g,{icon:n.jsx(Jf,{className:"h-4 w-4"}),label:"Goal",value:i.goal,field:"goal"}),n.jsx(g,{icon:n.jsx(ph,{className:"h-4 w-4"}),label:"Obstacle",value:i.obstacle,field:"obstacle"}),n.jsx(g,{icon:n.jsx(gl,{className:"h-4 w-4"}),label:"Character Relationships",value:i.relationships,field:"relationships"}),a&&n.jsxs("div",{className:"mt-4 pt-3 border-t",children:[n.jsxs("button",{onClick:d,className:"w-full py-2 rounded-md bg-primary text-primary-foreground text-sm hover:bg-primary/90 flex items-center justify-center gap-1",children:[n.jsx(Ut,{className:"h-4 w-4"}),"Add Details to Scenario"]}),n.jsx("p",{className:"text-xs text-muted-foreground text-center mt-2",children:"These details will be incorporated into your scenario description"})]})]})]})},My=({scenarioDescription:e,characters:t=[],backgroundImage:s})=>{const[a,r]=j.useState(!1),i=wl(e),o=c=>{const d=[`I'm ${c.name}. ${c.opening_line||"Nice to meet you."}`,`As ${c.type==="fantasy"?"a being of magic":c.type==="scifi"?"someone from an advanced civilization":c.type==="historical"?"a person of historical significance":"someone in this scenario"}, I find this situation quite interesting.`,`Given my ${c.mood} mood, I'm approaching this with ${c.mood==="happy"?"enthusiasm and optimism":c.mood==="sad"?"a heavy heart":c.mood==="angry"?"frustration and intensity":c.mood==="curious"?"inquisitiveness and wonder":"my own perspective"}.`];return d[Math.floor(Math.random()*d.length)]},l=()=>{if(s)return{backgroundImage:`linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.7)), url(${s})`,backgroundSize:"cover",backgroundPosition:"center",color:"white"};const c=e.toLowerCase().includes("magic")||e.toLowerCase().includes("fantasy")||e.toLowerCase().includes("enchanted"),d=e.toLowerCase().includes("space")||e.toLowerCase().includes("future")||e.toLowerCase().includes("technology"),u=e.toLowerCase().includes("adventure")||e.toLowerCase().includes("quest")||e.toLowerCase().includes("journey");return c?{background:"linear-gradient(to right, #8e2de2, #4a00e0)"}:d?{background:"linear-gradient(to right, #2193b0, #6dd5ed)"}:u?{background:"linear-gradient(to right, #f2994a, #f2c94c)"}:{background:"linear-gradient(to right, #4568dc, #b06ab3)"}};return n.jsxs("div",{className:"bg-background rounded-lg border border-border shadow-md overflow-hidden animate-fadeIn",children:[n.jsxs("div",{className:"flex items-center justify-between p-3 bg-primary/5 border-b",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(fh,{className:"h-4 w-4 text-primary"}),n.jsx("h3",{className:"font-medium",children:"Scenario Preview"})]}),n.jsx("button",{onClick:()=>r(!a),className:"text-xs text-primary hover:text-primary/80",children:a?"Collapse":"Expand"})]}),n.jsxs("div",{className:"p-4 text-white",style:l(),children:[n.jsx("h2",{className:"font-bold text-lg mb-1",children:e.split(".")[0]||"Custom Scenario"}),n.jsx("p",{className:"text-sm opacity-90 mb-3",children:e||"No description provided yet."}),n.jsxs("div",{className:"flex items-center gap-3 text-xs",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(Mt,{className:"h-3.5 w-3.5"}),n.jsxs("span",{children:[t.length," Characters"]})]}),i.setting&&n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(yn,{className:"h-3.5 w-3.5"}),n.jsx("span",{children:i.setting})]})]})]}),a&&t.length>0&&n.jsxs("div",{className:"p-4",children:[n.jsxs("h4",{className:"text-sm font-medium mb-3 flex items-center gap-1",children:[n.jsx(ne,{className:"h-3.5 w-3.5 text-primary"}),n.jsx("span",{children:"Sample Character Interactions"})]}),n.jsx("div",{className:"space-y-3",children:t.map(c=>n.jsxs("div",{className:"flex items-start gap-2",children:[n.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full overflow-hidden bg-secondary flex items-center justify-center",children:c.avatar?n.jsx("img",{src:c.avatar,alt:c.name,className:"w-full h-full object-cover",onError:d=>{d.target.onerror=null,d.target.src=`https://ui-avatars.com/api/?name=${encodeURIComponent(c.name)}&background=random`}}):n.jsx("span",{className:"font-bold text-xs",children:c.name.charAt(0)})}),n.jsx("div",{className:"flex-1",children:n.jsxs("div",{className:"bg-secondary/20 rounded-lg p-2 text-sm",children:[n.jsx("p",{className:"font-medium text-xs mb-1",children:c.name}),n.jsx("p",{children:o(c)})]})})]},c.name))})]})]})},Ty=({onCreateRoom:e,onBack:t})=>{const[s,a]=j.useState(""),[r,i]=j.useState([]),[o,l]=j.useState(""),[c,d]=j.useState(""),[u,g]=j.useState(""),[h,p]=j.useState(!1),[f,y]=j.useState(""),[N,m]=j.useState("manual"),[v,w]=j.useState(!1),[x,k]=j.useState(""),[I,T]=j.useState(""),[L,P]=j.useState(!1),[D,q]=j.useState([]),[A,S]=j.useState([]),[M,U]=j.useState(!1),[H,G]=j.useState(null),[b,E]=j.useState(!1),[V,ue]=j.useState(!1),ce=async()=>{if(c){g("Generating theme...");try{const _=await yy(c);g(_),l(_.prompt||o)}catch(_){g("Could not generate theme. Please try a different video URL."),console.error("Error generating theme:",_)}}},Ze=_=>{if(_.preventDefault(),r.length<2){alert("At least 2 characters are required for meaningful conversations. Please add more characters.");return}s&&r.length>=2&&e(s,r,o,c,I)},ht=()=>{x.trim()&&(w(!0),setTimeout(()=>{const _=Tr(x);i([...r,_]),k(""),w(!1)},1e3))},tn=_=>{i(r.filter(me=>me.name!==_))},st=Ns.filter(_=>_.name.toLowerCase().includes(f.toLowerCase())&&!r.some(me=>me.name===_.name)),At=_=>{if(!o.trim()){l(_);return}l(me=>{const sn=/[.!?]$/.test(me.trim());return`${me.trim()}${sn?" ":". "}${_}`})},Cs=_=>{i(me=>me.map(sn=>sn.name===_.name?_:sn)),G(null)},nn=_=>{l(_)},Vn=_=>{H&&H.name===_.name?G(null):G(_)};return j.useEffect(()=>{if(r.length>=2&&vy(o)&&!M){const _=wy(o,r),me=by(o,r);q(_),S(me),P(_.length>0||me.length>0)}else P(!1)},[o,r,M]),n.jsxs("div",{className:"container mx-auto py-8 px-4",children:[n.jsxs("div",{className:"flex items-center mb-8",children:[n.jsxs("button",{onClick:t,className:"mr-4 p-2 rounded-full hover:bg-secondary",children:[n.jsx(Jt,{className:"h-5 w-5"}),n.jsx("span",{className:"sr-only",children:"Back"})]}),n.jsx("h1",{className:"text-3xl font-bold",children:"Create Custom Scenario"})]}),n.jsxs("div",{className:"flex border-b mb-8",children:[n.jsx("button",{onClick:()=>m("manual"),className:`px-4 py-2 font-medium ${N==="manual"?"border-b-2 border-primary text-primary":"text-muted-foreground"}`,children:"Manual Creation"}),n.jsxs("button",{onClick:()=>m("ai"),className:`px-4 py-2 font-medium flex items-center ${N==="ai"?"border-b-2 border-primary text-primary":"text-muted-foreground"}`,children:[n.jsx(ne,{className:"h-4 w-4 mr-2"}),"AI Generation"]})]}),N==="ai"?n.jsx(xy,{onCreateScenario:e}):n.jsx("form",{onSubmit:Ze,className:"max-w-2xl mx-auto",children:n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{children:[n.jsx("label",{htmlFor:"room-name",className:"block text-sm font-medium mb-2",children:"Room Name"}),n.jsx("input",{id:"room-name",type:"text",value:s,onChange:_=>a(_.target.value),required:!0,placeholder:"Enter a name for your chat room",className:"w-full px-3 py-2 rounded-md border border-input bg-background"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium mb-2",children:"Characters"}),n.jsxs("div",{className:`p-3 mb-4 border rounded-md ${r.length===0?"border-muted-foreground/20 bg-secondary/10":r.length===1?"border-red-500/30 bg-red-500/5":"border-primary/20 bg-primary/5"}`,children:[n.jsx("div",{className:"flex items-center justify-between mb-2",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("h3",{className:"text-sm font-medium",children:["Selected Characters (",r.length,")"]}),r.length===1&&n.jsx("span",{className:"text-xs text-red-500 px-2 py-0.5 bg-red-500/10 rounded-full",children:"Need 1 more"}),r.length>=2&&n.jsx("span",{className:"text-xs text-green-600 px-2 py-0.5 bg-green-500/10 rounded-full",children:"Ready"})]})}),r.length===0?n.jsx("p",{className:"text-muted-foreground text-sm",children:"No characters selected. Add at least 2 characters to create a meaningful conversation."}):n.jsx("div",{className:"flex flex-wrap gap-2",children:r.map(_=>n.jsxs("div",{className:"bg-secondary rounded-full px-3 py-1 text-sm flex items-center gap-1 cursor-pointer hover:bg-secondary/80 transition-colors group",onClick:()=>Vn(_),children:[_.avatar?n.jsx("img",{src:_.avatar,alt:_.name,className:"w-5 h-5 rounded-full object-cover mr-1",onError:me=>{me.target.onerror=null,me.target.src=`https://ui-avatars.com/api/?name=${encodeURIComponent(_.name)}&background=random`}}):n.jsx("div",{className:"w-5 h-5 rounded-full bg-primary/20 flex items-center justify-center mr-1",children:n.jsx("span",{className:"text-xs font-bold",children:_.name.charAt(0)})}),_.name,n.jsx("button",{type:"button",onClick:me=>{me.stopPropagation(),tn(_.name)},className:"ml-1 hover:text-destructive",children:n.jsx(lt,{className:"h-3 w-3"})}),n.jsx(Ff,{className:"h-3 w-3 ml-1 text-primary opacity-0 group-hover:opacity-100 transition-opacity"})]},_.name))})]}),n.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[n.jsxs("button",{type:"button",onClick:()=>p(!0),className:"inline-flex items-center justify-center rounded-md border border-input bg-background px-4 py-2 text-sm font-medium shadow-sm hover:bg-accent hover:text-accent-foreground",children:[n.jsx(Ut,{className:"h-4 w-4 mr-2"}),"Add Existing Character"]}),n.jsxs("div",{className:"flex-1 flex gap-2",children:[n.jsx("input",{type:"text",value:x,onChange:_=>k(_.target.value),placeholder:"Generate character from keywords...",className:"flex-1 px-3 py-2 rounded-md border border-input bg-background"}),n.jsx("button",{type:"button",onClick:ht,disabled:!x.trim()||v,className:"inline-flex items-center justify-center rounded-md border border-input bg-background px-4 py-2 text-sm font-medium shadow-sm hover:bg-accent hover:text-accent-foreground disabled:opacity-50",children:v?n.jsx("span",{className:"animate-pulse",children:"Generating..."}):n.jsxs(n.Fragment,{children:[n.jsx(_e,{className:"h-4 w-4 mr-2"}),"Generate"]})})]})]})]}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("label",{htmlFor:"opening-prompt",className:"block text-sm font-medium",children:"Opening Prompt"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("button",{type:"button",onClick:()=>E(!b),className:"text-xs flex items-center gap-1 text-primary hover:text-primary/80 p-1 rounded-full hover:bg-primary/10",title:"Edit scenario details",children:[n.jsx(Kf,{className:"h-3.5 w-3.5"}),n.jsx("span",{children:"Details"})]}),n.jsxs("button",{type:"button",onClick:()=>ue(!V),className:"text-xs flex items-center gap-1 text-primary hover:text-primary/80 p-1 rounded-full hover:bg-primary/10",title:"Preview scenario",children:[n.jsx(fh,{className:"h-3.5 w-3.5"}),n.jsx("span",{children:"Preview"})]})]})]}),n.jsx("textarea",{id:"opening-prompt",value:o,onChange:_=>l(_.target.value),placeholder:"Set the scene for your characters... Describe the setting, atmosphere, and relationships between characters.",className:"w-full px-3 py-2 rounded-md border border-input bg-background min-h-[100px]"}),L&&n.jsx(jy,{suggestions:D,guidingQuestions:A,onApplySuggestion:At,onClose:()=>U(!0)}),b&&n.jsx("div",{className:"mt-3",children:n.jsx(Sy,{scenarioDescription:o,characters:r,onUpdate:nn})}),V&&n.jsx("div",{className:"mt-3",children:n.jsx(My,{scenarioDescription:o,characters:r,backgroundImage:I})})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"video-url",className:"block text-sm font-medium mb-2",children:"Video URL (Optional)"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("input",{id:"video-url",type:"url",value:c,onChange:_=>d(_.target.value),placeholder:"Paste a video link to theme your chat",className:"flex-1 px-3 py-2 rounded-md border border-input bg-background"}),n.jsxs("button",{type:"button",onClick:ce,disabled:!c,className:"inline-flex items-center justify-center rounded-md border border-input bg-background px-4 py-2 text-sm font-medium shadow-sm hover:bg-accent hover:text-accent-foreground disabled:opacity-50",children:[n.jsx(tg,{className:"h-4 w-4 mr-2"}),"Generate Theme"]})]}),u&&n.jsxs("div",{className:"mt-2 p-3 bg-secondary/50 rounded-md text-sm",children:[n.jsx("p",{className:"font-medium mb-1",children:"Theme Suggestion:"}),n.jsx("p",{children:u})]})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"background-image",className:"block text-sm font-medium mb-2",children:"Background Image URL (Optional)"}),n.jsx("input",{id:"background-image",type:"url",value:I,onChange:_=>T(_.target.value),placeholder:"Enter URL for chat background image",className:"w-full px-3 py-2 rounded-md border border-input bg-background"}),I&&n.jsx("div",{className:"mt-2",children:n.jsx("img",{src:I,alt:"Chat background preview",className:"w-full h-32 object-cover rounded-md",onError:_=>{_.target.onerror=null,_.target.src="https://placehold.co/600x400?text=Invalid+Image+URL"}})})]}),n.jsxs("div",{className:"flex justify-end gap-4 pt-4",children:[n.jsx("button",{type:"button",onClick:t,className:"inline-flex items-center justify-center rounded-md border border-input bg-background px-4 py-2 text-sm font-medium shadow-sm hover:bg-accent hover:text-accent-foreground",children:"Cancel"}),n.jsx("button",{type:"submit",disabled:!s||r.length<2,className:"inline-flex items-center justify-center rounded-md bg-primary px-4 py-2 text-sm font-medium text-primary-foreground shadow hover:bg-primary/90 disabled:opacity-50",children:"Create Chat Room"})]})]})}),H&&n.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:n.jsx("div",{className:"max-w-md w-full",children:n.jsx(Ny,{character:H,onUpdate:Cs,onClose:()=>G(null)})})}),h&&n.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:n.jsxs("div",{className:"bg-background rounded-lg shadow-lg max-w-2xl w-full p-6",children:[n.jsxs("div",{className:"flex justify-between items-center mb-4",children:[n.jsx("h2",{className:"text-2xl font-bold",children:"Select Characters"}),n.jsx("button",{onClick:()=>p(!1),className:"p-1 rounded-full hover:bg-secondary",children:n.jsx(lt,{className:"h-5 w-5"})})]}),n.jsx("div",{className:"mb-4",children:n.jsx("input",{type:"text",placeholder:"Search characters...",value:f,onChange:_=>y(_.target.value),className:"w-full px-3 py-2 rounded-md border border-input bg-background"})}),n.jsxs("div",{className:"max-h-[60vh] overflow-y-auto",children:[n.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:st.map(_=>n.jsxs("div",{onClick:()=>{i([...r,_]),p(!1)},className:"p-4 rounded-lg border border-border hover:border-primary/50 cursor-pointer transition-all hover:bg-secondary/10",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[_.avatar?n.jsx("img",{src:_.avatar,alt:_.name,className:"w-12 h-12 rounded-full object-cover"}):n.jsx("div",{className:`bg-${_.type==="fantasy"?"purple":_.type==="scifi"?"blue":_.type==="historical"?"amber":"green"}-500 w-12 h-12 rounded-full flex items-center justify-center text-white font-bold`,children:_.name.split(" ").map(me=>me[0]).join("").toUpperCase()}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-bold",children:_.name}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-xs px-2 py-0.5 bg-secondary rounded-full",children:_.mood}),n.jsx("span",{className:"text-xs text-muted-foreground",children:_.type})]})]})]}),n.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:_.description}),_.opening_line&&n.jsxs("p",{className:"text-xs italic border-l-2 border-primary/30 pl-2 mt-2",children:['"',_.opening_line,'"']})]},_.name))}),st.length===0&&n.jsx("p",{className:"text-center py-4 text-muted-foreground",children:"No characters found. Try a different search term."})]}),n.jsx("div",{className:"flex justify-end mt-4",children:n.jsx("button",{onClick:()=>p(!1),className:"inline-flex items-center justify-center rounded-md border border-input bg-background px-4 py-2 text-sm font-medium shadow-sm hover:bg-accent hover:text-accent-foreground",children:"Cancel"})})]})})]})},Cy=({onStartChat:e,onBack:t})=>{const[s,a]=j.useState(""),[r,i]=j.useState(!1),[o,l]=j.useState([]),[c,d]=j.useState("categories"),u=[{name:"Fantasy",keywords:"fantasy adventure magic quest",icon:"🧙‍♂️",description:"Magical journeys"},{name:"Sci-Fi",keywords:"space scifi future technology",icon:"🚀",description:"Cosmic wonders"},{name:"Mystery",keywords:"mystery detective crime investigation",icon:"🔍",description:"Perplexing cases"},{name:"Historical",keywords:"historical medieval renaissance ancient",icon:"📜",description:"Bygone eras"},{name:"Romance",keywords:"romance love relationship modern",icon:"❤️",description:"Love stories"},{name:"Horror",keywords:"horror scary supernatural survival",icon:"👻",description:"Terrifying scenarios"},{name:"Combat",keywords:"combat battle arena warrior sword duel",icon:"⚔️",description:"Fierce battles"},{name:"Superhero",keywords:"superhero powers hero villain",icon:"🦸‍♀️",description:"Extraordinary heroes"}],g=y=>{i(!0),a(y);const N={"star wars":{universe:"Star Wars universe",settings:["Tatooine desert","Death Star","Rebel base","Imperial fleet","Jedi temple","Coruscant","Endor moon","Hoth ice planet"],characters:["Jedi Knight","Sith Lord","smuggler","rebel pilot","Imperial officer","bounty hunter","droid","Wookiee"],items:["lightsaber","blaster","starship","the Force","hyperdrive","droid","Millennium Falcon"],conflicts:["Rebellion against Empire","Jedi vs Sith","smuggling operation","space battle","lightsaber duel","Imperial invasion"],themes:["the Force","good vs evil","rebellion","destiny","redemption","legacy"]},"lord of the rings":{universe:"Middle-earth",settings:["Shire","Mordor","Rivendell","Gondor","Rohan","Moria mines","Lothlorien forest"],characters:["hobbit","wizard","elf","dwarf","ranger","orc","Ringwraith"],items:["the One Ring","Elvish blade","mithril armor","wizard staff","palantir"],conflicts:["quest to destroy the Ring","battle for Middle-earth","siege of Gondor","corruption by the Ring"],themes:["power and corruption","fellowship","heroism","sacrifice","journey"]},"harry potter":{universe:"Wizarding World",settings:["Hogwarts School","Diagon Alley","Ministry of Magic","Forbidden Forest","Hogsmeade village"],characters:["wizard student","professor","magical creature","Auror","Death Eater","house-elf"],items:["wand","broomstick","potion","magical artifact","Marauder's Map","invisibility cloak"],conflicts:["wizard duel","magical tournament","fight against dark magic","Quidditch match"],themes:["magic","friendship","coming of age","prejudice","sacrifice"]},"game of thrones":{universe:"Westeros",settings:["King's Landing","Winterfell","The Wall","Iron Islands","Dorne","Braavos"],characters:["noble lord","knight","sellsword","wildling","maester","assassin"],items:["Valyrian steel","dragon egg","wildfire","poison","direwolf"],conflicts:["battle for the throne","political intrigue","house rivalry","White Walker invasion"],themes:["power","betrayal","honor","survival","family legacy"]},marvel:{universe:"Marvel Universe",settings:["New York City","Avengers Tower","secret lab","alien planet","Wakanda","alternate dimension"],characters:["superhero","supervillain","S.H.I.E.L.D. agent","mutant","scientist","cosmic entity"],items:["super serum","Infinity Stone","advanced tech","magical artifact","vibranium shield"],conflicts:["alien invasion","superhero civil war","stopping a villain's plan","saving the universe"],themes:["responsibility","heroism","teamwork","identity","sacrifice"]}},m=x=>{const k=x.toLowerCase();for(const[I,T]of Object.entries(N))if(k.includes(I))return{franchise:I,themes:T};return k.includes("star")&&k.includes("wars")?{franchise:"star wars",themes:N["star wars"]}:k.includes("lord")&&k.includes("rings")?{franchise:"lord of the rings",themes:N["lord of the rings"]}:k.includes("harry")&&k.includes("potter")?{franchise:"harry potter",themes:N["harry potter"]}:k.includes("game")&&k.includes("thrones")?{franchise:"game of thrones",themes:N["game of thrones"]}:k.includes("marvel")||k.includes("avengers")?{franchise:"marvel",themes:N.marvel}:null},v=(x,k,I)=>{const T={universe:k.universe,setting:k.settings[Math.floor(Math.random()*k.settings.length)],character:k.characters[Math.floor(Math.random()*k.characters.length)],item:k.items[Math.floor(Math.random()*k.items.length)],theme:k.themes[Math.floor(Math.random()*k.themes.length)]};let L={};if(I==="action"){const q=k.conflicts[Math.floor(Math.random()*k.conflicts.length)];L={title:`Battle in the ${T.setting}`,description:`An epic ${q} unfolds in the ${T.setting}. As a ${T.character} wielding ${T.item}, you must face overwhelming odds in this tale of ${T.theme}.`,prompt:`The ${T.setting} is a battlefield. You are a skilled ${T.character} in the ${T.universe}, and your ${T.item} may be the key to victory. The enemy forces are closing in, and the fate of many depends on your courage and skill.`,type:"combat"}}else I==="mystery"?L={title:`Mystery of the ${T.setting}`,description:`A perplexing mystery has emerged in the ${T.setting}. As a clever ${T.character}, you must uncover secrets involving ${T.item} in this intriguing tale of ${T.theme}.`,prompt:`Something valuable has disappeared from the ${T.setting}. As a ${T.character} in the ${T.universe}, your knowledge of ${T.item} makes you uniquely qualified to investigate. Strange clues point to a conspiracy that could change everything.`,type:"mystery"}:L={title:`Journey Through the ${T.setting}`,description:`A personal journey unfolds in the ${T.setting}. As a ${T.character} with a connection to ${T.item}, you navigate relationships and discover the true meaning of ${T.theme}.`,prompt:`The ${T.setting} is where your story begins. As a ${T.character} in the ${T.universe}, your relationship with ${T.item} has shaped who you are. Now you face choices that will test your values and reveal your true character.`,type:"adventure"};const P={"star wars":["https://images.unsplash.com/photo-1579566346927-c68383817a25?q=80&w=2070&auto=format&fit=crop","https://images.unsplash.com/photo-1608346128025-1896b97a6fa7?q=80&w=2070&auto=format&fit=crop","https://images.unsplash.com/photo-1601814933824-fd0b574dd592?q=80&w=2012&auto=format&fit=crop"],"lord of the rings":["https://images.unsplash.com/photo-1518709268805-4e9042af9f23?q=80&w=2069&auto=format&fit=crop","https://images.unsplash.com/photo-1542273917363-3b1817f69a2d?q=80&w=2074&auto=format&fit=crop","https://images.unsplash.com/photo-1536300007881-7e482242baa5?q=80&w=2070&auto=format&fit=crop"],"harry potter":["https://images.unsplash.com/photo-1551269901-5c5e14c25df7?q=80&w=2069&auto=format&fit=crop","https://images.unsplash.com/photo-1551022372-0bdac482a9c7?q=80&w=2070&auto=format&fit=crop","https://images.unsplash.com/photo-1618944847828-82e943c3bdb7?q=80&w=2070&auto=format&fit=crop"],"game of thrones":["https://images.unsplash.com/photo-1572742482459-e04d6cfdd6f3?q=80&w=2070&auto=format&fit=crop","https://images.unsplash.com/photo-1596636478939-59fed7a083f2?q=80&w=2071&auto=format&fit=crop","https://images.unsplash.com/photo-1504788363733-507549153474?q=80&w=2070&auto=format&fit=crop"],marvel:["https://images.unsplash.com/photo-1612036782180-6f0822045d55?q=80&w=2070&auto=format&fit=crop","https://images.unsplash.com/photo-1560343776-97e7d202ff0e?q=80&w=2069&auto=format&fit=crop","https://images.unsplash.com/photo-1569003339405-ea396a5a8a90?q=80&w=2070&auto=format&fit=crop"]};let D;if(P[x]){const q=I==="action"?0:I==="mystery"?1:2;D=P[x][q]}else D="linear-gradient(135deg, rgba(30,30,30,0.8), rgba(10,10,10,0.9))";return{title:L.title,description:L.description,prompt:L.prompt,type:L.type,background:D,franchise:x}},w=(x,k)=>{const I=x.toLowerCase().split(/[,\s]+/).filter(D=>D.length>2),T={action:["battle","combat","fight","action","conflict","challenge"],mystery:["mystery","investigation","secret","puzzle","intrigue","conspiracy"],character:["character","personal","emotional","relationship","development","backstory"],setting:["world","environment","location","atmosphere","landscape","setting"]},L=T[k]||T.action,P=[];for(let D=0;D<2;D++){const q=L[Math.floor(Math.random()*L.length)];P.includes(q)||P.push(q)}return[...I,...P].join(" ")};setTimeout(()=>{const x=m(y);let k=[];if(x){const{franchise:I,themes:T}=x;k=[v(I,T,"action"),v(I,T,"mystery"),v(I,T,"character")];const L=`${I} ${T.characters.join(" ")}`;k.forEach(P=>{P.characters=qs(L,3)})}else{const I=w(y,"action"),T=w(y,"mystery"),L=w(y,"character");if(k=[cs(I),cs(T),cs(L)],new Set(k.map(D=>D.type)).size<3){const D=w(y,"setting");k[2]=cs(D)}k[0].characters=qs(I,3),k[1].characters=qs(T,3),k[2].characters=qs(L,3)}k[0].actionFocus=!0,k[1].mysteryFocus=!0,k[2].characterFocus=!0,l(k),i(!1)},1e3)},h=y=>{if(y.title==="Avengers join battle"||y.title&&y.title.toLowerCase().includes("avengers")&&y.title.toLowerCase().includes("battle")){console.log("Starting special Avengers battle scenario");const N=[{name:"Iron Man",description:"Genius billionaire Tony Stark in his advanced armor suit",personality:"Brilliant, sarcastic, and heroic",appearance:"Red and gold armor suit with glowing arc reactor",background:"Weapons manufacturer turned superhero after being captured by terrorists",abilities:"Advanced technology, flight, repulsor beams, genius intellect",weaknesses:"Arrogance, PTSD, reliance on technology",speech_style:"Witty, technical, often makes pop culture references",opening_line:"Let's get this party started. JARVIS, give me a tactical assessment."},{name:"Captain America",description:"Super-soldier Steve Rogers, the first Avenger",personality:"Honorable, brave, and principled leader",appearance:"Muscular man in blue, red and white uniform with a shield",background:"World War II soldier enhanced by super-soldier serum",abilities:"Enhanced strength, speed, endurance, expert tactician, vibranium shield",weaknesses:"Old-fashioned worldview, sometimes too self-sacrificing",speech_style:"Direct, inspirational, occasionally uses outdated expressions",opening_line:"Avengers, we need to establish a perimeter and protect civilians. What's our status?"},{name:"Thor",description:"Asgardian god of thunder and lightning",personality:"Noble, powerful, sometimes arrogant but good-hearted",appearance:"Muscular with long blonde hair, armor, and Mjolnir hammer",background:"Prince of Asgard, son of Odin, protector of the Nine Realms",abilities:"Superhuman strength, control of lightning, flight with Mjolnir",weaknesses:"Pride, attachment to Earth and Asgard",speech_style:"Formal, sometimes archaic, speaks of battle with enthusiasm",opening_line:"These foes shall feel the wrath of Mjolnir! I'll take to the skies and thin their numbers."},{name:"Hulk",description:"Enormous green rage monster, alter ego of Bruce Banner",personality:"Angry, powerful, protective, simple speech",appearance:"Massive green humanoid with incredible muscles",background:"Scientist transformed by gamma radiation experiment",abilities:"Unlimited strength, regeneration, immunity to most weapons",weaknesses:"Rage can make him unpredictable, potential harm to allies",speech_style:"Simple, direct, often in third person, roars when angry",opening_line:"HULK SMASH PUNY ALIENS!"}],m="The Avengers are in the midst of battle against alien forces in downtown New York. Civilians are being evacuated while the team fights to push back the invasion. The alien mothership looms overhead, continuously sending down reinforcements. You join the team as they coordinate their defense while looking for a way to stop the invasion at its source.",v="https://images.unsplash.com/photo-1612036782180-6f0822045d55?q=80&w=2070&auto=format&fit=crop";console.log("Starting Avengers battle with predefined characters:",N.map(w=>w.name).join(", ")),e("Avengers join battle",N,m,v,"superhero"),console.log("Avengers chat started with background:",v);return}console.log("Starting normal scenario:",y.title),console.log("Characters:",y.characters.map(N=>N.name).join(", ")),e(y.title,y.characters,y.prompt,y.background,y.type||"custom")},p=()=>{g(s)},f=()=>{l([]),a("")};return n.jsxs("div",{className:"container mx-auto py-6 px-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"flex items-center",children:[n.jsxs("button",{onClick:t,className:"mr-3 p-2 rounded-full hover:bg-secondary",children:[n.jsx(Jt,{className:"h-5 w-5"}),n.jsx("span",{className:"sr-only",children:"Back"})]}),n.jsx("h1",{className:"text-2xl font-bold",children:"Choose Adventure"})]}),o.length>0&&n.jsx("button",{onClick:f,className:"p-2 rounded-full hover:bg-secondary",title:"Clear and start over",children:n.jsx(lt,{className:"h-5 w-5"})})]}),o.length?n.jsxs("div",{className:"max-w-5xl mx-auto",children:[n.jsxs("div",{className:"flex justify-between items-center mb-4",children:[n.jsxs("div",{children:[n.jsx("h2",{className:"text-lg font-medium",children:"Choose your adventure"}),n.jsxs("p",{className:"text-xs text-muted-foreground",children:['Based on: "',s,'"']})]}),n.jsx("button",{onClick:p,disabled:r,className:"inline-flex items-center justify-center rounded-md border border-input bg-background px-3 py-1.5 text-xs font-medium shadow-sm hover:bg-accent hover:text-accent-foreground disabled:opacity-50",children:r?n.jsx(gs,{className:"h-3.5 w-3.5 animate-spin"}):n.jsxs(n.Fragment,{children:[n.jsx(gs,{className:"h-3.5 w-3.5 mr-1.5"}),"Regenerate"]})})]}),n.jsx("div",{className:"space-y-3",children:o.map((y,N)=>n.jsxs("div",{className:"border rounded-lg overflow-hidden hover:border-primary/50 hover:shadow-md transition-all flex flex-col sm:flex-row",children:[n.jsxs("div",{className:"h-24 sm:w-1/4 sm:h-auto bg-cover bg-center relative",style:y.background.startsWith("linear-gradient")?{background:y.background}:{backgroundImage:`url(${y.background})`},children:[n.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-background/90 to-transparent sm:bg-gradient-to-r"}),n.jsxs("div",{className:"absolute top-2 right-2 flex flex-col gap-1 items-end",children:[y.franchise?n.jsx("div",{className:"bg-yellow-500/20 text-yellow-500 backdrop-blur-sm px-2 py-0.5 rounded-full text-xs font-medium",children:y.franchise.split(" ").map(m=>m.charAt(0).toUpperCase()+m.slice(1)).join(" ")}):n.jsx("div",{className:"bg-background/80 backdrop-blur-sm px-2 py-0.5 rounded-full text-xs font-medium",children:y.type.charAt(0).toUpperCase()+y.type.slice(1)}),y.actionFocus&&n.jsx("div",{className:"bg-red-500/20 text-red-500 backdrop-blur-sm px-2 py-0.5 rounded-full text-xs font-medium",children:"Action"}),y.mysteryFocus&&n.jsx("div",{className:"bg-purple-500/20 text-purple-500 backdrop-blur-sm px-2 py-0.5 rounded-full text-xs font-medium",children:"Mystery"}),y.characterFocus&&n.jsx("div",{className:"bg-blue-500/20 text-blue-500 backdrop-blur-sm px-2 py-0.5 rounded-full text-xs font-medium",children:"Character"})]}),n.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-3 sm:hidden",children:n.jsx("h3",{className:"text-base font-bold text-foreground drop-shadow-sm line-clamp-1",children:y.title})})]}),n.jsxs("div",{className:"p-3 flex-1 flex flex-col sm:flex-row sm:items-center sm:gap-4",children:[n.jsxs("div",{className:"flex-1",children:[n.jsx("h3",{className:"hidden sm:block text-base font-bold mb-1",children:y.title}),n.jsxs("div",{className:"mb-2",children:[n.jsx("p",{className:"text-xs text-muted-foreground line-clamp-2",children:y.description}),n.jsxs("div",{className:"mt-1 text-xs",children:[y.actionFocus&&n.jsx("span",{className:"text-red-500 font-medium",children:"Focus on combat and challenges"}),y.mysteryFocus&&n.jsx("span",{className:"text-purple-500 font-medium",children:"Uncover secrets and solve puzzles"}),y.characterFocus&&n.jsx("span",{className:"text-blue-500 font-medium",children:"Deep character interactions"})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"flex -space-x-1",children:y.characters.slice(0,3).map((m,v)=>n.jsxs("div",{className:"w-5 h-5 rounded-full bg-secondary/50 border border-background flex items-center justify-center text-xs",children:[m.type==="fantasy"&&"✨",m.type==="scifi"&&"🔭",m.type==="historical"&&"📜",m.type==="horror"&&"👻",m.type==="combat"&&"⚔️"]},v))}),n.jsx("p",{className:"text-xs text-muted-foreground line-clamp-1",children:y.characters.map(m=>m.name).join(", ")})]})]}),n.jsxs("button",{onClick:()=>h(y),className:"w-full sm:w-auto inline-flex items-center justify-center rounded-md bg-primary px-3 py-1.5 text-xs font-medium text-primary-foreground shadow hover:bg-primary/90 mt-2 sm:mt-0",children:["Begin Adventure",n.jsx(gn,{className:"h-3.5 w-3.5 ml-1.5"})]})]})]},N))})]}):n.jsxs("div",{className:"max-w-4xl mx-auto",children:[n.jsxs("div",{className:"flex border-b mb-4",children:[n.jsxs("button",{onClick:()=>d("categories"),className:`px-4 py-2 text-sm font-medium flex items-center ${c==="categories"?"border-b-2 border-primary text-primary":"text-muted-foreground"}`,children:[n.jsx(ne,{className:"h-4 w-4 mr-2"}),"Popular Categories"]}),n.jsxs("button",{onClick:()=>d("custom"),className:`px-4 py-2 text-sm font-medium flex items-center ${c==="custom"?"border-b-2 border-primary text-primary":"text-muted-foreground"}`,children:[n.jsx(_e,{className:"h-4 w-4 mr-2"}),"Custom Keywords"]})]}),c==="categories"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"mb-4",children:[n.jsx("h3",{className:"text-sm font-medium mb-3",children:"Featured Scenario:"}),n.jsxs("button",{onClick:()=>h({title:"Avengers join battle"}),className:"w-full p-3 rounded-lg border border-primary/30 bg-primary/5 hover:bg-primary/10 transition-all flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center",children:[n.jsx("span",{className:"text-2xl mr-3",children:"🦸‍♂️"}),n.jsxs("div",{className:"text-left",children:[n.jsx("div",{className:"font-medium text-sm",children:"Avengers: Join the Battle"}),n.jsx("div",{className:"text-xs text-muted-foreground",children:"Fight alongside Iron Man, Captain America, Thor and Hulk"})]})]}),n.jsx(Wt,{className:"h-5 w-5 text-primary/70"})]})]}),n.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3 mb-4",children:u.map(y=>n.jsxs("button",{onClick:()=>g(y.keywords),disabled:r,className:"flex items-center p-3 rounded-lg border border-border hover:border-primary/50 hover:bg-primary/5 transition-all",children:[n.jsx("span",{className:"text-2xl mr-3",children:y.icon}),n.jsxs("div",{className:"text-left",children:[n.jsx("div",{className:"font-medium text-sm",children:y.name}),n.jsx("div",{className:"text-xs text-muted-foreground",children:y.description})]})]},y.name))}),n.jsxs("div",{className:"mb-6",children:[n.jsx("h3",{className:"text-sm font-medium mb-3",children:"Inspired by Popular Media:"}),n.jsxs("div",{className:"mb-3",children:[n.jsxs("h4",{className:"text-xs text-muted-foreground mb-1.5 flex items-center",children:[n.jsx("span",{className:"mr-1.5",children:"🎬"})," Movies"]}),n.jsx("div",{className:"flex flex-wrap gap-2",children:["Star Wars cantina","Jurassic Park adventure","Matrix digital world","Lord of the Rings quest","Harry Potter wizardry","Mad Max wasteland"].map(y=>n.jsx("button",{onClick:()=>g(y),disabled:r,className:"px-3 py-1 text-xs rounded-full border border-primary/20 hover:bg-primary/10 transition-colors",children:y},y))})]}),n.jsxs("div",{className:"mb-3",children:[n.jsxs("h4",{className:"text-xs text-muted-foreground mb-1.5 flex items-center",children:[n.jsx("span",{className:"mr-1.5",children:"📺"})," TV Shows"]}),n.jsx("div",{className:"flex flex-wrap gap-2",children:["Game of Thrones intrigue","Stranger Things mystery","Breaking Bad tension","The Witcher monster hunt","Star Trek exploration","Walking Dead survival"].map(y=>n.jsx("button",{onClick:()=>g(y),disabled:r,className:"px-3 py-1 text-xs rounded-full border border-primary/20 hover:bg-primary/10 transition-colors",children:y},y))})]}),n.jsxs("div",{children:[n.jsxs("h4",{className:"text-xs text-muted-foreground mb-1.5 flex items-center",children:[n.jsx("span",{className:"mr-1.5",children:"🎮"})," Video Games"]}),n.jsx("div",{className:"flex flex-wrap gap-2",children:["Skyrim adventure","Cyberpunk 2077 heist","Mass Effect alien diplomacy","Fallout wasteland","Zelda dungeon","Minecraft exploration"].map(y=>n.jsx("button",{onClick:()=>g(y),disabled:r,className:"px-3 py-1 text-xs rounded-full border border-primary/20 hover:bg-primary/10 transition-colors",children:y},y))})]})]})]}),c==="custom"&&n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"relative",children:[n.jsx(qr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),n.jsx("input",{type:"text",value:s,onChange:y=>a(y.target.value),placeholder:"Enter keywords (e.g., underwater city, time travel)",className:"w-full pl-10 pr-4 py-3 rounded-md border border-input bg-background",disabled:r})]}),n.jsxs("div",{className:"text-xs text-muted-foreground mb-4",children:[n.jsx("p",{children:"Try to be specific about the setting, time period, and mood. For example:"}),n.jsxs("ul",{className:"list-disc pl-5 mt-1 space-y-1",children:[n.jsx("li",{children:'"Post-apocalyptic desert with mutants and scarce resources"'}),n.jsx("li",{children:'"Victorian London mystery with supernatural elements"'}),n.jsx("li",{children:'"Space station diplomatic mission with alien delegates"'})]})]}),n.jsx("button",{onClick:()=>g(s),disabled:!s.trim()||r,className:"w-full inline-flex items-center justify-center rounded-md bg-primary px-4 py-2.5 text-sm font-medium text-primary-foreground shadow hover:bg-primary/90 disabled:opacity-50",children:r?n.jsx(gs,{className:"h-5 w-5 animate-spin"}):n.jsxs(n.Fragment,{children:[n.jsx(ne,{className:"h-5 w-5 mr-2"}),"Generate Adventures"]})})]})]})]})},Iy=({selectedCharacters:e,onBack:t,onContinue:s})=>{const[a,r]=j.useState(""),[i,o]=j.useState(!1),[l,c]=j.useState([]),[d,u]=j.useState(""),[g,h]=j.useState(null),[p,f]=j.useState("select"),y=[{name:"Fantasy Adventure",keywords:"fantasy, magic, quest, adventure",icon:"🧙‍♂️",description:"Magical quests and epic journeys in fantastical worlds"},{name:"Sci-Fi Exploration",keywords:"sci-fi, space, technology, future",icon:"🚀",description:"Futuristic technology and space exploration"},{name:"Mystery",keywords:"mystery, detective, investigation, clues",icon:"🔍",description:"Solve puzzles and uncover secrets"},{name:"Romance",keywords:"romance, relationship, love, emotion",icon:"❤️",description:"Emotional connections and relationships"},{name:"Historical",keywords:"historical, past, era, period",icon:"📜",description:"Adventures set in different time periods"},{name:"Comedy",keywords:"comedy, humor, funny, jokes",icon:"😂",description:"Light-hearted and humorous interactions"},{name:"Horror",keywords:"horror, scary, suspense, supernatural",icon:"👻",description:"Frightening and suspenseful situations"},{name:"Everyday Life",keywords:"modern, casual, everyday, slice of life",icon:"🏙️",description:"Casual conversations in modern settings"}],N=()=>{const x=y[Math.floor(Math.random()*y.length)];m(x.keywords)},m=x=>{o(!0),r(x),setTimeout(()=>{const k=cs(x);k.prompt=k.prompt+`

`+v(x),k.characters=e,c([k]),h(k),o(!1)},1e3)},v=x=>{x.toLowerCase().split(/[,\s]+/).filter(G=>G.length>2);const k=["morning","afternoon","evening","night","dawn","dusk"][Math.floor(Math.random()*6)],I=["clear","cloudy","rainy","stormy","foggy","snowy"][Math.floor(Math.random()*6)],T=["tense","peaceful","mysterious","exciting","melancholic","joyful"][Math.floor(Math.random()*6)],L={foggy:{evening:"A thick blanket of fog has settled over the area, reducing visibility to mere feet. Streetlights create eerie halos in the mist, and shadows seem to move with a life of their own.",night:"The night is shrouded in a dense fog that swallows all but the closest objects. Lights appear as distant, blurred orbs, and familiar shapes become unrecognizable.",morning:"Morning fog clings to the ground, transforming the landscape into a dreamlike scene. Sunlight struggles to penetrate the haze, casting everything in a soft, diffused glow.",afternoon:"An unusual afternoon fog has rolled in, turning the world gray and muffled. The sun is a pale disc barely visible through the thick mist.",dawn:"The first light of dawn struggles to pierce through the heavy fog, creating an otherworldly atmosphere where silhouettes emerge and fade like ghosts.",dusk:"As dusk falls, the fog thickens, blurring the line between day and night. The last remnants of daylight scatter through the mist, creating an amber glow that quickly fades to gray."},rainy:{evening:"Rain falls steadily in the evening light, drumming on rooftops and forming puddles that reflect the glowing windows of nearby buildings.",night:"The night rain creates a symphony against windows and pavement, while water rushes through gutters and drains. Occasional lightning illuminates the scene in stark flashes.",morning:"Morning rain washes the world clean, droplets catching the early light like countless tiny prisms. The air smells fresh and renewed.",afternoon:"Afternoon showers create a constant patter against leaves and roofs, while gray clouds roll overhead, occasionally parting to let shafts of sunlight through.",dawn:"Rain at dawn creates a misty curtain across the horizon, where the rising sun turns water droplets into gold and copper.",dusk:"The rain intensifies as daylight fades, creating a shimmering veil through which lights begin to glow with haloed intensity."},stormy:{evening:"The evening storm brings powerful gusts that bend trees and scatter debris. Lightning forks across the darkening sky, followed by the deep rumble of thunder.",night:"The night storm rages with fury, lightning transforming night to day in blinding flashes. Thunder shakes the very foundations, and rain lashes horizontally in the howling wind.",morning:"Morning thunderheads tower ominously, casting premature darkness. The air feels charged with electricity as the storm unleashes its power.",afternoon:"The afternoon storm turns day to twilight, with clouds black as ink boiling overhead. Wind-driven rain comes in sheets, and lightning strikes with terrifying proximity.",dawn:"Storm clouds at dawn create a canvas of violent purples and reds, as if the sky itself is bruised. Thunder rolls across the landscape like a warning.",dusk:"The storm intensifies with the coming night, transforming dusk into a chaotic battlefield of elements, with wind, rain, and lightning in constant competition."},clear:{evening:"The clear evening sky transitions through a palette of oranges and purples as the sun sets. The air is still and sounds carry with unusual clarity.",night:"Stars punctuate the clear night sky in their thousands, the Milky Way a misty ribbon across the darkness. The moon casts sharp-edged shadows.",morning:"Morning sunlight streams unobstructed, casting long shadows and highlighting every detail with crystal clarity. The air feels fresh and full of possibility.",afternoon:"The clear afternoon sky is a perfect blue dome, with perhaps a few wispy clouds for contrast. Sunlight bathes everything in warm, golden light.",dawn:"The clear dawn sky is a masterpiece of color, from deep indigo to vibrant orange, with the landscape silhouetted against the brightening horizon.",dusk:"As dusk approaches on this clear day, the western sky becomes a canvas of warm colors, while the east already shows the first stars of evening."},cloudy:{evening:"Clouds hang low in the evening sky, their undersides tinged with the last light of day. The diffused light creates a soft, shadowless landscape.",night:"The cloudy night creates a peculiar half-light as the clouds reflect the glow of distant lights. The moon appears and disappears behind the moving cloud cover.",morning:"Morning clouds create a patchwork of light and shadow as sunlight breaks through gaps, creating spotlights that move across the landscape.",afternoon:"The afternoon sky is a tapestry of clouds in various shades of gray and white, constantly shifting and reshaping in the high-altitude winds.",dawn:"Dawn breaks behind a bank of clouds, sending rays of light shooting upward and turning cloud edges to gold and pink.",dusk:"Clouds at dusk become a spectacular display as they catch the setting sun's rays, turning fiery orange and deep purple against the darkening sky."},snowy:{evening:"Snow falls gently in the evening light, each flake catching the glow from windows and lamps. A hush falls over the world as sound is absorbed by the growing blanket of white.",night:"The night snowfall transforms the darkness, reflecting what little light there is and creating a luminous landscape of soft shapes and deep shadows.",morning:"Morning light sparkles off fresh snow with diamond brilliance. The world is transformed into a clean white canvas unmarked by footprints.",afternoon:"The afternoon snow creates a dreamlike quality as flakes swirl and dance in the wind, accumulating on every surface and softening every edge.",dawn:"Snow at dawn takes on the pink and gold hues of the rising sun, creating a magical landscape that seems to belong to another world.",dusk:"As dusk falls, the snow-covered landscape holds the fading light, glowing with an inner luminescence that defies the coming night."}},P={tense:"Tension hangs in the air like an electrical charge. Conversations are clipped, glances are wary, and everyone seems to be waiting for something to break the strained silence. The atmosphere is thick with unspoken words and suppressed emotions that threaten to erupt at any moment.",peaceful:"A sense of tranquility permeates the scene, allowing for open conversation and genuine connection. The atmosphere encourages reflection and honesty, with a gentle rhythm that soothes rather than excites.",mysterious:"Mystery shrouds the environment, with secrets seemingly hidden in every shadow. Questions outnumber answers, and each new revelation only deepens the enigma. Intuition becomes as valuable as logic in this atmosphere of uncertainty and intrigue.",exciting:"Excitement charges the air with a palpable energy. Possibilities seem endless, and even ordinary moments feel significant. There's a sense that anything could happen, and everyone is fully present in this heightened reality.",melancholic:"A bittersweet melancholy colors every interaction, bringing depth and poignancy to even simple exchanges. There's beauty in this sadness, a shared understanding of life's impermanence that makes connections more meaningful.",joyful:"Joy infuses the atmosphere with warmth and light. Laughter comes easily, barriers fall away, and there's a contagious quality to the happiness that spreads from person to person, making even strangers feel like friends."};let D="";if(e.length>1){const G=[{type:"are old friends",context:"Their shared history provides both comfort and complications, with inside jokes and old wounds equally likely to surface."},{type:"have just met",context:"The awkwardness of new acquaintance is mixed with the excitement of discovery, as they navigate the uncertain territory of first impressions."},{type:"are rivals",context:"Competition colors every interaction, with each measuring themselves against the other. Respect and resentment exist in equal measure."},{type:"are family members",context:"Family bonds bring both obligation and deep understanding. Patterns established years ago still influence their interactions, for better or worse."},{type:"are colleagues",context:"Professional boundaries blur with personal feelings as their work relationship evolves beyond its formal constraints."},{type:"have a complicated history",context:"Unresolved feelings and past events create an undercurrent of tension beneath every exchange, with much left unsaid but still felt."},{type:"are allies by necessity",context:"Circumstance rather than choice has brought them together, creating an uneasy alliance where trust must be earned rather than assumed."}],b=G[Math.floor(Math.random()*G.length)];D=`The characters ${b.type}. ${b.context} `}const q=["Each character harbors their own agenda, creating a complex web of motivations that sometimes align and sometimes conflict. Trust is a valuable currency that not everyone can afford.","Beneath the surface, each person carries private hopes and fears that color their perspective and drive their actions, often in ways they themselves don't fully understand.","Individual desires and goals create an intricate dance of cooperation and competition, with alliances forming and dissolving as circumstances change.","Personal histories influence present actions, as past experiences shape how each character approaches the current situation, sometimes in surprising ways.","Emotional wounds and unmet needs drive behavior more powerfully than logic, creating patterns that persist until they're consciously recognized and addressed."],A=q[Math.floor(Math.random()*q.length)],S=[{challenge:"They must work together to overcome an unexpected obstacle",stakes:"Failure would mean not just personal disappointment, but consequences that would ripple outward to affect many others."},{challenge:"A secret threatens to be revealed that could change everything",stakes:"The truth, once exposed, cannot be unknown, and relationships may be permanently altered by what comes to light."},{challenge:"An important decision must be made that will affect everyone involved",stakes:"Every choice has consequences, and the responsibility of making the right one weighs heavily on those who must decide."},{challenge:"A mysterious stranger has information they desperately need",stakes:"Obtaining this knowledge is essential, but the price demanded may be more than they're willing to pay."},{challenge:"Time is running out to accomplish their shared goal",stakes:"The pressure of the deadline creates both urgency and tension, forcing difficult choices about priorities and sacrifices."},{challenge:"Trust is fragile as motivations remain unclear",stakes:"Misplaced trust could lead to betrayal, while suspicion might damage genuine alliances."}],M=S[Math.floor(Math.random()*S.length)],U=["As the scene unfolds, tensions rise like a gathering storm, with small disagreements escalating into significant conflicts that threaten to shatter the fragile balance.","The situation grows increasingly complex, with each new development adding another layer of tension to an already volatile atmosphere.","What begins as a simple interaction gradually reveals deeper currents of conflict, as hidden agendas and suppressed emotions rise to the surface.","The pressure builds steadily, creating hairline fractures in relationships that could either be repaired or expanded into permanent breaks.","Beneath a veneer of civility, powerful emotions simmer and occasionally boil over, revealing the true nature of the connections between those present."],H=U[Math.floor(Math.random()*U.length)];return`${L[I][k]} ${P[T]} ${D}${A} ${M.challenge}. ${M.stakes} ${H} The characters must navigate their way through this situation, each bringing their own perspective and abilities to bear on the challenges ahead.`},w=()=>{p==="custom"?s({title:"Custom Scenario",prompt:d,description:"A custom scenario created by you",characters:e,background:"linear-gradient(to right, #4568dc, #b06ab3)"}):g&&s(g)};return n.jsxs("div",{className:"container mx-auto py-4 px-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"flex items-center",children:[n.jsxs("button",{onClick:t,className:"mr-3 p-2 rounded-full hover:bg-secondary",children:[n.jsx(Jt,{className:"h-5 w-5"}),n.jsx("span",{className:"sr-only",children:"Back"})]}),n.jsx("h1",{className:"text-2xl font-bold",children:"Choose Scenario"})]}),n.jsxs("div",{className:"flex items-center gap-1 bg-secondary/30 px-3 py-1 rounded-full text-xs",children:[n.jsx("div",{className:"flex -space-x-2 mr-1.5",children:e.slice(0,3).map((x,k)=>n.jsx("div",{className:`w-5 h-5 rounded-full border border-background flex items-center justify-center text-xs ${x.type==="fantasy"?"bg-purple-500/30":x.type==="scifi"?"bg-blue-500/30":x.type==="historical"?"bg-amber-500/30":x.type==="romance"?"bg-pink-500/30":x.type==="adventure"?"bg-orange-500/30":"bg-green-500/30"}`,children:x.name.charAt(0)},k))}),n.jsxs("span",{children:[e.length," character",e.length!==1?"s":""]})]})]}),n.jsxs("div",{className:"flex border-b mb-4",children:[n.jsxs("button",{onClick:()=>f("select"),className:`px-4 py-2 text-sm font-medium flex items-center ${p==="select"?"border-b-2 border-primary text-primary":"text-muted-foreground"}`,children:[n.jsx(ne,{className:"h-4 w-4 mr-2"}),"AI-Generated"]}),n.jsxs("button",{onClick:()=>f("custom"),className:`px-4 py-2 text-sm font-medium flex items-center ${p==="custom"?"border-b-2 border-primary text-primary":"text-muted-foreground"}`,children:[n.jsx(yl,{className:"h-4 w-4 mr-2"}),"Custom"]})]}),p==="select"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"max-w-4xl mx-auto",children:[n.jsxs("div",{className:"mb-6",children:[n.jsxs("div",{className:"relative",children:[n.jsx(qr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),n.jsx("input",{type:"text",value:a,onChange:x=>r(x.target.value),placeholder:"Enter keywords for your scenario (e.g., space pirates, medieval tavern)",className:"w-full pl-10 pr-4 py-3 rounded-md border border-input bg-background",disabled:i}),a&&n.jsx("button",{onClick:()=>r(""),className:"absolute right-14 top-1/2 transform -translate-y-1/2 text-muted-foreground hover:text-foreground",children:n.jsx(lt,{className:"h-4 w-4"})}),n.jsx("button",{onClick:()=>m(a),disabled:!a.trim()||i,className:"absolute right-3 top-1/2 transform -translate-y-1/2 inline-flex items-center justify-center rounded-md bg-primary px-3 py-1 text-xs font-medium text-primary-foreground shadow hover:bg-primary/90 disabled:opacity-50",children:i?n.jsx(gs,{className:"h-4 w-4 animate-spin"}):n.jsxs(n.Fragment,{children:[n.jsx(Xt,{className:"h-3.5 w-3.5 mr-1"}),"Generate"]})})]}),n.jsx("p",{className:"text-xs text-muted-foreground mt-2 ml-1",children:"Choose a category below or enter your own keywords above"})]}),n.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3 mb-6",children:y.map(x=>n.jsxs("button",{onClick:()=>m(x.keywords),disabled:i,className:"flex flex-col items-center justify-center p-3 rounded-lg border border-border hover:border-primary/50 hover:bg-primary/5 transition-all",children:[n.jsx("span",{className:"text-2xl mb-1",children:x.icon}),n.jsx("span",{className:"font-medium text-sm",children:x.name}),n.jsx("p",{className:"text-xs text-muted-foreground text-center line-clamp-1",children:x.description})]},x.name))}),n.jsxs("div",{className:"mb-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("h3",{className:"text-xs font-medium text-muted-foreground",children:"Popular combinations:"}),n.jsxs("button",{onClick:N,disabled:i,className:"inline-flex items-center justify-center rounded-md border border-primary/20 px-2 py-1 text-xs font-medium hover:bg-primary/10 transition-colors",children:[n.jsx(ne,{className:"h-3 w-3 mr-1"}),"Random"]})]}),n.jsx("div",{className:"flex flex-wrap gap-2",children:["Cyberpunk heist","Magical academy","Desert treasure hunt","Space station mystery","Underwater civilization","Time travel adventure"].map(x=>n.jsx("button",{onClick:()=>{r(x),m(x)},disabled:i,className:"px-3 py-1 text-xs rounded-full border border-primary/20 hover:bg-primary/10 transition-colors",children:x},x))})]})]}),l.length>0&&n.jsxs("div",{className:"mt-6 max-w-3xl mx-auto",children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsx("h2",{className:"text-lg font-bold",children:"Your Adventure Scenario"}),n.jsxs("button",{onClick:()=>m(a),className:"inline-flex items-center justify-center rounded-md border border-input bg-background px-3 py-1.5 text-xs font-medium shadow-sm hover:bg-accent hover:text-accent-foreground",children:[n.jsx(gs,{className:"h-3.5 w-3.5 mr-1.5"}),"Generate New"]})]}),n.jsxs("div",{className:"border rounded-lg overflow-hidden border-primary/20 shadow-sm transition-all flex flex-col sm:flex-row",children:[n.jsxs("div",{className:"h-40 sm:w-1/3 sm:h-auto bg-cover bg-center relative",style:l[0].background.startsWith("linear-gradient")?{background:l[0].background}:{backgroundImage:`url(${l[0].background})`},children:[n.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-background/90 to-transparent sm:bg-gradient-to-r sm:from-transparent sm:to-background/70"}),n.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-4 sm:hidden",children:n.jsx("h3",{className:"text-xl font-bold text-white drop-shadow-md",children:l[0].title})})]}),n.jsxs("div",{className:"p-4 flex-1 flex flex-col",children:[n.jsx("h3",{className:"hidden sm:block text-xl font-bold mb-2",children:l[0].title}),n.jsxs("div",{className:"flex border-b mb-3",children:[n.jsx("button",{onClick:()=>{},className:"px-3 py-1.5 text-xs font-medium border-b-2 border-primary text-primary",children:"Overview"}),n.jsx("button",{onClick:()=>{},className:"px-3 py-1.5 text-xs font-medium text-muted-foreground",children:"Details"})]}),n.jsxs("div",{className:"mb-3",children:[n.jsx("h4",{className:"text-xs font-medium text-muted-foreground mb-1",children:"Setting"}),n.jsx("p",{className:"text-sm",children:l[0].description})]}),l[0].prompt&&n.jsxs("div",{className:"mb-3",children:[n.jsx("h4",{className:"text-xs font-medium text-muted-foreground mb-1",children:"Scenario Preview"}),n.jsx("div",{className:"bg-secondary/20 p-3 rounded-md text-sm italic line-clamp-3",children:l[0].prompt.split(`
`)[0]}),n.jsx("button",{className:"text-xs text-primary mt-1 hover:underline",children:"Read more"})]}),n.jsxs("div",{className:"mt-auto",children:[n.jsx("h4",{className:"text-xs font-medium text-muted-foreground mb-1.5",children:"Characters"}),n.jsx("div",{className:"flex flex-wrap gap-1.5",children:l[0].characters.map((x,k)=>n.jsxs("div",{className:"px-2 py-0.5 bg-secondary/30 rounded-md text-xs flex items-center gap-1",children:[n.jsx("div",{className:`w-2 h-2 rounded-full ${x.type==="fantasy"?"bg-purple-500":x.type==="scifi"?"bg-blue-500":x.type==="historical"?"bg-amber-500":x.type==="romance"?"bg-pink-500":x.type==="adventure"?"bg-orange-500":"bg-green-500"}`}),x.name]},k))})]})]})]})]})]}),p==="custom"&&n.jsx("div",{className:"max-w-3xl mx-auto",children:n.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"mb-3",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("h3",{className:"text-sm font-medium",children:"Create Your Scenario"}),n.jsxs("div",{className:"text-xs text-muted-foreground",children:[d.length," characters"]})]}),n.jsxs("div",{className:"mb-3 p-3 border border-primary/20 rounded-md bg-primary/5",children:[n.jsxs("h4",{className:"text-sm font-medium mb-2 flex items-center gap-1",children:[n.jsx(ne,{className:"h-4 w-4 text-primary"}),n.jsx("span",{children:"Enhanced Scene Creation"})]}),n.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"For more immersive AI responses, include rich details about:"}),n.jsxs("ul",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 text-xs mb-2",children:[n.jsxs("li",{className:"flex items-start gap-1.5",children:[n.jsx("span",{className:"text-primary font-bold",children:"•"}),n.jsxs("span",{children:[n.jsx("strong",{children:"Setting:"})," Specific location, time of day, weather"]})]}),n.jsxs("li",{className:"flex items-start gap-1.5",children:[n.jsx("span",{className:"text-primary font-bold",children:"•"}),n.jsxs("span",{children:[n.jsx("strong",{children:"Sensory details:"})," Sights, sounds, smells, textures"]})]}),n.jsxs("li",{className:"flex items-start gap-1.5",children:[n.jsx("span",{className:"text-primary font-bold",children:"•"}),n.jsxs("span",{children:[n.jsx("strong",{children:"Social dynamics:"})," Power relationships, hierarchies"]})]}),n.jsxs("li",{className:"flex items-start gap-1.5",children:[n.jsx("span",{className:"text-primary font-bold",children:"•"}),n.jsxs("span",{children:[n.jsx("strong",{children:"Character motivations:"})," Desires, fears, secrets"]})]}),n.jsxs("li",{className:"flex items-start gap-1.5",children:[n.jsx("span",{className:"text-primary font-bold",children:"•"}),n.jsxs("span",{children:[n.jsx("strong",{children:"Emotional atmosphere:"})," Mood, tensions, undercurrents"]})]}),n.jsxs("li",{className:"flex items-start gap-1.5",children:[n.jsx("span",{className:"text-primary font-bold",children:"•"}),n.jsxs("span",{children:[n.jsx("strong",{children:"Potential interactions:"})," Flirting, arguing, negotiating"]})]})]})]}),n.jsx("textarea",{value:d,onChange:x=>u(x.target.value),placeholder:`Describe your scenario in rich detail. Example:

In the bustling market district of King's Landing during a warm afternoon, the air filled with spices and sea salt. As a respected maester with your loyal direwolf companion, you navigate the crowded streets where nobles and commoners alike regard you with a mixture of reverence and suspicion.

The tension between Lannister and Stark supporters is palpable, with whispered conversations falling silent as you pass. Your goal is to deliver an important message to a mysterious contact, but you sense you're being followed.

Several attractive nobles have caught your eye, including a Tyrell lady in an elegant green dress who keeps glancing your way with interest, and a charming Dornish merchant whose flirtatious smile suggests they might know more than they let on.

The air feels charged with both political intrigue and romantic possibility. Your direwolf seems unusually alert, sensing something - or someone - that you cannot yet perceive.`,className:"w-full px-3 py-2 rounded-md border border-input bg-background min-h-[250px] text-sm"})]}),n.jsxs("div",{className:"mb-4",children:[n.jsx("h4",{className:"text-xs font-medium text-muted-foreground mb-1.5",children:"Characters in this scenario:"}),n.jsx("div",{className:"flex flex-wrap gap-1.5",children:e.map((x,k)=>n.jsxs("div",{className:"px-2 py-0.5 bg-secondary/30 rounded-md text-xs flex items-center gap-1",children:[n.jsx("div",{className:`w-2 h-2 rounded-full ${x.type==="fantasy"?"bg-purple-500":x.type==="scifi"?"bg-blue-500":x.type==="historical"?"bg-amber-500":x.type==="romance"?"bg-pink-500":x.type==="adventure"?"bg-orange-500":"bg-green-500"}`}),x.name]},k))})]})]}),n.jsx("div",{className:"sm:w-64 flex-shrink-0",children:n.jsxs("div",{className:"bg-secondary/10 rounded-md p-3 border border-border/30",children:[n.jsxs("h3",{className:"text-xs font-medium mb-2 flex items-center",children:[n.jsx(ne,{className:"h-3.5 w-3.5 mr-1.5 text-primary"}),"Tips for great scenarios:"]}),n.jsxs("ul",{className:"space-y-1.5 text-xs text-muted-foreground",children:[n.jsxs("li",{className:"flex items-start gap-1.5",children:[n.jsx("span",{className:"text-primary",children:"•"}),n.jsxs("span",{children:[n.jsx("strong",{children:"Rich environmental details"})," create immersion and context for AI responses"]})]}),n.jsxs("li",{className:"flex items-start gap-1.5",children:[n.jsx("span",{className:"text-primary",children:"•"}),n.jsxs("span",{children:[n.jsx("strong",{children:"Sensory descriptions"})," (sights, sounds, smells) make the scene feel real"]})]}),n.jsxs("li",{className:"flex items-start gap-1.5",children:[n.jsx("span",{className:"text-primary",children:"•"}),n.jsxs("span",{children:[n.jsx("strong",{children:"Emotional undercurrents"})," give AI characters emotional context to respond from"]})]}),n.jsxs("li",{className:"flex items-start gap-1.5",children:[n.jsx("span",{className:"text-primary",children:"•"}),n.jsxs("span",{children:[n.jsx("strong",{children:"Character motivations"})," create depth and drive meaningful interactions"]})]}),n.jsxs("li",{className:"flex items-start gap-1.5",children:[n.jsx("span",{className:"text-primary",children:"•"}),n.jsxs("span",{children:[n.jsx("strong",{children:"Rising tensions"})," provide narrative momentum and emotional stakes"]})]}),n.jsxs("li",{className:"flex items-start gap-1.5",children:[n.jsx("span",{className:"text-primary",children:"•"}),n.jsxs("span",{children:[n.jsx("strong",{children:"Specific details"})," are better than general statements"]})]})]}),n.jsxs("div",{className:"mt-3 pt-3 border-t border-border/30",children:[n.jsx("h4",{className:"text-xs font-medium mb-1.5",children:"Example rich scenario:"}),n.jsx("p",{className:"text-xs text-muted-foreground italic",children:'"A thick blanket of fog has settled over the area, reducing visibility to mere feet. Streetlights create eerie halos in the mist, and shadows seem to move with a life of their own. Tension hangs in the air like an electrical charge. Conversations are clipped, glances are wary, and everyone seems to be waiting for something to break the strained silence. The characters have a complicated history. Unresolved feelings and past events create an undercurrent of tension beneath every exchange, with much left unsaid but still felt. Each character harbors their own agenda, creating a complex web of motivations that sometimes align and sometimes conflict. A secret threatens to be revealed that could change everything. The truth, once exposed, cannot be unknown, and relationships may be permanently altered by what comes to light. As the scene unfolds, tensions rise like a gathering storm, with small disagreements escalating into significant conflicts that threaten to shatter the fragile balance."'})]})]})})]})}),n.jsxs("div",{className:"sticky bottom-0 left-0 right-0 bg-background/95 backdrop-blur-sm border-t p-3 flex justify-between items-center mt-6",children:[n.jsxs("div",{className:"flex-1",children:[p==="select"&&g&&n.jsxs("span",{className:"text-xs text-muted-foreground",children:["Ready to start:"," ",n.jsx("span",{className:"font-medium text-foreground",children:g.title})]}),p==="custom"&&d.trim()&&n.jsx("span",{className:"text-xs text-muted-foreground",children:"Custom scenario ready"}),(p==="select"&&!g||p==="custom"&&!d.trim())&&n.jsx("span",{className:"text-xs text-muted-foreground",children:p==="select"?"Generate a scenario to continue":"Enter scenario details to continue"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("button",{onClick:t,className:"inline-flex items-center justify-center rounded-md border border-input bg-background px-3 py-1.5 text-xs font-medium hover:bg-accent hover:text-accent-foreground",children:[n.jsx(Jt,{className:"h-3.5 w-3.5 mr-1.5"}),"Back"]}),n.jsxs("button",{onClick:w,disabled:p==="select"&&!g||p==="custom"&&!d.trim(),className:"inline-flex items-center justify-center rounded-md bg-primary px-3 py-1.5 text-xs font-medium text-primary-foreground shadow hover:bg-primary/90 disabled:opacity-50",children:["Start Chat",n.jsx(gn,{className:"h-3.5 w-3.5 ml-1.5"})]})]})]})]})},Ay=({onComplete:e,onSelectCharacter:t,onCreateScenario:s,onQuickStart:a})=>{const[r,i]=j.useState(1),[o,l]=j.useState([]),[c,d]=j.useState(()=>[...Ns].sort(()=>.5-Math.random()).slice(0,6)),u=4,g=()=>{r<u?i(r+1):e(o)},h=()=>{r>1&&i(r-1)},p=f=>{o.some(y=>y.name===f.name)?l(o.filter(y=>y.name!==f.name)):l([...o,f])};return n.jsxs("div",{className:"min-h-screen flex flex-col",children:[n.jsx("header",{className:"border-b p-4",children:n.jsxs("div",{className:"container mx-auto flex justify-between items-center",children:[n.jsx("h1",{className:"text-2xl font-bold",children:"Welcome to Velora"}),n.jsx("button",{onClick:()=>e(o),className:"text-sm text-muted-foreground hover:text-foreground",children:"Skip Tutorial"})]})}),n.jsx("div",{className:"flex-1 overflow-y-auto",children:n.jsxs("div",{className:"container mx-auto max-w-4xl py-8 px-4",children:[n.jsx("div",{className:"flex items-center justify-center mb-8",children:Array.from({length:u}).map((f,y)=>n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${r>y+1?"bg-primary text-primary-foreground":r===y+1?"bg-primary/90 text-primary-foreground ring-2 ring-primary/30":"bg-secondary text-muted-foreground"}`,children:r>y+1?n.jsx(oe,{className:"h-4 w-4"}):y+1}),y<u-1&&n.jsx("div",{className:`h-1 w-12 ${r>y+1?"bg-primary":"bg-secondary"}`})]},y))}),n.jsxs("div",{className:"bg-card rounded-lg border shadow-sm p-6 mb-8",children:[r===1&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"text-center mb-6",children:[n.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Welcome to Velora!"}),n.jsx("p",{className:"text-muted-foreground",children:"Your portal to living conversations with AI characters"})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"bg-background rounded-lg p-4 border",children:[n.jsxs("div",{className:"flex items-center mb-3",children:[n.jsx(yn,{className:"h-5 w-5 mr-2 text-primary"}),n.jsx("h3",{className:"font-medium",children:"Engage in Dynamic Conversations"})]}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Chat with AI characters that respond naturally and remember context."})]}),n.jsxs("div",{className:"bg-background rounded-lg p-4 border",children:[n.jsxs("div",{className:"flex items-center mb-3",children:[n.jsx(Mt,{className:"h-5 w-5 mr-2 text-primary"}),n.jsx("h3",{className:"font-medium",children:"Create Custom Characters"})]}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Choose from our library or create your own unique characters."})]}),n.jsxs("div",{className:"bg-background rounded-lg p-4 border",children:[n.jsxs("div",{className:"flex items-center mb-3",children:[n.jsx(_e,{className:"h-5 w-5 mr-2 text-primary"}),n.jsx("h3",{className:"font-medium",children:"Generate Scenarios"})]}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Let AI create engaging scenarios based on your keywords and preferences."})]}),n.jsxs("div",{className:"bg-background rounded-lg p-4 border",children:[n.jsxs("div",{className:"flex items-center mb-3",children:[n.jsx(ne,{className:"h-5 w-5 mr-2 text-primary"}),n.jsx("h3",{className:"font-medium",children:"No Login Required"})]}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Start chatting immediately with no account creation or sign-up."})]})]})]}),r===2&&n.jsxs("div",{children:[n.jsxs("div",{className:"text-center mb-6",children:[n.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Choose Your Characters"}),n.jsx("p",{className:"text-muted-foreground",children:"Select characters to chat with or create your own"})]}),n.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4 mb-6",children:c.map(f=>{var y;return n.jsxs("div",{onClick:()=>p(f),className:`rounded-lg border overflow-hidden cursor-pointer transition-all hover:shadow-md ${o.some(N=>N.name===f.name)?"border-primary shadow-md":"border-border hover:border-primary/50"}`,children:[n.jsxs("div",{className:"relative h-32 bg-gradient-to-r from-secondary/50 to-primary/30 flex items-center justify-center overflow-hidden",children:[f.avatar?n.jsx("img",{src:f.avatar,alt:f.name,className:"w-full h-full object-cover"}):n.jsx("div",{className:`w-16 h-16 rounded-full flex items-center justify-center text-2xl ${f.type==="fantasy"?"bg-purple-500":f.type==="scifi"?"bg-blue-500":f.type==="historical"?"bg-amber-500":f.type==="modern"?"bg-green-500":"bg-gray-500"}`,children:f.name.charAt(0)}),o.some(N=>N.name===f.name)&&n.jsx("div",{className:"absolute top-2 right-2 bg-primary text-primary-foreground rounded-full w-6 h-6 flex items-center justify-center shadow-md",children:n.jsx(oe,{className:"h-4 w-4"})})]}),n.jsxs("div",{className:"p-3",children:[n.jsxs("div",{className:"flex items-center justify-between mb-1",children:[n.jsx("h3",{className:"font-medium",children:f.name}),n.jsx("span",{className:"text-xs px-2 py-0.5 bg-secondary rounded-full",children:f.type})]}),n.jsxs("p",{className:"text-xs text-muted-foreground line-clamp-2",children:[((y=f.description)==null?void 0:y.substring(0,80))||"A mysterious character with an unknown background.","..."]})]})]},f.name)})}),n.jsxs("div",{className:"flex justify-center gap-4",children:[n.jsx("button",{onClick:t,className:"inline-flex items-center justify-center rounded-md border border-input bg-background px-4 py-2 text-sm font-medium shadow-sm hover:bg-accent hover:text-accent-foreground",children:"Browse All Characters"}),n.jsxs("button",{onClick:()=>{const f=c.sort(()=>.5-Math.random()).slice(0,3);l(f)},className:"inline-flex items-center justify-center rounded-md border border-input bg-background px-4 py-2 text-sm font-medium shadow-sm hover:bg-accent hover:text-accent-foreground",children:[n.jsx(ne,{className:"h-4 w-4 mr-2"}),"Random Selection"]})]})]}),r===3&&n.jsxs("div",{children:[n.jsxs("div",{className:"text-center mb-6",children:[n.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Choose Your Adventure"}),n.jsx("p",{className:"text-muted-foreground",children:"Select how you want to start your conversation"})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[n.jsxs("div",{onClick:a,className:"bg-background rounded-lg p-6 border hover:border-primary cursor-pointer transition-all hover:shadow-md flex flex-col items-center text-center",children:[n.jsx(ne,{className:"h-10 w-10 mb-4 text-primary"}),n.jsx("h3",{className:"font-medium mb-2",children:"Quick Start"}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Choose from pre-made scenarios based on themes like fantasy, sci-fi, or mystery."})]}),n.jsxs("div",{onClick:s,className:"bg-background rounded-lg p-6 border hover:border-primary cursor-pointer transition-all hover:shadow-md flex flex-col items-center text-center",children:[n.jsx(_e,{className:"h-10 w-10 mb-4 text-primary"}),n.jsx("h3",{className:"font-medium mb-2",children:"AI-Generated"}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Let AI create a custom scenario based on your keywords and preferences."})]}),n.jsxs("div",{onClick:()=>g(),className:"bg-background rounded-lg p-6 border hover:border-primary cursor-pointer transition-all hover:shadow-md flex flex-col items-center text-center",children:[n.jsx(yn,{className:"h-10 w-10 mb-4 text-primary"}),n.jsx("h3",{className:"font-medium mb-2",children:"Just Chat"}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Start a conversation with your selected characters without a specific scenario."})]})]})]}),r===4&&n.jsxs("div",{children:[n.jsxs("div",{className:"text-center mb-6",children:[n.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Chat Tips & Features"}),n.jsx("p",{className:"text-muted-foreground",children:"Get the most out of your Velora experience"})]}),n.jsxs("div",{className:"space-y-4 mb-6",children:[n.jsx("div",{className:"bg-background rounded-lg p-4 border",children:n.jsxs("div",{className:"flex items-start",children:[n.jsx("div",{className:"bg-primary/10 rounded-full p-2 mr-3 mt-1",children:n.jsx("span",{className:"text-lg",children:"*"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium mb-1",children:"Use Asterisks for Actions"}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Type actions between asterisks like *smiles* or *opens the door* to describe physical actions."})]})]})}),n.jsx("div",{className:"bg-background rounded-lg p-4 border",children:n.jsxs("div",{className:"flex items-start",children:[n.jsx("div",{className:"bg-primary/10 rounded-full p-2 mr-3 mt-1",children:n.jsx(tr,{className:"h-5 w-5 text-primary"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium mb-1",children:"Narrate the Scene"}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Use the Narrate button to add scene descriptions or move the story forward."})]})]})}),n.jsx("div",{className:"bg-background rounded-lg p-4 border",children:n.jsxs("div",{className:"flex items-start",children:[n.jsx("div",{className:"bg-primary/10 rounded-full p-2 mr-3 mt-1",children:n.jsx(Mt,{className:"h-5 w-5 text-primary"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium mb-1",children:"Switch Characters"}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"You can speak as yourself or take on the role of any character in the chat."})]})]})}),n.jsx("div",{className:"bg-background rounded-lg p-4 border",children:n.jsxs("div",{className:"flex items-start",children:[n.jsx("div",{className:"bg-primary/10 rounded-full p-2 mr-3 mt-1",children:n.jsx(_e,{className:"h-5 w-5 text-primary"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium mb-1",children:"AI Instructions"}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Guide the AI's writing style, response length, and character behavior using the AI Instructions panel."})]})]})})]})]})]})]})}),n.jsx("footer",{className:"border-t p-4",children:n.jsxs("div",{className:"container mx-auto max-w-4xl flex justify-between",children:[n.jsxs("button",{onClick:h,disabled:r===1,className:"inline-flex items-center justify-center rounded-md border border-input bg-background px-4 py-2 text-sm font-medium shadow-sm hover:bg-accent hover:text-accent-foreground disabled:opacity-50",children:[n.jsx(Jt,{className:"h-4 w-4 mr-2"}),"Back"]}),n.jsxs("div",{className:"flex items-center",children:[n.jsxs("span",{className:"text-sm text-muted-foreground mr-4",children:["Step ",r," of ",u]}),n.jsx("button",{onClick:g,className:"inline-flex items-center justify-center rounded-md bg-primary px-4 py-2 text-sm font-medium text-primary-foreground shadow hover:bg-primary/90",children:r<u?n.jsxs(n.Fragment,{children:["Next",n.jsx(gn,{className:"h-4 w-4 ml-2"})]}):n.jsxs(n.Fragment,{children:["Get Started",n.jsx(gn,{className:"h-4 w-4 ml-2"})]})})]})]})})]})},Ey=({onBack:e})=>{const[t,s]=j.useState("getting-started"),a=r=>{s(r),window.scrollTo(0,0)};return n.jsxs("div",{className:"min-h-screen flex flex-col bg-background",children:[n.jsx("header",{className:"border-b py-3 px-4 bg-background/95 backdrop-blur-sm sticky top-0 z-30 shadow-sm",children:n.jsxs("div",{className:"container mx-auto flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs("button",{onClick:e,className:"p-2 rounded-full hover:bg-secondary/80 transition-colors",title:"Back to Home",children:[n.jsx(Jt,{className:"h-5 w-5"}),n.jsx("span",{className:"sr-only",children:"Back"})]}),n.jsx("h1",{className:"text-xl md:text-2xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-primary to-purple-600",children:"How to Use Velora"})]}),n.jsxs("button",{onClick:e,className:"inline-flex items-center justify-center rounded-full bg-primary/10 px-4 py-1.5 text-sm font-medium text-primary hover:bg-primary/20 transition-colors",children:[n.jsx(Of,{className:"h-4 w-4 mr-1.5"}),"Return Home"]})]})}),n.jsxs("div",{className:"flex flex-col md:flex-row flex-1",children:[n.jsx("aside",{className:"md:w-64 lg:w-72 border-r md:h-[calc(100vh-57px)] md:sticky md:top-[57px] bg-background/95 backdrop-blur-sm",children:n.jsxs("nav",{className:"p-4",children:[n.jsxs("div",{className:"space-y-1",children:[n.jsxs("button",{onClick:()=>a("getting-started"),className:`w-full flex items-center gap-2 px-3 py-2 text-sm rounded-lg transition-colors ${t==="getting-started"?"bg-primary/10 text-primary font-medium":"hover:bg-secondary/50 text-foreground"}`,children:[n.jsx(ne,{className:"h-4 w-4"}),n.jsx("span",{children:"Getting Started"}),t==="getting-started"&&n.jsx(Wt,{className:"h-4 w-4 ml-auto"})]}),n.jsxs("button",{onClick:()=>a("chat-features"),className:`w-full flex items-center gap-2 px-3 py-2 text-sm rounded-lg transition-colors ${t==="chat-features"?"bg-primary/10 text-primary font-medium":"hover:bg-secondary/50 text-foreground"}`,children:[n.jsx(yn,{className:"h-4 w-4"}),n.jsx("span",{children:"Chat Features"}),t==="chat-features"&&n.jsx(Wt,{className:"h-4 w-4 ml-auto"})]}),n.jsxs("button",{onClick:()=>a("creating-content"),className:`w-full flex items-center gap-2 px-3 py-2 text-sm rounded-lg transition-colors ${t==="creating-content"?"bg-primary/10 text-primary font-medium":"hover:bg-secondary/50 text-foreground"}`,children:[n.jsx(_e,{className:"h-4 w-4"}),n.jsx("span",{children:"Creating Content"}),t==="creating-content"&&n.jsx(Wt,{className:"h-4 w-4 ml-auto"})]}),n.jsxs("button",{onClick:()=>a("tips"),className:`w-full flex items-center gap-2 px-3 py-2 text-sm rounded-lg transition-colors ${t==="tips"?"bg-primary/10 text-primary font-medium":"hover:bg-secondary/50 text-foreground"}`,children:[n.jsx(Mr,{className:"h-4 w-4"}),n.jsx("span",{children:"Tips & Tricks"}),t==="tips"&&n.jsx(Wt,{className:"h-4 w-4 ml-auto"})]}),n.jsxs("button",{onClick:()=>a("faq"),className:`w-full flex items-center gap-2 px-3 py-2 text-sm rounded-lg transition-colors ${t==="faq"?"bg-primary/10 text-primary font-medium":"hover:bg-secondary/50 text-foreground"}`,children:[n.jsx(yn,{className:"h-4 w-4"}),n.jsx("span",{children:"FAQ"}),t==="faq"&&n.jsx(Wt,{className:"h-4 w-4 ml-auto"})]})]}),n.jsxs("div",{className:"mt-8 p-4 bg-primary/5 rounded-lg border border-primary/10",children:[n.jsx("h3",{className:"text-sm font-medium mb-2 text-primary",children:"Quick Start"}),n.jsx("p",{className:"text-xs text-muted-foreground mb-3",children:"New to Velora? Watch our quick tutorial to get started in under 2 minutes."}),n.jsxs("button",{onClick:()=>{alert("Video tutorial coming soon!")},className:"w-full flex items-center justify-center gap-2 px-3 py-2 text-xs font-medium rounded-md bg-primary/10 text-primary hover:bg-primary/20 transition-colors",children:[n.jsx(Yf,{className:"h-3 w-3"}),n.jsx("span",{children:"Watch Tutorial"})]})]})]})}),n.jsx("div",{className:"flex-1 overflow-y-auto",children:n.jsxs("div",{className:"container mx-auto max-w-4xl px-4 py-8",children:[t==="getting-started"&&n.jsxs("div",{children:[n.jsxs("div",{className:"mb-8",children:[n.jsx("div",{className:"inline-block bg-primary/10 px-3 py-1 rounded-full text-primary text-sm font-medium mb-3",children:"Guide"}),n.jsx("h2",{className:"text-3xl font-bold mb-4",children:"Welcome to Velora"}),n.jsx("p",{className:"text-lg text-muted-foreground mb-6",children:"Velora is your portal to living conversations with AI characters. This guide will help you get the most out of your experience."})]}),n.jsxs("div",{className:"bg-gradient-to-r from-primary/5 to-purple-500/5 rounded-xl p-6 mb-8",children:[n.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Quick Start Guide"}),n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex gap-4 items-start",children:[n.jsx("div",{className:"w-8 h-8 rounded-full bg-primary/20 flex items-center justify-center text-primary font-bold flex-shrink-0",children:"1"}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium mb-1",children:"Choose how to start"}),n.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Select one of the three options on the home page:"}),n.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 mt-3",children:[n.jsxs("div",{className:"bg-background/80 backdrop-blur-sm rounded-lg p-3 border border-primary/10 flex flex-col items-center text-center",children:[n.jsx(ne,{className:"h-5 w-5 text-primary mb-2"}),n.jsx("span",{className:"text-sm font-medium",children:"Quick Start"}),n.jsx("span",{className:"text-xs text-muted-foreground",children:"Fastest option"})]}),n.jsxs("div",{className:"bg-background/80 backdrop-blur-sm rounded-lg p-3 border border-primary/10 flex flex-col items-center text-center",children:[n.jsx(Mt,{className:"h-5 w-5 text-primary mb-2"}),n.jsx("span",{className:"text-sm font-medium",children:"Select Characters"}),n.jsx("span",{className:"text-xs text-muted-foreground",children:"Choose specific characters"})]}),n.jsxs("div",{className:"bg-background/80 backdrop-blur-sm rounded-lg p-3 border border-primary/10 flex flex-col items-center text-center",children:[n.jsx(_e,{className:"h-5 w-5 text-primary mb-2"}),n.jsx("span",{className:"text-sm font-medium",children:"Create Scenario"}),n.jsx("span",{className:"text-xs text-muted-foreground",children:"Custom experience"})]})]})]})]}),n.jsxs("div",{className:"flex gap-4 items-start",children:[n.jsx("div",{className:"w-8 h-8 rounded-full bg-primary/20 flex items-center justify-center text-primary font-bold flex-shrink-0",children:"2"}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium mb-1",children:"Start chatting"}),n.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Once your chat room is set up, you can:"}),n.jsx("div",{className:"bg-background/80 backdrop-blur-sm rounded-lg p-4 border border-primary/10 mt-2",children:n.jsxs("ul",{className:"space-y-2 text-sm",children:[n.jsxs("li",{className:"flex items-start gap-2",children:[n.jsx(oe,{className:"h-4 w-4 text-primary mt-0.5 flex-shrink-0"}),n.jsx("span",{children:"Type messages as yourself or take on the role of any character"})]}),n.jsxs("li",{className:"flex items-start gap-2",children:[n.jsx(oe,{className:"h-4 w-4 text-primary mt-0.5 flex-shrink-0"}),n.jsx("span",{children:"Use *asterisks* to describe actions (e.g., *smiles warmly*)"})]}),n.jsxs("li",{className:"flex items-start gap-2",children:[n.jsx(oe,{className:"h-4 w-4 text-primary mt-0.5 flex-shrink-0"}),n.jsx("span",{children:"Add narration to set the scene or move the story forward"})]}),n.jsxs("li",{className:"flex items-start gap-2",children:[n.jsx(oe,{className:"h-4 w-4 text-primary mt-0.5 flex-shrink-0"}),n.jsx("span",{children:"Let AI characters respond automatically or prompt specific characters to speak"})]})]})})]})]}),n.jsxs("div",{className:"flex gap-4 items-start",children:[n.jsx("div",{className:"w-8 h-8 rounded-full bg-primary/20 flex items-center justify-center text-primary font-bold flex-shrink-0",children:"3"}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium mb-1",children:"Save your experience"}),n.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"When you're done, you can save your chat to continue later:"}),n.jsxs("div",{className:"bg-background/80 backdrop-blur-sm rounded-lg p-3 border border-primary/10 flex items-center gap-3 mt-2",children:[n.jsx(Ws,{className:"h-5 w-5 text-primary flex-shrink-0"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium",children:'Click "Save Chat" in the top right'}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"Your chat will be downloaded as a JSON file"})]})]})]})]})]})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"bg-card rounded-xl border p-6 shadow-sm",children:[n.jsxs("h3",{className:"text-xl font-semibold mb-3 flex items-center gap-2",children:[n.jsx(ne,{className:"h-5 w-5 text-primary"}),n.jsx("span",{children:"Getting Started"})]}),n.jsx("p",{className:"text-muted-foreground mb-4",children:"Velora offers multiple ways to start a conversation:"}),n.jsxs("ul",{className:"space-y-3 text-sm",children:[n.jsxs("li",{className:"flex items-start",children:[n.jsx("div",{className:"w-6 h-6 rounded-full bg-primary/10 flex items-center justify-center text-primary flex-shrink-0 mt-0.5 mr-2",children:n.jsx(ne,{className:"h-3.5 w-3.5"})}),n.jsxs("span",{children:[n.jsx("strong",{children:"Quick Start:"})," Choose from pre-made scenarios based on themes"]})]}),n.jsxs("li",{className:"flex items-start",children:[n.jsx("div",{className:"w-6 h-6 rounded-full bg-primary/10 flex items-center justify-center text-primary flex-shrink-0 mt-0.5 mr-2",children:n.jsx(Mt,{className:"h-3.5 w-3.5"})}),n.jsxs("span",{children:[n.jsx("strong",{children:"Select Characters:"})," Browse and choose specific characters to chat with"]})]}),n.jsxs("li",{className:"flex items-start",children:[n.jsx("div",{className:"w-6 h-6 rounded-full bg-primary/10 flex items-center justify-center text-primary flex-shrink-0 mt-0.5 mr-2",children:n.jsx(_e,{className:"h-3.5 w-3.5"})}),n.jsxs("span",{children:[n.jsx("strong",{children:"Create Custom Scenario:"})," Design your own scenario or let AI generate one"]})]})]})]}),n.jsxs("div",{className:"bg-card rounded-xl border p-6 shadow-sm",children:[n.jsxs("h3",{className:"text-xl font-semibold mb-3 flex items-center gap-2",children:[n.jsx(un,{className:"h-5 w-5 text-primary"}),n.jsx("span",{children:"No Login Required"})]}),n.jsx("p",{className:"text-muted-foreground mb-4",children:"Velora is designed for immediate use without any account creation:"}),n.jsxs("ul",{className:"space-y-3 text-sm",children:[n.jsxs("li",{className:"flex items-start",children:[n.jsx("div",{className:"w-6 h-6 rounded-full bg-primary/10 flex items-center justify-center text-primary flex-shrink-0 mt-0.5 mr-2",children:n.jsx(Ws,{className:"h-3.5 w-3.5"})}),n.jsxs("span",{children:[n.jsx("strong",{children:"Save Chats:"})," Download your conversations as JSON files to continue later"]})]}),n.jsxs("li",{className:"flex items-start",children:[n.jsx("div",{className:"w-6 h-6 rounded-full bg-primary/10 flex items-center justify-center text-primary flex-shrink-0 mt-0.5 mr-2",children:n.jsx(un,{className:"h-3.5 w-3.5"})}),n.jsxs("span",{children:[n.jsx("strong",{children:"Upload Chats:"})," Resume previous conversations by uploading saved files"]})]}),n.jsxs("li",{className:"flex items-start",children:[n.jsx("div",{className:"w-6 h-6 rounded-full bg-primary/10 flex items-center justify-center text-primary flex-shrink-0 mt-0.5 mr-2",children:n.jsx(oe,{className:"h-3.5 w-3.5"})}),n.jsxs("span",{children:[n.jsx("strong",{children:"Private:"})," All conversations stay on your device unless you choose to save them"]})]})]})]})]})]}),t==="chat-features"&&n.jsxs("div",{children:[n.jsxs("div",{className:"mb-8",children:[n.jsx("div",{className:"inline-block bg-primary/10 px-3 py-1 rounded-full text-primary text-sm font-medium mb-3",children:"Features"}),n.jsx("h2",{className:"text-3xl font-bold mb-4",children:"Chat Features"}),n.jsx("p",{className:"text-lg text-muted-foreground mb-6",children:"Velora offers a rich set of features to make your conversations engaging and immersive."})]}),n.jsxs("div",{className:"bg-background/60 backdrop-blur-md rounded-xl border border-primary/20 shadow-lg overflow-hidden mb-8",children:[n.jsx("div",{className:"p-4 border-b border-primary/10 flex items-center justify-between",children:n.jsx("h3",{className:"font-medium",children:"Chat Interface Overview"})}),n.jsxs("div",{className:"p-6",children:[n.jsx("div",{className:"bg-secondary/10 rounded-xl p-6 mb-6",children:n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium mb-3",children:"Message Area"}),n.jsxs("ul",{className:"space-y-2 text-sm",children:[n.jsxs("li",{className:"flex items-start gap-2",children:[n.jsx(oe,{className:"h-4 w-4 text-primary mt-0.5 flex-shrink-0"}),n.jsxs("span",{children:[n.jsx("strong",{children:"Character Messages:"})," Messages from AI characters appear on the left"]})]}),n.jsxs("li",{className:"flex items-start gap-2",children:[n.jsx(oe,{className:"h-4 w-4 text-primary mt-0.5 flex-shrink-0"}),n.jsxs("span",{children:[n.jsx("strong",{children:"Your Messages:"})," Your messages appear on the right"]})]}),n.jsxs("li",{className:"flex items-start gap-2",children:[n.jsx(oe,{className:"h-4 w-4 text-primary mt-0.5 flex-shrink-0"}),n.jsxs("span",{children:[n.jsx("strong",{children:"System Messages:"})," Narration and scene descriptions appear centered"]})]})]})]}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium mb-3",children:"Input Area"}),n.jsxs("ul",{className:"space-y-2 text-sm",children:[n.jsxs("li",{className:"flex items-start gap-2",children:[n.jsx(oe,{className:"h-4 w-4 text-primary mt-0.5 flex-shrink-0"}),n.jsxs("span",{children:[n.jsx("strong",{children:"Character Selection:"})," Choose which character you're speaking as"]})]}),n.jsxs("li",{className:"flex items-start gap-2",children:[n.jsx(oe,{className:"h-4 w-4 text-primary mt-0.5 flex-shrink-0"}),n.jsxs("span",{children:[n.jsx("strong",{children:"Message Input:"})," Type your message or actions"]})]}),n.jsxs("li",{className:"flex items-start gap-2",children:[n.jsx(oe,{className:"h-4 w-4 text-primary mt-0.5 flex-shrink-0"}),n.jsxs("span",{children:[n.jsx("strong",{children:"Quick Actions:"})," Access common actions like narration"]})]})]})]})]})}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[n.jsxs("div",{className:"bg-background/80 backdrop-blur-sm rounded-lg border border-primary/10 p-4",children:[n.jsx("div",{className:"w-8 h-8 rounded-full bg-primary/20 flex items-center justify-center text-primary mb-3",children:n.jsx(yn,{className:"h-4 w-4"})}),n.jsx("h4",{className:"font-medium mb-2",children:"Character Messages"}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Messages from AI characters appear with their name and avatar."})]}),n.jsxs("div",{className:"bg-background/80 backdrop-blur-sm rounded-lg border border-primary/10 p-4",children:[n.jsx("div",{className:"w-8 h-8 rounded-full bg-primary/20 flex items-center justify-center text-primary mb-3",children:n.jsx(tr,{className:"h-4 w-4"})}),n.jsx("h4",{className:"font-medium mb-2",children:"Narration"}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Add scene descriptions and narrative elements to set the mood."})]}),n.jsxs("div",{className:"bg-background/80 backdrop-blur-sm rounded-lg border border-primary/10 p-4",children:[n.jsx("div",{className:"w-8 h-8 rounded-full bg-primary/20 flex items-center justify-center text-primary mb-3",children:n.jsx(ne,{className:"h-4 w-4"})}),n.jsx("h4",{className:"font-medium mb-2",children:"Actions"}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Use *asterisks* to describe actions your character is taking."})]})]})]})]}),n.jsxs("div",{className:"space-y-6 mb-8",children:[n.jsx("h3",{className:"text-xl font-semibold",children:"Key Chat Features"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"bg-card rounded-xl border p-6 shadow-sm",children:[n.jsxs("h4",{className:"text-lg font-medium mb-3 flex items-center gap-2",children:[n.jsx(ne,{className:"h-5 w-5 text-primary"}),n.jsx("span",{children:"Character Actions"})]}),n.jsx("p",{className:"text-muted-foreground mb-4 text-sm",children:"Make your conversations more immersive by including actions:"}),n.jsxs("div",{className:"bg-secondary/20 rounded-lg p-4 mb-4",children:[n.jsx("p",{className:"text-sm font-medium mb-1",children:"Example:"}),n.jsx("p",{className:"text-sm",children:"Hello there! *extends hand for a handshake* I'm Captain Alex."})]}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"Simply wrap your actions in asterisks (*) to distinguish them from regular speech."})]}),n.jsxs("div",{className:"bg-card rounded-xl border p-6 shadow-sm",children:[n.jsxs("h4",{className:"text-lg font-medium mb-3 flex items-center gap-2",children:[n.jsx(tr,{className:"h-5 w-5 text-primary"}),n.jsx("span",{children:"Narration"})]}),n.jsx("p",{className:"text-muted-foreground mb-4 text-sm",children:"Add narrative elements to set the scene or advance the story:"}),n.jsxs("div",{className:"bg-secondary/20 rounded-lg p-4 mb-4",children:[n.jsx("p",{className:"text-sm font-medium mb-1",children:"How to use:"}),n.jsxs("p",{className:"text-sm",children:['1. Click the "Narrate" button',n.jsx("br",{}),"2. Type your narration",n.jsx("br",{}),"3. Send to add it to the chat"]})]}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"Narration appears centered in the chat and is styled differently from regular messages."})]}),n.jsxs("div",{className:"bg-card rounded-xl border p-6 shadow-sm",children:[n.jsxs("h4",{className:"text-lg font-medium mb-3 flex items-center gap-2",children:[n.jsx(Xt,{className:"h-5 w-5 text-primary"}),n.jsx("span",{children:"AI Character Turns"})]}),n.jsx("p",{className:"text-muted-foreground mb-4 text-sm",children:"Let AI characters take their turn in the conversation:"}),n.jsxs("div",{className:"bg-secondary/20 rounded-lg p-4 mb-4",children:[n.jsx("p",{className:"text-sm font-medium mb-1",children:"Two ways to use:"}),n.jsxs("p",{className:"text-sm",children:['1. Click "AI Turn" and select a character',n.jsx("br",{}),'2. Toggle "Auto-respond" for automatic replies']})]}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"Characters will respond based on the conversation context and their personality."})]}),n.jsxs("div",{className:"bg-card rounded-xl border p-6 shadow-sm",children:[n.jsxs("h4",{className:"text-lg font-medium mb-3 flex items-center gap-2",children:[n.jsx(Vc,{className:"h-5 w-5 text-primary"}),n.jsx("span",{children:"AI Style Instructions"})]}),n.jsx("p",{className:"text-muted-foreground mb-4 text-sm",children:"Guide how AI characters respond to you:"}),n.jsxs("div",{className:"bg-secondary/20 rounded-lg p-4 mb-4",children:[n.jsx("p",{className:"text-sm font-medium mb-1",children:"Example instructions:"}),n.jsxs("p",{className:"text-sm",children:['"Respond in a poetic style"',n.jsx("br",{}),'"Keep responses brief and mysterious"',n.jsx("br",{}),'"Include technical jargon in your answers"']})]}),n.jsx("p",{className:"text-xs text-muted-foreground",children:'Click the "AI Style" button to set custom instructions for AI responses.'})]})]})]}),n.jsxs("div",{className:"bg-gradient-to-r from-primary/5 to-purple-500/5 rounded-xl p-6",children:[n.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Advanced Features"}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"bg-background/80 backdrop-blur-sm rounded-lg border border-primary/10 p-4 flex gap-4",children:[n.jsx("div",{className:"w-10 h-10 rounded-full bg-primary/20 flex items-center justify-center text-primary flex-shrink-0",children:n.jsx(Mr,{className:"h-5 w-5"})}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium mb-1",children:"What Next? Suggestions"}),n.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:'Not sure where to take the conversation? Use the "What Next?" feature to get AI-generated suggestions.'}),n.jsx("p",{className:"text-xs text-primary",children:"Click the lightbulb icon in the chat interface to see suggestions."})]})]}),n.jsxs("div",{className:"bg-background/80 backdrop-blur-sm rounded-lg border border-primary/10 p-4 flex gap-4",children:[n.jsx("div",{className:"w-10 h-10 rounded-full bg-primary/20 flex items-center justify-center text-primary flex-shrink-0",children:n.jsx(ne,{className:"h-5 w-5"})}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium mb-1",children:"Scene Transitions"}),n.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Add atmospheric scene transitions to indicate the passage of time or changes in the environment."}),n.jsx("p",{className:"text-xs text-primary",children:'Click "Scene Transition" to add a random transition to your chat.'})]})]}),n.jsxs("div",{className:"bg-background/80 backdrop-blur-sm rounded-lg border border-primary/10 p-4 flex gap-4",children:[n.jsx("div",{className:"w-10 h-10 rounded-full bg-primary/20 flex items-center justify-center text-primary flex-shrink-0",children:n.jsx(Ws,{className:"h-5 w-5"})}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium mb-1",children:"Saving & Continuing Chats"}),n.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Save your conversations to continue them later or share with friends."}),n.jsx("p",{className:"text-xs text-primary",children:"Click the download icon in the chat header to save your chat as a JSON file."})]})]})]})]})]}),t==="creating-content"&&n.jsxs("div",{children:[n.jsxs("div",{className:"mb-8",children:[n.jsx("div",{className:"inline-block bg-primary/10 px-3 py-1 rounded-full text-primary text-sm font-medium mb-3",children:"Create"}),n.jsx("h2",{className:"text-3xl font-bold mb-4",children:"Creating Content"}),n.jsx("p",{className:"text-lg text-muted-foreground mb-6",children:"Learn how to create custom characters and scenarios to make your Velora experience uniquely yours."})]}),n.jsxs("div",{className:"bg-background/60 backdrop-blur-md rounded-xl border border-primary/20 shadow-lg overflow-hidden mb-8",children:[n.jsx("div",{className:"p-4 border-b border-primary/10 flex items-center justify-between",children:n.jsx("h3",{className:"font-medium",children:"Character Creation"})}),n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[n.jsxs("div",{children:[n.jsxs("h4",{className:"text-lg font-medium mb-4 flex items-center gap-2",children:[n.jsx(Mt,{className:"h-5 w-5 text-primary"}),n.jsx("span",{children:"Creating Characters"})]}),n.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Velora offers two ways to create characters:"}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"bg-secondary/10 rounded-lg p-4",children:[n.jsx("h5",{className:"font-medium mb-2 text-sm",children:"AI-Generated Characters"}),n.jsxs("ol",{className:"space-y-2 text-sm list-decimal pl-4",children:[n.jsx("li",{children:'Click "Select Characters" on the home page'}),n.jsx("li",{children:'Choose "Generate Character with AI"'}),n.jsx("li",{children:"Enter keywords describing the character you want"}),n.jsx("li",{children:"Review and edit the generated character"}),n.jsx("li",{children:'Click "Add to Chat" to include them'})]})]}),n.jsxs("div",{className:"bg-secondary/10 rounded-lg p-4",children:[n.jsx("h5",{className:"font-medium mb-2 text-sm",children:"Custom Characters"}),n.jsxs("ol",{className:"space-y-2 text-sm list-decimal pl-4",children:[n.jsx("li",{children:'Click "Select Characters" on the home page'}),n.jsx("li",{children:'Choose "Create Custom Character"'}),n.jsx("li",{children:"Fill in the character details manually"}),n.jsx("li",{children:'Click "Add to Chat" when finished'})]})]})]})]}),n.jsxs("div",{className:"bg-gradient-to-r from-primary/5 to-purple-500/5 rounded-xl p-6",children:[n.jsx("h4",{className:"font-medium mb-4",children:"Character Properties"}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"bg-background/80 backdrop-blur-sm rounded-lg border border-primary/10 p-3",children:[n.jsx("h5",{className:"text-sm font-medium mb-1",children:"Name"}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"The character's full name"})]}),n.jsxs("div",{className:"bg-background/80 backdrop-blur-sm rounded-lg border border-primary/10 p-3",children:[n.jsx("h5",{className:"text-sm font-medium mb-1",children:"Description"}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"Physical appearance, age, and other visual details"})]}),n.jsxs("div",{className:"bg-background/80 backdrop-blur-sm rounded-lg border border-primary/10 p-3",children:[n.jsx("h5",{className:"text-sm font-medium mb-1",children:"Personality"}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"Character traits, quirks, and behavioral patterns"})]}),n.jsxs("div",{className:"bg-background/80 backdrop-blur-sm rounded-lg border border-primary/10 p-3",children:[n.jsx("h5",{className:"text-sm font-medium mb-1",children:"Background"}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"History, origins, and important life events"})]}),n.jsxs("div",{className:"bg-background/80 backdrop-blur-sm rounded-lg border border-primary/10 p-3",children:[n.jsx("h5",{className:"text-sm font-medium mb-1",children:"Voice"}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"How the character speaks, including accent, vocabulary, and speech patterns"})]})]})]})]}),n.jsxs("div",{className:"mt-6 bg-primary/5 rounded-lg p-4 border border-primary/10",children:[n.jsxs("h5",{className:"font-medium mb-2 flex items-center gap-2",children:[n.jsx(ne,{className:"h-4 w-4 text-primary"}),n.jsx("span",{children:"Pro Tip: Character Creation"})]}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"For the most engaging characters, include contradictions and flaws. Perfect characters are less interesting than those with internal conflicts and room to grow."})]})]})]}),n.jsxs("div",{className:"bg-background/60 backdrop-blur-md rounded-xl border border-primary/20 shadow-lg overflow-hidden mb-8",children:[n.jsx("div",{className:"p-4 border-b border-primary/10 flex items-center justify-between",children:n.jsx("h3",{className:"font-medium",children:"Scenario Creation"})}),n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[n.jsxs("div",{children:[n.jsxs("h4",{className:"text-lg font-medium mb-4 flex items-center gap-2",children:[n.jsx(_e,{className:"h-5 w-5 text-primary"}),n.jsx("span",{children:"Creating Scenarios"})]}),n.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Scenarios set the stage for your conversations. Here's how to create them:"}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"bg-secondary/10 rounded-lg p-4",children:[n.jsx("h5",{className:"font-medium mb-2 text-sm",children:"AI-Generated Scenarios"}),n.jsxs("ol",{className:"space-y-2 text-sm list-decimal pl-4",children:[n.jsx("li",{children:'Click "Create Scenario" on the home page'}),n.jsx("li",{children:"Enter keywords describing the scenario you want"}),n.jsx("li",{children:"Review and edit the generated scenario"}),n.jsx("li",{children:'Click "Continue" to select or create characters'}),n.jsx("li",{children:'Click "Start Chat" when ready'})]})]}),n.jsxs("div",{className:"bg-secondary/10 rounded-lg p-4",children:[n.jsx("h5",{className:"font-medium mb-2 text-sm",children:"Custom Scenarios"}),n.jsxs("ol",{className:"space-y-2 text-sm list-decimal pl-4",children:[n.jsx("li",{children:'Click "Create Scenario" on the home page'}),n.jsx("li",{children:'Choose "Create Custom Scenario"'}),n.jsx("li",{children:"Fill in the scenario details manually"}),n.jsx("li",{children:'Click "Continue" to select or create characters'}),n.jsx("li",{children:'Click "Start Chat" when ready'})]})]})]})]}),n.jsxs("div",{children:[n.jsxs("div",{className:"bg-gradient-to-r from-primary/5 to-purple-500/5 rounded-xl p-6 mb-6",children:[n.jsx("h4",{className:"font-medium mb-4",children:"Scenario Elements"}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"bg-background/80 backdrop-blur-sm rounded-lg border border-primary/10 p-3",children:[n.jsx("h5",{className:"text-sm font-medium mb-1",children:"Setting"}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"Where and when the scenario takes place"})]}),n.jsxs("div",{className:"bg-background/80 backdrop-blur-sm rounded-lg border border-primary/10 p-3",children:[n.jsx("h5",{className:"text-sm font-medium mb-1",children:"Situation"}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"The current circumstances or problem to be addressed"})]}),n.jsxs("div",{className:"bg-background/80 backdrop-blur-sm rounded-lg border border-primary/10 p-3",children:[n.jsx("h5",{className:"text-sm font-medium mb-1",children:"Mood"}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"The emotional tone of the scenario (tense, lighthearted, mysterious, etc.)"})]})]})]}),n.jsxs("div",{className:"bg-card rounded-lg border p-4",children:[n.jsx("h4",{className:"font-medium mb-3",children:"Example Scenario Keywords"}),n.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[n.jsx("div",{className:"bg-secondary/20 rounded p-2",children:"space exploration, alien encounter, diplomatic mission"}),n.jsx("div",{className:"bg-secondary/20 rounded p-2",children:"medieval tavern, adventurers, quest planning"}),n.jsx("div",{className:"bg-secondary/20 rounded p-2",children:"cyberpunk city, corporate espionage, rogue AI"}),n.jsx("div",{className:"bg-secondary/20 rounded p-2",children:"haunted mansion, paranormal investigators, mystery"}),n.jsx("div",{className:"bg-secondary/20 rounded p-2",children:"royal court, political intrigue, secret alliance"}),n.jsx("div",{className:"bg-secondary/20 rounded p-2",children:"desert oasis, travelers, ancient artifact"})]})]})]})]}),n.jsxs("div",{className:"mt-6 bg-primary/5 rounded-lg p-4 border border-primary/10",children:[n.jsxs("h5",{className:"font-medium mb-2 flex items-center gap-2",children:[n.jsx(ne,{className:"h-4 w-4 text-primary"}),n.jsx("span",{children:"Pro Tip: Scenario Creation"})]}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"The best scenarios have clear stakes but leave room for character choices. Include a situation that needs resolution but don't prescribe exactly how it should be solved."})]})]})]}),n.jsxs("div",{className:"bg-gradient-to-r from-primary/5 to-purple-500/5 rounded-xl p-6",children:[n.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Quick Start Templates"}),n.jsx("p",{className:"text-sm text-muted-foreground mb-6",children:"Not sure where to begin? Try one of these pre-made templates to get started quickly:"}),n.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",children:[n.jsxs("div",{className:"bg-background/80 backdrop-blur-sm rounded-lg border border-primary/10 p-4",children:[n.jsx("h4",{className:"font-medium mb-2",children:"Space Adventure"}),n.jsx("p",{className:"text-xs text-muted-foreground mb-3",children:"Explore the cosmos with a crew of diverse characters aboard a starship."}),n.jsx("div",{className:"text-xs text-primary",children:"Available in Quick Start"})]}),n.jsxs("div",{className:"bg-background/80 backdrop-blur-sm rounded-lg border border-primary/10 p-4",children:[n.jsx("h4",{className:"font-medium mb-2",children:"Fantasy Quest"}),n.jsx("p",{className:"text-xs text-muted-foreground mb-3",children:"Join a party of adventurers in a magical world filled with wonder and danger."}),n.jsx("div",{className:"text-xs text-primary",children:"Available in Quick Start"})]}),n.jsxs("div",{className:"bg-background/80 backdrop-blur-sm rounded-lg border border-primary/10 p-4",children:[n.jsx("h4",{className:"font-medium mb-2",children:"Detective Mystery"}),n.jsx("p",{className:"text-xs text-muted-foreground mb-3",children:"Solve a perplexing case with a team of investigators in a noir-inspired setting."}),n.jsx("div",{className:"text-xs text-primary",children:"Available in Quick Start"})]})]})]})]}),t==="tips"&&n.jsxs("div",{children:[n.jsxs("div",{className:"mb-8",children:[n.jsx("div",{className:"inline-block bg-primary/10 px-3 py-1 rounded-full text-primary text-sm font-medium mb-3",children:"Tips"}),n.jsx("h2",{className:"text-3xl font-bold mb-4",children:"Tips & Tricks"}),n.jsx("p",{className:"text-lg text-muted-foreground mb-6",children:"Master Velora with these expert tips and tricks to create more engaging conversations."})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[n.jsxs("div",{className:"bg-card rounded-xl border p-6 shadow-sm",children:[n.jsxs("h3",{className:"text-lg font-medium mb-3 flex items-center gap-2",children:[n.jsx(ne,{className:"h-5 w-5 text-primary"}),n.jsx("span",{children:"Creating Engaging Conversations"})]}),n.jsxs("ul",{className:"space-y-3 text-sm",children:[n.jsxs("li",{className:"flex items-start gap-2",children:[n.jsx("div",{className:"w-5 h-5 rounded-full bg-primary/20 flex items-center justify-center text-primary flex-shrink-0 mt-0.5",children:n.jsx(oe,{className:"h-3 w-3"})}),n.jsxs("span",{children:[n.jsx("strong",{children:"Ask open-ended questions"}),` that can't be answered with just "yes" or "no"`]})]}),n.jsxs("li",{className:"flex items-start gap-2",children:[n.jsx("div",{className:"w-5 h-5 rounded-full bg-primary/20 flex items-center justify-center text-primary flex-shrink-0 mt-0.5",children:n.jsx(oe,{className:"h-3 w-3"})}),n.jsxs("span",{children:[n.jsx("strong",{children:"Include actions"})," to make your messages more dynamic and expressive"]})]}),n.jsxs("li",{className:"flex items-start gap-2",children:[n.jsx("div",{className:"w-5 h-5 rounded-full bg-primary/20 flex items-center justify-center text-primary flex-shrink-0 mt-0.5",children:n.jsx(oe,{className:"h-3 w-3"})}),n.jsxs("span",{children:[n.jsx("strong",{children:"React to what characters say"})," rather than changing the subject abruptly"]})]}),n.jsxs("li",{className:"flex items-start gap-2",children:[n.jsx("div",{className:"w-5 h-5 rounded-full bg-primary/20 flex items-center justify-center text-primary flex-shrink-0 mt-0.5",children:n.jsx(oe,{className:"h-3 w-3"})}),n.jsxs("span",{children:[n.jsx("strong",{children:"Create moments of tension"})," by introducing challenges or conflicts"]})]})]})]}),n.jsxs("div",{className:"bg-card rounded-xl border p-6 shadow-sm",children:[n.jsxs("h3",{className:"text-lg font-medium mb-3 flex items-center gap-2",children:[n.jsx(_e,{className:"h-5 w-5 text-primary"}),n.jsx("span",{children:"Advanced Character Interactions"})]}),n.jsxs("ul",{className:"space-y-3 text-sm",children:[n.jsxs("li",{className:"flex items-start gap-2",children:[n.jsx("div",{className:"w-5 h-5 rounded-full bg-primary/20 flex items-center justify-center text-primary flex-shrink-0 mt-0.5",children:n.jsx(oe,{className:"h-3 w-3"})}),n.jsxs("span",{children:[n.jsx("strong",{children:"Switch between characters"})," to create dialogue between multiple AI characters"]})]}),n.jsxs("li",{className:"flex items-start gap-2",children:[n.jsx("div",{className:"w-5 h-5 rounded-full bg-primary/20 flex items-center justify-center text-primary flex-shrink-0 mt-0.5",children:n.jsx(oe,{className:"h-3 w-3"})}),n.jsxs("span",{children:[n.jsx("strong",{children:"Use narration"})," to set the scene or advance time in the story"]})]}),n.jsxs("li",{className:"flex items-start gap-2",children:[n.jsx("div",{className:"w-5 h-5 rounded-full bg-primary/20 flex items-center justify-center text-primary flex-shrink-0 mt-0.5",children:n.jsx(oe,{className:"h-3 w-3"})}),n.jsxs("span",{children:[n.jsx("strong",{children:"Customize AI instructions"})," to guide the tone and style of responses"]})]}),n.jsxs("li",{className:"flex items-start gap-2",children:[n.jsx("div",{className:"w-5 h-5 rounded-full bg-primary/20 flex items-center justify-center text-primary flex-shrink-0 mt-0.5",children:n.jsx(oe,{className:"h-3 w-3"})}),n.jsxs("span",{children:[n.jsx("strong",{children:'Use "What Next?" suggestions'})," when you're not sure how to proceed"]})]})]})]})]}),n.jsxs("div",{className:"bg-gradient-to-r from-primary/5 to-purple-500/5 rounded-xl p-6 mb-8",children:[n.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Pro Tips for Immersive Experiences"}),n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"bg-background/80 backdrop-blur-sm rounded-lg border border-primary/10 p-4",children:[n.jsxs("h4",{className:"font-medium mb-3 flex items-center gap-2",children:[n.jsx(ne,{className:"h-5 w-5 text-primary"}),n.jsx("span",{children:"Creating Story Arcs"})]}),n.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"Structure your conversations to follow a narrative arc for more satisfying experiences:"}),n.jsxs("ol",{className:"space-y-2 text-sm list-decimal pl-4",children:[n.jsxs("li",{children:[n.jsx("strong",{children:"Introduction:"})," Establish the setting and characters"]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Rising Action:"})," Introduce a problem or challenge"]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Climax:"})," Reach a critical moment or decision point"]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Resolution:"})," Resolve the situation and reflect on outcomes"]})]})]}),n.jsxs("div",{className:"bg-background/80 backdrop-blur-sm rounded-lg border border-primary/10 p-4",children:[n.jsxs("h4",{className:"font-medium mb-3 flex items-center gap-2",children:[n.jsx(Vc,{className:"h-5 w-5 text-primary"}),n.jsx("span",{children:"Writing Effective AI Instructions"})]}),n.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"Customize how AI characters respond with these instruction patterns:"}),n.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[n.jsx("div",{className:"bg-secondary/20 rounded p-2 text-xs",children:'"Respond in a [style] manner with [specific details]"'}),n.jsx("div",{className:"bg-secondary/20 rounded p-2 text-xs",children:'"Keep your responses [length] and focus on [topic]"'}),n.jsx("div",{className:"bg-secondary/20 rounded p-2 text-xs",children:'"Include [specific elements] in your responses"'}),n.jsx("div",{className:"bg-secondary/20 rounded p-2 text-xs",children:'"Avoid [specific topics] and emphasize [preferred topics]"'})]})]})]})]}),n.jsxs("div",{className:"bg-card rounded-xl border p-6 shadow-sm",children:[n.jsxs("h3",{className:"text-lg font-medium mb-4 flex items-center gap-2",children:[n.jsx(Xt,{className:"h-5 w-5 text-primary"}),n.jsx("span",{children:"Keyboard Shortcuts"})]}),n.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Speed up your interactions with these helpful keyboard shortcuts:"}),n.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 text-sm",children:[n.jsxs("div",{className:"flex justify-between items-center p-2 bg-secondary/10 rounded",children:[n.jsx("span",{children:"Send message"}),n.jsx("span",{className:"font-mono bg-secondary/30 px-2 py-0.5 rounded text-xs",children:"Enter"})]}),n.jsxs("div",{className:"flex justify-between items-center p-2 bg-secondary/10 rounded",children:[n.jsx("span",{children:"New line in message"}),n.jsx("span",{className:"font-mono bg-secondary/30 px-2 py-0.5 rounded text-xs",children:"Shift + Enter"})]}),n.jsxs("div",{className:"flex justify-between items-center p-2 bg-secondary/10 rounded",children:[n.jsx("span",{children:"Toggle narration mode"}),n.jsx("span",{className:"font-mono bg-secondary/30 px-2 py-0.5 rounded text-xs",children:"Alt + N"})]}),n.jsxs("div",{className:"flex justify-between items-center p-2 bg-secondary/10 rounded",children:[n.jsx("span",{children:"Toggle AI instructions"}),n.jsx("span",{className:"font-mono bg-secondary/30 px-2 py-0.5 rounded text-xs",children:"Alt + I"})]})]})]})]}),t==="faq"&&n.jsxs("div",{children:[n.jsxs("div",{className:"mb-8",children:[n.jsx("div",{className:"inline-block bg-primary/10 px-3 py-1 rounded-full text-primary text-sm font-medium mb-3",children:"FAQ"}),n.jsx("h2",{className:"text-3xl font-bold mb-4",children:"Frequently Asked Questions"}),n.jsx("p",{className:"text-lg text-muted-foreground mb-6",children:"Find answers to common questions about using Velora."})]}),n.jsxs("div",{className:"space-y-4 mb-8",children:[n.jsxs("div",{className:"bg-card rounded-xl border p-5 shadow-sm",children:[n.jsx("h3",{className:"text-lg font-medium mb-2",children:"Do I need to create an account to use Velora?"}),n.jsx("p",{className:"text-muted-foreground",children:"No, Velora is designed for immediate use without any account creation or sign-up process. You can start chatting right away."})]}),n.jsxs("div",{className:"bg-card rounded-xl border p-5 shadow-sm",children:[n.jsx("h3",{className:"text-lg font-medium mb-2",children:"How do I save my conversations?"}),n.jsx("p",{className:"text-muted-foreground mb-3",children:"You can save your conversations by clicking the Download icon in the chat header. This will save your chat as a JSON file that you can upload later to continue the conversation."}),n.jsxs("div",{className:"bg-secondary/10 rounded-lg p-3 flex items-center gap-3",children:[n.jsx(Ws,{className:"h-5 w-5 text-primary flex-shrink-0"}),n.jsx("p",{className:"text-sm",children:"Look for this icon in the top-right corner of the chat interface."})]})]}),n.jsxs("div",{className:"bg-card rounded-xl border p-5 shadow-sm",children:[n.jsx("h3",{className:"text-lg font-medium mb-2",children:"Can I create my own characters?"}),n.jsx("p",{className:"text-muted-foreground",children:'Yes, you can create custom characters in two ways: by using the AI character generator with keywords, or by manually filling in character details yourself. Both options are available when you click "Select Characters" on the home page.'})]}),n.jsxs("div",{className:"bg-card rounded-xl border p-5 shadow-sm",children:[n.jsx("h3",{className:"text-lg font-medium mb-2",children:"How do I make characters perform actions?"}),n.jsx("p",{className:"text-muted-foreground",children:'To include actions in your messages, simply wrap the action text in asterisks (*). For example: "Hello there! *extends hand for a handshake* Nice to meet you."'})]}),n.jsxs("div",{className:"bg-card rounded-xl border p-5 shadow-sm",children:[n.jsx("h3",{className:"text-lg font-medium mb-2",children:"Is my data private?"}),n.jsx("p",{className:"text-muted-foreground",children:"Yes, your conversations in Velora are private. Since there's no account system, your chats are stored locally in your browser. If you want to save them permanently, you need to download them using the Save Chat feature."})]}),n.jsxs("div",{className:"bg-card rounded-xl border p-5 shadow-sm",children:[n.jsx("h3",{className:"text-lg font-medium mb-2",children:"Can I use Velora on mobile devices?"}),n.jsx("p",{className:"text-muted-foreground",children:"Yes, Velora is fully responsive and works on smartphones and tablets. The interface will adapt to your screen size for the best experience on any device."})]}),n.jsxs("div",{className:"bg-card rounded-xl border p-5 shadow-sm",children:[n.jsx("h3",{className:"text-lg font-medium mb-2",children:"How do I get the AI to respond as a specific character?"}),n.jsx("p",{className:"text-muted-foreground",children:'You can prompt a specific AI character to respond by clicking the "AI Turn" button and selecting the character you want to speak. Alternatively, you can toggle "Auto-respond" to have characters respond automatically.'})]})]}),n.jsxs("div",{className:"bg-gradient-to-r from-primary/5 to-purple-500/5 rounded-xl p-6",children:[n.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Still Have Questions?"}),n.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"If you couldn't find the answer to your question, here are some additional resources:"}),n.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[n.jsxs("div",{className:"bg-background/80 backdrop-blur-sm rounded-lg border border-primary/10 p-4 flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 rounded-full bg-primary/20 flex items-center justify-center text-primary flex-shrink-0",children:n.jsx(yn,{className:"h-5 w-5"})}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium mb-1",children:"Contact Support"}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"Reach out to our support team for personalized help"})]})]}),n.jsxs("div",{className:"bg-background/80 backdrop-blur-sm rounded-lg border border-primary/10 p-4 flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 rounded-full bg-primary/20 flex items-center justify-center text-primary flex-shrink-0",children:n.jsx(tr,{className:"h-5 w-5"})}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium mb-1",children:"Documentation"}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"Browse our detailed documentation for in-depth guides"})]})]})]})]})]})]})})]}),n.jsx("footer",{className:"border-t py-6",children:n.jsxs("div",{className:"container mx-auto max-w-4xl px-4 flex justify-between items-center",children:[n.jsxs("p",{className:"text-sm text-muted-foreground",children:["Made with love, coffee and vibe coding by"," ",n.jsx("a",{href:"https://www.linkedin.com/in/saurao-dalvi/",target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:text-primary/80 transition-colors underline",children:"Saurao Dalvi"})]}),n.jsx("button",{onClick:e,className:"inline-flex items-center justify-center rounded-md bg-primary px-4 py-2 text-sm font-medium text-primary-foreground shadow hover:bg-primary/90",children:"Return to Velora"})]})})]})},Ly=({chatRoom:e,storyArc:t,activeCharacter:s,chatHistory:a})=>{const[r,i]=j.useState(!1),[o,l]=j.useState(null);return j.useEffect(()=>{const c=d=>{var u,g;console.log("Error captured by DebugPanel:",d.error),l({message:((u=d.error)==null?void 0:u.message)||"Unknown error",stack:((g=d.error)==null?void 0:g.stack)||"",time:new Date().toISOString()})};return window.addEventListener("error",c),()=>window.removeEventListener("error",c)},[]),r?n.jsxs("div",{className:"fixed bottom-0 right-0 w-full md:w-1/2 h-1/2 bg-gray-900 text-white p-4 overflow-auto z-50 border-t border-l border-gray-700",children:[n.jsxs("div",{className:"flex justify-between items-center mb-4",children:[n.jsx("h2",{className:"text-xl font-bold",children:"Debug Panel"}),n.jsx("button",{className:"bg-gray-700 px-3 py-1 rounded-md",onClick:()=>i(!1),children:"Close"})]}),o&&n.jsxs("div",{className:"mb-4 p-2 bg-red-900 rounded",children:[n.jsx("h3",{className:"font-bold",children:"Last Error:"}),n.jsx("p",{children:o.message}),n.jsx("p",{className:"text-xs opacity-70",children:o.time}),n.jsx("pre",{className:"text-xs mt-2 overflow-auto max-h-20",children:o.stack})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"bg-gray-800 p-2 rounded",children:[n.jsx("h3",{className:"font-bold mb-2",children:"Chat Room:"}),n.jsx("pre",{className:"text-xs overflow-auto max-h-32",children:e?JSON.stringify(e,null,2):"No chat room data"})]}),n.jsxs("div",{className:"bg-gray-800 p-2 rounded",children:[n.jsx("h3",{className:"font-bold mb-2",children:"Story Arc:"}),n.jsx("pre",{className:"text-xs overflow-auto max-h-32",children:t?JSON.stringify(t,null,2):"No story arc data"})]}),n.jsxs("div",{className:"bg-gray-800 p-2 rounded",children:[n.jsx("h3",{className:"font-bold mb-2",children:"Active Character:"}),n.jsx("pre",{className:"text-xs overflow-auto max-h-32",children:s?JSON.stringify(s,null,2):"No active character"})]}),n.jsxs("div",{className:"bg-gray-800 p-2 rounded",children:[n.jsx("h3",{className:"font-bold mb-2",children:"Chat History:"}),n.jsx("pre",{className:"text-xs overflow-auto max-h-32",children:a&&a.length>0?`${a.length} messages`:"No chat history"})]})]}),n.jsx("div",{className:"mt-4",children:n.jsx("button",{className:"bg-blue-600 px-3 py-1 rounded-md mr-2",onClick:()=>{console.log("Debug data:",{chatRoom:e,storyArc:t,activeCharacter:s,chatHistory:a}),alert("Debug data logged to console")},children:"Log Data to Console"})})]}):n.jsx("button",{className:"fixed bottom-2 right-2 bg-red-600 text-white px-3 py-1 rounded-md z-50",onClick:()=>i(!0),children:"Debug"})};function $y(){const[e,t]=j.useState(()=>localStorage.getItem("velora-visited")?"landing":"onboarding"),[s,a]=j.useState([]),[r,i]=j.useState(null),[o,l]=j.useState([]),[c,d]=j.useState(null),u=f=>{t(f)},g=(f,y,N="",m="",v="")=>{console.log("startChat called with:",{roomName:f,charactersCount:(y==null?void 0:y.length)||0,characterNames:y?y.map(w=>(w==null?void 0:w.name)||"Unnamed").join(", "):"No characters",openingPrompt:N?N.length>50?N.substring(0,50)+"...":N:"None",background:m||"None",theme:v||"None"});try{if(!y||!Array.isArray(y)){console.error("Invalid characters parameter:",y),alert("Error: Invalid character data. Please try again.");return}if(y.length<1){console.warn("No characters selected:",y.length),alert("At least 1 character is required for a conversation. Please select a character.");return}console.log(`Starting chat with ${y.length} characters`);const w=y.filter(P=>!P||typeof P!="object"||!P.name);if(w.length>0){console.error("Invalid characters detected:",w),alert("Some characters have invalid data. Please try again with different characters.");return}const x=N&&N.trim()?N:`Welcome to "${f}". The scene is set and the characters are ready to interact. What happens next is up to you...`,k={name:f||"Chat Room",characters:y,openingPrompt:x,background:m,theme:v,createdAt:new Date().toISOString()};console.log("Setting chatRoom:",k),i(k),console.log("Initializing story arc for:",f);const I=ji(f,x,v);console.log("Setting storyArc:",I),d(I);const T=[{id:Date.now(),system:!0,isNarration:!0,message:"The conversation begins...",timestamp:new Date().toISOString()}];console.log("Getting scenario data for:",f,v);const L=Mn(f,v);if(console.log("Retrieved scenario data:",L?"Found":"Not found"),console.log("Starting chat with scenario:",f),console.log("Characters:",y.map(P=>P.name)),L&&L.initialMessages&&Array.isArray(L.initialMessages)&&L.initialMessages.length>0)console.log("Found scenario data with initial messages:",L.initialMessages.length),L.initialNarration&&(console.log("Adding initial narration:",L.initialNarration.substring(0,50)+"..."),T.push({id:Date.now()+1,system:!0,isNarration:!0,message:L.initialNarration,timestamp:new Date(new Date().getTime()+500).toISOString()})),L.initialMessages.forEach((P,D)=>{if(!P||!P.speaker){console.warn(`Skipping invalid message data at index ${D}:`,P);return}console.log(`Processing initial message from ${P.speaker}`);const q=y.findIndex(A=>A&&A.name===P.speaker);if(q!==-1){console.log(`Found character ${P.speaker} at index ${q}`);const A={...y[q]};let S=P.message||"";S.includes("}")&&(S=S.replace(/\{[^}]*\}/g,""));try{const M=wo(I,A);T.push({id:Date.now()+D+2,speaker:A.name,character:A,message:S,isUser:!1,isAction:P.isAction||!1,timestamp:new Date(new Date().getTime()+1e3*(D+1)).toISOString(),writingInstructions:M})}catch(M){console.error("Error generating writing instructions:",M),T.push({id:Date.now()+D+2,speaker:A.name,character:A,message:S,isUser:!1,isAction:P.isAction||!1,timestamp:new Date(new Date().getTime()+1e3*(D+1)).toISOString()})}}else console.warn(`Character ${P.speaker} not found in characters array!`),console.log("Available characters:",y.map(A=>A.name))});else if(y.length>0){console.log("No scenario data found, adding default greeting from first character");const P=y[0],D=P.opening_line||`Hello! I'm ${P.name}. How can I help you today?`;try{const q=wo(I,P);T.push({id:Date.now()+1,speaker:P.name,character:P,message:D,isUser:!1,timestamp:new Date(new Date().getTime()+1e3).toISOString(),writingInstructions:q})}catch(q){console.error("Error generating writing instructions for default greeting:",q),T.push({id:Date.now()+1,speaker:P.name,character:P,message:D,isUser:!1,timestamp:new Date(new Date().getTime()+1e3).toISOString()})}}console.log("Setting initial chat history with",T.length,"messages"),l(T),console.log("Navigating to chat page"),u("chat")}catch(w){console.error("Error in startChat function:",w),alert("An error occurred while starting the chat. Please try again.")}},h=f=>{const y={name:f.room_name,characters:f.characters,background:f.background||"",theme:f.theme||"",openingPrompt:f.opening_prompt||"",createdAt:f.created_at||new Date().toISOString()};i(y);const N=f.chat_history.map(m=>({...m,id:m.id||Date.now()+Math.random(),timestamp:m.timestamp||new Date().toISOString(),character:m.character||(m.speaker?f.characters.find(v=>v.name===m.speaker):null)}));if(l(N),f.story_arc)d(f.story_arc);else{const m=ji(y.name,y.openingPrompt,y.theme);d(m)}u("chat")},p=()=>{const f={room_name:r.name,characters:r.characters,chat_history:o,background:r.background||"",theme:r.theme||"",opening_prompt:r.openingPrompt||"",created_at:r.createdAt||new Date().toISOString(),updated_at:new Date().toISOString(),story_arc:c||ji(r.name,r.openingPrompt,r.theme),version:"1.2.0"},y=new Blob([JSON.stringify(f,null,2)],{type:"application/json"}),N=URL.createObjectURL(y),m=document.createElement("a");return m.href=N,m.download=`velora-chat-${r.name.replace(/\s+/g,"-").toLowerCase()}-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(m),m.click(),document.body.removeChild(m),URL.revokeObjectURL(N),!0};return j.useEffect(()=>{e!=="onboarding"&&localStorage.setItem("velora-visited","true")},[e]),n.jsx(Ef,{defaultTheme:"dark",storageKey:"velora-theme",children:n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Ly,{chatRoom:r,storyArc:c,activeCharacter:s[0],chatHistory:o}),e==="onboarding"&&n.jsx(Ay,{onComplete:f=>{f&&f.length>0?(a(f),g("Character Chat",f)):u("landing")},onSelectCharacter:()=>u("character-selection"),onCreateScenario:()=>u("custom-scenario"),onQuickStart:()=>u("quick-scenario")}),e==="landing"&&n.jsx(ig,{onSelectCharacter:()=>u("character-selection"),onCreateScenario:()=>u("custom-scenario"),onQuickStart:()=>u("quick-scenario"),onUploadChat:f=>h(f),onHowToUse:()=>u("how-to-use"),onStartChat:(f,y,N,m,v)=>g(f,y,N,m,v)}),e==="how-to-use"&&n.jsx(Ey,{onBack:()=>u("landing")}),e==="character-selection"&&n.jsx(bg,{selectedCharacters:s,setSelectedCharacters:a,onStartChat:()=>u("scenario-selection"),onBack:()=>u("landing")}),e==="scenario-selection"&&n.jsx(Iy,{selectedCharacters:s,onBack:()=>u("character-selection"),onContinue:f=>g(f.title,f.characters,f.prompt,f.background)}),e==="chat"&&n.jsx(fy,{chatRoom:r,chatHistory:o,setChatHistory:l,storyArc:c,setStoryArc:d,onSaveChat:p,onLeaveChat:()=>u("landing"),onHowToUse:()=>u("how-to-use")}),e==="custom-scenario"&&n.jsx(Ty,{onCreateRoom:(f,y,N,m,v,w)=>g(f,y,N,v,w),onBack:()=>u("landing")}),e==="quick-scenario"&&n.jsx(Cy,{onStartChat:(f,y,N,m,v,w)=>g(f,y,N,v,w),onBack:()=>u("landing")})]})})}const Sh=Object.entries;Object.entries=function(e){return e==null?(console.warn("Object.entries called with null/undefined. Returning empty array instead of throwing error."),[]):Sh(e)};Object.safeEntries||(Object.safeEntries=function(e){return e==null?[]:Sh(e)});Si.createRoot(document.getElementById("root")).render(n.jsx(xm.StrictMode,{children:n.jsx($y,{})}));
